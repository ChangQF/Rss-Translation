<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>ä¸»åŠ¨é—®é¢˜æ ‡è®°çš„æœºå™¨å­¦ä¹  - å †æ ˆæº¢å‡º</title>
    <link>https://stackoverflow.com/questions/tagged/?tagnames=machine-learning&sort=active</link>
    <description>æœ€è¿‘çš„30ä¸ªæ¥è‡ªstackoverflow.com</description>
    <lastBuildDate>Wed, 26 Mar 2025 06:25:40 GMT</lastBuildDate>
    <item>
      <title>å¦‚ä½•åœ¨æ²¡æœ‰è‡ªåŠ¨å·®å¼‚çš„ç¥ç»ç½‘ç»œçš„æƒ…å†µä¸‹å®æ–½åå‘ä¼ æ’­ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/79535519/how-to-implement-backpropagation-without-auto-differentiation-for-a-feedforward</link>
      <description><![CDATA[æˆ‘æ­£åœ¨ç ”ç©¶ä¸€ä¸ªæ·±åº¦å­¦ä¹ ä»»åŠ¡ï¼Œè¯¥ä»»åŠ¡éœ€è¦ä½¿ç”¨ä»…ä½¿ç”¨ numpy ï¼ˆæ²¡æœ‰Tensorflowï¼ŒPytorchæˆ–å…¶ä»–è‡ªåŠ¨åˆ†è¾¨ç‡å·¥å…·ï¼‰å®ç° feedforwardç¥ç»ç½‘ç»œï¼ˆFNNï¼‰ã€‚è¯¥ç½‘ç»œå…·æœ‰ä¸‰å±‚ï¼ˆ2048ã€512ã€10ä¸ªç¥ç»å…ƒï¼‰ï¼Œä½¿ç”¨ reluå’ŒSoftMaxæ¿€æ´»ï¼Œå¹¶ç”¨ mini-Batchéšæœºæ¸å˜ï¼ˆSGDï¼‰è¿›è¡Œäº†ä¼˜åŒ–ã€‚
åˆ†é…éœ€è¦æ‰‹åŠ¨å®æ–½å‘å‰ä¼ æ’­ï¼Œåå‘ä¼ æ’­å’Œé‡é‡æ›´æ–°ï¼Œä»¥ç¡®ä¿æˆ‘ä½¿ç”¨ BackPropagation AlgorithM  ç¡®ä¿æˆ‘æ­£ç¡®è®¡ç®—æ¯ä¸ªå±‚çš„æ¢¯åº¦ã€‚ã€‚
ä½†æ˜¯ï¼Œæˆ‘æ­£åœ¨åŠªåŠ›æ­£ç¡®åœ°è®¡ç®—æ¯ä¸ªå±‚çš„æ¢¯åº¦ï¼Œå°¤å…¶æ˜¯å½“å¤„ç† reluæ¿€æ´»çš„è¡ç”Ÿç‰©å’Œ softmax æ—¶ã€‚æˆ‘æƒ³ç¡®è®¤æˆ‘çš„æ¢¯åº¦è®¡ç®—å’Œé‡é‡æ›´æ–°æ˜¯æ­£ç¡®çš„ã€‚
 å¯¼å…¥numpyä½œä¸ºNP

def reluï¼ˆxï¼‰ï¼š
    è¿”å›np.maximumï¼ˆ0ï¼Œxï¼‰

def relu_derivativeï¼ˆxï¼‰ï¼š
    è¿”å›ï¼ˆxï¼†gt; 0ï¼‰.astypeï¼ˆfloatï¼‰ï¼ƒrelu derivativeï¼ˆ1å¦‚æœxï¼†gt; 0ï¼Œelse 0ï¼‰

def softmaxï¼ˆxï¼‰ï¼š
    exp_x = np.expï¼ˆx -np.maxï¼ˆxï¼Œaxis = 1ï¼Œkeepdims = trueï¼‰ï¼‰ï¼ƒç¨³å®šæŠ€å·§
    è¿”å›exp_x / np.sumï¼ˆexp_xï¼Œaxis = 1ï¼Œkeepdims = trueï¼‰

def cross_entropy_lossï¼ˆy_predï¼Œy_trueï¼‰ï¼š
    è¿”å›-np.meanï¼ˆnp.sumï¼ˆy_true * np.logï¼ˆy_pred + 1e -9ï¼‰ï¼Œè½´= 1ï¼‰ï¼‰ï¼ƒé˜²æ­¢logï¼ˆ0ï¼‰

def softmax_cross_entropy_gradï¼ˆy_predï¼Œy_trueï¼‰ï¼š
    è¿”å›y_pred -y_trueï¼ƒsoftmax +è·¨æ¸—é€è¡ç”Ÿç‰©

def gradient_checkï¼ˆï¼‰ï¼š
    np.random.seedï¼ˆ42ï¼‰ï¼ƒç¡®ä¿å¯é‡å¤æ€§
    
    ï¼ƒå‡è¾“å…¥ï¼ˆbatch_size = 3ï¼Œinput_dim = 5ï¼‰
    x = np.random.randnï¼ˆ3ï¼Œ5ï¼‰
    w1 = np.random.randnï¼ˆ5ï¼Œ4ï¼‰
    b1 = np.zerosï¼ˆï¼ˆ1ï¼Œ4ï¼‰ï¼‰

    ï¼ƒå‡å¼å•å£ç¼–ç æ ‡ç­¾ï¼ˆbatch_size = 3ï¼Œnum_classes = 4ï¼‰
    y = np.Arrayï¼ˆ[[[0ï¼Œ1ï¼Œ0ï¼Œ0]ï¼Œ 
                  [1ï¼Œ0ï¼Œ0ï¼Œ0]ï¼Œ 
                  [0ï¼Œ0ï¼Œ1ï¼Œ0]]ï¼‰

    z1 = np.dotï¼ˆxï¼Œw1ï¼‰ + b1
    a1 = reluï¼ˆz1ï¼‰
    y_pred = softmaxï¼ˆa1ï¼‰
    æŸå¤±= cross_entropy_lossï¼ˆy_predï¼Œyï¼‰

    dl_da1 = softmax_cross_entropy_gradï¼ˆy_predï¼Œyï¼‰ï¼ƒæ¸å˜W.R.T. SoftMaxè¾“å‡º
    dl_dz1 = dl_da1 * relu_derivativeï¼ˆz1ï¼‰ï¼ƒä¸reluçš„é“¾æ¡è§„åˆ™

    æ‰“å°ï¼ˆy_predï¼ˆSoftMaxè¾“å‡ºï¼‰ï¼š\ nï¼†quort y_predï¼‰
    æ‰“å°ï¼ˆâ€œæŸå¤±ï¼š; quotâ€æŸå¤±ï¼‰
    æ‰“å°ï¼ˆ&#39;æ¢¯åº¦W.R.T. SoftMaxè¾“å‡ºï¼ˆDL/DA1ï¼‰ï¼š\ nï¼†quort; dl_da1ï¼‰
    æ‰“å°ï¼ˆ``relu derivative&#39;&#39;ä¹‹åçš„æ¸å˜ï¼ˆdl/dz1ï¼‰ï¼š\ nï¼†quort; dl_dz1ï¼‰

gradient_checkï¼ˆï¼‰
 
æˆ‘ä»…ä½¿ç”¨ numpy å¹¶æ‰‹åŠ¨è®¡ç®—çš„åå‘ä¼ æ’­å®ç°äº† feedforwardç¥ç»ç½‘ç»œï¼ˆFNNï¼‰ã€‚æˆ‘æœŸæœ›æŸå¤±ä¼šé™ä½å’Œçš„å‡†ç¡®æ€§ï¼Œä½†ç›¸åï¼ŒæŸå¤±æ³¢åŠ¨ï¼Œå‡†ç¡®æ€§ä¿æŒ low ï¼Œæœ‰æ—¶æ¢¯åº¦ çˆ†ç‚¸æˆ–æˆä¸ºnan ã€‚æˆ‘æ€€ç–‘ reluçš„å¯¼æ•°å’Œ softmax +äº¤å‰æ¸—é€æ¢¯åº¦è®¡ç®—çš„é—®é¢˜ï¼Œéœ€è¦éªŒè¯æˆ‘çš„åå‘ä¼ æ’­æ˜¯å¦æ­£ç¡®ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/79535519/how-to-implement-backpropagation-without-auto-differentiation-for-a-feedforward</guid>
      <pubDate>Wed, 26 Mar 2025 05:59:43 GMT</pubDate>
    </item>
    <item>
      <title>æˆ‘ä½¿ç”¨densenet-169åˆ›å»ºäº†ä½¿ç”¨ç»„ç»‡ç—…ç†å­¦å›¾åƒé¢„æµ‹ç»“è‚ ç™Œçš„æ¨¡å‹ï¼Œæˆ‘è¯¥æ€ä¹ˆåšæ‰èƒ½å°†F1åˆ†æ•°ä»75ï¼…æé«˜ã€‚</title>
      <link>https://stackoverflow.com/questions/79535469/i-used-densenet-169-in-creating-a-model-for-predicting-colon-cancer-using-histop</link>
      <description><![CDATA[æˆ‘ä½¿ç”¨Pythonåœ¨10,000å¼ å›¾åƒçš„æ•°æ®é›†ä¸Šä½¿ç”¨Densenet169åˆ›å»ºäº†ä¸€ä¸ªæ¨¡å‹ï¼Œä»¥é¢„æµ‹ç»“è‚ ç™Œï¼Œä¸¤ä¸ªå­æ–‡ä»¶å¤¹æœ‰5000å¼ å›¾åƒï¼Œæ¯å¼ å›¾åƒ5000å¼ å›¾åƒç”¨äºè‰¯æ€§å’Œç™Œç»„ç»‡ã€‚è®­ç»ƒæŒç»­äº†8å°æ—¶ï¼Œè®­ç»ƒåçš„F1åˆ†æ•°ä¸º0.75ï¼Œè¿™æ˜¯ä¸å¯å–çš„ã€‚æˆ‘è¯•å›¾æŸ¥çœ‹æˆ‘å¯ä»¥åšå‡ºçš„æ›´æ”¹ä»¥æ”¹å–„æŒ‡æ ‡ï¼Œä½†æ˜¯æˆ‘æ²¡æœ‰ä»»ä½•æ›´æ”¹çš„æ–¹æ³•ï¼Œå¹¶ä¸”éœ€è¦å¸®åŠ©ç¡®å®šå¯ä»¥åœ¨å“ªé‡Œè¿›è¡Œæ›´æ”¹ä»¥æé«˜F1åˆ†æ•°ã€‚è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡ä»äº‹è¿™æ ·çš„äº‹æƒ…ï¼Œæˆ‘å‘ç°æ²¡æœ‰åœ¨çº¿ææ–™è¿›è¡Œæ·±åº¦å­¦ä¹ å¯ä»¥å¸®åŠ©æˆ‘è§£å†³è¿™ä¸ªé—®é¢˜
 å°†TensorFlowå¯¼å…¥ä¸ºTF
æ¥è‡ªTensorflow.keras.applicationså¯¼å…¥Densenet169
æ¥è‡ªtensorflow.keras.layerså¯¼å…¥å¯†é›†ï¼Œglobalaveration -pooling2dï¼ŒRandomflipï¼ŒRandomRotationï¼Œè¾å­¦
æ¥è‡ªTensorflow.keras.modelså¯¼å…¥æ¨¡å‹ï¼Œé¡ºåº
æ¥è‡ªTensorflow.keras.optimizerå¯¼å…¥Adam
ä»tensorflow.keras.regulinizerå¯¼å…¥l2
æ¥è‡ªtensorflow.keras.applications.densenetå¯¼å…¥preprocess_input
æ¥è‡ªsklearn.metricså¯¼å…¥æ··æ·†_matrixï¼Œf1_score
å¯¼å…¥numpyä½œä¸ºNP
è¿›å£æµ·æ´‹ä½œä¸ºSNS
å¯¼å…¥matplotlib.pyplotä½œä¸ºPLT
å¯¼å…¥æ“ä½œç³»ç»Ÿ

ï¼ƒå®šä¹‰å¸¸æ•°
img_size =ï¼ˆ224ï¼Œ224ï¼‰ï¼ƒåŒ¹é…densenet169è¾“å…¥å¤§å°
batch_size = 32
æ—¶ä»£= 15
data_dir =ï¼†quot; colon_imagesï¼†quot;
class_names = [ï¼†quast; cancyous&#39;&#39;æ­£å¸¸ï¼†quot;]
split_ratio = 0.2

ï¼ƒç›´æ¥åŠ è½½æ•°æ®é›†åœ¨224x224
def create_datasetï¼ˆå­é›†ï¼‰ï¼š
    è¿”å›tf.keras.utils.image_dataset_from_directoryï¼ˆ
        data_dirï¼Œ
        éªŒè¯_split = split_ratioï¼Œ
        å­é›†=å­é›†
        ç§å­= 42ï¼Œ
        image_size = img_sizeï¼Œï¼ƒç›´æ¥ä»¥ç›®æ ‡å¤§å°åŠ è½½
        batch_size = batch_sizeï¼Œ
        label_mode =&#39;binary&#39;
    ï¼‰

train_ds = create_datasetï¼ˆâ€œè®­ç»ƒâ€ï¼‰
val_ds = create_datasetï¼ˆ&#39;éªŒè¯ï¼†quot;ï¼‰

ï¼ƒé€šè¿‡å¢å¼ºè¿›è¡Œé¢„å¤„ç†ï¼ˆä»…åœ¨åŸ¹è®­æœŸé—´æ´»è·ƒï¼‰
é¢„å¤„ç†=é¡ºåºï¼ˆ[
    Randomflipï¼ˆâ€œæ°´å¹³â€ï¼Œâ€œï¼‰ï¼Œ
    éšæœºæ—‹è½¬ï¼ˆ0.1ï¼‰ï¼Œ
    tf.keras.layers.lambdaï¼ˆpreprocess_inputï¼‰ï¼ƒæ­£ç¡®å½’ä¸€åŒ–
ï¼‰ï¼‰ï¼‰

ï¼ƒæ„å»ºæ¨¡å‹
base_model = densenet169ï¼ˆ
    æƒé‡=&#39;Imagenet&#39;ï¼Œ
    include_top = falseï¼Œ
    input_shape = img_size +ï¼ˆ3ï¼Œï¼‰
ï¼‰

è¾“å…¥= tf.keras.inputï¼ˆshape = img_size +ï¼ˆ3ï¼Œï¼‰ï¼‰
X =é¢„å¤„ç†ï¼ˆè¾“å…¥ï¼‰
x = base_modelï¼ˆxï¼‰
x = globalaveragepooling2dï¼ˆï¼‰ï¼ˆxï¼‰
x =å¯†é›†ï¼ˆ512ï¼Œæ¿€æ´»=&#39;relu&#39;ï¼Œkernel_regularizer = l2ï¼ˆ0.01ï¼‰ï¼‰ï¼ˆxï¼‰
x =è¾å­¦ï¼ˆ0.5ï¼‰ï¼ˆxï¼‰ï¼ƒæ­£åˆ™åŒ–
è¾“å‡º=å¯†é›†ï¼ˆ1ï¼Œæ¿€æ´»=&#39;Sigmoid&#39;ï¼‰ï¼ˆxï¼‰
æ¨¡å‹=æ¨¡å‹ï¼ˆè¾“å…¥ï¼Œè¾“å‡ºï¼‰

ï¼ƒé˜¶æ®µ1ï¼šç«è½¦é¡¶å±‚
base_model.trainable = false
model.compileï¼ˆ
    ä¼˜åŒ–å™¨= ADAMï¼ˆ1E-3ï¼‰ï¼Œ
    æŸå¤±=&#39;binary_crossentropy&#39;ï¼Œ
    é‡è¡¨= [&#39;fecycy&#39;ï¼Œtf.keras.metrics.aucï¼ˆname =&#39;auc&#39;ï¼‰ï¼Œ
             tf.keras.metrics.precisionï¼ˆname =&#39;precision&#39;ï¼‰ï¼Œ
             tf.keras.metrics.Recallï¼ˆname =&#39;recember&#39;ï¼‰]
ï¼‰

ï¼ƒç”¨å›è°ƒç›‘è§†AUCçš„ç«è½¦
æ—©æœŸ_stop = tf.keras.callbacks.earlystoppingï¼ˆ
    Monitor =&#39;Val_auc&#39;ï¼Œè€å¿ƒ= 3ï¼Œæ¨¡å¼=&#39;max&#39;ï¼Œè¯¦ç»†= 1
ï¼‰
æ£€æŸ¥ç‚¹= tf.keras.callbacks.modelcheckpointï¼ˆ
    &#39;best_model.h5&#39;ï¼Œsave_best_only = trueï¼Œmonitor =&#39;val_auc&#39;ï¼Œmode =&#39;max&#39;
ï¼‰

å†å²= model.fitï¼ˆ
    train_dsï¼Œ
    éªŒè¯_data = val_dsï¼Œ
    æ—¶ä»£= epochsï¼Œ
    å›è°ƒ= [æ—©æœŸ_STOPï¼Œæ£€æŸ¥ç‚¹]
ï¼‰

ï¼ƒé˜¶æ®µ2ï¼šå¾®è°ƒæ•´ä¸ªæ¨¡å‹
base_model.trainable = true
model.compileï¼ˆ
    ä¼˜åŒ–å™¨= ADAMï¼ˆ1E-5ï¼‰ï¼Œï¼ƒéå¸¸ä½çš„å­¦ä¹ ç‡
    æŸå¤±=&#39;binary_crossentropy&#39;ï¼Œ
    é‡è¡¨= [&#39;facer&#39;ï¼Œtf.keras.metrics.aucï¼ˆname =&#39;auc&#39;ï¼‰]
ï¼‰

history_fine = model.fitï¼ˆfitï¼‰ï¼ˆ
    train_dsï¼Œ
    éªŒè¯_data = val_dsï¼Œ
    æ—¶ä»£= epochsï¼Œ
    onirome_epoch = history.epoch [-1]ï¼Œ
    å›è°ƒ= [æ—©æœŸ_STOPï¼Œæ£€æŸ¥ç‚¹]
ï¼‰

ï¼ƒ è¯„ä¼°
y_pred =ï¼ˆmodel.predictï¼ˆval_dsï¼‰ï¼†gt; 0.5ï¼‰.astypeï¼ˆintï¼‰
y_true = np.concatenateï¼ˆ[y for _ï¼Œy in val_ds]ï¼Œaxis = 0ï¼‰

æ‰“å°ï¼ˆfï¼†quot f1åˆ†æ•°ï¼š{f1_scoreï¼ˆy_trueï¼Œy_predï¼‰ï¼šã€‚3f}ï¼†quot;ï¼‰
 ]]></description>
      <guid>https://stackoverflow.com/questions/79535469/i-used-densenet-169-in-creating-a-model-for-predicting-colon-cancer-using-histop</guid>
      <pubDate>Wed, 26 Mar 2025 05:27:58 GMT</pubDate>
    </item>
    <item>
      <title>æˆ‘çš„åŠ æƒåŠ¨æ€æ—¶é—´æ‰­æ›²ç®—æ³•ä¸­æ˜¯å¦å­˜åœ¨é”™è¯¯</title>
      <link>https://stackoverflow.com/questions/79535435/is-there-an-error-in-my-weighted-dynamic-time-warping-algorithm</link>
      <description><![CDATA[ä½¿ç”¨å¹³å‡å½’ä¸€åŒ–ï¼Œå¹¶ä¸ºç®—æ³•ä¸­çš„è¾“å…¥è¿›è¡Œä¿®æ”¹çš„é€»è¾‘æƒé‡å‡½æ•°ã€‚ä¸ç¡®å®šæˆ‘çš„ä»£ç æˆ–æˆ‘çš„æ•°æ®æ˜¯å¦å¼„ä¹±äº†ï¼Œä½¿ç”¨äº†ä¸¤ä¸ªä¸åŒäººçš„æ­¥æ€æ•°æ®æ•°æ®é›†ï¼Œè€Œæˆ‘çš„è·ç¦»æœ€ç»ˆæ˜¯ï¼š0.06495056266749273 
æˆ‘å°†ä»¥ä¸‹å…¬å¼ç”¨äºWDTWå’Œä¿®æ”¹åçš„é€»è¾‘æƒé‡å‡½æ•°ï¼š
      def stripfunctionï¼ˆi_jï¼Œgï¼Œw_maxï¼‰ï¼š#calculatesä¿®æ”¹åçš„é€»è¾‘æƒé‡å‡½æ•°
  å°ºå¯¸= lenï¼ˆxï¼‰
  m_c = size // 2

  è¿”å›w_max /ï¼ˆ1 + np.expï¼ˆ-g*ï¼ˆi_j -m_cï¼‰ï¼‰ï¼‰

def euclidean_distancesï¼ˆxï¼Œyï¼‰ï¼š
      è¿”å›np.sqrtï¼ˆnp.sumï¼ˆï¼ˆï¼ˆx -yï¼‰** 2ï¼‰ï¼‰ï¼‰

def witeeddtwï¼ˆxï¼Œyï¼Œvector = trueï¼‰ï¼š
  w_max = 3

  nï¼Œm = X.Shape [0]ï¼Œy.Shape [0]
  æˆæœ¬= np r.zerosï¼ˆï¼ˆï¼ˆnï¼Œmï¼‰ï¼‰

  æˆæœ¬[0,0] = euclidean_distancesï¼ˆx [0]ï¼Œy [0]ï¼‰

  å¯¹äºæˆ‘åœ¨èŒƒå›´ï¼ˆ1ï¼Œnï¼‰ä¸­ï¼š
    æˆæœ¬[iï¼Œ0] =æˆæœ¬[I-1ï¼Œ0] + Euclidean_distancesï¼ˆx [i]ï¼Œy [0]ï¼‰

  å¯¹äºJèŒƒå›´ï¼ˆ1ï¼Œmï¼‰çš„Jï¼š
    æˆæœ¬[0ï¼Œj] =æˆæœ¬[0ï¼Œj-1] + euclidean_distancesï¼ˆx [0]ï¼Œy [j]ï¼‰


  å¯¹äºæˆ‘åœ¨èŒƒå›´ï¼ˆ1ï¼Œnï¼‰ä¸­ï¼š
    å¯¹äºJèŒƒå›´ï¼ˆ1ï¼Œmï¼‰çš„Jï¼š
      i_j = euclidean_distancesï¼ˆx [i]ï¼Œy [j]ï¼‰
      w =é‡é‡å‡½æ•°ï¼ˆI_Jï¼Œ0.4ï¼ŒW_MAXï¼‰
      min_value = minï¼ˆ[æˆæœ¬[I-1ï¼ŒJ-1]ï¼Œæˆæœ¬[I-1ï¼ŒJ]ï¼Œæˆæœ¬[Iï¼ŒJ-1]]ï¼‰
      æˆæœ¬[iï¼Œj] = w * i_j + min_value

    max_dist = w_max *ï¼ˆn + m -2ï¼‰
    norm_dist = cop [n-1ï¼Œm-1] / max_dist


  é€€è´§æˆæœ¬[N-1ï¼ŒM-1]ï¼ŒNORM_DIST

x_norm =ï¼ˆx -np.meanï¼ˆxï¼Œaxis = 0ï¼‰ï¼‰ /ï¼ˆnp.maxï¼ˆxï¼Œaxis = 0ï¼‰-np.minï¼ˆxï¼Œaxis = 0ï¼‰ï¼‰

y_norm =ï¼ˆy -np.meanï¼ˆyï¼Œaxis = 0ï¼‰ï¼‰ /ï¼ˆnp.maxï¼ˆyï¼Œaxis = 0ï¼‰-np.minï¼ˆyï¼Œaxis = 0ï¼‰ï¼‰


ï¼ƒè®¡ç®—WDTW
è·ç¦»ï¼Œå½’ä¸€åŒ–=åŠ æƒdtwï¼ˆx_norm [ï¼šï¼Œ0]ï¼Œy_norm [ï¼šï¼Œ0]ï¼‰

æ‰“å°ï¼ˆfï¼†quot&#39;wdtwè·ç¦»ï¼š{demand}ï¼†quot;ï¼‰
æ‰“å°ï¼ˆfï¼†quotâ€œå½’ä¸€åŒ–wdtwè·ç¦»ï¼š{normolized_distance}ï¼†quortâ€ï¼‰
 ]]></description>
      <guid>https://stackoverflow.com/questions/79535435/is-there-an-error-in-my-weighted-dynamic-time-warping-algorithm</guid>
      <pubDate>Wed, 26 Mar 2025 04:58:34 GMT</pubDate>
    </item>
    <item>
      <title>è®­ç»ƒé‡ï¼šâ€œåŒ…è£…â€å’Œâ€œ group_by_lengthâ€ç›¸äº’æŠµæ¶ˆï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/79533473/trainingarguments-do-packing-and-group-by-length-counteract-each-other</link>
      <description><![CDATA[åœ¨huggingfaceçš„ sftConfig ï¼ˆä» trieb&gt; triagn&gt; triagn&gt; triebs triaght&gt; triaghtarguments ï¼‰ä¸­ï¼Œæœ‰ä¸¤ä¸ªå‚ä¸priaged ï¼‰


  group_by_length ï¼šæ˜¯å¦å°†è®­ç»ƒæ•°æ®é›†ä¸­å¤§è‡´ç›¸åŒé•¿åº¦çš„æ ·æœ¬ç»„åˆåœ¨ä¸€èµ·ï¼ˆä»¥æœ€å¤§ç¨‹åº¦åœ°å‡å°‘åº”ç”¨çš„å¡«å……å¹¶æ›´æœ‰æ•ˆï¼‰ã€‚ä»…åœ¨åº”ç”¨åŠ¨æ€å¡«å……æ—¶æœ‰ç”¨ã€‚
 åŒ…è£…ï¼šæ˜¯å¦å°†å¤šä¸ªåºåˆ—æ‰“åŒ…åˆ°å›ºå®šé•¿åº¦æ ¼å¼ä¸­ã€‚ä½¿ç”¨ max_length å®šä¹‰åºåˆ—é•¿åº¦ã€‚


  config = sftConfigï¼ˆ...ï¼Œï¼Œï¼Œ 
                   group_by_length = trueï¼Œ 
                   åŒ…è£…= trueï¼Œ...ï¼‰
 
è¿™äº›è®ºç‚¹çš„ç›®çš„æ˜¯å‡å°‘å¡«å……æ¡¨çš„åŠªåŠ›ã€‚ä½†æ˜¯ï¼Œå½“ packing = true æ—¶ï¼Œä½¿ç”¨ ä½¿ç”¨ group_by_length = true ã€‚æˆ‘ä»¬æ˜¯å¦å¯ä»¥ä¸¤è€…éƒ½æé«˜è®­ç»ƒè¡¨ç°ï¼Ÿä»–ä»¬äº’ç›¸æŠµæ¶ˆå—ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/79533473/trainingarguments-do-packing-and-group-by-length-counteract-each-other</guid>
      <pubDate>Tue, 25 Mar 2025 11:13:20 GMT</pubDate>
    </item>
    <item>
      <title>GOCVå’ŒPython OpenCVä¹‹é—´çš„æ¨æ–­ç»“æœä¸åŒ</title>
      <link>https://stackoverflow.com/questions/79533406/different-inference-results-between-gocv-and-python-opencv</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/79533406/different-inference-results-between-gocv-and-python-opencv</guid>
      <pubDate>Tue, 25 Mar 2025 10:48:10 GMT</pubDate>
    </item>
    <item>
      <title>åœ¨HuggingFace Seq2Seqtrainerä¸­ä½¿ç”¨åŸ¹è®­ï¼ŒéªŒè¯å’Œæµ‹è¯•é›†[é—­åˆ]</title>
      <link>https://stackoverflow.com/questions/79532570/use-of-training-validation-and-test-set-in-huggingface-seq2seqtrainer</link>
      <description><![CDATA[ iå…·æœ‰ä»¥ä¸‹æ•°æ®é›†ï¼Œè¯¥æ•°æ®é›†å…·æœ‰3ä¸ªæ‹†åˆ†ï¼ˆ Train ï¼ŒéªŒè¯å’Œ test ï¼‰ã€‚æ•°æ®æ˜¯2ç§è¯­è¨€çš„å¹³è¡Œè¯­æ–™åº“ã€‚
  datasetDictï¼ˆ{{
    ç«è½¦ï¼šæ•°æ®é›†ï¼ˆ{
        åŠŸèƒ½ï¼š[&#39;translation&#39;]ï¼Œ
        num_rowsï¼š109942
    }ï¼‰ï¼‰
    éªŒè¯ï¼šæ•°æ®é›†ï¼ˆ{
        åŠŸèƒ½ï¼š[&#39;translation&#39;]ï¼Œ
        num_rowsï¼š6545
    }ï¼‰ï¼‰
    æµ‹è¯•ï¼šæ•°æ®é›†ï¼ˆ{
        åŠŸèƒ½ï¼š[&#39;translation&#39;]ï¼Œ
        num_rowsï¼š13743
    }ï¼‰ï¼‰
}ï¼‰ï¼‰
 
å¯¹äºæˆ‘çš„ seq2seqtrainer ï¼Œæˆ‘æä¾›æ•°æ®é›†å¦‚ä¸‹ï¼š
  trainer = seq2seqtrainerï¼ˆ
    æ¨¡å‹=æ¨¡å‹ï¼Œ
    args =è®­ç»ƒ_argsï¼Œ
    train_dataset = tokenized_dataset [&#39;train&#39;]ï¼Œ
    eval_dataset = tokenized_dataset [&#39;éªŒè¯&#39;]ï¼Œ
    tokenizer = tokenizerï¼Œ
    data_collatâ€‹â€‹or = data_collatâ€‹â€‹orï¼Œ
    compute_metrics = compute_metricsï¼Œ
ï¼‰
 
å°†éªŒè¯æ‹†åˆ† ever_dataset ä¸­çš„æ‹†åˆ†æ˜¯æ­£ç¡®çš„å—ï¼Ÿåœ¨ documentation&gt; documentation 

ç”¨äºè¯„ä¼°çš„æ•°æ®é›†ã€‚å¦‚æœæ˜¯æ•°æ®é›†ï¼Œåˆ™è‡ªåŠ¨åˆ é™¤ model.forwardï¼ˆï¼‰æ–¹æ³•æœªæ¥å—çš„åˆ—ã€‚å¦‚æœæ˜¯å­—å…¸ï¼Œå®ƒå°†åœ¨æ¯ä¸ªæ•°æ®é›†ä¸Šè¿›è¡Œè¯„ä¼°ã€‚

æˆ–è€…æˆ‘åº”è¯¥å°†æµ‹è¯•åˆ†é…åœ¨ eval_dataset ä¸­ï¼Ÿæ— è®ºå“ªç§æ–¹å¼ï¼Œéƒ½æ²¡æœ‰ä½¿ç”¨å…¶ä¸­ä¸€ä¸ªåˆ†è£‚ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/79532570/use-of-training-validation-and-test-set-in-huggingface-seq2seqtrainer</guid>
      <pubDate>Tue, 25 Mar 2025 02:22:21 GMT</pubDate>
    </item>
    <item>
      <title>Lora Fineted Llama 8bçš„è‡ªå®šä¹‰å‰å¾€å‰æ–¹æ³• - ä½¿ç”¨Unsploth</title>
      <link>https://stackoverflow.com/questions/79531231/custom-forward-method-for-lora-finetuned-llama-8b-using-unsloth</link>
      <description><![CDATA[æˆ‘æ­£åœ¨å°è¯•å¯¹æˆ‘çš„å›ºå®šæ¨¡å‹è¿›è¡Œä¸€äº›æ¶ˆèç ”ç©¶ã€‚è¯•å›¾è¶…è½½å‰å‘æ–¹æ³•
 ç±»GROK_CUSTOMPEFTCAUSALLMï¼ˆTORCH.NN.MODULEï¼‰ï¼š
def __init __ï¼ˆè‡ªæˆ‘ï¼Œæ¨¡å‹ï¼‰ï¼š
    superï¼ˆï¼‰.__ init __ï¼ˆï¼‰
    self.model =å‹å·ï¼ƒåŸå§‹fastlanguagemodel

    ï¼ƒä¿®è¡¥å†…éƒ¨æ¨¡å‹çš„å‰è¿›
    orig_forward = self.model.model.forward

    def new_forwardï¼ˆinned_selfï¼Œinput_idsï¼Œactivation_mask = noneï¼Œnum_logits_to_keep = noneï¼Œ** kwargsï¼‰ï¼š
        æ‰“å°ï¼ˆ&#39;ğŸ”¹è‡ªå®šä¹‰å‰è¿›è¢«è°ƒç”¨ï¼ï¼†quot; flush = trueï¼‰

        ï¼ƒåµŒå…¥
        hidden_â€‹â€‹states = inner_self.model.embed_tokensï¼ˆinput_idsï¼‰
        æ‰“å°ï¼ˆåµŒå…¥åéšè—çŠ¶æ€ï¼š{hidden_â€‹â€‹states.shape}ï¼†quot; flush = trueï¼‰

        ï¼ƒæ³¨æ„é¢å…·
        å¦‚æœactive_maskæ— ï¼š
            activation_mask = torch.onesï¼ˆinput_ids.shapeï¼Œdtype = type = turch.bfloat16ï¼Œdevice = input_ids.deviceï¼‰.boolï¼ˆï¼‰
        åˆ«çš„ï¼š
            ##å¼ºåˆ¶å…¥bool
            activation_mask = activation_mask.boolï¼ˆï¼‰

        ï¼ƒå±‚
        past_key_values =æ— 
        å¯¹äºiï¼Œåœ¨æšä¸¾ä¸­å±‚ï¼ˆinner_self.model.layersï¼‰ï¼š
            æ‰“å°ï¼ˆfï¼†quot&#39;layer {i}ï¼†quotï¼†quotï¼†clush = trueï¼‰
            layer_output = layerï¼ˆhidden_â€‹â€‹statesï¼Œactivation_mask = activation_maskï¼‰
            printï¼ˆf&#39;layer {i} outputï¼š{typeï¼ˆlayer_outputï¼‰}ï¼Œlenï¼š{lenï¼ˆlayer_outputï¼‰å¦‚æœisInstanceï¼ˆlayer_outputï¼Œtupleï¼Œtupleï¼‰else 1}ï¼†quot;ï¼Œ\ \
                                                                                              å†²æ´—= trueï¼‰
            hidden_â€‹â€‹states = layer_output [0]å¦‚æœisInstanceï¼ˆlayer_outputï¼Œtupleï¼‰else layer_output
            å¦‚æœlenï¼ˆlayer_outputï¼‰ï¼†gt; 1ï¼š
                past_key_values = layer_output [1]ï¼ƒæ›´æ–°kvç¼“å­˜
            printï¼ˆfï¼†quot&#39;efter layer {i}ï¼š{hidden_â€‹â€‹states.shape}ï¼†quortï¼†quortï¼†quort; flush = trueï¼‰

        ï¼ƒè§„èŒƒ
        hidden_â€‹â€‹states = inner_self.model.normï¼ˆhidden_â€‹â€‹statesï¼‰
        printï¼ˆfï¼†quot&#39;normï¼š{hidden_â€‹â€‹states.shape}ï¼†quortï¼†quot; flush = trueï¼‰

        ï¼ƒlogits
        logits = inner_self.lm_headï¼ˆhidden_â€‹â€‹statesï¼‰
        printï¼ˆfï¼†quotâ€œ logitsï¼š{logits.shape}ï¼†quortâ€ï¼Œflush = trueï¼‰

        ï¼ƒè¿”å›å®Œæ•´è¾“å‡º
        è¿”å›causallMoutputwithpastï¼ˆlogits = logitsï¼Œpast_key_values = past_key_valuesï¼‰
    ï¼ƒè¦†ç›–å†…éƒ¨æ¨¡å‹çš„å‰è¿›
    å¯¼å…¥ç±»å‹
    self.model.model.forward = types.methodtypeï¼ˆnew_forwardï¼Œself.model.modelï¼‰

defç”Ÿæˆï¼ˆselfï¼Œ *argsï¼Œ** kwargsï¼‰ï¼š
    æ‰“å°ï¼ˆ&#39;ğŸ”¹è‡ªå®šä¹‰ç”Ÿæˆè°ƒç”¨ï¼ï¼†quot; flush = trueï¼‰
    ï¼ƒè¿‡æ»¤num_logits_to_keep

    if&#39;num_logits_to_keepï¼†quotåœ¨å¤¸å°”æ ¼æ–¯ï¼š
        del Kwargs [ï¼†quot; num_logits_to_keep;]
    è¿”å›self.model.generateï¼ˆ*argsï¼Œ** kwargsï¼‰
 
æˆ‘åƒè¿™æ ·è°ƒç”¨äº†
 æ¨¡å‹ï¼Œtokenizer = fastlanguagemodel.from_pretrateingï¼ˆ
        model_name = inf_model_ï¼Œ
        max_seq_length = 3072ï¼Œ
        dtype = noneï¼Œ
        load_in_4bit = true
ï¼‰

eos_token = tokenizer.eos_token

æ¨¡å‹= fastlanguagemodel.for_inferenceï¼ˆæ¨¡å‹ï¼‰

ï¼ƒè¡¥ä¸ä¼ é€’é€šè¡Œè¯
æ¨¡å‹= grok_custompeftcausallmï¼ˆæ¨¡å‹ï¼‰
printï¼ˆtypeï¼ˆmodel.modelï¼‰ï¼‰ï¼ƒç¡®ä¿å®ƒæ˜¯æ‚¨çš„â€œ SkippableModelâ€
è¾“å…¥= tokenizerï¼ˆ
[
    data_prompt.formatï¼ˆ
        è¯­å¢ƒ_ï¼Œ
        â€œâ€
    ï¼‰
]ï¼Œreturn_tensors =; pt; quotã€‚


printï¼ˆdata_prompt.formatï¼ˆä¸Šä¸‹æ–‡_ï¼Œ; quord;ï¼‰ï¼‰
å¯åŠ¨å™¨_ = time.timeï¼ˆï¼‰
è¾“å‡º=å‹å·ã€‚generateï¼ˆ**è¾“å…¥ï¼Œmax_new_tokens = 800ï¼Œæ¸©åº¦= 0.1ï¼‰
æ‰“å°ï¼ˆ&#39;take out ::&#39;ï¼Œtime.timeï¼ˆï¼‰ - å¯åŠ¨_ï¼‰

ç­”æ¡ˆ= tokenizer.batch_decodeï¼ˆè¾“å‡ºï¼‰
 
å®ƒåªæ˜¯ç”Ÿæˆgibberishï¼ˆåœ¨æ²¡æœ‰æ­¤è¶…è½½çš„æƒ…å†µä¸‹ï¼Œå®ƒçš„æ€§èƒ½ç»å¯¹æ˜¯é¢„æœŸçš„ - è‰¯å¥½çš„ä»£ç ç”Ÿæˆï¼‰ã€‚ç°åœ¨çš„é—®é¢˜æ˜¯ï¼Œæˆ‘å¯ä»¥ä½¿ç”¨çš„å±‚æ¬¡ç»“æ„çš„å”¯ä¸€éƒ¨åˆ†æ˜¯Model.Modelï¼Œå®ƒæŒ‡å‘åŸºæœ¬Meta Llamaä¸Šçš„CasualllamaåŒ…è£…å™¨ã€‚æˆ‘æœ‰ä¸€ç§ä¸å¥½çš„æ„Ÿè§‰ï¼Œè¿™ä¸æ˜¯æ­£ç¡®çš„å‰è¿›ï¼Œä¸å¡åœ¨å¼•æ“ç›–ä¸‹å‘ç”Ÿäº†å…¶ä»–äº‹æƒ…ã€‚æˆ‘åœ¨è¿™é‡Œç¼ºå°‘ä»€ä¹ˆï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/79531231/custom-forward-method-for-lora-finetuned-llama-8b-using-unsloth</guid>
      <pubDate>Mon, 24 Mar 2025 13:38:48 GMT</pubDate>
    </item>
    <item>
      <title>ä¸ºä»€ä¹ˆæˆ‘çš„ä»£ç ä¸å¯¼è‡´å¼ é‡çš„é”™è¯¯â€œå…ƒç´ 0â€ä¸éœ€è¦æ¯•ä¸šï¼Œä¹Ÿä¸éœ€è¦grad_fn'</title>
      <link>https://stackoverflow.com/questions/79524465/why-does-not-my-code-cause-the-error-element-0-of-tensors-does-not-require-grad</link>
      <description><![CDATA[ç»™å®šä¸‹é¢çš„ä»£ç ç‰‡æ®µï¼Œæˆ‘ä½¿ç”¨ model.fc1.requires_grad_ï¼ˆfalseï¼‰ and  model.fc2.requires_grad_ï¼ˆfalseï¼‰å†»ç»“ç¥ç»ç½‘ç»œçš„æƒé‡ã€‚
å¦‚æœæˆ‘ä½¿ç”¨æŸå¤±=æ ‡å‡†ï¼ˆè¾“å‡ºï¼Œy_batchï¼‰æ¥è®¡ç®—æŸå¤±ï¼Œåˆ™è®­ç»ƒå¾ˆå¥½ã€‚ä¸ºä»€ä¹ˆå®ƒä¸ä¼šå¯¼è‡´é”™è¯¯ RuntimeErrorï¼šå¼ é‡çš„å…ƒç´ 0ä¸éœ€è¦gradï¼Œä¹Ÿä¸éœ€è¦Grad_fn ï¼Ÿ
æˆ‘è®¤ä¸ºè¿™åº”è¯¥å¯¼è‡´é”™è¯¯ï¼Œå› ä¸ºç¥ç»ç½‘ç»œçš„æ‰€æœ‰å±‚éƒ½å·²å†»ç»“ã€‚
 å¯¼å…¥ç«ç‚¬
å¯¼å…¥Torch.nnä½œä¸ºnn
å¯¼å…¥Torch.optimä½œä¸ºæœ€ä½³
æ¥è‡ªTorch.utils.dataå¯¼å…¥æ•°æ®è½½ä½“ï¼ŒTensordataSet

ï¼ƒå®šä¹‰ä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œ
ç±»SimpleNetï¼ˆnn.Moduleï¼‰ï¼š
    def __init __ï¼ˆselfï¼Œinput_sizeï¼Œhidden_â€‹â€‹sizeï¼Œoutput_sizeï¼‰ï¼š
        è¶…çº§ï¼ˆSimpleNetï¼ŒSelfï¼‰.__ INIT __ï¼ˆï¼‰
        self.fc1 = nn.linearï¼ˆinput_sizeï¼Œhidden_â€‹â€‹sizeï¼‰
        self.fc2 = nn.linearï¼ˆhidden_â€‹â€‹sizeï¼Œoutput_sizeï¼‰

    defå‘å‰ï¼ˆselfï¼Œxï¼‰ï¼š
        x = self.fc1ï¼ˆxï¼‰
        x = self.fc2ï¼ˆxï¼‰
        è¿”å›x

input_size = 3
hidden_â€‹â€‹size = 3
output_size = 3
batch_size = 16
num_epochs = 1
Learning_rate = 0.01
num_samples = 1000 
x_train = torch.randnï¼ˆnum_samplesï¼Œinput_sizeï¼Œquirenes_grad = trueï¼‰  
y_train = torch.onesï¼ˆï¼ˆnum_samplesï¼Œoutput_sizeï¼‰ï¼‰
dataset = tensordatasetï¼ˆx_trainï¼Œy_trainï¼‰
dataloader = dataloaderï¼ˆæ•°æ®é›†ï¼Œbatch_size = batch_sizeï¼Œshuffle = trueï¼‰

model = simpleNetï¼ˆinput_sizeï¼Œhidden_â€‹â€‹sizeï¼Œoutput_sizeï¼‰


æ ‡å‡†= nn.Crossentropylossï¼ˆï¼‰
ä¼˜åŒ–å™¨= Optim.SGDï¼ˆmodel.parametersï¼ˆï¼‰ï¼Œlr = Learning_rateï¼‰

å¯¹äºèŒƒå›´ï¼ˆnum_epochsï¼‰çš„æ—¶ä»£ï¼š
    total_loss = 0
    å¯¹äºemumerateï¼ˆdataloaderï¼‰ä¸­çš„batch_idxï¼ˆx_batchï¼Œy_batchï¼‰ï¼š
        ä¼˜åŒ–å™¨.zero_gradï¼ˆï¼‰
        è¾“å‡º=æ¨¡å‹ï¼ˆx_batchï¼‰
        æŸå¤±=æ ‡å‡†ï¼ˆè¾“å‡ºï¼Œy_batchï¼‰
        æ‰“å°ï¼ˆæŸå¤±ã€‚_grad_fnï¼‰
        loss.backwardï¼ˆï¼‰ 
        ä¼˜åŒ–å™¨.stepï¼ˆï¼‰ 
                
        ifï¼ˆbatch_idx + 1ï¼‰ï¼…10 == 0ï¼š
            printï¼ˆf&#39;batch [{batch_idx + 1}/{lenï¼ˆdataloaderï¼‰}]ï¼ŒæŸå¤±ï¼š{loss.itemï¼ˆï¼‰ï¼šã€‚4f}&#39;ï¼‰
            model.fc1.requires_grad_ï¼ˆfalseï¼‰
            model.fc2.requires_grad_ï¼ˆfalseï¼‰
                        
æ‰“å°ï¼ˆâ€œè®­ç»ƒå®Œæˆï¼â€ï¼‰
 ]]></description>
      <guid>https://stackoverflow.com/questions/79524465/why-does-not-my-code-cause-the-error-element-0-of-tensors-does-not-require-grad</guid>
      <pubDate>Fri, 21 Mar 2025 02:40:41 GMT</pubDate>
    </item>
    <item>
      <title>DL4Jè‡ªåŠ¨ç¼–ç å™¨ç”¨äºå¼‚å¸¸æ£€æµ‹ï¼šæ„å¤–ç»“æœ[å°é—­]</title>
      <link>https://stackoverflow.com/questions/79523631/dl4j-autoencoder-for-anomaly-detection-unexpected-results</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/79523631/dl4j-autoencoder-for-anomaly-detection-unexpected-results</guid>
      <pubDate>Thu, 20 Mar 2025 16:59:01 GMT</pubDate>
    </item>
    <item>
      <title>èŠ‚ç‚¹/è¾¹ç¼˜å½’å› çš„æœ‰å‘å›¾åµŒå…¥</title>
      <link>https://stackoverflow.com/questions/79508535/node-edge-attributed-directed-graph-embedding</link>
      <description><![CDATA[  graph2vec  gl2vec  in  karateclub éœ€è¦ä»€ä¹ˆï¼Ÿå®ƒç¡®å®æåˆ°åº”è¯¥æ²¡æœ‰å­—ç¬¦ä¸²åŠŸèƒ½ï¼Œä½†æ˜¯æ— è®ºæœ‰æ²¡æœ‰å®ƒï¼Œæˆ‘éƒ½ä¼šé‡åˆ°ä»¥ä¸‹ä»£ç çš„é”™è¯¯ï¼š
 å¯¼å…¥NetworkXä¸ºNx
å¯¼å…¥Karateclubä¸ºKC
å¯¼å…¥matplotlib.pyplotä½œä¸ºPLT

g = nx.digraphï¼ˆï¼‰

g.add_nodeï¼ˆ0ï¼Œlabel =; a;
g.add_nodeï¼ˆ1ï¼Œlabel =; bï¼†quot; feature = [1.2]ï¼‰
g.add_nodeï¼ˆ2ï¼Œlabel =; cï¼†quot;ç‰¹å¾= [0.8]ï¼‰

g.add_edgeï¼ˆ0ï¼Œ1ï¼‰
g.add_edgeï¼ˆ0ï¼Œ2ï¼‰
g.add_edgeï¼ˆ1ï¼Œ2ï¼‰

nx.draw_networkxï¼ˆgï¼Œwith_labels = trueï¼‰
plt.showï¼ˆï¼‰

å›¾= [g]

å‹å·= kc.graph_embedding.graph2vecï¼ˆï¼‰
å‹å·ï¼ˆå›¾ï¼‰
åµŒå…¥= model.get_embeddingï¼ˆï¼‰
æ‰“å°ï¼ˆåµŒå…¥ï¼‰
 
é”™è¯¯ï¼š RuntimeErrorï¼šæ‚¨å¿…é¡»åœ¨è®­ç»ƒæ¨¡å‹ä¹‹å‰å…ˆæ„å»ºè¯æ±‡ 
æˆ‘åœ¨ word2vec ä¸­çœ‹åˆ°äº†ä¸€ä¸ªé€‰é¡¹ï¼Œä½†æ˜¯å¦‚ä½•ä¸º graph2vec ï¼Ÿæ‰§è¡Œæ­¤æ“ä½œã€‚
æ˜¯å¦æœ‰ä»»ä½•æ›¿ä»£è½¯ä»¶åŒ…ï¼Œæœ€å¥½ä½¿ç”¨ KarateClub ç­‰æ›´ç®€å•çš„å®ç°ï¼Œæˆ‘å¯ä»¥ç”¨æ¥ç”Ÿæˆå®šå‘èŠ‚ç‚¹/edgeå±æ€§åˆ—è¡¨ network&gt; networkx  Graphs å›¾å½¢è€Œæ— éœ€å®šä¹‰è®­ç»ƒ/æµ‹è¯•é›†å—ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/79508535/node-edge-attributed-directed-graph-embedding</guid>
      <pubDate>Fri, 14 Mar 2025 08:52:01 GMT</pubDate>
    </item>
    <item>
      <title>é«˜æ•ˆNETB3æ¨¡å‹çš„å‡†ç¡®æ€§éå¸¸ä½ï¼Œå¹¶ä¸”åœ¨è¯†åˆ«è„‘è‚¿ç˜¤é—®é¢˜æ–¹é¢å­¦ä¹ é«˜åŸ[å°é—­]</title>
      <link>https://stackoverflow.com/questions/79390644/very-low-accuracy-of-efficientnetb3-model-and-learning-plateau-on-identifying-br</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/79390644/very-low-accuracy-of-efficientnetb3-model-and-learning-plateau-on-identifying-br</guid>
      <pubDate>Mon, 27 Jan 2025 11:58:17 GMT</pubDate>
    </item>
    <item>
      <title>ç¥ç»ç½‘ç»œç²¾ç¡®åº¦ä½</title>
      <link>https://stackoverflow.com/questions/73780627/neural-network-low-accuracy</link>
      <description><![CDATA[è¯¥æ¨¡å‹çš„ç²¾åº¦ç¡®å®å¾ˆä½ã€‚è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å†™ç¥ç»ç½‘ç»œï¼Œæ‰€ä»¥æˆ‘çœŸçš„ä¸çŸ¥é“å¦‚ä½•ä½¿å®ƒå˜å¾—æ›´å¥½
 å°†TensorFlowå¯¼å…¥ä¸ºTF
å¯¼å…¥matplotlib.pyplotä½œä¸ºPLT
    
#dataè®¾ç½®
data = tf.keras.datasets.cifar10


ï¼ˆx_trainï¼Œy_trainï¼‰ï¼Œï¼ˆx_testï¼Œy_testï¼‰= data.load_dataï¼ˆï¼‰
plt.imshowï¼ˆx_train [0]ï¼Œcmap = plt.cm.binaryï¼‰

#normalizeæ•°æ®
x_train = tf.keras.utils.normalizeï¼ˆx_trainï¼Œaxis = 1ï¼‰
x_test = tf.keras.utils.normalizeï¼ˆx_testï¼Œaxis = 1ï¼‰

#building AIæ¨¡å‹

å‹å·= tf.keras.models.sequeentialï¼ˆï¼‰
Model.Addï¼ˆtf.keras.layers.flattenï¼ˆï¼‰ï¼‰
model.Addï¼ˆtf.keras.layers.denseï¼ˆ128ï¼Œæ¿€æ´»= tf.nn.reluï¼‰ï¼‰
model.Addï¼ˆtf.keras.layers.denseï¼ˆ128ï¼Œæ¿€æ´»= tf.nn.reluï¼‰ï¼‰
model.Addï¼ˆtf.keras.layers.denseï¼ˆ10ï¼Œæ¿€æ´»= tf.nn.softmaxï¼‰ï¼‰ï¼‰



#compileæ¨¡å‹
model.compileï¼ˆä¼˜åŒ–å™¨=&#39;adam&#39;ï¼Œ
             æŸå¤±=&#39;Sparse_categorical_crossentropy&#39;ï¼Œ
             æŒ‡æ ‡= [&#39;å‡†ç¡®æ€§&#39;]ï¼‰

plt.showï¼ˆï¼‰
#Train AIæ¨¡å‹
model.fitï¼ˆx_trainï¼Œy_trainï¼Œepochs = 3ï¼‰
 ]]></description>
      <guid>https://stackoverflow.com/questions/73780627/neural-network-low-accuracy</guid>
      <pubDate>Tue, 20 Sep 2022 00:59:44 GMT</pubDate>
    </item>
    <item>
      <title>ç¥ç»ç½‘ç»œçš„ç²¾åº¦éå¸¸ä½</title>
      <link>https://stackoverflow.com/questions/65777704/getting-a-very-low-accuracy-with-neural-network</link>
      <description><![CDATA[æˆ‘æ­£åœ¨å°è¯•ä½¿ç”¨kerasåœ¨CIFAR-10æ•°æ®é›†ä¸Šå®ç°ANN
ä½†æ˜¯ç”±äºæŸç§åŸå› ï¼Œæˆ‘ä¸çŸ¥é“æˆ‘åªèƒ½è·å¾—10ï¼…çš„å‡†ç¡®æ€§ï¼Ÿ
æˆ‘åˆ†åˆ«ä½¿ç”¨äº†5ä¸ªéšè—å±‚IWTH 8,16,32,64,128ç¥ç»å…ƒã€‚
 è¿™æ˜¯jupyterç¬”è®°æœ¬ çš„é“¾æ¥
  model = sequentionï¼ˆï¼‰
model.Addï¼ˆå¯†é›†ï¼ˆå•ä½= 8ï¼Œactivation =&#39;sigmoid&#39;ï¼Œinput_dim = x.shape [1]ï¼‰ï¼‰ï¼‰ï¼‰ï¼‰
model.Addï¼ˆå¯†é›†ï¼ˆå•ä½= 16ï¼Œactivation =&#39;Sigmoid&#39;ï¼‰ï¼‰ï¼‰ï¼‰
model.Addï¼ˆå¯†é›†ï¼ˆå•ä½= 32ï¼Œactivation =&#39;Sigmoid&#39;ï¼‰ï¼‰
model.Addï¼ˆå¯†é›†ï¼ˆå•ä½= 64ï¼Œactivation =&#39;sigmoid&#39;ï¼‰ï¼‰
model.Addï¼ˆå¯†é›†ï¼ˆå•ä½= 128ï¼Œactivation =&#39;Sigmoid&#39;ï¼‰ï¼‰
model.Addï¼ˆå¯†åº¦ï¼ˆå•ä½= 10ï¼Œactivation =&#39;softmax&#39;ï¼‰ï¼‰

model.compileï¼ˆloss =&#39;accorical_crossentropy&#39;ï¼Œimportizer =&#39;adam&#39;ï¼Œé‡è¡¨= [&#39;fecicy&#39;]ï¼‰

model.fitï¼ˆx_trainï¼Œy_trainï¼Œepochs = 1000ï¼Œbatch_size = 500ï¼‰
 ]]></description>
      <guid>https://stackoverflow.com/questions/65777704/getting-a-very-low-accuracy-with-neural-network</guid>
      <pubDate>Mon, 18 Jan 2021 15:44:46 GMT</pubDate>
    </item>
    <item>
      <title>Pytorchä¸­çš„æ•°æ®å¢å¼º</title>
      <link>https://stackoverflow.com/questions/51677788/data-augmentation-in-pytorch</link>
      <description><![CDATA[æˆ‘å¯¹Pytorchä¸­æ‰§è¡Œçš„æ•°æ®å¢åŠ æœ‰äº›å›°æƒ‘ã€‚ç°åœ¨ï¼Œæ®æˆ‘æ‰€çŸ¥ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œæ•°æ®å¢å¼ºæ—¶ï¼Œæˆ‘ä»¬å°†ä¿ç•™åŸå§‹æ•°æ®é›†ï¼Œç„¶åæ·»åŠ å…¶ä»–ç‰ˆæœ¬ï¼ˆç¿»è½¬ï¼Œè£å‰ªç­‰ï¼‰ã€‚ä½†è¿™ä¼¼ä¹å¹¶æ²¡æœ‰å‘ç”Ÿåœ¨Pytorchä¸­ã€‚æ®æˆ‘ä»å‚è€ƒæ–‡çŒ®ä¸­ç†è§£æ—¶ï¼Œå½“æˆ‘ä»¬åœ¨pytorchä¸­ä½¿ç”¨ data.transforms æ—¶ï¼Œå®ƒå°†å®ƒä»¬ä¸€ä¸€åº”ç”¨å®ƒä»¬ã€‚å› æ­¤ï¼š
  data_transforms = {
    &#39;train&#39;ï¼štransforms.composeï¼ˆ[
        transforms.randomresizedcropï¼ˆ224ï¼‰ï¼Œ
        transforms.randomhorizoâ€‹â€‹ntalflipï¼ˆï¼‰ï¼Œ
        transforms.totensorï¼ˆï¼‰ï¼Œ
        transforms.normizeï¼ˆ[0.485ï¼Œ0.456ï¼Œ0.406]ï¼Œ[0.229ï¼Œ0.224ï¼Œ0.225]ï¼‰
    ]ï¼‰ï¼Œï¼Œ
    &#39;val&#39;ï¼štransforms.composeï¼ˆ[
        è½¬æ¢å¼Resizeï¼ˆ256ï¼‰ï¼Œ
        transforms.centercropï¼ˆ224ï¼‰ï¼Œ
        transforms.totensorï¼ˆï¼‰ï¼Œ
        transforms.normizeï¼ˆ[0.485ï¼Œ0.456ï¼Œ0.406]ï¼Œ[0.229ï¼Œ0.224ï¼Œ0.225]ï¼‰
    ]ï¼‰ï¼Œï¼Œ
}
 
åœ¨è¿™é‡Œï¼Œå¯¹äºåŸ¹è®­ï¼Œæˆ‘ä»¬é¦–å…ˆæ˜¯éšæœºè£å‰ªå›¾åƒå¹¶å°†å…¶è°ƒæ•´ä¸ºShape ï¼ˆ224,224ï¼‰ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†è¿™äº›ï¼ˆ224,224ï¼‰å›¾åƒè¿›è¡Œæ°´å¹³ç¿»è½¬ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„æ•°æ®é›†ç°åœ¨ä»…åŒ…å«æ°´å¹³ç¿»è½¬çš„å›¾åƒï¼Œå› æ­¤åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„åŸå§‹å›¾åƒä¸¢å¤±äº†ã€‚
æˆ‘å¯¹å—ï¼Ÿè¿™ç†è§£æ˜¯æ­£ç¡®çš„å—ï¼Ÿå¦‚æœä¸æ˜¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨ä¸Šé¢çš„æ­¤ä»£ç ä¸­ï¼ˆå–è‡ªå®˜æ–¹æ–‡æ¡£ï¼‰å°†Pytorchå‘Šè¯‰åŸå§‹å›¾åƒå¹¶å°†å…¶è°ƒæ•´åˆ°é¢„æœŸå½¢çŠ¶ï¼ˆ224,224ï¼‰ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/51677788/data-augmentation-in-pytorch</guid>
      <pubDate>Fri, 03 Aug 2018 17:51:49 GMT</pubDate>
    </item>
    <item>
      <title>åœ¨GridSearchCVä¸­å¾—åˆ†XGBoost</title>
      <link>https://stackoverflow.com/questions/50296817/scoring-in-gridsearchcv-for-xgboost</link>
      <description><![CDATA[æˆ‘æ­£åœ¨å°è¯•ä½¿ç”¨XGBoosté¦–æ¬¡åˆ†ææ•°æ®ã€‚æˆ‘æƒ³ä½¿ç”¨GridSearchCVæ‰¾åˆ°æœ€ä½³å‚æ•°ã€‚æˆ‘æƒ³æœ€å¤§ç¨‹åº¦åœ°å‡å°‘å‡æ–¹æ ¹é”™è¯¯ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä½¿ç”¨äº†â€œ rmseâ€ã€‚ä½œä¸ºeval_metricã€‚ä½†æ˜¯ï¼Œç½‘æ ¼æœç´¢çš„è¯„åˆ†æ²¡æœ‰è¿™æ ·çš„åº¦é‡ã€‚æˆ‘åœ¨æ­¤ç½‘ç«™ä¸Šå‘ç°â€œ neg_mean_squared_errorâ€è¿™æ ·åšä¸€æ ·ï¼Œä½†æ˜¯æˆ‘å‘ç°è¿™ç»™æˆ‘ä¸RMSEä¸åŒçš„ç»“æœã€‚å½“æˆ‘è®¡ç®—â€œ neg_mean_squared_errorâ€çš„ç»å¯¹å€¼çš„æ ¹ç›®å½•æ—¶ï¼Œæˆ‘çš„å€¼çº¦ä¸º8.9ï¼Œè€Œä¸åŒçš„åŠŸèƒ½ä½¿æˆ‘çš„RMSEçº¦ä¸º4.4ã€‚
æˆ‘ä¸çŸ¥é“æ€ä¹ˆäº†ï¼Œæˆ–è€…å¦‚ä½•è·å¾—è¿™ä¸¤ä¸ªåŠŸèƒ½åŒæ„/ç»™å‡ºç›¸åŒçš„å€¼ï¼Ÿ
ç”±äºè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘é‡åˆ°äº†é”™è¯¯çš„å€¼ï¼Œå› ä¸º best_params _ ï¼Œå®ƒæ¯”æˆ‘æœ€åˆå¼€å§‹è°ƒéŸ³çš„æŸäº›å€¼æ›´é«˜çš„RMSEã€‚
å¦‚ä½•åœ¨ç½‘æ ¼æœç´¢ä¸­è·å¾—RMSEçš„åˆ†æ•°ä»¥åŠä¸ºä»€ä¹ˆæˆ‘çš„ä»£ç ç»™å‡ºä¸åŒçš„å€¼ï¼Ÿ
  def modelfitï¼ˆalgï¼Œtrainxï¼Œtrainyï¼Œusetraincv = trueï¼Œcv_folds = 10ï¼Œarmond_stopping_rounds = 50ï¼‰ï¼š
    å¦‚æœç”¨UsetrainCVï¼š
        xgb_param = alg.get_xgb_paramsï¼ˆï¼‰
        xgtrain = xgb.dmatrixï¼ˆtrainxï¼Œlabel = Trainyï¼‰
        cvresult = xgb.cvï¼ˆxgb_paramï¼Œxgtrainï¼Œnum_boost_round = alg.get_paramsï¼ˆï¼‰[&#39;n_estimators&#39;]ï¼Œnfold = cv_foldsï¼Œ
                          æŒ‡æ ‡=&#39;rmse&#39;ï¼Œropard_stopping_rounds = armon_stopping_roundsï¼‰
        alg.set_paramsï¼ˆn_estimators = cvresult.shape [0]ï¼‰

    ï¼ƒå°†ç®—æ³•é€‚åˆæ•°æ®
    alg.fitï¼ˆTrainxï¼ŒTrainyï¼Œeval_metric =&#39;rmse&#39;ï¼‰

    ï¼ƒé¢„æµ‹è®­ç»ƒé›†ï¼š
    dtrain_predictions = alg.predictï¼ˆtrainxï¼‰
    ï¼ƒdtrain_predprob = alg.predict_probaï¼ˆTrainyï¼‰[ï¼šï¼Œ1]
    æ‰“å°ï¼ˆdtrain_predictionsï¼‰
    printï¼ˆnp.sqrtï¼ˆmean_squared_errorï¼ˆtrainyï¼Œdtrain_predictionsï¼‰ï¼‰ï¼‰ï¼‰ï¼‰ï¼‰ï¼‰ï¼‰

    ï¼ƒæ‰“å°æ¨¡å‹æŠ¥å‘Šï¼š
    æ‰“å°ï¼ˆâ€œ \ nmodelæŠ¥å‘Šâ€ï¼‰
    æ‰“å°ï¼ˆ&#39;rmseï¼šï¼….4G;ï¼…np.sqrtï¼ˆé‡å­¦

 param_test2 = {
 &#39;max_depth&#39;ï¼š[6,7,8]ï¼Œ
 &#39;min_child_weight&#39;ï¼š[2,3,4]
}

grid2 = gridSearchCVï¼ˆä¼°ç®—= xgb.xgb.xgbregressorï¼ˆLearning_rate = 0.1ï¼Œn_estimators = 2000ï¼Œmax_depth = 5ï¼Œ
 min_child_weight = 2ï¼Œgamma = 0ï¼Œsubsampe = 0.8ï¼Œcolsample_bytree = 0.8ï¼Œ
 objective =&#39;regï¼šlinear&#39;ï¼Œnthread = 4ï¼Œscale_pos_weight = 1ï¼Œandury_state = 4ï¼‰ï¼Œ
 param_grid = param_test2ï¼Œè¯„åˆ†=&#39;neg_mean_squared_error&#39;ï¼Œn_jobs = 4ï¼Œiid = falseï¼Œcv = 10ï¼Œå†—é•¿= 20ï¼‰
grid2.fitï¼ˆx_trainï¼Œy_trainï¼‰
ï¼ƒbest_estimatorçš„å¹³å‡äº¤å‰éªŒè¯å¾—åˆ†
printï¼ˆgrid2.best_params_ï¼Œnp.sqrtï¼ˆnp.absï¼ˆgrid2.best_score_ï¼‰ï¼‰ï¼‰ï¼‰ï¼Œprintï¼ˆnp.sqrtï¼ˆnp.absï¼ˆgrid2.score2.scoreï¼ˆx_trainï¼Œy_trainï¼Œy_trainï¼‰ï¼‰ï¼‰ï¼‰
modelfitï¼ˆgrid2.best_estimator_ï¼Œx_trainï¼Œy_trainï¼‰
printï¼ˆnp.sqrtï¼ˆnp.absï¼ˆgrid2.scoreï¼‰ï¼ˆx_trainï¼Œy_trainï¼‰ï¼‰ï¼‰ï¼‰ï¼‰ï¼‰ï¼‰ï¼‰ï¼‰ï¼‰ï¼‰
 ]]></description>
      <guid>https://stackoverflow.com/questions/50296817/scoring-in-gridsearchcv-for-xgboost</guid>
      <pubDate>Fri, 11 May 2018 16:46:16 GMT</pubDate>
    </item>
    </channel>
</rss>