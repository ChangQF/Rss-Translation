<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>标记为机器学习的活跃问题 - 堆栈内存溢出</title>
    <link>https://stackoverflow.com/questions/tagged/?tagnames=machine-learning&sort=active</link>
    <description>来自 stackoverflow.com 的最新 30 条</description>
    <lastBuildDate>Fri, 23 Aug 2024 01:08:27 GMT</lastBuildDate>
    <item>
      <title>随机森林测试分割</title>
      <link>https://stackoverflow.com/questions/78903794/random-forest-test-split</link>
      <description><![CDATA[我使用六月数据集训练了随机森林模型来预测员工的status_value，并使用0.3分割进行test_size。我包含了代码片段，因为代码本身运行良好，没有任何错误
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=0)
rf = RandomForestClassifier()
rf.fit(X_resampled,y_resampled)
y_pred = rf.predict(X_test)

当我使用经过训练的 RF 模型来预测 status_value 而不拆分 7 月数据集时，它仍然只能预测 30% 的员工，而不是完整的数据集。
ml_cols = [&#39;age&#39;,&#39;months tenure&#39;,&#39;salary_deviation&#39;,&#39;review_rating&#39;,&#39;term Reason enc&#39;,&#39;color_rating&#39;,&#39;satisfaction分数&#39;、&#39;年初至今佣金&#39;、&#39;销售活动&#39;、&#39;销售通话时长&#39;、&#39;销售通话里程&#39;、&#39;推荐&#39;、&#39;承认&#39;]
ml_df_pred =merged_df_pred[ml_cols]
X_pred = ml_df_pred[ml_cols]
y_fcst = merged_df_pred[&#39;status_value&#39;]
y_pred = rf.predict(X_pred)

我该如何确保它不会拆分 7 月份的数据，并对 7 月份数据集中列出的所有 180 名员工进行预测？]]></description>
      <guid>https://stackoverflow.com/questions/78903794/random-forest-test-split</guid>
      <pubDate>Thu, 22 Aug 2024 22:54:38 GMT</pubDate>
    </item>
    <item>
      <title>你能在保持梯度流的同时仿射扭曲张量吗？</title>
      <link>https://stackoverflow.com/questions/78903793/can-you-affine-warp-a-tensor-while-preserving-gradient-flow</link>
      <description><![CDATA[我试图重新创建 cv2.warpAffine() 函数，采用张量输入和输出，而不是 numpy 数组。但是，从输出张量计算出的梯度会产生全为 0 的非无梯度张量。我花了一整晚的时间试图找出我错在哪里，如果有人能发现我的错误，我会很高兴知道它是什么。我很乐意提供任何进一步的信息。谢谢！
def tensor_warp_affine(tensor, M, output_shape, border_value=0.0):
height, width = output_shape
channels = tensor.shape[2]
device = tensor.device
dtype = tensor.dtype

# 将 M 转换为张量并计算逆
M_tensor = torch.tensor(M, dtype=torch.float32, device=device)
M_padded = torch.cat([M_tensor, torch.tensor([[0, 0, 1]], dtype=torch.float32, device=device)], dim=0)
M_inv = torch.inverse(M_padded)[:2]
# 创建坐标网格
y_coords, x_coords = torch.meshgrid(torch.arange(height, device=device), torch.arange(width, device=device), indexing=&#39;ij&#39;)
coords = torch.stack([x_coords.flatten(), y_coords.flatten(), torch.ones_like(x_coords.flatten())], dim=0).float()
# 变换坐标
src_coords = M_inv @ coords
src_x, src_y = src_coords[0], src_coords[1]
# 计算插值权重
x0 = src_x.long()
y0 = src_y.long()
x1 = x0 + 1
y1 = y0 + 1
x0 = torch.clamp(x0, 0, tensor.shape[1] - 1)
x1 = torch.clamp(x1, 0, tensor.shape[1] - 1)
y0 = torch.clamp(y0, 0, tensor.shape[0] - 1)
y1 = torch.clamp(y1, 0, tensor.shape[0] - 1)
dx = src_x - x0.float()
dy = src_y - y0.float()
# 执行双线性插值
wa = (1 - dx) * (1 - dy)
wb = dx * (1 - dy)
wc = (1 - dx) * dy
wd = dx * dy
img_flat = tensor.reshape(-1, channels)

pixel = (wa[:, None] * img_flat[y0 * tensor.shape[1] + x0] +
wb[:, None] * img_flat[y0 * tensor.shape[1] + x1] +
wc[:, None] * img_flat[y1 * tensor.shape[1] + x0] +
wd[:, None] * img_flat[y1 * tensor.shape[1] + x1])

result = pixel.reshape(height, width, channels)
return result

我这样做是为了将结果张量传递到生成潜在向量的编码器模型中。我正尝试使用随机梯度下降优化对输入图像的添加扰动。我怀疑一些变换点超出了界限，并且四舍五入为零，这是否不可微分？
我尝试打印出超出界限的值，但没有任何标记。]]></description>
      <guid>https://stackoverflow.com/questions/78903793/can-you-affine-warp-a-tensor-while-preserving-gradient-flow</guid>
      <pubDate>Thu, 22 Aug 2024 22:54:33 GMT</pubDate>
    </item>
    <item>
      <title>如何使用目标编码转换用户输入的分类数据？</title>
      <link>https://stackoverflow.com/questions/78903710/how-can-i-transform-the-categorical-data-entered-by-the-user-using-target-encodi</link>
      <description><![CDATA[在 google collab 中拟合模型时似乎没有任何问题。但是，当我尝试使用 streamlit 和 pickle 创建接口时，Target 编码器不起作用，我无法解决它。
错误可能与维度有关，也可能是这样的：
TypeError: unhashable type: &#39;Series&#39;

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split,GridSearchCV
from sklearn.preprocessing import StandardScaler,OneHotEncoder
from category_encoders import TargetEncoder
from sklearn.naive_bayes import BernoulliNB
from sklearn.metrics import *
from sklearn.compose import ColumnTransformer
import pickle
import streamlit as st

with open(&quot;C:/Users/isma_/Desktop/VS Code/Violencia genero/model_violencia_genero.pkl&quot;,&quot;rb&quot;) 作为文件：
model= pickle.load(file)

使用 open(&quot;C:/Users/isma_/Desktop/VS Code/Violencia genero/oh_encoder.pkl&quot;,&quot;rb&quot;) 作为文件：
oh_encoder=pickle.load(file)

使用 open(&quot;C:/Users/isma_/Desktop/VS Code/Violencia genero/scaler_X.pkl&quot;,&quot;rb&quot;) 作为文件：
scaler_X=pickle.load(file)

使用 open(&quot;C:/Users/isma_/Desktop/VS Code/Violencia genero/target_encoder.pkl&quot;,&quot;rb&quot;) 作为文件：
target_encoder=pickle.load(file)

df=pd.read_csv(&quot;C:/Users/isma_/Downloads/archive (15)/Domestic violence.csv&quot;)
############################
st.title(&quot;Violencia de género&quot;)
st.write(df.columns)
edad=st.sidebar.slider(&quot;Edad&quot;,1.0,120.0,df[&#39;Age&#39;].mean(),1.0)
educacion=st.sidebar.select_slider(&quot;Educación&quot;,[&quot;Ninguna&quot;,&quot;Primaria&quot;,&quot;Secundaria&quot;,&quot;Terciaria&quot;])
empleo=st.sidebar.selectbox(&quot;Empleo&quot; ;,[&quot;Desempleada&quot;,&quot;Semi-Empleada&quot;,&quot;Empleada&quot;])
ingresos=st.sidebar.slider(&quot;Ingresos&quot;,0.0,float(df[&quot;Income&quot;].max()),df[&quot;Income&quot;].mean())
estado_civil=st.sidebar.selectbox(&quot;Empleo&quot;,[&quot;Soltera&quot;,&quot;Casada&quot;])

data={
&#39;年龄&#39;:edad,
&#39;教育&#39;:educacion,
&#39;就业&#39;:empleo,
&#39;收入&#39;:ingresos,
&#39;婚姻状况&#39;:estado_civil,
}
features=pd.DataFrame(data,index=[0])
st.write(&quot;Datos introducidos&quot;)
st.write(features)

#标签编码器
df[&#39;暴力&#39;]=df[&#39;暴力&#39;].map({&quot;no&quot;:0,&quot;yes&quot;:1})

#这是我无法做到的
#我尝试了很多方法
#目标编码器
X_selected = features[[&#39;就业&#39;]]
a=target_encoder.transform(X_selected, df[&#39;暴力&#39;])
st.write(a)
]]></description>
      <guid>https://stackoverflow.com/questions/78903710/how-can-i-transform-the-categorical-data-entered-by-the-user-using-target-encodi</guid>
      <pubDate>Thu, 22 Aug 2024 22:19:18 GMT</pubDate>
    </item>
    <item>
      <title>如何访问 Google Video Intelligence API 使用的预定义标签的完整列表？[关闭]</title>
      <link>https://stackoverflow.com/questions/78901885/how-can-i-access-the-full-list-of-predefined-labels-used-by-google-video-intelli</link>
      <description><![CDATA[我正在使用 Google Video Intelligence API 检测视频中的对象、场景和动作。API 在响应的 entity.description 字段中返回诸如人、汽车、狗等标签。
我了解这些标签是预定义的，来自 Google 机器学习模型使用的结构化分类法。但是，我正在寻找 API 可以检测到的所有可能的标签或类别的完整列表。具体来说，我想知道：

是否有 Google Video Intelligence API 使用的所有标签的官方列表？
我在哪里可以找到或访问此列表？
如果没有已发布的列表，是否有任何已知的资源或方法来收集此信息？

我需要此列表，因为我正在进行类别映射，了解所有可能的标签将有助于确保我涵盖 API 的所有潜在输出。
关于在哪里可以找到这些信息的任何指导或见解？]]></description>
      <guid>https://stackoverflow.com/questions/78901885/how-can-i-access-the-full-list-of-predefined-labels-used-by-google-video-intelli</guid>
      <pubDate>Thu, 22 Aug 2024 13:42:14 GMT</pubDate>
    </item>
    <item>
      <title>按相似性对文本文档进行分组[关闭]</title>
      <link>https://stackoverflow.com/questions/78901288/grouping-text-documents-by-similarity</link>
      <description><![CDATA[我试图根据内容的相似程度对一些相对较短的文本文档（通常每个文档最多 500 个单词）进行分组。相似的文档通常在措辞上相当接近，但并不完全相同，因此我正在寻找一种机器学习方法来提供比简单地查找重复文本（即基于相似度的百分比进行分组）更宽松的匹配算法。但是，我对 ML 的经验有限，所以我正在寻找有关至少从哪里开始解决此类问题的信息。
当我使用 C# 工作时，我正在使用 ML.NET 寻找解决方案。我熟悉 K-Means，并且找到了一些关于使用它执行相似性匹配的信息，以及有关 ML.NET 的句子相似性 API的信息，但我不确定这些是否是正确的方向，因为 ML.NET 对这些的实现似乎需要一定数量的监督训练数据，而不是能够完全不受监督地对一组数据进行工作。
我理解，为了让代码理解什么是“相似文本”，可能需要一些预先的数据实际上看起来像，但我不清楚实际实现此类事情的最佳方法，也很难找到相关信息。我知道余弦相似度与此类问题有关，但 ML.NET 是应用它的正确库吗？有没有更简单的解决方案，特别是考虑到文档在文本和主题上已经相对接近？]]></description>
      <guid>https://stackoverflow.com/questions/78901288/grouping-text-documents-by-similarity</guid>
      <pubDate>Thu, 22 Aug 2024 11:21:52 GMT</pubDate>
    </item>
    <item>
      <title>使用弹性网络进行特征选择</title>
      <link>https://stackoverflow.com/questions/78901259/feature-selection-with-elastic-net</link>
      <description><![CDATA[我编写了一个代码，在嵌套交叉验证设置（具有 5 个内折和 20 个外折）中从最佳弹性网络模型（具体而言，具有实现最高 AUC 的 alpha 和 lambda 值的模型）中选择最佳特征。然后，我使用这些选定的特征进行进一步的模型训练。
但是，我不确定我是否正确实施了嵌套交叉验证。此外，当我尝试检索 alpha 和 lambda 值以报告它们的可重复性时，我似乎无法在结果中找到它们。
代码如下：
set.seed(1)
train_elastic_net &lt;- function(X_train, y_train, alphas, lambdas) {
best_auc &lt;- 0
best_model &lt;- NULL
best_features &lt;- NULL

for (alpha_value in alphas) {
# 设置交叉验证的训练控制
train_control &lt;- trainControl(method = &quot;cv&quot;, 
number = 5, 
classProbs = TRUE, 
summaryFunction = twoClassSummary)

# 定义调整网格
tune_grid &lt;- expand.grid(alpha = alpha_value, lambda = lambdas)

# 使用 caret 训练模型
model &lt;- train(X_train, y_train,
method = &quot;glmnet&quot;,
trControl = train_control,
tuneGrid = tune_grid,
metric = &quot;ROC&quot;,
family = &quot;binomial&quot;)

# 获取最佳模型
best_lambda &lt;- model$bestTune$lambda
elastic_net_model &lt;- glmnet(as.matrix(X_train), y_train, alpha = alpha_value, lambda = best_lambda, family = &quot;binomial&quot;)

# 获取最佳模型的 AUC
auc &lt;- max(model$results$ROC)

# 如果当前模型更好，则更新最佳模型
if (auc &gt; best_auc) {
best_auc &lt;- auc
best_model &lt;- elastic_net_model
coef_elastic_net &lt;- coef(best_model, s = best_lambda)
selected_features &lt;- which(coef_elastic_net != 0) - 1 # 获取非零系数的索引
selected_features &lt;- selected_features[selected_features != 0] # 删除截距索引
best_features &lt;- selected_features
}
}

list(model = best_model, features = best_features)
}

y_train_factor &lt;- as.factor(y_train_total)
X_train_matrix &lt;- as.matrix(X_train_total)

# 定义要搜索的 alpha 和 lambda 值
alpha_values &lt;- seq(0.1, 1, by = 0.1)
lambda_values &lt;- 10^seq(-4, 1, length = 100)

# 为每个分割执行 20 次重复
n_repeats &lt;- 20
selected_features_list &lt;- list()

for (i in 1:n_repeats) {

# 使用弹性网络执行变量选择
result &lt;- train_elastic_net(X_train_matrix, y_train_factor, alpha_values, lambda_values)
best_model &lt;- result$model
best_features &lt;- result$features

# 存储此重复的选定特征
selected_features_list[[i]] &lt;- best_features
}
selected_features_list
# 聚合所有重复的选定特征
selected_features_final &lt;- Reduce(intersect, selected_features_list)
selected_features_final
# 使用最终选定的特征对训练数据进行子集化
X_train_total &lt;- X_train_total[, selected_features_final]
]]></description>
      <guid>https://stackoverflow.com/questions/78901259/feature-selection-with-elastic-net</guid>
      <pubDate>Thu, 22 Aug 2024 11:14:15 GMT</pubDate>
    </item>
    <item>
      <title>使用定制的头部来微调语言模型</title>
      <link>https://stackoverflow.com/questions/78901109/finetuning-a-language-model-with-a-customized-head</link>
      <description><![CDATA[我正在微调 BERT 模型来执行一项相当复杂的任务。它应该识别输入字符串中的目标，对每个目标执行回归并输出

输入中每个已识别目标的开始/结束索引
每个目标的回归值

采用 JSON 格式。
据我所知，训练本身非常简单，但要以所需的格式获得输出（JSON 格式的多个输出），我需要自定义模型的头部。
所以，我并不是真的在这里寻找解决方案，而是寻找有关如何做到这一点的资源（教程、论文、视频）。]]></description>
      <guid>https://stackoverflow.com/questions/78901109/finetuning-a-language-model-with-a-customized-head</guid>
      <pubDate>Thu, 22 Aug 2024 10:41:28 GMT</pubDate>
    </item>
    <item>
      <title>如何在 jupyter 笔记本中摆脱“PineconeApiException：（400）”和“ValueError：在您的 Pinecone 项目中未找到索引‘None’”？</title>
      <link>https://stackoverflow.com/questions/78900691/how-to-get-rid-of-pineconeapiexception-400-and-valueerror-index-none-no</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/78900691/how-to-get-rid-of-pineconeapiexception-400-and-valueerror-index-none-no</guid>
      <pubDate>Thu, 22 Aug 2024 09:07:42 GMT</pubDate>
    </item>
    <item>
      <title>我怎样才能正确地连接不同的功能？</title>
      <link>https://stackoverflow.com/questions/78900219/how-can-i-properly-conctenate-the-different-features</link>
      <description><![CDATA[我有一个特征图，形状为 (100,48)，其他特征的形状为 (100,1)
我该如何正确地连接这些不同的特征？
我想这样做是因为我现在正在训练 XGboost 模型，但如果我将不同的特征直接连接在一起，机器就无法区分特征图和单个特征。
我尝试了下面的代码，但我认为这不是正确的方法，每次我操作代码（没有随机种子）时，这样做的结果都不同。
input_1_layer = Input(shape=(input_1.shape[1],)) density_1 = Dense(48,activation=&#39;relu&#39;)(input_1_layer)

input_2_layer = Input(shape=(input_2.shape[1],)) density_2 = Dense(6,激活=&#39;relu&#39;)(输入2层)

feature_extractor = 模型(输入=[输入1层，输入2层]，输出=合并)

new_features = feature_extractor.predict([输入1，输入2])

你能给我提供一些论文吗？]]></description>
      <guid>https://stackoverflow.com/questions/78900219/how-can-i-properly-conctenate-the-different-features</guid>
      <pubDate>Thu, 22 Aug 2024 07:19:22 GMT</pubDate>
    </item>
    <item>
      <title>适合专家阅读的机器学习书籍有哪些？[关闭]</title>
      <link>https://stackoverflow.com/questions/78899696/what-are-books-on-machine-learning-for-experts</link>
      <description><![CDATA[我是一名自学成才的程序员，我已经掌握了所有基础知识，如 ml 模型、cnn、rnn、lstm 等
我想知道如何才能成为机器学习专家。您可以固定任何书籍、代码链接、
博客等。请告诉我机器学习中有哪些主题在计算机视觉、nlp、时间序列、文本分类等所有​​领域的流行互联网书籍中都找不到。
告诉我一些只有高级机器学习工程师才能做的项目。]]></description>
      <guid>https://stackoverflow.com/questions/78899696/what-are-books-on-machine-learning-for-experts</guid>
      <pubDate>Thu, 22 Aug 2024 03:32:40 GMT</pubDate>
    </item>
    <item>
      <title>如何在一个 cv2 相机屏幕中运行两个计算机视觉模型</title>
      <link>https://stackoverflow.com/questions/78894715/how-to-run-two-computer-vision-models-in-one-cv2-camera-screen</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/78894715/how-to-run-two-computer-vision-models-in-one-cv2-camera-screen</guid>
      <pubDate>Tue, 20 Aug 2024 23:51:16 GMT</pubDate>
    </item>
    <item>
      <title>卷积自动编码器</title>
      <link>https://stackoverflow.com/questions/61614366/convolutional-autoencoders</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/61614366/convolutional-autoencoders</guid>
      <pubDate>Tue, 05 May 2020 13:30:06 GMT</pubDate>
    </item>
    <item>
      <title>使用 ML.NET 进行动态训练/测试类</title>
      <link>https://stackoverflow.com/questions/52822696/dynamic-training-test-classes-with-ml-net</link>
      <description><![CDATA[这是对问题的跟进
动态类/对象 ML.net 的 PredictionMoadel&lt;TInput, TOutput&gt; Train()
我的系统无法在编译时使用预定义类，因此我尝试将动态类输入 ML.NET，如下所示
// 字段数据类型
public class Field
{
public string FieldName { get; set; }
public Type FieldType { get; set; }
}

// 动态类助手
public class DynamicClass : DynamicObject
{
private readonly Dictionary&lt;string, KeyValuePair&lt;Type, object&gt;&gt; _fields;

public DynamicClass(List&lt;Field&gt; fields)
{
_fields = new Dictionary&lt;string, KeyValuePair&lt;Type, object&gt;&gt;();
fields.ForEach(x =&gt; _fields.Add(x.FieldName,
new KeyValuePair&lt;Type, object&gt;(x.FieldType, null)));
}

public override bool TrySetMember(SetMemberBinder binding, object value)
{
if (_fields.ContainsKey(binder.Name))
{
var type = _fields[binder.Name].Key;
if (value.GetType() == type)
{
_fields[binder.Name] = new KeyValuePair&lt;Type, object&gt;(type, value);
return true;
}
else throw new Exception(&quot;Value &quot; + value + &quot; 不是类型 &quot; + type.Name);
}
return false;
}

public override bool TryGetMember(GetMemberBinder binding, out object result)
{
result = _fields[binder.Name].Value;
return true;
}
}

private static void Main(string[] args)
{
var fields = new List&lt;Field&gt;
{
new Field {FieldName = &quot;Name&quot;, FieldType = typeof(string)},
new Field {FieldName = &quot;Income&quot;, FieldType = typeof(float)}
};

dynamic obj1 = new DynamicClass(fields);
obj1.Name = &quot;John&quot;;
obj1.Income = 100f;

dynamic obj2 = new DynamicClass(fields);
obj2.Name = &quot;Alice&quot;;
obj2.Income = 200f;

var trainingData = new List&lt;dynamic&gt; {obj1, obj2};

var env = new LocalEnvironment();
var schemaDef = SchemaDefinition.Create(typeof(DynamicClass));
schemaDef.Add(new SchemaDefinition.Column(null, &quot;Name&quot;, TextType.Instance));
schemaDef.Add(new SchemaDefinition.Column(null, &quot;Income&quot;, NumberType.R4));
var trainDataView = env.CreateStreamingDataView(trainingData, schemaDef);

var pipeline = new CategoricalEstimator(env, &quot;Name&quot;)
.Append(new ConcatEstimator(env, &quot;Features&quot;, &quot;Name&quot;))
.Append(new FastTreeRegressionTrainer(env, &quot;Income&quot;, &quot;Features&quot;));

var model = pipeline.Fit(trainDataView);
}

出现错误：
在类型“System.Object”中未找到名称为“Name”的字段或属性

我尝试使用反射生成类，但遇到了同样的问题。
有解决方法吗？]]></description>
      <guid>https://stackoverflow.com/questions/52822696/dynamic-training-test-classes-with-ml-net</guid>
      <pubDate>Mon, 15 Oct 2018 18:24:15 GMT</pubDate>
    </item>
    <item>
      <title>DNN 中的训练损失并未减少</title>
      <link>https://stackoverflow.com/questions/50997028/training-loss-is-not-reduced-in-dnn</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/50997028/training-loss-is-not-reduced-in-dnn</guid>
      <pubDate>Sat, 23 Jun 2018 00:41:24 GMT</pubDate>
    </item>
    <item>
      <title>如何利用机器学习进行反向预测？</title>
      <link>https://stackoverflow.com/questions/41592027/how-to-run-a-reverse-prediction-with-machine-learning</link>
      <description><![CDATA[我正在寻找解决以下问题的方法。这是一种反向预测。
我有很多输入，因此每条记录都有一个输出。因此，我可以轻松地对未知的新数据集进行分类并预测输出。
我想解决的问题是采取一个预期结果并对输入数据集进行分类，最终以非常高的概率达到预期定义的输出。
为了使问题更加复杂，我希望能够灵活地定义一些可能无法更改的输入标准（例如男性/女性），并添加这些标准（如过滤器）并获得新的反向预测 - 除了给定的输入之外，最相关的重要输入是什么，最终会得到预期和定义的结果。
让我们举个例子：我有数千条学生记录，包括教育等，以及他们在 10 年工作经验后收入正常还是极高的信息。因此，如果我是一名新生，我可以根据我的教育程度、性别、获得学位的年龄、我正在学习的内容等预测我是否会赚很多钱或赚得一般。
我想得到的是，鉴于我是男性，并且预计获得学位的年龄，我应该学习什么才能有很高的概率赚到高薪？]]></description>
      <guid>https://stackoverflow.com/questions/41592027/how-to-run-a-reverse-prediction-with-machine-learning</guid>
      <pubDate>Wed, 11 Jan 2017 13:19:09 GMT</pubDate>
    </item>
    </channel>
</rss>