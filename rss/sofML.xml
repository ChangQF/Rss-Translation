<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>æ ‡è®°ä¸ºæœºå™¨å­¦ä¹ çš„æ´»è·ƒé—®é¢˜ - å †æ ˆå†…å­˜æº¢å‡º</title>
    <link>https://stackoverflow.com/questions/tagged/?tagnames=machine-learning&sort=active</link>
    <description>æ¥è‡ª stackoverflow.com çš„æœ€æ–° 30 æ¡</description>
    <lastBuildDate>Wed, 17 Jul 2024 12:29:23 GMT</lastBuildDate>
    <item>
      <title>DSPy æ— æ³•æ£€ç´¢ ChromaDB ä¸­å¸¦æœ‰æ–‡æœ¬åµŒå…¥çš„æ®µè½</title>
      <link>https://stackoverflow.com/questions/78758312/dspy-cant-retrieve-passage-with-text-embeddings-in-chromadb</link>
      <description><![CDATA[æˆ‘æ­£åœ¨ä½¿ç”¨ DSPy å’Œ ChromaDB ä¸º pdf æ–‡ä»¶å¼€å‘ RAG åº”ç”¨ç¨‹åºã€‚
é¦–å…ˆï¼Œæˆ‘ä» pdf ä¸­è·å–æ–‡æœ¬å¹¶å°†å…¶ä½œä¸ºå—æ·»åŠ åˆ° Chromadbã€‚è¿˜æ·»åŠ äº†å—çš„åµŒå…¥ã€‚å¹¶å°è¯•ä½¿ç”¨ DSPy æ£€ç´¢ä¸æŸ¥è¯¢ç›¸å…³çš„å—ã€‚ä½†æ˜¯å®ƒå‡ºç°äº†é”™è¯¯
å­˜å‚¨æ•°æ®å’ŒåµŒå…¥
def store_document_in_chromadb(text):
chunks = chunk_document(text)
ids = [f&#39;chunk_{i}&#39; for i in range(len(chunks))]
embeddings = [get_embedding(chunk).tolist() for chunk in chunks]

collection.add(ids=ids, documents=chunks, embeddings=embeddings)

æˆ‘å°è¯•åƒè¿™æ ·æ£€ç´¢ç›¸å…³å—ï¼Œ
retriever_model = ChromadbRM(&quot;contracts_collection&quot;, &#39;db/&#39;, k=2)
dspy.settings.configure(lm=llama2_model, rm=retriever_model)

class GenerateAnswer(dspy.Signature): 
â€œâ€â€œâ€æ ¹æ®ç»™å‡ºçš„ä¸Šä¸‹æ–‡å›ç­”é—®é¢˜ã€‚â€œâ€â€œâ€
context = dspy.InputField(desc=&quot;å¯èƒ½åŒ…å«ç›¸å…³ä¸Šä¸‹æ–‡&quot;)
question = dspy.InputField()
answer = dspy.OutputField(desc=&quot;é€šå¸¸ä¸º 5 åˆ° 10 ä¸ªå•è¯&quot;)

class RAG(dspy.Module): 
def __init__(self, num_passages=2):
super().__init__()
self.retrieve = dspy.Retrieve(k=num_passages)
self.generate_answer = dspy.ChainOfThought(GenerateAnswer)

def forward(self, question):
context = self.retrieve(question).passages
prediction = self.generate_answer(context=context, question=question)
return dspy.Prediction(context=context, answer=prediction.answer)

with dspy.context(lm=llama2_model, rm=retriever_model):
module = RAG()
response = module(&quot;æ€»æ”¯å‡ºæ˜¯å¤šå°‘&quot;)
print(response)

å½“æˆ‘è¿è¡Œæ­¤ç¨‹åºæ—¶ï¼Œå‡ºç°æ­¤é”™è¯¯
InvalidDimensionExceptionï¼šåµŒå…¥ç»´åº¦ 384 ä¸é›†åˆç»´åº¦ 768 ä¸åŒ¹é…
ä½†æ˜¯å½“æˆ‘ä» ChromaDB ä¸­åˆ é™¤åµŒå…¥æ—¶ï¼Œå®ƒä¼šæ­£ç¡®æ£€ç´¢ç›¸å…³å—ã€‚
æœ‰äººçŸ¥é“ä¸ºä»€ä¹ˆä½¿ç”¨åµŒå…¥æ—¶æ²¡æœ‰å‡ºç°æ­¤é”™è¯¯å—ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/78758312/dspy-cant-retrieve-passage-with-text-embeddings-in-chromadb</guid>
      <pubDate>Wed, 17 Jul 2024 08:03:30 GMT</pubDate>
    </item>
    <item>
      <title>è¯·å¸®åŠ©æˆ‘æ„å»ºæˆ‘çš„äºŒå…ƒåˆ†ç±»é¡¹ç›®[å…³é—­]</title>
      <link>https://stackoverflow.com/questions/78758049/please-help-me-to-structure-my-binary-classification-project</link>
      <description><![CDATA[æˆ‘æ­£åœ¨å¼€å‘ä¸€ä¸ªäºŒå…ƒåˆ†ç±»é¡¹ç›®ã€‚æœ€åˆï¼Œæˆ‘å¾—åˆ°äº†ä¸€ä¸ªåŒ…å« 3290 è¡Œå’Œ 15 åˆ—çš„çœŸå®æ•°æ®çš„æ•°æ®é›†ã€‚ç„¶åï¼Œæˆ‘ä½¿ç”¨ CTGAN ç½‘ç»œç”Ÿæˆäº†åŒ…å« 100000 è¡Œçš„åˆæˆæ•°æ®é›†ã€‚ç„¶åï¼Œæˆ‘å°†è¿™ä¸¤ä¸ªæ•°æ®é›†æ··æ´—ï¼Œå¾—åˆ° 1 ä¸ªæ•°æ®é›†ã€‚æˆ‘çš„ç›®æ ‡å˜é‡é«˜åº¦ä¸å¹³è¡¡ï¼ˆæ˜¯ï¼š23175ï¼Œå¦ï¼š76825ï¼‰ã€‚æˆ‘å¯¹æˆ‘çš„é¡¹ç›®æœ‰ä»¥ä¸‹é—®é¢˜ï¼Ÿ

æœ‰ 7 ä¸ªåˆ†ç±»é¢„æµ‹å› å­ï¼Œå…¶ä¸­æœ‰ 4 ä¸ªäºŒå…ƒåˆ†ç±»åˆ—ï¼ˆæ€§åˆ«ã€å©šå§»çŠ¶å†µç­‰ï¼‰ï¼Œå…¶ä»–æ˜¯éäºŒå…ƒåˆ†ç±»å˜é‡ï¼ˆçœã€åŒºç­‰ï¼‰ã€‚æˆ‘åº”è¯¥ä½¿ç”¨ä»€ä¹ˆç¼–ç æŠ€æœ¯ï¼Ÿ

å¤„ç†è¿™é‡Œçš„æ•°æ®ä¸å¹³è¡¡é—®é¢˜æ˜¯å¦é‡è¦ï¼Ÿå¦‚æœé‡è¦ï¼Œæˆ‘åº”è¯¥ä½¿ç”¨ä»€ä¹ˆæŠ€æœ¯æ¥å¤„ç†è¿™ä¸ªä¸å¹³è¡¡é—®é¢˜ï¼Ÿ

æˆ‘çš„æ•°å€¼å˜é‡éƒ½ä¸æ˜¯æ­£æ€åˆ†å¸ƒçš„ã€‚å¤„ç†è¿™ä¸ªé—®é¢˜æ˜¯å¦é‡è¦ï¼Ÿå¦‚æœæ˜¯ï¼Œæˆ‘éœ€è¦ä½¿ç”¨å“ªäº›æŠ€æœ¯ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœéœ€è¦ï¼Œè¿›è¡Œè½¬æ¢ï¼‰ï¼Ÿ

æˆ‘éœ€è¦æ ‡å‡†åŒ–æˆ–è§„èŒƒåŒ–æˆ‘çš„æ•°æ®å—ï¼Ÿå¦‚æœæ˜¯ï¼Œä¸ºä»€ä¹ˆï¼Ÿ

æˆ‘åº”è¯¥åœ¨è¿™é‡Œä½¿ç”¨å“ªäº›ç‰¹å¾é€‰æ‹©æŠ€æœ¯ï¼Ÿ

æˆ‘çš„é¡¹ç›®çš„é¡ºåºæ˜¯ä»€ä¹ˆã€‚è¯·æŒ‰ä»¥ä¸‹é¡ºåºæ’åˆ—ã€‚ï¼ˆæ•°æ®ä¸å¹³è¡¡é—®é¢˜å¤„ç†/ç¼–ç åˆ†ç±»å˜é‡/è½¬æ¢æ•°å€¼æ•°æ®/æ ‡å‡†åŒ–æˆ–è§„èŒƒåŒ–æ•°å€¼æ•°æ®/ç‰¹å¾é€‰æ‹©\å»ºæ¨¡ï¼‰

æœ€åæˆ‘å¯ä»¥ä½¿ç”¨ç¥ç»ç½‘ç»œæ¥å®ç°è¿™ä¸€ç‚¹å—ï¼Ÿå¦‚æœå¯ä»¥ï¼Œæˆ‘å¯ä»¥ä½¿ç”¨å“ªäº› NN ç±»å‹


æˆ‘çŸ¥é“è¿™æ˜¯ä¸€ä¸ªå¾ˆé•¿çš„é—®é¢˜ï¼Œæ„Ÿè°¢æ‚¨èŠ±æ—¶é—´å’Œç²¾åŠ›å›ç­”è¿™äº›é—®é¢˜ã€‚
æˆ‘æœŸå¾…ä¸Šè¿°é—®é¢˜çš„ç­”æ¡ˆã€‚]]></description>
      <guid>https://stackoverflow.com/questions/78758049/please-help-me-to-structure-my-binary-classification-project</guid>
      <pubDate>Wed, 17 Jul 2024 06:57:24 GMT</pubDate>
    </item>
    <item>
      <title>å¦‚ä½•åœ¨ XGBoost å†³ç­–æ ‘çš„å¶èŠ‚ç‚¹ä¸Šæ˜¾ç¤ºé¢„æµ‹ç±»æ ‡ç­¾ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/78757774/how-do-i-display-predicted-class-labels-on-the-leaf-nodes-of-an-xgboost-decision</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/78757774/how-do-i-display-predicted-class-labels-on-the-leaf-nodes-of-an-xgboost-decision</guid>
      <pubDate>Wed, 17 Jul 2024 05:22:10 GMT</pubDate>
    </item>
    <item>
      <title>æ— æ³•å®‰è£… pytorch-forecastingï¼šæ²¡æœ‰åä¸ºâ€œdistutilsâ€çš„æ¨¡å—é”™è¯¯</title>
      <link>https://stackoverflow.com/questions/78757738/unable-to-install-pytorch-forecasting-no-module-named-distutils-error</link>
      <description><![CDATA[å½“æˆ‘å°è¯•åœ¨ VSCode ç»ˆç«¯ä¸­è¿è¡Œ pip install pytorch-forecasting æ—¶ï¼Œæˆ‘æ”¶åˆ°é”™è¯¯æ¶ˆæ¯ï¼Œæç¤ºæ²¡æœ‰ æ²¡æœ‰åä¸ºâ€œdistutilsâ€çš„æ¨¡å—ã€‚
é¦–å…ˆï¼ŒPyTorch å·²å®‰è£…ï¼Œå¹¶ä¸”ä½¿ç”¨ conda install pytorch-forecasting pytorch&gt;=1.7 -c pytorch -c conda-forge åœ¨ Anaconda ä¸Šå®‰è£…äº† pytorch-forecastingã€‚
æˆ‘å·²ç»çœ‹åˆ°äº† pip install setuptools çš„è§£å†³æ–¹æ¡ˆã€‚æˆ‘åœ¨æˆ‘çš„ç»ˆç«¯ä¸ŠæˆåŠŸè¿è¡Œäº†å®‰è£… setuptools çš„å‘½ä»¤ï¼Œä½†å®ƒå¹¶æ²¡æœ‰æ‘†è„±â€œæ²¡æœ‰åä¸ºâ€œdistutilsâ€çš„æ¨¡å—â€é”™è¯¯ã€‚
æˆ‘éœ€è¦å¸®åŠ©æ¥ç»•è¿‡â€œæ²¡æœ‰åä¸ºâ€œdistutilsâ€çš„æ¨¡å—â€é”™è¯¯ï¼Œä»¥ä¾¿æˆ‘å¯ä»¥å®‰è£… pytorch-forecasting åŒ…ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/78757738/unable-to-install-pytorch-forecasting-no-module-named-distutils-error</guid>
      <pubDate>Wed, 17 Jul 2024 05:09:49 GMT</pubDate>
    </item>
    <item>
      <title>å¦‚ä½•å°†å¤šå¤´è‡ªæ³¨æ„åŠ›è¾“å‡ºçš„å½¢çŠ¶æ›´æ”¹ä¸ºå¯ä»¥é¦ˆé€åˆ°å·ç§¯å±‚çš„å½¢çŠ¶ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/78757193/how-to-change-shape-of-multi-head-self-attention-output-to-a-shape-that-can-be-f</link>
      <description><![CDATA[æˆ‘é‡åˆ°äº†è¿™æ ·çš„é”™è¯¯ï¼š
MHSAï¼ˆå¤šå¤´è‡ªæ³¨æ„åŠ›ï¼‰çš„è¾“å‡ºå¦‚ä¸‹ï¼š
torch.Size([20, 197, 768])


æ‰¹æ¬¡å¤§å°ä¸º 20
åºåˆ—é•¿åº¦ä¸º 197ï¼ˆä¹‹å‰ä¸º 196ï¼Œæ·»åŠ ç±»æ ‡è®°åå˜ä¸º 197ï¼‰
åµŒå…¥ç»´åº¦ä¸º 768

æˆ‘æƒ³å°†å…¶é‡å¡‘ä»¥é€‚åº”ä»¥ä¸‹æ ¼å¼ï¼Œä»¥ä¾¿å°†å…¶é¦ˆé€åˆ°å·ç§¯å±‚ï¼š
torch.Size([batch_size, channel, width, height])

æˆ‘å°è¯•é€šè¿‡ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æ·»åŠ æ–°ç»´åº¦æ¥å®ç°æ­¤ç›®çš„æ–¹æ³•ï¼š
torch.unsqueeze(1)
torch.transpose(1, 3)

è¿™æˆåŠŸåœ°å…è®¸é¦ˆé€åˆ°å·ç§¯å±‚ã€‚ä½†æ˜¯ï¼Œæˆ‘ä¸ç¡®å®šè¿™ç§æ–¹æ³•æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœä¸æ­£ç¡®ï¼Œè¯·çº æ­£æˆ‘ã€‚
ç›®å‰ï¼Œæˆ‘æ­£åœ¨å°è¯•ä¸€ç§ä¸åŒçš„æ–¹æ³•ï¼š
new_size = int(math.sqrt(sequence_length))
torch.transpose(1, 2).view(batch_size, embed_dim, new_size, new_size)

è¿™å¯¼è‡´é”™è¯¯ï¼ŒæŒ‡å‡ºå½¢çŠ¶å¯¹äºå¤§å°ä¸º (some_number) çš„è¾“å…¥æ— æ•ˆã€‚è¿™æ˜¯å› ä¸ºåºåˆ—é•¿åº¦ï¼ˆ197ï¼‰ä¸æ˜¯å®Œå…¨å¹³æ–¹çš„ï¼Œå¾—å‡ºçš„æ˜¯ä¸€ä¸ªåè¿›åˆ¶æ•°ï¼Œè€Œè§†å›¾å‡½æ•°éœ€è¦è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼Œå¹³æ–¹è¿ç®—åœ¨è½¬æ¢ä¸ºæ•´æ•°åå¾—å‡º 16ï¼Œä½† batch_size * 768 * 16 * 16 ä¸ç­‰äº batch_size * 197 * 768ï¼Œå¯¼è‡´é”™è¯¯
æˆ‘çš„åˆ†ææ­£ç¡®å—ï¼Ÿæˆ‘è¯¥å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿè¿˜æœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹æ³•ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/78757193/how-to-change-shape-of-multi-head-self-attention-output-to-a-shape-that-can-be-f</guid>
      <pubDate>Wed, 17 Jul 2024 00:24:06 GMT</pubDate>
    </item>
    <item>
      <title>éœ€è¦ä»€ä¹ˆç±»å‹çš„ç›¸æœºæˆ–è®¡ç®—æœºè§†è§‰ç¡¬ä»¶/è½¯ä»¶æ¥è·Ÿè¸ªå¯»æ‰¾ç‰¹å®šè¿åŠ¨çš„äºº[å…³é—­]</title>
      <link>https://stackoverflow.com/questions/78757027/what-type-of-camera-or-computer-vision-hardware-software-be-needed-to-track-a-hu</link>
      <description><![CDATA[æˆ‘éœ€è¦æ‰¾åˆ°ä¸€ä¸ªæ‘„åƒå¤´å’Œç›¸åº”çš„è®¡ç®—æœºè§†è§‰æŠ€æœ¯ï¼Œå¯ä»¥è·Ÿè¸ªäººç±»ç›´åˆ°åšå‡ºç‰¹å®šåŠ¨ä½œï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹å®ƒå°†è§¦å‘å¦ä¸€ä¸ªç³»ç»Ÿäº‹ä»¶ã€‚ä¾‹å¦‚ï¼Œè¿™ä¸ªæ‘„åƒå¤´åº”è¯¥æ£€æµ‹å…¶æ¡†æ¶å†…çš„äººçš„å­˜åœ¨ï¼Œå¦‚æœäººåä¸‹ï¼Œå®ƒå°†å‘Šè¯‰è§¦å‘è¿æ¥åˆ°æ‘„åƒå¤´ç³»ç»Ÿçš„ LED ä»¥æ‰“å¼€ã€‚ä»»ä½•æƒ³æ³•æˆ–æŒ‡å¯¼éƒ½å€¼å¾—èµèµã€‚
æˆ‘ç ”ç©¶è¿‡åƒ arduinos Nicla Vision è¿™æ ·çš„è®¡ç®—æœºè§†è§‰ç³»ç»Ÿï¼Œä½†å¹¶ä¸è®¤ä¸ºå®ƒæœ‰èƒ½åŠ›æ£€æµ‹åˆ°è¿™ç§å˜åŒ–ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/78757027/what-type-of-camera-or-computer-vision-hardware-software-be-needed-to-track-a-hu</guid>
      <pubDate>Tue, 16 Jul 2024 23:02:38 GMT</pubDate>
    </item>
    <item>
      <title>å½“å·²çŸ¥ç›®æ ‡å€¼çš„ç‰¹å¾å‘é‡æ—¶ï¼Œå¦‚ä½•ä½¿ç”¨ç›‘ç£å¼æœºå™¨å­¦ä¹ è¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/78757005/how-to-use-supervised-ml-for-time-series-predictions-when-the-feature-vector-for</link>
      <description><![CDATA[æˆ‘å°è¯•ä½¿ç”¨ LSTM é¢„æµ‹ä»ªå™¨çš„è¿ç»­â€œåç§»â€æ ¡å‡†å€¼ã€‚è¿™äº›åç§»å€¼ä¹‹å‰å·²è¢«è¯æ˜ä¸ç”¨ä½œç‰¹å¾çš„ä¸€å¯¹æ¸©åº¦å€¼æœ‰å¾ˆå¥½çš„ç›¸å…³æ€§ã€‚è¿™äº›åç§»å€¼æ˜¾ç¤ºå‡ºå‘¨æœŸæ€§ï¼Œå› æ­¤ä¸ºæ¨¡å‹é€‰æ‹©äº† LSTMã€‚ä½†æ˜¯ï¼Œæˆ‘å‘ç°çš„æ‰€æœ‰ LSTM ç¤ºä¾‹éƒ½ä½¿ç”¨æ¥è‡ªå…ˆå‰æ•°æ®ç‚¹åºåˆ—çš„ç‰¹å¾å‘é‡æ¥é¢„æµ‹ç›®æ ‡ã€‚æˆ‘è§‰å¾—è¿™å¯èƒ½æ— æ³•æ•æ‰åºåˆ—ä¸­æ¯ä¸ªç‰¹å¾å‘é‡ä¸å…¶åç§»ä¹‹é—´çš„å…³ç³»ã€‚è€Œä¸”ç”±äºåœ¨é¢„æµ‹ä¸­åªä½¿ç”¨äº†å…ˆå‰æ•°æ®ç‚¹åºåˆ—çš„ç‰¹å¾å‘é‡ï¼Œå› æ­¤æ— æ³•æœ‰æ•ˆåœ°åˆ©ç”¨è¯¥æ¸©åº¦åç§»å…³ç³»ã€‚
ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘å·²ç»å°†å½“å‰æ•°æ®ç‚¹çš„ç‰¹å¾å‘é‡æ·»åŠ åˆ°ç”¨äºè®­ç»ƒæ¨¡å‹çš„å‘é‡åºåˆ—ä¸­ï¼Œå½“ç„¶ï¼Œä¹Ÿæ·»åŠ åˆ°ç”¨äºé¢„æµ‹ç›®æ ‡åç§»çš„åºåˆ—ä¸­ã€‚
ä½†æ˜¯ï¼Œæˆ‘å¦‚ä½•æ‰èƒ½å¯¹è¦é¢„æµ‹çš„åç§»çš„ç‰¹å¾å‘é‡èµ‹äºˆæ›´å¤§çš„æƒé‡ï¼Œä»¥ä½¿æ¨¡å‹èƒ½å¤Ÿåˆ©ç”¨æ¸©åº¦åç§»å…³ç³»ï¼Ÿ
è°¢è°¢ï¼ ğŸ––
åˆ›å»ºåºåˆ—çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š
def create_sequences(x, y, time_steps = 24):
xs, ys = [], []
for i in range(len(x) - time_steps - 1):
x_temp = x[i:(i + time_steps + 1)] #åœ¨ç›®æ ‡å€¼ä¹‹å‰åˆ›å»ºä¸€ä¸ª time_steps åºåˆ—
xs.append(x_temp)
ys.append(y[i + time_steps]) #ç›®æ ‡å€¼æ˜¯åºåˆ—ä¹‹åçš„å€¼
return np.array(xs), np.array(ys)
]]></description>
      <guid>https://stackoverflow.com/questions/78757005/how-to-use-supervised-ml-for-time-series-predictions-when-the-feature-vector-for</guid>
      <pubDate>Tue, 16 Jul 2024 22:49:31 GMT</pubDate>
    </item>
    <item>
      <title>è¯åˆ°è¯æœºå™¨ç¿»è¯‘çš„è¯„ä¼°æŒ‡æ ‡/ç®—æ³•</title>
      <link>https://stackoverflow.com/questions/78756460/evaluation-metric-algorithm-for-word-to-word-machine-translation</link>
      <description><![CDATA[æˆ‘æ­£åœ¨å¯»æ‰¾ä¸€ç§ç§‘å­¦åˆç†çš„æ–¹æ³•æ¥è¯„ä¼°æˆ‘çš„å­¦å£«è®ºæ–‡çš„å•è¯ç¿»è¯‘ã€‚åœ¨å¯»æ‰¾çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°å¤§å¤šæ•°æ–¹æ³•éƒ½æ˜¯åŸºäº n-gram ç²¾åº¦æ¥è¿›è¡Œå¥å­è¯„ä¼°ã€‚æˆ‘æ­£åœ¨å°†æ•°æ®åº“åˆ—å’Œè¡¨åä»è‹±è¯­ç¿»è¯‘æˆå¾·è¯­ã€‚æˆ‘å¯ä»¥é€‰æ‹©åŒ…å«åŸºæœ¬äº‹å®ï¼Œä½†æˆ‘æ›´å–œæ¬¢ä¸åŒ…å«å®ƒçš„æ–¹æ³•ã€‚æˆ‘çš„ç¿»è¯‘å’ŒåŸæ–‡ä¹ŸåŒ…å«ç¼©å†™ã€‚
ç°åœ¨æˆ‘ä½¿ç”¨ OpenAIs æœ€æ–°çš„åµŒå…¥æ¨¡å‹ï¼Œç„¶åè®¡ç®—åµŒå…¥ä¹‹é—´çš„è·ç¦»ã€‚ä½†ç»“æœå¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºæ¨¡å‹ã€‚æˆ‘ç ”ç©¶è¿‡ä½¿ç”¨å­—ç¬¦ n-gram çš„ ChrFã€‚ä½†å¦‚ä¸Šæ‰€è¿°ï¼Œä¸éœ€è¦åŸºæœ¬äº‹å®çš„æ–¹æ³•ä¼šæ›´ç†æƒ³ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/78756460/evaluation-metric-algorithm-for-word-to-word-machine-translation</guid>
      <pubDate>Tue, 16 Jul 2024 19:42:06 GMT</pubDate>
    </item>
    <item>
      <title>å°è¯•ä½¿ç”¨ GCP TPU è¿›è¡Œå¤šå¤„ç†ï¼Œä½† shell æ„å¤–æ­»æœº</title>
      <link>https://stackoverflow.com/questions/78756024/attempting-multiprocessing-with-gcp-tpus-but-the-shell-dies-unexpectedly</link>
      <description><![CDATA[æˆ‘å¯ä»¥è®¿é—®ç¾å›½åœ°åŒºçš„ 32 ä¸ªå¯æŠ¢å  Cloud TPU v4 èŠ¯ç‰‡ï¼Œå¹¶å°è¯•ä½¿ç”¨ä»¥ä¸‹ Python ä»£ç è¿è¡Œæˆ‘çš„ PyTorch æ¨¡å‹ï¼š
import os 
import sys 
import pickle 
import torch_xla.distributed.xla_multiprocessing as xmp 
from transformers 
import AutoTokenizer 
import main_utils as utils 
import multiprocessing as mp

lock = mp.Manager().Lock()

def _mp_fn(i): 

A_tasks, B_tasks, desire_output_lengths, keys = utils.get_total_tasks()

import torch
import torch_xla.core.xla_model as xm
from models_mamba import MambaForCausalLM

DEVICE_NAME = xm.xla_device()
tokenizer = AutoTokenizer.from_pretrained(&quot;~/Mamba-1B/&quot;)
model = MambaForCausalLM.from_pretrained(&quot;~/Mamba-1B/&quot;, torch_dtype=&quot;auto&quot;,
device_map=&quot;auto&quot;, low_cpu_mem_usage=True)
model = model.to_empty(device=&#39;cpu&#39;)
model.apply(lambda module: module.reset_parameters() if hasattr(module, &#39;reset_parameters&#39;) else None)
model = model.to(xm.xla_device())

params_to_save = [&quot;out_proj_y&quot;]

def generate_logits(task, logits_list, desire_output_length):
for i in range(48):
layer_to_save = [i + 1]
input_ids = tokenizer.encode(task, return_tensors=&quot;pt&quot;).to(è®¾å¤‡åç§°)
model.saved_activation(params_to_save, layer_to_save, precision=&#39;r&#39;)
output = model.generate(input_ids, max_length=desired_output_length, no_repeat_ngram_size=2)

saved_dict = model.reset_everything_and_save()
param = saved_dict[f&quot;out_proj_y_{i + 1}&quot;][0, -1, :].to(è®¾å¤‡åç§°)

xm.all_gather(param)
logits = model.get_unembed_for_layer(param, norm=&quot;False&quot;)

xm.all_gather(logits)
logits_list.append(logits.to(&quot;cpu&quot;))

del input_idsã€outputã€saved_dictã€paramã€logits

task_dict = {}
for A_taskã€B_taskã€dolã€key in zip(A_tasksã€B_tasksã€desired_output_lengthsã€keys):
A_logits = []
B_logits = []
generate_logits(A_taskã€A_logitsã€dol)
generate_logits(B_taskã€B_logitsã€dol)

aux_dict = {&#39;A&#39;: A_logits, &#39;B&#39;: B_logits}
task_dict[key] = aux_dict

device = xm.xla_device()
with lock:
print(f&#39;Process {i}, Device {device}&#39;)

xm.mark_step()
with open(f&#39;~/main_file.pickle&#39;, &#39;wb&#39;) as handle:
pickle.dump(task_dict, handle, protocol=pickle.HIGHEST_PROTOCOL)

if name == &quot;main&quot;: 
xmp.spawn(_mp_fn, args=(), nprocs=8, start_method=&#39;fork&#39;)`

è¦æ‰§è¡Œæ­¤ä»£ç ï¼Œæˆ‘ä½¿ç”¨ Cloud Shell å’Œä»¥ä¸‹å‘½ä»¤ï¼ˆè®¾ç½® TPU å¹¶åœ¨æ‰€æœ‰ 8 ä¸ªå·¥ä½œå™¨ä¸Šå®‰è£…åº“ä¹‹åï¼‰ï¼š
gcloud compute tpus tpu-vm ssh ${TPU_NAME} --zone=${ZONE} --project=${PROJECT_ID} --worker=all --command=&quot;PJRT_DEVICE=TPU python3 ~test.py&quot;
æˆ‘å¸Œæœ›æ¨¡å‹åœ¨æ‰€æœ‰ TPU ä¸Šæ‰§è¡Œ _mp_fn() ä¸­å®šä¹‰çš„ä»»åŠ¡ï¼ŒæŒ‰ç…§æŒ‡å®šçš„æ–¹å¼æ”¶é›†å’Œä¿å­˜ logitï¼Œæœ€åå°†ç»“æœå­˜å‚¨åœ¨ main_file.pickle ä¸­ã€‚ä½†æ˜¯ï¼Œåœ¨ Cloud Shell ä¸­å¯åŠ¨å‘½ä»¤åï¼Œshell åœ¨æ¨¡å‹åŠ è½½æœŸé—´æ‰“å°äº†ä¸€äº›é¢„æœŸçš„è­¦å‘Šï¼Œä½†æ²¡æœ‰ç»§ç»­è¿›è¡Œã€‚ç›¸åï¼Œè¿‡äº†ä¸€æ®µæ—¶é—´ï¼Œshell ä¼šè¯æ„å¤–ç»ˆæ­¢ã€‚æˆ‘ä¸ç¡®å®šå¦‚ä½•æ’é™¤æ•…éšœï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/78756024/attempting-multiprocessing-with-gcp-tpus-but-the-shell-dies-unexpectedly</guid>
      <pubDate>Tue, 16 Jul 2024 17:38:54 GMT</pubDate>
    </item>
    <item>
      <title>LSTM æ¨¡å‹æ— æ³•è®­ç»ƒ</title>
      <link>https://stackoverflow.com/questions/78753201/lstm-model-doesnt-train</link>
      <description><![CDATA[æˆ‘æ­£åœ¨å°è¯•ä½¿ç”¨æ·±åº¦å­¦ä¹ æ¥æŸ¥æ‰¾ç²’å­çš„åŒ–å­¦çŠ¶æ€ã€‚ä½œä¸ºè¾“å…¥ï¼Œæˆ‘æœ‰ç²’å­åœ¨ X_train ä¸­éšæ—¶é—´çš„ä½ç½®ï¼Œå½¢çŠ¶ä¸º (num_train,sequence_length)ã€‚ ï¼ˆæˆ‘çš„åºåˆ—é•¿åº¦ä¸º 100ï¼‰ï¼Œè¾“å‡ºæ˜¯å½¢çŠ¶ä¸º (num_train,1) çš„ Y_train ä¸­åŒ…å«çš„è½¬æ¢å¸§ï¼ˆä»‹äº 1 å’Œ 100 ä¹‹é—´ï¼‰ã€‚
è¿™æ˜¯ä¸€ä¸ªåºåˆ—ç¤ºä¾‹ï¼ˆhttps://i.sstatic.net/Ddmhjc24.jpgï¼‰ï¼Œè½¬æ¢ä½äºç¬¬ 84 å¸§ã€‚
æ‰€æœ‰æ•°æ®éƒ½æ˜¯ç”¨éå¸¸å…·ä½“çš„ç®—æ³•ç”Ÿæˆçš„ï¼Œä½†æ˜¯è¯¥ç®—æ³•ä¸ä¼šç”Ÿæˆéå¸¸å¤æ‚çš„æ•°æ®ï¼Œæˆ‘è®¤ä¸ºè‡ªå·±å¾ˆå®¹æ˜“æ‰¾åˆ°è½¬æ¢ï¼Œä½†æˆ‘å¸Œæœ›è¿™ä¸ªæ·±åº¦å­¦ä¹ æ¨¡å‹èƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚
è¿™æ˜¯ LSTM ä»£ç ï¼š
# è¿‡æ»¤

# å®šä¹‰ LSTM æ¨¡å‹
model = Sequential([
LSTM(64, input_shape=(sequence_length, 1), return_sequences=False), Dense(64,activation=&#39;relu&#39;), Dense(1) ]) # æ¨¡å‹ç¼–è¯‘å™¨ model.compile(optimizer=&#39;adam&#39;, loss=&#39;mse&#39;) # å›å½’çš„å‡æ–¹è¯¯å·® # æ¨¡å‹æ‘˜è¦ model.summary() # æ¨¡å‹æ¨¡å‹åµŒå…¥ model.fit( X_train, Y_train, epochs=40, batch_size=32,validation_data=(X_test, Y_test)) # æ–°é¢„æµ‹ç¤ºä¾‹é¢„æµ‹ = model.predict(X_test) print(prediction)  ç»“æœï¼š æ¨¡å‹ï¼šâ€œé¡ºåºâ€
_________________________________________________________________
å±‚ï¼ˆç±»å‹ï¼‰è¾“å‡ºå½¢çŠ¶å‚æ•° # 
====================================================================
lstm (LSTM) (æ— ï¼Œ64) 16896 

å¯†é›† (å¯†é›†) (æ— ï¼Œ64) 4160 

å¯†é›†_1 (å¯†é›†) (æ— ï¼Œ1) 65 

============================================================================
æ€»å‚æ•°ï¼š21121 (82.50 KB)
å¯è®­ç»ƒå‚æ•°ï¼š 21121 (82.50 KB)
ä¸å¯è®­ç»ƒå‚æ•°ï¼š0 (0.00 å­—èŠ‚)
_________________________________________________________________
Epoch 1/10
631/631 [==============================] - 35s 50ms/step - æŸå¤±ï¼š1043.6710 - val_lossï¼š840.6771
Epoch 2/10
631/631 [==============================] - 30s 48ms/step - æŸå¤±ï¼š840.9444 - val_lossï¼š839.9596
Epoch 3/10
631/631 [===============================] - 32s 50ms/æ­¥ - æŸå¤±ï¼š841.6289 - val_lossï¼š840.7188
Epoch 4/10
631/631 [=============================] - 30s 48ms/æ­¥ - æŸå¤±ï¼š840.9946 - val_lossï¼š840.6344
Epoch 5/10
631/631 [===============================] - 33s 52ms/æ­¥ - æŸå¤±ï¼š841.8745 - val_lossï¼š839.9298
Epoch 6/10
631/631 [==============================] - 31s 49ms/æ­¥ - æŸå¤±ï¼š841.6499 - val_lossï¼š839.8434
Epoch 7/10
631/631 [=============================] - 31s 49ms/æ­¥ - æŸå¤±ï¼š841.2045 - val_lossï¼š840.0717
Epoch 8/10
631/631 [===============================] - 30s 48ms/æ­¥ - æŸå¤±ï¼š842.0576 - val_lossï¼š 840.2137
çºªå…ƒ 9/10
631/631 [=============================] - 33s 52ms/æ­¥ - æŸå¤±ï¼š842.7056 - val_lossï¼š840.5657
çºªå…ƒ 10/10
631/631 [=============================] - 30s 48ms/æ­¥ - æŸå¤±ï¼š841.5714 - val_lossï¼š839.8404
70/70 [================================] - 2s 16ms/æ­¥
[[52.569366]
[52.569286]
[52.569378]
...
[52.569344]
[52.569313]
[52.56937 ]]

å¦‚æ‚¨æ‰€è§ï¼Œå½“æˆ‘æµ‹è¯•è®­ç»ƒåçš„æ¨¡å‹æ—¶ï¼Œæ— è®ºè¾“å…¥æ˜¯ä»€ä¹ˆï¼Œè¾“å‡ºéƒ½æ˜¯ç›¸åŒçš„ã€‚ val_loss ä¸ä¼šéšç€ epoch çš„æ•°é‡è€Œæ”¹å–„ã€‚ è¿™å°±æ˜¯é—®é¢˜æ‰€åœ¨ï¼Œæˆ‘ä¸æ˜ç™½å‘ç”Ÿäº†ä»€ä¹ˆã€‚
æˆ‘æ˜¯æ·±åº¦å­¦ä¹ çš„åˆå­¦è€…ï¼Œæ‰€ä»¥ä¹Ÿè®¸æˆ‘çŠ¯äº†ä¸€ä¸ªéå¸¸ç®€å•çš„é”™è¯¯ã€‚ ä½†æ˜¯æˆ‘ä»”ç»†æ£€æŸ¥äº†æˆ‘çš„æ•°æ®ï¼ŒX_train å·²æ ‡å‡†åŒ–ï¼Œæˆ‘å°è¯•åœ¨æˆ‘çš„æ¨¡å‹ä¸Šæ·»åŠ ä¸€äº› drop out å’Œå…¶ä»–å±‚ï¼Œä½†æ²¡æœ‰ä»»ä½•å˜åŒ–ã€‚
ä¹Ÿè®¸ä½¿ç”¨ LSTM æ— æ³•åšåˆ°è¿™ä¸€ç‚¹ï¼Œä½†æˆ‘è®¤ä¸ºæ•°æ®éå¸¸ç®€å•ã€‚ æˆ‘çœŸçš„æƒ³å°è¯•æ‰¾åˆ°ä¸€ç§æ–¹æ³•æ¥ä½¿ç”¨æ·±åº¦å­¦ä¹ æ¥æ‰¾åˆ°å®ƒã€‚ æˆ‘ d]]></description>
      <guid>https://stackoverflow.com/questions/78753201/lstm-model-doesnt-train</guid>
      <pubDate>Tue, 16 Jul 2024 07:31:40 GMT</pubDate>
    </item>
    <item>
      <title>å³ä½¿ç»è¿‡æ•°ç™¾ä¸ªæ—¶æœŸï¼Œpytorch AdamW çš„ LR ä»æœªè¡°å‡</title>
      <link>https://stackoverflow.com/questions/78752899/lr-not-decaying-for-pytorch-adamw-even-after-hundreds-of-epochs</link>
      <description><![CDATA[æˆ‘æœ‰ä»¥ä¸‹ä½¿ç”¨ Pytorch ä¸­çš„ AdamW ä¼˜åŒ–å™¨çš„ä»£ç ï¼š
optimizer = AdamW(params=self.model.parameters(), lr=0.00005)

æˆ‘å°è¯•ä½¿ç”¨ wandb è¿›è¡Œç™»å½•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
lrs = {f&#39;lr_group_{i}&#39;: param_group[&#39;lr&#39;]
for i, param_group in enumerate(self.optimizer.param_groups)}
wandb.log({&quot;train_loss&quot;: avg_train_loss, &quot;val_loss&quot;: val_loss, **lrs})

è¯·æ³¨æ„ weight_decay å‚æ•°çš„é»˜è®¤å€¼ä¸º 0.01ï¼ˆå¯¹äº AdamWï¼‰ã€‚
å½“æˆ‘æ£€æŸ¥ wandb ä»ªè¡¨æ¿æ—¶ï¼Œå®ƒæ˜¾ç¤º AdamW çš„ LR å³ä½¿åœ¨ 200 ä¸ª epoch ä¹‹åä¹Ÿç›¸åŒï¼Œå¹¶ä¸”æ ¹æœ¬æ²¡æœ‰è¡°å‡ã€‚æˆ‘å°è¯•äº†å‡ æ¬¡ã€‚

ä¸ºä»€ä¹ˆ LR è¡°å‡æ²¡æœ‰å‘ç”Ÿï¼Ÿ
æ­¤å¤–ï¼Œå®ƒä»…æ˜¾ç¤ºä¸€ä¸ªå‚æ•°ç»„çš„ LRã€‚ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿä¼¼ä¹æˆ‘åœ¨è¿™é‡Œé”™è¿‡äº†ä¸€äº›åŸºæœ¬çš„ä¸œè¥¿ã€‚æœ‰äººå¯ä»¥æŒ‡å‡ºå—ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/78752899/lr-not-decaying-for-pytorch-adamw-even-after-hundreds-of-epochs</guid>
      <pubDate>Tue, 16 Jul 2024 06:09:44 GMT</pubDate>
    </item>
    <item>
      <title>å¦‚ä½•æŸ¥çœ‹ YOLOv6 ä¸­çš„è¯„ä¼°æŒ‡æ ‡ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/78680846/how-to-see-evaluation-metrics-in-yolov6</link>
      <description><![CDATA[æˆ‘æœ‰ä»¥ä¸‹è¾“å‡ºï¼Œä½†æ— æ³•å¼„æ¸…æ¥šå¦‚ä½•è¯„ä¼°ï¼Œå› ä¸ºæ²¡æœ‰ F1 åˆ†æ•° æˆ– æ··æ·†çŸ©é˜µã€‚
å¹³å‡å¬å›ç‡ (AR) @[ IoU=0.50:0.95 | area= small |maxDets=100] = -1.000

å¹³å‡å¬å›ç‡ (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.250

å¹³å‡å¬å›ç‡ (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.410

20/499 0.001595 0.6697 0 1.393: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:

21/499 0.001594 0.6417 0 1.353: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:

22/499 0.001594 0.6727 0 1.431: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:

æˆ‘è®­ç»ƒäº† 400 ä¸ª epochï¼Œè¿™åªæ˜¯è¾“å‡ºçš„ä¸€å°éƒ¨åˆ†ã€‚æˆ‘ä¹Ÿçœ‹ä¸åˆ° mAPã€‚
æˆ‘æœ‰è¿™è¡Œä»£ç è¦è¯„ä¼°
!python tools/eval.py --data Fabric-Defect-2/data.yaml --weights runs/train/exp/weights/best_ckpt.pt --device 0

æœ‰æ²¡æœ‰åŠæ³•è·å¾—è¯¦ç»†çš„è¯„ä¼°æŒ‡æ ‡ï¼Œä¾‹å¦‚ F1 åˆ†æ•°ã€æ··æ·†çŸ©é˜µ å’Œ mAPï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/78680846/how-to-see-evaluation-metrics-in-yolov6</guid>
      <pubDate>Fri, 28 Jun 2024 05:55:12 GMT</pubDate>
    </item>
    <item>
      <title>è·å–â€œmodel.fitâ€keras API å‚æ•°çš„å€¼</title>
      <link>https://stackoverflow.com/questions/77581428/get-values-of-model-fit-keras-api-parameters</link>
      <description><![CDATA[æˆ‘æ­£åœ¨å°è¯•ä½¿ç”¨è‡ªå®šä¹‰å›è°ƒå‡½æ•°è·å– Kera é¡ºåºæ¨¡å‹çš„è¯¦ç»†ä¿¡æ¯ã€‚æˆ‘éœ€è¦æå– model.fit() API ä¸­è®¾ç½®çš„å‚æ•°çš„æ‰€æœ‰å€¼ï¼Œä¾‹å¦‚ batch_sizeã€epochsã€validation_split ç­‰ã€‚ä½†æˆ‘æ— æ³•åœ¨ Keras çš„å›è°ƒä¸­è®¿é—®å®ƒä»¬ã€‚æ‚¨çŸ¥é“å¦‚ä½•è‡ªåŠ¨è·å–è¿™äº›å€¼å—ï¼Ÿ
æˆ‘ä½¿ç”¨çš„æ˜¯ Python 3.10 å’Œ Keras 2.8ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/77581428/get-values-of-model-fit-keras-api-parameters</guid>
      <pubDate>Thu, 30 Nov 2023 20:13:45 GMT</pubDate>
    </item>
    <item>
      <title>å¦‚ä½•è®¡ç®—ä¼¯åŠªåˆ©æœ´ç´ è´å¶æ–¯çš„è”åˆå¯¹æ•°ä¼¼ç„¶</title>
      <link>https://stackoverflow.com/questions/52861129/how-to-calculate-the-joint-log-likelihood-for-bernoulli-naive-bayes</link>
      <description><![CDATA[å¯¹äºä½¿ç”¨ BernoulliNB çš„åˆ†ç±»é—®é¢˜ï¼Œå¦‚ä½•è®¡ç®—è”åˆå¯¹æ•°ä¼¼ç„¶ã€‚è”åˆä¼¼ç„¶ç”±ä»¥ä¸‹å…¬å¼è®¡ç®—ï¼Œå…¶ä¸­ y(d) æ˜¯å®é™…è¾“å‡ºï¼ˆä¸æ˜¯é¢„æµ‹å€¼ï¼‰çš„æ•°ç»„ï¼Œx(d) æ˜¯ç‰¹å¾çš„æ•°æ®é›†ã€‚
æˆ‘é˜…è¯»äº†è¿™ä¸ªç­”æ¡ˆå¹¶é˜…è¯»äº†æ–‡æ¡£ï¼Œä½†å®ƒå¹¶æ²¡æœ‰å®Œå…¨æ»¡è¶³æˆ‘çš„ç›®çš„ã€‚æœ‰äººå¯ä»¥å¸®å¿™å—ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/52861129/how-to-calculate-the-joint-log-likelihood-for-bernoulli-naive-bayes</guid>
      <pubDate>Wed, 17 Oct 2018 18:08:50 GMT</pubDate>
    </item>
    <item>
      <title>AttributeErrorï¼šæ¨¡å—'_Box2D'æ²¡æœ‰å±æ€§'RAND_LIMIT_swigconstant'</title>
      <link>https://stackoverflow.com/questions/50037674/attributeerror-module-box2d-has-no-attribute-rand-limit-swigconstant</link>
      <description><![CDATA[æˆ‘æ­£åœ¨å°è¯•åœ¨å¼ºåŒ–å­¦ä¹ ä¸Šè¿è¡Œ lunar_landerï¼Œä½†è¿è¡Œæ—¶å‡ºç°é”™è¯¯ã€‚
å¦å¤–æˆ‘çš„ç”µè„‘æ˜¯osxç³»ç»Ÿã€‚
è¿™æ˜¯æœˆçƒç€é™†å™¨çš„ä»£ç ï¼š
import numpy as np
import gym
import csv

from keras.models import Sequential
from keras.layers import Dense, Activation, Flatten
from keras.optimizers import Adam

from rl.agents.dqn import DQNAgent
from rl.policy import BoltzmannQPolicy, EpsGreedyQPolicy
from rl.memory import SequentialMemory

import io
import sys
import csv

# è·¯å¾„ç¯å¢ƒæ”¹å˜ä»¥ä½¿ä¸€åˆ‡æ­£å¸¸å·¥ä½œ
# export DYLD_FALLBACK_LIBRARY_PATH=$DYLD_FALLBACK_LIBRARY_PATH:/usr/lib

# è·å–ç¯å¢ƒå¹¶æå–æ“ä½œæ•°é‡ã€‚
ENV_NAME = &#39;LunarLander-v2&#39;
env = gym.make(ENV_NAME)
np.random.seed(123)
env.seed(123)
nb_actions = env.action_space.n

# æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å»ºç«‹ä¸€ä¸ªéå¸¸ç®€å•çš„æ¨¡å‹ã€‚
model = Sequential()
model.add(Flatten(input_shape=(1,) + env.observation_space.shape))
model.add(Dense(16))
model.add(Activation(&#39;relu&#39;))
model.add(Dense(16))
model.add(Activation(&#39;relu&#39;))
model.add(Dense(16))
model.add(Activation(&#39;relu&#39;))
model.add(Dense(nb_actions))
model.add(Activation(&#39;linear&#39;))
#print(model.summary())

# æœ€åï¼Œæˆ‘ä»¬é…ç½®å¹¶ç¼–è¯‘æˆ‘ä»¬çš„ä»£ç†ã€‚æ‚¨å¯ä»¥ä½¿ç”¨æ¯ä¸ªå†…ç½®çš„ Keras ä¼˜åŒ–å™¨å’Œ
# ç”šè‡³æŒ‡æ ‡ï¼
memory = SequentialMemory(limit=300000, window_length=1)
policy = EpsGreedyQPolicy()
dqn = DQNAgent(model=model, nb_actions=nb_actions, memory=memory, nb_steps_warmup=10,
target_model_update=1e-2, policy=policy)
dqn.compile(Adam(lr=1e-3), metrics=[&#39;mae&#39;])

# è®­ç»ƒå®Œæˆåï¼Œæˆ‘ä»¬ä¿å­˜æœ€ç»ˆæƒé‡ã€‚
dqn.load_weights(&#39;dqn_{}_weights.h5f&#39;.format(ENV_NAME))

# é‡å®šå‘ stdout ä»¥æ•è·æµ‹è¯•ç»“æœ
old_stdout = sys.stdout
sys.stdout = mystdout = io.StringIO()

# è¯„ä¼°æˆ‘ä»¬çš„ç®—æ³•çš„å‡ ä¸ªæƒ…èŠ‚ã€‚
dqn.test(env, nb_episodes=200, visualize=False)

# é‡ç½® stdout
sys.stdout = old_stdout

results_text = mystdout.getvalue()

# æ‰“å°ç»“æœæ–‡æœ¬
print(&quot;results&quot;)
print(results_text)

# ä»ç»“æœä¸­æå–å¥–åŠ±åˆ—è¡¨
total_rewards = list()
for idx, line in enumerate(results_text.split(&#39;\n&#39;)):
if idx &gt; 0 and len(line) &gt; 1ï¼š
reward = float(line.split(&#39;:&#39;)[2].split(&#39;,&#39;)[0].strip())
total_rewards.append(reward)

# æ‰“å°å¥–åŠ±å’Œå¹³å‡å€¼
print(&quot;total rewards&quot;, total_rewards)
print(&quot;average total reward&quot;, np.mean(total_rewards))

# å°†æ€»å¥–åŠ±å†™å…¥æ–‡ä»¶
f = open(&quot;lunarlander_rl_rewards.csv&quot;,&#39;w&#39;)
wr = csv.writer(f)
for r in total_rewards:
wr.writerow([r,])
f.close()

é”™è¯¯å¦‚ä¸‹ï¼š
å›æº¯ï¼ˆæœ€è¿‘ä¸€æ¬¡è°ƒç”¨æœ€åä¸€æ¬¡ï¼‰ï¼š
æ–‡ä»¶â€œ/s/user/Document/Semester2/Advanced Machine Learning/Lab/Lab6/lunar_lander_ml_states_player.pyâ€ï¼Œç¬¬ 23 è¡Œï¼Œåœ¨ &lt;module&gt; ä¸­
env = gym.make(ENV_NAME)
æ–‡ä»¶â€œ/s/user/anaconda/envs/untitled/lib/python3.6/site-packages/gym/envs/registration.pyâ€ï¼Œç¬¬ 167 è¡Œï¼Œåœ¨ make ä¸­
return registry.make(id)
æ–‡ä»¶â€œ/s/user/anaconda/envs/untitled/lib/python3.6/site-packages/gym/envs/registration.pyâ€ï¼Œç¬¬ 119 è¡Œï¼Œåœ¨ make ä¸­
env = spec.make()
æ–‡ä»¶â€œ/s/user/anaconda/envs/untitled/lib/python3.6/site-packages/gym/envs/registration.pyâ€ï¼Œç¬¬ 85 è¡Œï¼Œåœ¨ make ä¸­
cls = load(self._entry_point)
æ–‡ä»¶â€œ/s/user/anaconda/envs/untitled/lib/python3.6/site-packages/gym/envs/registration.pyâ€ï¼Œç¬¬ 14 è¡Œï¼ŒåŠ è½½ä¸­
result = entry_point.load(False)
æ–‡ä»¶â€œ/s/user/anaconda/envs/untitled/lib/python3.6/site-packages/pkg_resources/__init__.pyâ€ï¼Œç¬¬ 2405 è¡Œï¼ŒåŠ è½½ä¸­
return self.resolve()
æ–‡ä»¶â€œ/s/user/anaconda/envs/untitled/lib/python3.6/site-packages/pkg_resources/__init__.pyâ€ï¼Œç¬¬ 2411 è¡Œï¼Œè§£æä¸­
module = __import__(self.module_name, fromlist=[&#39;__name__&#39;], level=0)
æ–‡ä»¶â€œ/s/user/anaconda/envs/untitled/lib/python3.6/site-packages/gym/envs/box2d/__init__.pyâ€ï¼Œç¬¬ 1 è¡Œï¼Œ&lt;module&gt;
ä» gym.envs.box2d.lunar_lander å¯¼å…¥ LunarLander
æ–‡ä»¶â€œ/s/user/anaconda/envs/untitled/lib/python3.6/site-packages/gym/envs/box2d/lunar_lander.pyâ€ï¼Œç¬¬ 4 è¡Œï¼Œä½äº &lt;module&gt;
å¯¼å…¥ Box2D
æ–‡ä»¶â€œ/s/user/anaconda/envs/untitled/lib/python3.6/site-packages/Box2D/__init__.pyâ€ï¼Œç¬¬ 20 è¡Œï¼Œä½äº &lt;module&gt;
ä» .Box2D å¯¼å…¥ *
æ–‡ä»¶â€œ/s/user/anaconda/envs/untitled/lib/python3.6/site-packages/Box2D/Box2D.pyâ€ï¼Œç¬¬ 435 è¡Œï¼Œä½äº &lt;module&gt;
_Box2D.RAND_LIMIT_swigconstant(_Box2D)
AttributeError: æ¨¡å— &#39;_Box2D&#39; æ²¡æœ‰å±æ€§ &#39;RAND_LIMIT_swigconstant&#39;

æˆ‘å°è¯•æŒ‰ç…§ https://github.com/pybox2d/pybox2d/blob/master/INSTALL.md çš„æŒ‡å—é‡æ–°å®‰è£… Box2d
ä½†ä»ç„¶ä¸èµ·ä½œç”¨ï¼Œæœ‰äººèƒ½å¸®æˆ‘å—ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/50037674/attributeerror-module-box2d-has-no-attribute-rand-limit-swigconstant</guid>
      <pubDate>Thu, 26 Apr 2018 07:55:13 GMT</pubDate>
    </item>
    </channel>
</rss>