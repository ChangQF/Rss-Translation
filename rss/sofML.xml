<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>æ ‡è®°ä¸ºæœºå™¨å­¦ä¹ çš„æ´»è·ƒé—®é¢˜ - å †æ ˆå†…å­˜æº¢å‡º</title>
    <link>https://stackoverflow.com/questions/tagged/?tagnames=machine-learning&sort=active</link>
    <description>æ¥è‡ª stackoverflow.com çš„æœ€æ–° 30 æ¡</description>
    <lastBuildDate>Sun, 11 Aug 2024 18:21:13 GMT</lastBuildDate>
    <item>
      <title>ä¸ Google Colabï¼ˆTesla T4ï¼‰ç›¸æ¯”ï¼Œæˆ‘çš„ GPUï¼ˆRTX 3070ï¼‰çœŸçš„é‚£ä¹ˆæ…¢å—ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/78858972/is-my-gpu-rtx-3070-that-slow-when-compared-to-google-colab-tesla-t4</link>
      <description><![CDATA[å½“ä½¿ç”¨æˆ‘çš„ jupyter ç¬”è®°æœ¬å’Œ google colabï¼ˆä½¿ç”¨å®Œå…¨ç›¸åŒçš„ç¬”è®°æœ¬ï¼‰è®­ç»ƒåŒä¸€æ¨¡å‹æ—¶ï¼Œ
å®ƒä»¬éƒ½è¿è¡Œç›¸åŒçš„ä»£ç ï¼Œå› æ­¤å®ƒä»¬è‚¯å®šéƒ½ä½¿ç”¨â€œcudaâ€ä½œä¸ºè®¾å¤‡ã€‚
æˆ‘çš„æœ¬â€‹â€‹åœ°æœºå™¨æ€»è®­ç»ƒæ—¶é—´ï¼š72.489 ç§’ |
Google Colab æ€»è®­ç»ƒæ—¶é—´ï¼š3.115 ç§’
è¿™æ˜¯ä¸€ä¸ªå·¨å¤§çš„å·®å¼‚ã€‚ä»¥ä¸‹æ˜¯æˆ‘æœºå™¨çš„â€œnvidia-smiâ€è¾“å‡º
åœ¨æ­¤å¤„è¾“å…¥å›¾ç‰‡è¯´æ˜
ä»¥åŠæ¥è‡ª google colabï¼š
åœ¨æ­¤å¤„è¾“å…¥å›¾ç‰‡è¯´æ˜
*æˆ‘å·²é‡æ–°å®‰è£…å¹¶æ›´æ–°äº†å®Œæ•´çš„ pytorch ç”Ÿæ€ç³»ç»Ÿï¼Œæ›´æ–°äº†æˆ‘çš„é©±åŠ¨ç¨‹åºå’Œ CUDA é©±åŠ¨ç¨‹åºã€‚
æˆ‘çš„æœºå™¨ä¸Šçš„ cuda ä¸­ä¸€åˆ‡éƒ½åœ¨è¿è¡Œï¼Œä½†ä¸çŸ¥ä½•æ•…é€Ÿåº¦å¾ˆæ…¢ã€‚åœ¨æˆ‘çš„æœºå™¨ä¸­ï¼ŒCPU å®é™…ä¸Šæ¯” GPU æ›´å¿«ã€‚
BATCH_SIZE = 32
NUM_WORKERS = os.cpu_count()

train_loader = DataLoader(train_data, batch_size=BATCH_SIZE, num_workers=NUM_WORKERS, shuffle=True)
train_loader = DataLoader(test_data, batch_size=BATCH_SIZE, num_workers=NUM_WORKERS)
train_loader, test_loader

è¿™å°±æ˜¯æˆ‘çš„åŠ è½½å™¨çš„è®¾ç½®æ–¹å¼ã€‚
batch, labels = next(iter(train_loader))
print(f&#39;{batch.size() = }&#39;)
print(f&#39;{labels.size() = }&#39;)

åœ¨æˆ‘è¿™è¾¹åŠ è½½ä¸€ä¸ªæ‰¹æ¬¡éœ€è¦ 2-3 ç§’ã€‚è€Œåœ¨ google colab ä¸­é€Ÿåº¦æ›´å¿«ã€‚è¿™å¯èƒ½æ˜¯ç“¶é¢ˆå—ï¼Ÿ
æˆ‘åº”è¯¥åšä»€ä¹ˆå—ï¼Ÿè¿˜æ˜¯æˆ‘çš„ GPU çœŸçš„é‚£ä¹ˆç³Ÿç³•ï¼Ÿ
è°¢è°¢ï¼]]></description>
      <guid>https://stackoverflow.com/questions/78858972/is-my-gpu-rtx-3070-that-slow-when-compared-to-google-colab-tesla-t4</guid>
      <pubDate>Sun, 11 Aug 2024 17:29:05 GMT</pubDate>
    </item>
    <item>
      <title>å¦‚ä½•è°ƒè¯•ä¸å·¥ä½œçš„ Yolov8n æ¨¡å‹ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/78858811/how-do-i-debug-yolov8n-model-not-working</link>
      <description><![CDATA[æˆ‘æ­£åœ¨å°è¯•ä½¿ç”¨é¢„å…ˆè®­ç»ƒçš„ yolov8 æ¨¡å‹è¿›è¡Œå¯¹è±¡æ£€æµ‹å’Œè·Ÿè¸ªã€‚æˆ‘èƒ½å¤ŸæˆåŠŸåŠ è½½å®ƒï¼Œä½†ç”±äºæŸç§åŸå› ï¼Œå½“å®ƒæ£€æµ‹åˆ°å¯¹è±¡æ—¶ï¼Œå®ƒä¼šéšæœºæ£€æµ‹åˆ°è®¸å¤šä¸å›¾åƒæ— å…³çš„ä¸åŒå¯¹è±¡ï¼Œæ‰€æœ‰å¯¹è±¡çš„ç½®ä¿¡åº¦å¾—åˆ†å‡ä¸º 1.0ã€‚
è¿™æ˜¯æˆ‘çš„ä»£ç ï¼š
from ultralytics import YOLO
import cv2

#åŠ è½½ yolov8 æ¨¡å‹
model = YOLO(&quot;yolov8n.pt&quot;)

#åŠ è½½ video()
video_path = &#39;./puppy.mp4&#39;
cap = cv2.VideoCapture(video_path)

ret = True
while ret:
ret,frame = cap.read()
#ä»è§†é¢‘ä¸­è¿”å›ä¸€ä¸ªæ–°å¸§ï¼›å¦‚æœæˆåŠŸè¯»å–å¸§ï¼Œåˆ™ ret ä¸ºçœŸï¼Œå¦åˆ™ä¸ºå‡
å¦‚æœä¸æ˜¯ ret:
break
#æ£€æµ‹å¯¹è±¡
#è·Ÿè¸ªå¯¹è±¡
results = model.track(frame,persist=True) #persist= Trueï¼Œå› æ­¤ YOLO ä¼šè®°ä½å®ƒä¹‹å‰è§è¿‡çš„å¸§

#ç»˜åˆ¶ç»“æœ
frame_ = results[0].plot() #åˆ›å»ºç”¨äºæ£€æµ‹çš„å›¾åƒ
#ä¹Ÿå¯ä»¥ä½¿ç”¨ cv2.rectangle å’Œ cv2.putText
#å¯è§†åŒ–
cv2.imshow(&#39;frame&#39;,frame_)
if cv2.waitKey(25) &amp; 0xFF==ord(&#39;q&#39;):
break

è¾“å‡ºï¼š
0ï¼š384x640 3 è¾†æ±½è½¦ã€33 è¾†æ‘©æ‰˜è½¦ã€21 æ¶é£æœºã€29 åˆ—ç«è½¦ã€52 è‰˜èˆ¹ã€9 ä¸ªæ¶ˆé˜²æ “ã€7 ä¸ªé•¿å‡³ã€1 ä¸ªæ‰‹æç®±ã€37 ä¸ªæ»‘é›ªæ¿ã€6 ä¸ªæ»‘é›ªæ¿ã€1 ä¸ªè¿åŠ¨çƒã€5 æ ¹æ£’çƒæ£’ã€8 ä¸ªç“¶å­ã€1 ä¸ªå‰å­ã€20 æŠŠåˆ€ã€64 æŠŠå‹ºå­ã€1 ä¸ªé©¬æ¡¶ã€1 ä¸ªçƒ¤é¢åŒ…æœºã€1 æŠŠç‰™åˆ·ã€329.4 æ¯«ç§’
é€Ÿåº¦ï¼š4.5 æ¯«ç§’é¢„å¤„ç†ã€329.4 æ¯«ç§’æ¨ç†ã€51.4 æ¯«ç§’åå¤„ç†æ¯ä¸ªå½¢çŠ¶ä¸º (1, 3, 384, 640) çš„å›¾åƒ

0ï¼š384x640 1 è¾†è‡ªè¡Œè½¦ã€16 è¾†æ±½è½¦ã€4 è¾†æ‘©æ‰˜è½¦ã€13 æ¶é£æœºã€4å…¬å…±æ±½è½¦ã€9 åˆ—ç«è½¦ã€9 è‰˜èˆ¹ã€8 ä¸ªäº¤é€šä¿¡å·ç¯ã€1 ä¸ªæ¶ˆé˜²æ “ã€10 ä¸ªåœè½¦æ ‡å¿—ã€2 å¼ é•¿æ¤…ã€3 åªç¾Šã€2 å¤´ç‰›ã€1 æŠŠé›¨ä¼ã€2 ä¸ªé£ç›˜ã€2 æ ¹æ£’çƒæ£’ã€1 å‰¯æ£’çƒæ‰‹å¥—ã€5 æ”¯ç½‘çƒæ‹ã€2 æŠŠåˆ€ã€2 æŠŠå‹ºå­ã€1 æ ¹èƒ¡èåœã€3 ä¸ªçƒ­ç‹—ã€5 ä¸ªæŠ«è¨ã€1 ä¸ªç”œç”œåœˆã€1 å¼ æ²™å‘ã€1 å¼ åºŠã€476.8 æ¯«ç§’
é€Ÿåº¦ï¼š9.3 æ¯«ç§’é¢„å¤„ç†ã€476.8 æ¯«ç§’æ¨ç†ã€0.0 æ¯«ç§’åå¤„ç†æ¯ä¸ªå½¢çŠ¶ä¸º (1, 3, 384, 640) çš„å›¾åƒ

0ï¼š384x640 1 ä¸ªäººã€7 è¾†æ±½è½¦ã€3 è¾†æ‘©æ‰˜è½¦ã€20 æ¶é£æœºã€1 è¾†å…¬å…±æ±½è½¦ã€7 åˆ—ç«è½¦ã€44 è‰˜èˆ¹ã€2 ä¸ªæ¶ˆé˜²æ “ã€5 ä¸ªåœè½¦æ ‡å¿—ã€3 ä¸ªåœè½¦è®¡è´¹è¡¨ã€2 åªé¸Ÿã€3 å¤´ç‰›ã€2å¤§è±¡ã€1 åªç†Šã€4 æŠŠé›¨ä¼ã€1 ä¸ªæ‰‹æåŒ…ã€1 ä¸ªé£ç›˜ã€1 æŠŠåˆ€ã€4 æŠŠå‹ºå­ã€2 ä¸ªè‹¹æœã€1 ä¸ªèƒ¡èåœã€1 ä¸ªçƒ­ç‹—ã€1 ä¸ªæŠ«è¨ã€1 ä¸ªè›‹ç³•ã€1 å¼ é¤æ¡Œã€651.2 æ¯«ç§’
é€Ÿåº¦ï¼š15.5 æ¯«ç§’é¢„å¤„ç†ã€651.2 æ¯«ç§’æ¨ç†ã€15.8 æ¯«ç§’åå¤„ç†æ¯ä¸ªå½¢çŠ¶ä¸º (1ã€3ã€384ã€640) çš„å›¾åƒ

0ï¼š384x640 7 ä¸ªäººã€3 è¾†æ±½è½¦ã€1 è¾†æ‘©æ‰˜è½¦ã€2 åˆ—ç«è½¦ã€13 è‰˜èˆ¹ã€2 ä¸ªäº¤é€šä¿¡å·ç¯ã€2 ä¸ªæ¶ˆé˜²æ “ã€54 ä¸ªåœè½¦æ ‡å¿—ã€2 ä¸ªåœè½¦è®¡è´¹è¡¨ã€2 åªçŒ«ã€4 åªç‹—ã€1 å¤´ç‰›ã€18 åªç†Šã€1 åŒ¹æ–‘é©¬ã€15 åªé•¿é¢ˆé¹¿ã€11 æŠŠé›¨ä¼ã€14 ä¸ªæ‰‹æåŒ…ã€6 æ¡é¢†å¸¦ã€1 ä¸ªé£ç›˜ã€1 ä¸ªæ»‘é›ªæ¿ã€1 ä¸ªè¿åŠ¨çƒã€ 5 ä¸ªæ£’çƒæ‰‹å¥—ã€4 ä¸ªé…’æ¯ã€1 æŠŠå‰å­ã€1 æŠŠåˆ€ã€1 æŠŠå‹ºå­ã€1 ä¸ªè‹¹æœã€1 ä¸ªæ©™å­ã€1 æ ¹èƒ¡èåœã€2 ä¸ªæŠ«è¨ã€1 å¼ é¤æ¡Œã€2 å°ç¬”è®°æœ¬ç”µè„‘ã€1 éƒ¨æ‰‹æœºã€1 ä¸ªæ°´æ§½ã€1 ä¸ªå¹é£æœºã€656.2 æ¯«ç§’
é€Ÿåº¦ï¼š0.0 æ¯«ç§’é¢„å¤„ç†ã€656.2 æ¯«ç§’æ¨ç†ã€66.9 æ¯«ç§’åå¤„ç†æ¯ä¸ªå½¢çŠ¶ä¸º (1, 3, 384, 640) çš„å›¾åƒ

0ï¼š384x640 20 è‰˜èˆ¹ã€8 å¼ é•¿å‡³ã€5 åªçŒ«ã€4 ä¸ªæ‰‹æç®±ã€48 ä¸ªé£ç›˜ã€3 ä¸ªæ»‘æ¿ã€20 ä¸ªç¢—ã€1 å¼ æ²™å‘ã€26 å¼ åºŠã€37 å°ç¬”è®°æœ¬ç”µè„‘ã€1 ä¸ªé¼ æ ‡ã€15 ä¸ªé¥æ§å™¨ã€30 éƒ¨æ‰‹æœºã€27 æœ¬ä¹¦ã€1057.5 æ¯«ç§’
é€Ÿåº¦ï¼š15.7 æ¯«ç§’é¢„å¤„ç†ã€1057.5 æ¯«ç§’æ¨ç†ï¼Œå½¢çŠ¶ä¸º (1, 3, 384, 640) æ—¶æ¯å¹…å›¾åƒçš„åå¤„ç†æ—¶é—´ä¸º 55.0ms

å¦‚æ‚¨æ‰€è§ï¼Œå½“è§†é¢‘ä¸­åªæœ‰ä¸€æ¡ç‹—æ—¶ï¼Œå®ƒæ£€æµ‹åˆ°äº†è®¸å¤šéšæœºç‰©ä½“ã€‚
è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡ä½¿ç”¨ yoloï¼Œæˆ‘æ˜¯è®¡ç®—æœºè§†è§‰é¢†åŸŸçš„æ–°æ‰‹ã€‚
æˆ‘ä¹Ÿå°è¯•ä½¿ç”¨ç»ˆç«¯ä½¿ç”¨ yolov8n è¿›è¡Œé¢„æµ‹ï¼Œä½†å®ƒä»ç„¶æ£€æµ‹åˆ°è®¸å¤šä¸åŒçš„ç‰©ä½“ï¼Œç½®ä¿¡åº¦å‡ä¸º 1.0ã€‚
è¿™æ˜¯æˆ‘åœ¨ CLI ä¸­è¾“å…¥çš„å†…å®¹ï¼š
 yolo predict model=yolov8n.pt source=&#39;https://ultralytics.com/images/bus.jpg&#39;
è¾“å‡ºï¼š
Ultralytics YOLOv8.2.75 ğŸš€ Python-3.12.3 torch-2.4.0+cpu CPUï¼ˆç¬¬ 11 ä»£ Intel Core(TM) i5-1145G7 2.60GHzï¼‰
YOLOv8n æ‘˜è¦ï¼ˆèåˆï¼‰ï¼š168 å±‚ã€3,151,904 ä¸ªå‚æ•°ã€0 ä¸ªæ¢¯åº¦ã€8.7 GFLOP

å°† https://ultralytics.com/images/bus.jpg ä¸‹è½½åˆ°&#39;bus.jpg&#39;...
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 134k/134k [00:00&lt;00:00ï¼Œ8.86MB/s]
å›¾åƒ 1/1 C:\Users\aksha\OneDrive\Documents\Computer_Vision\tutorial_detect\bus.jpgï¼š640x480 79 äººã€3 è¾†è‡ªè¡Œè½¦ã€46 è¾†æ±½è½¦ã€46 è¾†æ‘©æ‰˜è½¦ã€15 æ¶é£æœºã€11 è¾†å…¬å…±æ±½è½¦ã€5 åˆ—ç«è½¦ã€28 è¾†å¡è½¦ã€49 è‰˜èˆ¹ã€4 ä¸ªæ¶ˆé˜²æ “ã€2 ä¸ªåœè½¦è®¡è´¹è¡¨ã€2 ä¸ªè¿åŠ¨çƒã€6 ä¸ªç“¶å­ã€4 æŠŠå‹ºå­ã€324.2ms
é€Ÿåº¦ï¼š15.6ms é¢„å¤„ç†ã€324.2ms æ¨ç†ã€27.8ms åå¤„ç†ï¼Œå½¢çŠ¶ä¸º (1, 3, 640, 480)ï¼Œæ¯å¹…å›¾åƒ
ç»“æœä¿å­˜åˆ° runs\detect\predict
ğŸ’¡ äº†è§£æ›´å¤šä¿¡æ¯https://docs.ultralytics.com/modes/predict

æˆ‘çš„ ultralyticsã€torch å’Œ np ç‰ˆæœ¬å¦‚ä¸‹ï¼š
8.2.75 - ultralytics
2.4.0+cpu - torch
1.26.4 - numpy
æˆ‘ä¸ç¡®å®šé—®é¢˜æ˜¯ä»€ä¹ˆï¼›æˆ‘å°è¯•å¸è½½å¹¶é‡æ–°å®‰è£… ultralytics ä¸¤æ¬¡ï¼Œä½†é—®é¢˜æ²¡æœ‰è§£å†³ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/78858811/how-do-i-debug-yolov8n-model-not-working</guid>
      <pubDate>Sun, 11 Aug 2024 16:25:30 GMT</pubDate>
    </item>
    <item>
      <title>çºªå…ƒ 1/3 ^Cï¼ˆmodel.fit() ä»¥æ­¤è¡Œç»ˆæ­¢ä¸”æ²¡æœ‰ä»»ä½•é”™è¯¯ï¼‰</title>
      <link>https://stackoverflow.com/questions/78858484/epoch-1-3-c-model-fit-was-terminate-with-this-line-and-without-any-error</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/78858484/epoch-1-3-c-model-fit-was-terminate-with-this-line-and-without-any-error</guid>
      <pubDate>Sun, 11 Aug 2024 13:47:36 GMT</pubDate>
    </item>
    <item>
      <title>è·å– ValueErrorï¼šæ‰€æœ‰æ•°ç»„çš„é•¿åº¦å¿…é¡»ç›¸åŒ</title>
      <link>https://stackoverflow.com/questions/78858321/getting-valueerror-all-arrays-must-be-of-the-same-length</link>
      <description><![CDATA[æˆ‘ä¸€ç›´è¯•å›¾å°†å­—å…¸è½¬æ¢ä¸ºæ•°æ®æ¡†ï¼Œä½†æ¯æ¬¡æˆ‘éƒ½æ”¶åˆ° ValueErrorï¼šæ‰€æœ‰æ•°ç»„çš„é•¿åº¦å¿…é¡»ç›¸åŒã€‚æˆ‘å·²ç»æ£€æŸ¥äº†æ¯ä¸ªæ•°ç»„çš„é•¿åº¦å¹¶ç¡®è®¤å®ƒä»¬ç›¸åŒï¼Œä½†æˆ‘ä»ç„¶æ”¶åˆ°ç›¸åŒçš„é”™è¯¯
def metrics_from_pipes(pipes_dict):
for name, pipeline in pipes_dict.items():

pipeline.fit(X_train, y_train)
y_pred_val = pipeline.predict(X_val)
y_pred_train = pipeline.predict(X_train)

train_metrics = {
&#39;model&#39;:list(pipes_dict.keys()),
&#39;MAE&#39;:train_mae,
&#39;MAPE&#39;:train_mape,
&#39;RMSE&#39;:train_rmse,
&#39;RSquared&#39;:train_rsquared
}

train_metrics_data = pd.DataFrame(train_metrics)
val_metrics = {
&#39;model&#39;:list(pipes_dict.keys()),
&#39;MAE&#39;:val_mae,
&#39;MAPE&#39;:val_mape,
&#39;RMSE&#39;:val_rmse,
&#39;RSquared&#39;:val_rsquared 
}

val_metrics_data = pd.DataFrame(val_metrics,)

# åˆå¹¶æ¥è‡ªè®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„æŒ‡æ ‡
train_val_metrics = train_metrics_data.merge(val_metrics_data,
on = &#39;Model&#39;,
how = &#39;left&#39;,
suffixes = (&#39;_train&#39;, &#39;_val&#39;))

# æ’åºåˆ— 
train_val_metrics = train_val_metrics.reindex(columns = [&#39;Model&#39;,
&#39;MAE_train&#39;,
&#39;MAPE_train&#39;,
&#39;RMSE_train&#39;,
&#39;RSquared_train&#39;,
&#39;MAE_val&#39;,
&#39;MAPE_val&#39;,
&#39;RMSE_val&#39;,
&#39;RSquared_val&#39;])

return train_val_metrics.set_index(&#39;Model&#39;).transpose()

# è·å–æŒ‡æ ‡è¡¨
metrics_table = metrics_from_pipes(pipelines)

è¿è¡Œæ­¤ä»£ç ä¼šå‡ºç°æ­¤é”™è¯¯
ValueError Traceback (most recent call last)
Cell In[45]ï¼Œç¬¬ 82 è¡Œ
80 return train_val_metrics.set_index(&#39;Model&#39;).transpose()
81 # è·å–æŒ‡æ ‡è¡¨
---&gt; 82 metrics_table = metrics_from_pipes(pipelines)
83 #print(&#39;è¡¨ 1ï¼šåŸºæœ¬æ¨¡å‹æŒ‡æ ‡&#39;)
84 #metrics_table.style.background_gradient(cmap = Blues)
85 metrics_table

å•å…ƒæ ¼ In[45]ï¼Œç¬¬ 50 è¡Œï¼Œä½äº metrics_from_pipes(pipes_dict)
41 # å°†æ€§èƒ½æŒ‡æ ‡åˆ—è¡¨èšåˆåˆ°å•ç‹¬çš„æ•°æ®æ¡†ä¸­
42 train_metrics = {
43 &#39;model&#39;:list(pipes_dict.keys()),
44 &#39;MAE&#39;:train_mae,
(...)
47 &#39;RSquared&#39;:train_rsquared
48 }
---&gt; 50 train_metrics_data = pd.DataFrame(train_metrics)
51 val_metrics = {
52 &#39;model&#39;:list(pipes_dict.keys()),
53 &#39;MAE&#39;:val_mae,
(...)
56 &#39;RSquared&#39;:val_rsquared 
57 }
59 val_metrics_data = pd.DataFrame(val_metrics,)

ValueError: æ‰€æœ‰æ•°ç»„çš„é•¿åº¦å¿…é¡»ç›¸åŒ

å½“æˆ‘æ£€æŸ¥ train_metrics å’Œ val æŒ‡æ ‡çš„å­—å…¸ç»“æœæ—¶ï¼Œæˆ‘å¾—åˆ°äº†è¿™ä¸ª
({&#39;model&#39;: [&#39;Linear Regression&#39;,
&#39;Random Forest Regressor&#39;,
&#39;Gradient Boost Regression&#39;,
&#39;Extra Tree Regressor&#39;],
&#39;MAE&#39;: [829.1023412412194,
288.33455697065233,
712.9637267872279,
0.0010629575741748962],
&#39;MAPE&#39;: [1.0302372135902111,
0.20937541440883897,
0.538244903316323,
6.306697580961048e-07],
&#39;RMSE&#39;: [1120.5542708017374,
416.48933196590013,
1012.399201767692,
0.05804079289490426],
&#39;RSquared&#39;: [0.5598288286601083,
0.9391916010838417,
0.6406981997919169,
0.9999999988190745]},
{&#39;model&#39;: [&#39;çº¿æ€§å›å½’&#39;,
&#39;éšæœºæ£®æ—å›å½’å™¨&#39;,
&#39;æ¢¯åº¦æå‡å›å½’&#39;,
&#39;é¢å¤–æ ‘å›å½’å™¨&#39;],
&#39;MAE&#39;: [855.9254413559535,
802.5902302175274,
772.3140648475379,
839.9018341377154],
&#39;MAPE&#39;: [1.0395487579496652,
0.5607987708065988,
0.5438627253681279,
0.5852285872937784],
&#39;RMSE&#39;: [1148.6549900167981,
1158.8411708570625,
1109.6145558003204,
1223.23337689915],
&#39;RSquared&#39;: [0.5876710102285392,
0.5803255834810521,
0.6152231339508221,
0.5323905190373128]})
]]></description>
      <guid>https://stackoverflow.com/questions/78858321/getting-valueerror-all-arrays-must-be-of-the-same-length</guid>
      <pubDate>Sun, 11 Aug 2024 12:27:40 GMT</pubDate>
    </item>
    <item>
      <title>æ‰¹é‡æ•°æ®çš„ SGD ä¼˜åŒ–å™¨è®¾ç½®</title>
      <link>https://stackoverflow.com/questions/78858189/sgd-optimizer-setting-for-batched-data</link>
      <description><![CDATA[æˆ‘æ­£åœ¨å­¦ä¹  Joh Krohn çš„æ•°å­¦å…¥é—¨è¯¾ç¨‹ã€‚è¯¾ç¨‹è§£é‡Šå¾—å¾ˆæ¸…æ¥šï¼Œä½†æœ‰ä¸€ä»¶äº‹è®©æˆ‘å¾ˆå›°æƒ‘ã€‚åœ¨è¿™ä¸ªä»»åŠ¡ä¸­ https://github.com/jonkrohn/ML-foundations/blob/master/notebooks/regression-in-pytorch.ipynbï¼Œæˆ‘ä»¬ä½¿ç”¨äº† torch.optim.SGD torch SGDï¼Œå®ƒè¿è¡Œäº†æ‰€æœ‰ç¤ºä¾‹æ•°æ®ã€‚
optimizer = torch.optim.SGD([m,b], lr = 0.01)
epochs = 999
for epoch in range(epochs): 

optimizer.zero_grad() # å°†æ¢¯åº¦é‡ç½®ä¸ºé›¶ï¼›å¦åˆ™å®ƒä»¬ä¼šç´¯ç§¯

yhats = å›å½’ï¼ˆxsï¼Œmï¼Œbï¼‰# æ­¥éª¤ 1
C = mseï¼ˆyhatsï¼Œysï¼‰# æ­¥éª¤ 2

C.backward() # æ­¥éª¤ 3

optimizer.step() # æ­¥éª¤ 4

åœ¨ç¬¬äºŒä¸ªç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬è¿›è¡Œäº†å­¦ä¹ ç‡è°ƒåº¦ https://github.com/jonkrohn/ML-foundations/blob/master/notebooks/learning-rate-scheduling.ipynb
æœ‰ 8.000.000 ä¸ªæ•°æ®ç‚¹ï¼Œå› æ­¤æ•°æ®è¢«è®¾ç½®ä¸ºæ‰¹å¤„ç†ï¼Œå¹¶ä¸”ä»£ç åœ¨è¿™äº›æ ·æœ¬ä¸Šè½®æµè¿è¡Œï¼Œè€Œä¸æ˜¯åœ¨æ‰€æœ‰æ•°æ®ä¸ŠæŒ‰æ—¶æœŸè¿è¡Œã€‚ç„¶è€Œï¼Œè¿™ä¸æ˜¯ç”¨ torch.optim.SGD å®Œæˆçš„ï¼Œè€Œæ˜¯åœ¨ä»£ç ä¸Šæ˜¾ç¤ºä»¥æŸ¥çœ‹æ•°å­¦æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚æˆ‘æ­£åœ¨åŠªåŠ›ç”¨ torch.optim.SGD è¿è¡Œå®ƒã€‚å¦‚ä½•ç¼–å†™ä»£ç æ¥è¿è¡Œå®ƒï¼Œè€Œä¸æ˜¯åƒä¸‹é¢è¿™æ ·ç¼–å†™å¤§å‹æ•°å­¦æ–¹ç¨‹å¼ï¼Œå…¶ä¸­å·²ç»åˆ›å»ºäº†æ‰€æœ‰æ–¹ç¨‹å¼ï¼Œä¾‹å¦‚æ¢¯åº¦ã€thetaï¼š
n = 8000000
x = torch.linspace(0., 8., n)
y = -0.5*x + 2 + torch.normal(mean=torch.zeros(n), std=1)
indices = np.random.choice(n, size=2000, replace=False)
gradient = torch.tensor([[b.grad.item(), m.grad.item()]]).T
theta = torch.tensor([[b, m]]).T 
lr = 0.01
new_theta = theta - lr*gradient
C = mse(regression(x[batch_indices], m, b), y[batch_indices])
b.requires_grad_()
m.requires_grad_()

def return(my_x, my_m, my_b):
return my_m*my_x + my_b

m = torch.tensor([0.9]).requires_grad_()
b = torch.tensor([0.1]).requires_grad_()

batch_size = 32 # æ¨¡å‹è¶…å‚æ•°
batch_indices = np.random.choice(n, size=batch_size, replace=False)
yhat = return(x[batch_indices], m, b)

yhat = return(x[batch_indices], m, b)

def mse(my_yhat, my_y): 
sigma = torch.sum((my_yhat - my_y)**2)
return sigma/len(my_y)

C = mse(yhat, y[batch_indices])

C.backward()
m.grad
b.grad

gradient = torch.tensor([[b.grad.item(), m.grad.item()]]).T

theta = torch.tensor([[b, m]]).T 

lr = 0.01
new_theta = theta - lr*gradient
new_theta

b = new_theta[0]
m = new_theta[1]

C = mse(regression(x[batch_indices], m, b), y[batch_indices])

rounds = 100 

for r in range(rounds): 

# è¿™ä¸ªé‡‡æ ·æ­¥éª¤å¾ˆæ…¢ï¼›ç¨åæˆ‘ä»¬å°†ä»‹ç»æ›´å¿«çš„æ‰¹é‡é‡‡æ ·ï¼š 
batch_indices = np.random.choice(n, size=batch_size, replace=False)

yhat = return(x[batch_indices], m, b) # æ­¥éª¤ 1
C = mse(yhat, y[batch_indices]) # æ­¥éª¤ 2

C.backward() # æ­¥éª¤ 3

gradient = torch.tensor([[b.grad.item(), m.grad.item()]]).T
theta = torch.tensor([[b, m]]).T 

new_theta = theta - lr*gradient # æ­¥éª¤ 4

b = new_theta[0].requires_grad_()
m = new_theta[1].requires_grad_()
]]></description>
      <guid>https://stackoverflow.com/questions/78858189/sgd-optimizer-setting-for-batched-data</guid>
      <pubDate>Sun, 11 Aug 2024 11:20:48 GMT</pubDate>
    </item>
    <item>
      <title>è§£å†³è‡ªåŠ¨æ ‡è®°ï¼ˆä¼˜åŒ–ï¼‰+åˆ†ç±»é—®é¢˜</title>
      <link>https://stackoverflow.com/questions/78858155/tackling-an-automatic-labeling-optimization-classification-problem</link>
      <description><![CDATA[æˆ‘çŸ¥é“è¿™ä¸å¤ªä¾§é‡äºç¼–ç¨‹ï¼Œä½†æˆ‘ä¸çŸ¥é“è¿˜æœ‰ä»€ä¹ˆåœ°æ–¹å¯ä»¥é—®è¿™ä¸ªé—®é¢˜ã€‚è¿™æ›´å¤šçš„æ˜¯å…³äºæ–¹æ³•è€Œä¸æ˜¯æŠ€æœ¯é—®é¢˜ã€‚
ä¸Šä¸‹æ–‡
æˆ‘æœ‰ä¸€ä¸ªä¼˜åŒ– + åˆ†ç±»ä»»åŠ¡ã€‚å› æ­¤ï¼Œæœ¬è´¨ä¸Šï¼Œæˆ‘çš„æ•°æ®å…·æœ‰ä»¥ä¸‹åˆ—ï¼š
[&#39;Model ID&#39;, &#39;Q&#39;, &#39;refinement&#39;, &#39;avg_time&#39;, &#39;lattice&#39;, &#39;radius&#39;]ï¼ˆè¿˜æœ‰æ›´å¤šï¼Œä½†ä¸ºäº†ç®€æ´èµ·è§ï¼Œæˆ‘ä»¬åªä¿ç•™è¿™äº›ï¼‰

Model IDï¼šä»£è¡¨â€œè®¾è®¡â€ï¼Œæ¯ä¸ª Model ID å°†æœ‰å¤šè¡Œ

Qï¼šè¿™æ˜¯ç›®æ ‡å˜é‡

refinementï¼šè¿™æ˜¯ä¸€ä¸ªè®¾ç½®å˜é‡ï¼›å®ƒå¯ä»¥å– 1-8 çš„å€¼ï¼Œè¿™ç›´æ¥å½±å“ Qï¼Œï¼ˆæ¨¡å‹ IDï¼Œç»†åŒ–ï¼‰å¯¹æ˜¯å”¯ä¸€çš„ã€‚å› æ­¤ï¼Œæ¨¡å‹ ID å°†å…·æœ‰å¤šè¡Œï¼Œç»†åŒ–ç¨‹åº¦å„ä¸ç›¸åŒ

avg_timeï¼šè¿™æ˜¯æ¨¡æ‹Ÿå®Œæˆæ‰€éœ€çš„æ—¶é—´ï¼Œä»…å—ç»†åŒ–çš„å½±å“ï¼Œç»†åŒ–ç¨‹åº¦è¶Šé«˜ï¼Œæ‰€éœ€çš„æ—¶é—´è¶Šé•¿ã€‚æ­¤å€¼ä¸è®¾è®¡æ— å…³ï¼Œå®ƒä»…å–å†³äºç»†åŒ–ï¼Œå› æ­¤ç‰¹å®šç»†åŒ–çš„æ‰€æœ‰è®¾è®¡éƒ½å…·æœ‰ç›¸åŒçš„æ—¶é—´ã€‚

lattice å’Œ radiusï¼šè¿™äº›ä»£è¡¨â€œè®¾è®¡â€ï¼Œæœ¬è´¨ä¸Šæ›´æ”¹å®ƒä»¬å°†æ›´æ”¹ Q


æ•°æ®é›†
æˆ‘çš„æ•°æ®é›†æ¥è‡ªéšæœºè®¾è®¡çš„æ¨¡æ‹Ÿã€‚å¯¹äºæ¯ä¸ªè®¾è®¡ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰ä»¥ä¸‹è¡Œä¸ºï¼š

æŒç»­å¢åŠ ï¼ˆæ¯æ¬¡ç»†åŒ–æ—¶çš„ Q å€¼é«˜äºä¸Šä¸€ä¸ªç»†åŒ–çº§åˆ«ï¼‰
æŒç»­å‡å°‘ï¼ˆæ¯æ¬¡ç»†åŒ–æ—¶çš„ Q å€¼ä½äºä¸Šä¸€ä¸ªç»†åŒ–çº§åˆ«ï¼‰
ä¹‹å­—å½¢ï¼Œå…¶ä¸­ Q å€¼éµå¾ªæ­¤å½“å‰æ¨¡å¼ï¼ˆé«˜ï¼Œä½ï¼Œé«˜ï¼Œä½ï¼‰æˆ–ï¼ˆä½ï¼Œé«˜ï¼Œä½ï¼Œé«˜ï¼‰
ç¢—å½¢ï¼Œå…¶ä¸­ Q å€¼éµå¾ªæ­¤å½“å‰æ¨¡å¼ï¼šï¼ˆé«˜ï¼Œä½ï¼Œä½ï¼Œé«˜ï¼‰
æ¢¯å½¢ï¼Œå…¶ä¸­ Q å€¼éµå¾ªæ­¤å½“å‰æ¨¡å¼ï¼šï¼ˆä½ï¼Œé«˜ï¼Œé«˜ï¼Œä½ï¼‰
æˆ‘æœ‰ä»£ç å¯ä»¥æ£€æµ‹è¿™äº›å½¢çŠ¶å¹¶è¿”å›å¸ƒå°”å€¼ï¼š

def is_zigzag(q_values)

def is_bowl(q_values)

def is_trapezoid(q_values)

æ•°æ®é›†ä¸­ç»†åŒ–çš„å€¼èŒƒå›´æ˜¯ 2-5ï¼Œä½†ç»†åŒ–å¯ä»¥å– 1-8 çš„å€¼ã€‚
ä»»åŠ¡
å› æ­¤ï¼Œæˆ‘è¯•å›¾å®ç°çš„æ˜¯è‡ªåŠ¨æ ‡è®°æ¯ä¸ªæ¨¡å‹ IDï¼ˆé€šè¿‡å¯¹è¡Œè¿›è¡Œåˆ†ç»„ï¼‰å’Œæœ€ä½³ç»†åŒ–å€¼ï¼ˆèŒƒå›´ä¸º 1-8ï¼‰ï¼Œä»¥æœ€å¤§åŒ– Q çš„å˜åŒ–ï¼ˆå¢é‡è¶Šå¤§è¶Šå¥½ï¼‰å¹¶æœ€å°åŒ–æ‰€èŠ±è´¹çš„æ—¶é—´ï¼ˆè¶Šä½è¶Šå¥½ï¼‰ã€‚é—®é¢˜æ˜¯ç”±äºæ•°æ®æ˜¯åœ¨ç»†åŒ–çº§åˆ« 5 å¤„åˆ‡å‰²çš„ï¼Œæ‰€ä»¥æˆ‘æƒ³åˆ°ä½¿ç”¨æ¦‚ç‡æ–¹æ³•ï¼ˆä¾‹å¦‚ MLEï¼‰æ¥åˆ›å»ºæœªæ¥ç»†åŒ–çš„é¢„æœŸå˜åŒ–å’Œé¢„æœŸæ‰€èŠ±è´¹çš„æ—¶é—´ã€‚ä½†æˆ‘ä¼¼ä¹æ— æ³•â€œè°ƒæ•´â€å®ƒï¼Œæ‰€ä»¥å®ƒå¾ˆæœ‰ç”¨ã€‚è·å¾—é¢„æœŸå€¼åï¼Œæˆ‘éœ€è¦ä¸€ä¸ªæˆæœ¬å‡½æ•°æ¥è®¡ç®—ï¼ˆä¼˜åŒ–ï¼‰Q çš„å›æŠ¥ä¸å®Œæˆè¯¥ç»†åŒ–çº§åˆ«æ‰€èŠ±è´¹çš„å¢åŠ æ—¶é—´çš„æ¯”è¾ƒã€‚
åœ¨ä¸‹ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘å°†å¼€å‘ä¸€ä¸ªåˆ†ç±»å™¨ï¼Œå®ƒå°†é‡‡ç”¨è®¾è®¡å’Œæœ€ä½³ç»†åŒ–ã€‚ä»ç†è®ºä¸Šè®²ï¼Œå®ƒåº”è¯¥å¯ä»¥é¢„æµ‹æœªè§è¿‡çš„è®¾è®¡çš„æœ€ä½³ç»†åŒ–çº§åˆ«
æˆ‘å¾ˆæ„Ÿæ¿€ä»»ä½•æœ‰å…³è§£å†³è¿™ä¸ªé—®é¢˜çš„æŒ‡å¯¼/å¸®åŠ©ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/78858155/tackling-an-automatic-labeling-optimization-classification-problem</guid>
      <pubDate>Sun, 11 Aug 2024 11:01:40 GMT</pubDate>
    </item>
    <item>
      <title>å¤„ç†ç¼ºå¤±æ•°æ®å¹¶å»ºç«‹å…·æœ‰ä¸å®Œæ•´ä¿¡æ¯çš„é¢„æµ‹æ¨¡å‹ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/78858124/handling-missing-data-and-building-a-predictive-model-with-incomplete-informatio</link>
      <description><![CDATA[æˆ‘æ­£åœ¨ä¸ºæ¶‰åŠ 20 ä¸ªå½±å“ç‚¹çš„ä¾›æ°´ç½‘ç»œå¼€å‘ä¸€ä¸ªé¢„æµ‹æ¨¡å‹ã€‚ä½†æ˜¯ï¼Œæˆ‘åªæœ‰è¿™ 20 ä¸ªç‚¹ä¸­çš„ 10 ä¸ªçš„å†å²æ•°æ®ã€‚
æˆ‘æƒ³çŸ¥é“å¦‚ä½•åœ¨è¿™ä¸ªä¸å®Œæ•´çš„æ•°æ®é›†ä¸‹æ„å»ºé¢„æµ‹æ¨¡å‹ã€‚å…·ä½“æ¥è¯´ï¼š
æˆ‘å¯ä»¥ä½¿ç”¨å“ªäº›æ–¹æ³•æ¥å¤„ç†å‰©ä½™ 10 ä¸ªç‚¹çš„ç¼ºå¤±æ•°æ®ï¼Ÿåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ˜¯å¦æœ‰ä»»ä½•æ ‡å‡†æŠ€æœ¯æˆ–æœ€ä½³å®è·µæ¥å¤„ç†ç¼ºå¤±æ•°æ®ï¼Ÿ
æˆ‘å¦‚ä½•æœ‰æ•ˆåœ°å°†æˆ‘æ‹¥æœ‰çš„ 10 ä¸ªç‚¹çš„æ•°æ®åˆå¹¶åˆ°æ¨¡å‹ä¸­ï¼Ÿæˆ‘å¯ä»¥é‡‡ç”¨å“ªäº›ç­–ç•¥æ¥ç¡®ä¿æœ‰æ•ˆåˆ©ç”¨å¯ç”¨æ•°æ®è¿›è¡Œå‡†ç¡®é¢„æµ‹ï¼Ÿ
æ˜¯å¦æœ‰ç‰¹å®šçš„æŠ€æœ¯æˆ–æ¨¡å‹å¯ä»¥å¸®åŠ©åœ¨æ•°æ®ä¸å®Œæ•´çš„æƒ…å†µä¸‹è¿›è¡Œé¢„æµ‹ï¼Ÿæˆ‘å¯¹å¯ä»¥æœ‰æ•ˆç®¡ç†å’Œåˆ©ç”¨ä¸å®Œæ•´æ•°æ®çš„æ–¹æ³•æ„Ÿå…´è¶£ã€‚
&quot;æˆ‘è¿˜æ²¡æœ‰å…·ä½“çš„æ–¹æ³•ã€‚&quot;]]></description>
      <guid>https://stackoverflow.com/questions/78858124/handling-missing-data-and-building-a-predictive-model-with-incomplete-informatio</guid>
      <pubDate>Sun, 11 Aug 2024 10:43:28 GMT</pubDate>
    </item>
    <item>
      <title>ä½¿ç”¨ hub.KerasLayer ä½¿ç”¨ tf.keras.sequential åˆ¶ä½œæ·±åº¦å­¦ä¹ æ¨¡å‹æ—¶å‡ºé”™</title>
      <link>https://stackoverflow.com/questions/78857786/error-when-using-hub-keraslayer-using-tf-keras-sequential-to-make-deep-learning</link>
      <description><![CDATA[æˆ‘æ˜¯åˆšå¼€å§‹ä½¿ç”¨ keras çš„ï¼Œè¿™é‡Œæˆ‘é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼š
åˆ›å»ºä¸€ä¸ªæ„å»º Keras æ¨¡å‹çš„å‡½æ•°
def create_model(input_shape=INPUT_SHAPE, output_shape=OUTPUT_SHAPE, model_url=MODEL_URL):
print(&quot;Building model with:&quot;, MODEL_URL)

model = tf.keras.Sequential([
hub.KerasLayer(MODEL_URL), # ç¬¬ 1 å±‚ï¼ˆè¾“å…¥å±‚ï¼‰
tf.keras.layers.Dense(units=OUTPUT_SHAPE, 
activation=&quot;softmax&quot;) # ç¬¬ 2 å±‚ï¼ˆè¾“å‡ºå±‚ï¼‰
])

# ç¼–è¯‘æ¨¡å‹
model.compile(
loss=tf.keras.losses.CategoricalCrossentropy(), # æˆ‘ä»¬çš„æ¨¡å‹æƒ³è¦å‡å°‘è¿™ä¸ªï¼ˆå®ƒçš„çŒœæµ‹æœ‰å¤šé”™è¯¯ï¼‰
optimizer=tf.keras.optimizers.Adam()ï¼Œ# ä¸€ä¸ªæœ‹å‹å‘Šè¯‰æˆ‘ä»¬çš„æ¨¡å‹å¦‚ä½•æ”¹è¿›å®ƒçš„çŒœæµ‹
metrics=[&quot;accuracy&quot;] # æˆ‘ä»¬å¸Œæœ›è¿™ä¸ªæ•°å­—ä¸Šå‡
)

# æ„å»ºæ¨¡å‹
model.build(INPUT_SHAPE) # è®©æ¨¡å‹çŸ¥é“å®ƒå°†è·å¾—ä»€ä¹ˆæ ·çš„è¾“å…¥

è¿”å›æ¨¡å‹

æˆ‘æœ‰ä¸Šé¢çš„å‡½æ•°ï¼Œå½“æˆ‘è¿è¡Œä¸‹é¢çš„å…¶ä»–ç¨‹åºæ—¶
model = create_model()
model.summary()

å®ƒä¼šäº§ç”Ÿä¸€äº›é”™è¯¯
TypeErrorï¼šæ·»åŠ çš„å±‚å¿…é¡»æ˜¯ Layer ç±»çš„å®ä¾‹ã€‚æ”¶åˆ°ï¼šlayer= ç±»å‹ä¸º &lt;class &#39;keras.src.layers.core.dense.Dense&#39;&gt;ã€‚
æ‰€ä»¥æˆ‘é”™äº†ä»€ä¹ˆï¼Œæˆ‘ä¸€ç›´åœ¨æœç´¢è¿™ä¸ªï¼Œä½†é—®é¢˜å’Œæˆ‘å¾—åˆ°çš„ä¸ä¸€æ ·]]></description>
      <guid>https://stackoverflow.com/questions/78857786/error-when-using-hub-keraslayer-using-tf-keras-sequential-to-make-deep-learning</guid>
      <pubDate>Sun, 11 Aug 2024 08:05:45 GMT</pubDate>
    </item>
    <item>
      <title>å¦‚ä½•è®¡ç®— CV-k æŠ˜å é¢„æµ‹â€œæ˜¯â€â€œå¦â€çš„å‡æ–¹è¯¯å·®ï¼Ÿ[å…³é—­]</title>
      <link>https://stackoverflow.com/questions/78857561/how-to-calculate-mean-square-error-for-predictions-yes-no-with-a-cv-k-fold</link>
      <description><![CDATA[ä¸ºäº†æ ¹æ®æ»¡æ„åº¦æŒ‡æ•°å’Œå‚ä¸åº¦æŒ‡æ•°é¢„æµ‹å®¢æˆ·æ˜¯å¦ä¼šè´­ä¹°äº§å“ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† k è¿‘é‚»æ³•ã€‚
å¦‚ä½•ç”¨ 4 å€äº¤å‰éªŒè¯è¿‡ç¨‹è¯„ä¼°é¢„æµ‹å‡æ–¹è¯¯å·®ï¼Ÿå®ƒä¸éœ€è¦åœ¨ R ä¸­ã€‚æˆ‘åªéœ€è¦å¦‚ä½•è®¡ç®—å®ƒçš„ç†è®ºã€‚
æˆ‘çŸ¥é“å¦‚ä½•ç”¨æ•°å­—è®¡ç®—ï¼Œä½†ä¸çŸ¥é“å¦‚ä½•ç”¨å­—ç¬¦ä¸²è®¡ç®—]]></description>
      <guid>https://stackoverflow.com/questions/78857561/how-to-calculate-mean-square-error-for-predictions-yes-no-with-a-cv-k-fold</guid>
      <pubDate>Sun, 11 Aug 2024 05:16:27 GMT</pubDate>
    </item>
    <item>
      <title>å¦‚ä½•æé«˜ SGDRegressor æ¨¡å‹æ€§èƒ½</title>
      <link>https://stackoverflow.com/questions/78857401/how-to-improve-sgdregressor-model-performance</link>
      <description><![CDATA[æˆ‘æ­£åœ¨åšä¸€ä¸ªä¸ªäººé¡¹ç›®ï¼Œæ¯”è¾ƒ OLS æ¨¡å‹å’Œ SGDRessor æ¨¡å‹ä¹‹é—´çš„æ¨¡å‹æ€§èƒ½ã€‚OLS æ¨¡å‹å¹¶ä¸å®Œç¾ï¼Œä½†è¿è¡Œè‰¯å¥½ã€‚SGDR æ¨¡å‹é¢„æµ‹åå·®å¾ˆå¤§ã€‚æˆ‘æ£€æŸ¥äº†è¿­ä»£è¿‡ç¨‹ä¸­çš„æˆæœ¬é™ä½æƒ…å†µã€‚ç»“æœè¡¨æ˜å­¦ä¹ ç‡å¤ªé«˜ã€‚ç„¶è€Œï¼Œé™ä½å­¦ä¹ ç‡ä¼¼ä¹ä¼šä½¿æˆæœ¬é™ä½å˜å¾—æ›´ç³Ÿã€‚
æˆ‘æ˜¯æœºå™¨å­¦ä¹ çš„æ–°æ‰‹ï¼Œæˆ‘ä¸çŸ¥é“å¦‚ä½•æ”¹è¿› SGDR æ¨¡å‹ã€‚ä»»ä½•å»ºè®®éƒ½å°†ä¸èƒœæ„Ÿæ¿€ã€‚
è¿™æ˜¯æˆ‘çš„ä»£ç ï¼šGoogle Colab é“¾æ¥ã€‚æ‚¨å¯ä»¥é‡ç‚¹å…³æ³¨â€œæ¢¯åº¦ä¸‹é™æ–¹æ³•â€éƒ¨åˆ†å’Œâ€œæ’é™¤ SGDR æ•…éšœâ€ã€‚
æå‰æ„Ÿè°¢æ‚¨çš„æ—¶é—´å’Œå¸®åŠ©ï¼]]></description>
      <guid>https://stackoverflow.com/questions/78857401/how-to-improve-sgdregressor-model-performance</guid>
      <pubDate>Sun, 11 Aug 2024 02:34:35 GMT</pubDate>
    </item>
    <item>
      <title>TensorBoard ä¸­çš„ add_hparams() å‡½æ•°æ— æ³•æ­£å¸¸å·¥ä½œ</title>
      <link>https://stackoverflow.com/questions/78857269/add-hparams-function-from-tensorboard-doesnt-work-properly</link>
      <description><![CDATA[æˆ‘è¯•å›¾å‘æ­¤ SummaryWriter æ·»åŠ æŒ‡æ ‡ï¼Œä½†ä¸èµ·ä½œç”¨ã€‚
æˆ‘æ­£åœ¨ä½¿ç”¨ SummaryWriter çš„ add_hparams() å‡½æ•°ï¼Œå…¶è¯¦ç»†ä¿¡æ¯å¯åœ¨æ­¤å¤„æ‰¾åˆ°ï¼šhttps://pytorch.org/docs/stable/tensorboard.htmlã€‚
æˆ‘è¿™æ ·åšï¼š
 writer = SummaryWriter(f&#39;runs/lstm_experiment_final&#39;)

for e in tqdm(range(num_epochs)):
tr_loss, tr_f1, tr_precision, tr_recall = training_loop(model, train_dataloader, loss_function, optimizer, e, writer)
val_loss, val_f1, val_precision, val_recall = validation_loop(model, test_dataloader, loss_function, e, writer)

metric_dict = {&#39;Loss/train&#39;: tr_loss, &#39;Loss/valid&#39;: val_loss,
&#39;F1/train&#39;: tr_f1, &#39;F1/valid&#39;: val_f1,
&#39;Precision/train&#39;: tr_precision, &#39;Precision/valid&#39;: val_precision,
&#39;Recall/train&#39;: tr_recall, &#39;Recall/valid&#39;: val_recall}
writer.add_hparams(best_params, metric_dict, global_step=num_epochs-1)
writer.close()

è¿™å°±æ˜¯æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ã€‚
åœ¨æ­¤å¤„è¾“å…¥å›¾ç‰‡æè¿°
æ¢å¥è¯è¯´ï¼Œè¶…å‚æ•°ç¡®å®è®°å½•åœ¨ TensorBoard ä¸Šï¼Œä½†åº¦é‡å€¼å´æ²¡æœ‰è®°å½•ã€‚
æˆ‘å¸Œæœ›æœ‰äººå·²ç»çœ‹åˆ°æˆ‘çš„é—®é¢˜å¹¶çŸ¥é“å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚
æå‰è°¢è°¢ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/78857269/add-hparams-function-from-tensorboard-doesnt-work-properly</guid>
      <pubDate>Sun, 11 Aug 2024 00:21:56 GMT</pubDate>
    </item>
    <item>
      <title>å¯ç”¨ GPU 2024-OSErrorï¼š[WinError 127] æ‰¾ä¸åˆ°æŒ‡å®šçš„è¿‡ç¨‹</title>
      <link>https://stackoverflow.com/questions/78856582/enable-gpu-2024-oserror-winerror-127-the-specified-procedure-could-not-be-fo</link>
      <description><![CDATA[æˆ‘æ­£åœ¨å°è¯•å¯ç”¨ GPU è¿›è¡Œæœºå™¨å­¦ä¹ ï¼Œä½†é‡åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼š

OSErrorï¼š[WinError 127] æ‰¾ä¸åˆ°æŒ‡å®šçš„ç¨‹åºã€‚é”™è¯¯
åŠ è½½
â€œC:\Users\name\anaconda3\Lib\site-packages\torch\lib\c10_cuda.dllâ€
æˆ–å…¶ä¾èµ–é¡¹ä¹‹ä¸€ã€‚

ç›®å‰ï¼Œæˆ‘æ­£åœ¨ä½¿ç”¨é…å¤‡ NVIDIA 3050 GPU çš„ Windows ç¬”è®°æœ¬ç”µè„‘ï¼Œä»¥ Python ä½œä¸ºæˆ‘çš„ä¸»è¦å¼€å‘è¯­è¨€ã€‚

æ³¨æ„åˆ°è¯¥æ–‡ä»¶å­˜åœ¨ï¼Œå› ä¸º torch åº“æ˜¯ä½¿ç”¨ pip ç›´æ¥ä¸‹è½½çš„ã€‚å› æ­¤ï¼Œä»æŠ€æœ¯ä¸Šè®²ï¼Œæ­¤é”™è¯¯ä¸åº”è¯¥å‘ç”Ÿã€‚

æœ€åˆï¼Œæˆ‘æ”¶åˆ°äº†ç±»ä¼¼çš„é”™è¯¯â€œ[WinError 126] æ‰¾ä¸åˆ°æŒ‡å®šçš„è¿‡ç¨‹ã€‚â€ä½†æˆ‘å·²ç»æ›´æ–°å¹¶å®‰è£…äº† VisualStudio 2022 çš„ C/C++ ç¼–è¯‘å™¨ï¼Œå®ƒè§£å†³äº† [WinError 126}ï¼Œä½†æˆ‘å¾—åˆ°çš„å´æ˜¯ [WinError 127]ã€‚
è¦å®‰è£…å’Œå¯ç”¨ GPUï¼Œæˆ‘å°†æŒ‰ç…§æ­¤æ•™ç¨‹æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ã€‚

å®‰è£… VisualStudio -&gt; å…¨éƒ¨ä¸‹è½½

å®‰è£… Pytorch (pip) -&gt; CUDA 12.4

å®‰è£… CUDA å·¥å…·åŒ… (12.6)

ä¸‹è½½ cuDNNâ€œä¸‹è½½ cuDNN v8.9.7 (2023 å¹´ 12 æœˆ 5 æ—¥)ï¼Œé€‚ç”¨äº CUDA 12.xâ€

å°† cuDNN çš„å†…å®¹æŒ‰ç…§å„è‡ªçš„æ–‡ä»¶å¤¹åç§°ç²˜è´´åˆ°â€œNVIDIA GPU è®¡ç®—å·¥å…·åŒ…â€ä¸­ã€‚


å·²éªŒè¯å·²å®‰è£…çš„ CUDA å·²æ·»åŠ åˆ°ç¯å¢ƒä¸­

æˆ‘ä¹ŸæŒ‰ç…§è¿™ä¸ªæœ€è¿‘æ›´æ–°çš„è§†é¢‘çš„å»ºè®®ä¸‹è½½ C/C++ ç¼–è¯‘å™¨ã€‚ç„¶è€Œï¼Œè¿™å¹¶æ²¡æœ‰è§£å†³æˆ‘çš„é—®é¢˜ã€‚
å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/78856582/enable-gpu-2024-oserror-winerror-127-the-specified-procedure-could-not-be-fo</guid>
      <pubDate>Sat, 10 Aug 2024 16:59:08 GMT</pubDate>
    </item>
    <item>
      <title>åœ¨æ‰©å±•ä¸­è®¿é—® NetLogo æ‰©å±•</title>
      <link>https://stackoverflow.com/questions/78851057/accessing-netlogo-extensions-within-an-extension</link>
      <description><![CDATA[æˆ‘æ­£åœ¨å°è¯•å¼€å‘ä¸€ä¸ª NetLogo æ‰©å±•æ¥ä¸ä¸åŒçš„ LLMSï¼ˆåœ¨çº¿ã€ç¦»çº¿ï¼‰è¿›è¡Œé€šä¿¡ã€‚LLM è°ƒç”¨è¿”å› JSON æ ¼å¼çš„å­—ç¬¦ä¸²ã€‚æˆ‘æƒ³è§£æ JSON å¹¶å°†å…¶è½¬æ¢ä¸ºåµŒå¥—çš„ TABLE å¯¹è±¡ï¼Œä»¥è®¿é—® NetLogo Table æ‰©å±•ã€‚
æ˜¯å¦æœ‰åŠæ³•è®©ä¸€ä¸ªæ‰©å±•è®¿é—®å’Œä½¿ç”¨å¦ä¸€ä¸ªæ‰©å±•ä¸­çš„ç±»ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/78851057/accessing-netlogo-extensions-within-an-extension</guid>
      <pubDate>Fri, 09 Aug 2024 03:21:02 GMT</pubDate>
    </item>
    <item>
      <title>ValueErrorï¼šå±‚â€œdense_2â€éœ€è¦ 1 ä¸ªè¾“å…¥ï¼Œä½†å®ƒæ”¶åˆ°äº† 2 ä¸ªè¾“å…¥å¼ é‡</title>
      <link>https://stackoverflow.com/questions/78846949/valueerror-layer-dense-2-expects-1-inputs-but-it-received-2-input-tensors</link>
      <description><![CDATA[æˆ‘æ— æ³•åŠ è½½æˆ‘çš„æ¨¡å‹ï¼Œå®ƒä¸€ç›´æ˜¾ç¤ºé”™è¯¯
ValueErrorï¼šå±‚â€œdense_2â€éœ€è¦ 1 ä¸ªè¾“å…¥ï¼Œä½†å®ƒæ”¶åˆ°äº† 2 ä¸ªè¾“å…¥å¼ é‡ã€‚æ”¶åˆ°çš„è¾“å…¥ï¼š[&lt;KerasTensor shape=(None, 7, 7, 1280), dtype=float32, sparse=False, name=keras_tensor_2896&gt;, &lt;KerasTensor shape=(None, 7, 7, 1280), dtype=float32, sparse=False, name=keras_tensor_2897&gt;]
è¿™æ˜¯æˆ‘çš„ä»£ç 
image_generator = ImageDataGenerator(
rescale=1./255,
rotation_range=20,
zoom_range=0.2,
width_shift_range=0.2,
height_shift_range=0.2,
Horizoâ€‹â€‹ntal_flip=True,
validation_split=0.2
)

train_dataset = image_generator.flow_from_directory(
directory=path_to_dataset,
target_size=(224, 224),
batch_size=32,
subset=&#39;training&#39;
)

validation_dataset = image_generator.flow_from_directory(
directory=path_to_dataset,
target_size=(224, 224),
batch_size=32,
subset=&#39;validation&#39;
)

# åŠ è½½æ•°æ®é›†ä¸­å­æ–‡ä»¶å¤¹ä¸­çš„ (num_classes) ç±»
num_classes = len(train_dataset.class_indices)

from tensorflow.keras.applications.mobilenet import MobileNet

# åŠ è½½ MobileNet æ¨¡å‹
pre_trained_model = tf.keras.applications.MobileNetV2(input_shape=(224, 224, 3),
include_top=False,
weights=&#39;imagenet&#39;)

pre_trained_model.summary()

# æ‰“å°æ•°æ®é›†ä¿¡æ¯ä»¥ä¾›è°ƒè¯•
print(f&quot;è®­ç»ƒæ•°æ®é›†å½¢çŠ¶ï¼š{train_dataset.image_shape}&quot;)
print(f&quot;éªŒè¯æ•°æ®é›†å½¢çŠ¶ï¼š{validation_dataset.image_shape}&quot;)

pre_trained_model.trainable = False

# ä¸ºé¢„è®­ç»ƒæ¨¡å‹æ·»åŠ è‡ªå®šä¹‰å±‚
model = tf.keras.Sequential([
pre_trained_model,
tf.keras.layers.GlobalAveragePooling2D(),
tf.keras.layers.Dense(1024,activation=&#39;relu&#39;),
tf.keras.layers.Dropout(0.5),
tf.keras.layers.Dense(num_classes,activation=&#39;softmax&#39;) 
])

# ç¼–è¯‘æ¨¡å‹
#from tensorflow.keras.optimizers import RMSprop
model.compile(optimizer=Adam(learning_rate=0.0001),
loss=&#39;categorical_crossentropy&#39;,
metrics=[&#39;accuracy&#39;])

batch=40
history = model.fit(train_dataset,
validation_data=validation_dataset,
epochs=20,
steps_per_epoch = train_dataset.samples//batch,
validation_steps =validation_dataset.samples//batch,
verbose = 1
)

# åŠ è½½æ¨¡å‹
model_save_path = &#39;/content/drive/MyDrive/Machine Learning/saved_models/model_plastik.h5&#39;

# åŠ è½½æ¨¡å‹ï¼Œç¡®ä¿å¿…è¦æ—¶å·²ç¼–è¯‘
loaded_model = tf.keras.models.load_model(model_save_path) 

# ç°åœ¨æ‚¨å¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹å·²åŠ è½½çš„æ¨¡å‹
# ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æƒ³æå–å­æ¨¡å‹ï¼š
input_layer_index = 0 # æ›¿æ¢ä¸ºå®é™…ç´¢å¼•
dense_2_index = 3 # æ›¿æ¢ä¸ºå®é™…ç´¢å¼•
loaded_model = tf.keras.models.Model(inputs=loaded_model.layers[input_layer_index].input, 
outputs=loaded_model.layers[dense_2_index].output)

# æ£€æŸ¥å·²åŠ è½½æ¨¡å‹çš„é…ç½®
for i, layer in enumerate(loaded_model.layers):
print(f&quot;Layer {i}: {layer.name} - è¾“å…¥å½¢çŠ¶ï¼š{layer.input_shape} - è¾“å‡ºå½¢çŠ¶ï¼š{layer.output_shape}&quot;)

print(&quot;å·²æˆåŠŸåŠ è½½ä¿®è®¢æ¨¡å‹ã€‚&quot;)

æˆ‘å°è¯•åŠ è½½æ¨¡å‹ï¼Œå¹¶å¸Œæœ›å®ƒèƒ½å¤ŸåŠ è½½ä»¥è¿›è¡Œæµ‹è¯•]]></description>
      <guid>https://stackoverflow.com/questions/78846949/valueerror-layer-dense-2-expects-1-inputs-but-it-received-2-input-tensors</guid>
      <pubDate>Thu, 08 Aug 2024 07:06:54 GMT</pubDate>
    </item>
    <item>
      <title>å°†è‡ªå®šä¹‰æ¨¡å‹å’Œé…ç½®æ³¨å†Œåˆ° AutoModel å’Œ AutoConfig</title>
      <link>https://stackoverflow.com/questions/77428197/registering-custom-model-and-config-to-automodel-and-autoconfig</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/77428197/registering-custom-model-and-config-to-automodel-and-autoconfig</guid>
      <pubDate>Mon, 06 Nov 2023 00:48:18 GMT</pubDate>
    </item>
    </channel>
</rss>