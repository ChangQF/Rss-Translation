<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>标记为机器学习的活跃问题 - 堆栈内存溢出</title>
    <link>https://stackoverflow.com/questions/tagged/?tagnames=machine-learning&sort=active</link>
    <description>来自 stackoverflow.com 的最新 30 条</description>
    <lastBuildDate>Sat, 22 Jun 2024 21:13:51 GMT</lastBuildDate>
    <item>
      <title>ValueError：将 TF 1 代码转换为 TF 2 时，形状 (None, 8631) 和 (8631,) 不兼容</title>
      <link>https://stackoverflow.com/questions/78657168/valueerror-shapes-none-8631-and-8631-are-incompatible-when-converting-tf</link>
      <description><![CDATA[我有以下 TensorFlow 代码，我尝试将其从 TF 1.14 转换为 TF 2.10.0。我主要通过将 tf 替换为 tf.compat.v1 来实现此目的：
target = tf.compat.v1.keras.utils.to_categorical(target_idx, 8631)
target_variable = tf.compat.v1.keras.backend.variable(target, dtype=tf.float32)
source = tf.compat.v1.keras.utils.to_categorical(source_idx, 8631)
source_variable = tf.compat.v1.Variable(source, dtype=tf.float32)

init_new_vars_op = tf.compat.v1.variables_initializer([target_variable, source_variable])
sess.run(init_new_vars_op)

class_variable_t = target_variable
loss_func_t = tf.compat.v1.keras.metrics.categorical_crossentropy(model.output.op.inputs[0], class_variable_t) # 导致错误
get_grad_values_t = tf.compat.v1.keras.backend.function([model.input], tf.compat.v1.keras.backend.gradients(loss_func_t, model.input))

...


该代码用于使用 LaVAN 方法生成对抗性补丁，可从此处获取。 categorical_crossentropy() 方法调用似乎会导致以下错误：
 文件 &quot;d:\...\attacks\laVAN.py&quot;，第 230 行，位于 &lt;module&gt;
perturb_one(VGGModel(vggface.ARCHITECTURE_RESNET50)，“D:/BA-Python-Code/VGGFace2/n842_0056_01.jpg”，151，500，save_to_disk=True，image_domain=True)
文件“d:\...\attacks\laVAN.py”，第 196 行，位于 perturb_one 中
preprocessed_array = generate_adversarial_examples(vggmodel、img_path、epsilon、src_idx、tar_idx、iterations、image_domain)
文件“d:\...\attacks\laVAN.py”，第 90 行，位于 generate_adversarial_examples 中
loss_func_t = tf.compat.v1.keras.metrics.categorical_crossentropy(model.output.op.inputs[0], class_variable_t)
文件 &quot;D:\...\miniconda3\envs\tf-gpu210\lib\site-packages\tensorflow\python\util\traceback_utils.py&quot;, 第 153 行, 位于 error_handler
从 None 引发 e.with_traceback(filtered_tb)
文件 &quot;D:\...\miniconda3\envs\tf-gpu210\lib\site-packages\keras\losses.py&quot;, 第 1990 行, 位于 categorical_crossentropy
返回 backend.categorical_crossentropy(
文件“D:\...\miniconda3\envs\tf-gpu210\lib\site-packages\keras\backend.py”，第 5529 行，位于 categorical_crossentropy
target.shape.assert_is_compatible_with(output.shape)
ValueError：形状 (None, 8631) 和 (8631,) 不兼容

当我使用 TF 1.14 时，代码（没有 .compat.v1.）运行良好，但现在，使用 TF 2.10.0，它就无法工作了。
你能告诉我如何解决这个问题吗？
在这两种情况下，我都在 Windows 上使用 GPU 版本的 Tensorflow。
我知道在 TF 1.14 代码中，形状是 (?, 8631) 和 (8631,)，并且它可以正常工作。]]></description>
      <guid>https://stackoverflow.com/questions/78657168/valueerror-shapes-none-8631-and-8631-are-incompatible-when-converting-tf</guid>
      <pubDate>Sat, 22 Jun 2024 20:48:40 GMT</pubDate>
    </item>
    <item>
      <title>无法安装 Tensorflowjs</title>
      <link>https://stackoverflow.com/questions/78656818/cannot-install-tensorflowjs</link>
      <description><![CDATA[我有一个名为“melanoma_binary_classifer.keras”的 keras 机器学习模型，我正在尝试将其转换为 tf.js 层格式，并将其加载到 tensorflow.js 中。我通过在 jupyter 笔记本中加载模型、将 tensorflowjs 导入为 tfjs 并进行转换来实现此目的：
tfjs.converters.save_keras_model(model, tfjs_target_dir)

以上代码来自此处的文档：https://www.tensorflow.org/js/tutorials/conversion/import_keras
但是，文档中说的是“pip install tensorflowjs”，而我却收到此错误：
这不允许我或不允许我在 jupyter 笔记本中执行下面的代码：
我的 tensorflow 版本是 2.6.0。]]></description>
      <guid>https://stackoverflow.com/questions/78656818/cannot-install-tensorflowjs</guid>
      <pubDate>Sat, 22 Jun 2024 18:01:55 GMT</pubDate>
    </item>
    <item>
      <title>不支持文件格式：Keras 3 仅支持 .keras 和 .h5 [关闭]</title>
      <link>https://stackoverflow.com/questions/78656789/file-format-not-supported-keras-3-only-supports-keras-and-h5</link>
      <description><![CDATA[ValueError Traceback（最近一次调用最后一次）
Cell In[4]，第 8 行
5 import cv2
6 from scipy import ndimage
----&gt; 8 classifier=load_model(&#39;cnn_svhn.model&#39;)

文件 ~\AppData\Roaming\Python\Python312\site-packages\keras\src\saving\saving_api.py:193，位于 load_model(filepath, custom_objects, compile, safe_mode)
187 raise ValueError(
188 f&quot;文件未找到：filepath={filepath}。&quot;
189 &quot;请确保文件是可访问的 `.keras` &quot;
190 &quot;zip 文件。&quot;
191 )
192 else:
--&gt; 193 raise ValueError(
194 f&quot;不支持文件格式：filepath={filepath}。&quot;
195 &quot;Keras 3 仅支持 V3 `.keras` 文件和 &quot;
196 &quot;旧版 H5 格式文件（`.h5` 扩展名）。&quot;
197 &quot;请注意，Keras 3 中的 `load_model()` 不支持旧版 SavedModel 格式。&quot;
198 &quot;为了在 Keras 3 中将 TensorFlow SavedModel 重新加载为 &quot;
200 &quot;仅推理层，请使用 &quot;
201 &quot;`keras.layers.TFSMLayer(&quot;
202 f&quot;{filepath}, call_endpoint=&#39;serving_default&#39;)` &quot;
203 &quot;（请注意，您的`call_endpoint` &quot;
204 &quot;可能有不同的名称。&quot;
205 )

ValueError：不支持文件格式：filepath=cnn_svhn.model。Keras 3 仅支持 V3 `.keras` 文件和旧版 H5 格式文件（`.h5` 扩展名）。请注意，Keras 3 中的 `load_model()` 不支持旧版 SavedModel 格式。为了在 Keras 3 中将 TensorFlow SavedModel 重新加载为仅推理层，请使用 `keras.layers.TFSMLayer(cnn_svhn.model, call_endpoint=&#39;serving_default&#39;)`（请注意，您的 `call_endpoint` 可能有不同的名称）。

我无法运行此单元格，代码如下：
从 keras.models 导入 load_model
导入 numpy 作为 np
从 matplotlib 导入 pyplot 作为 plt
导入 cv2
从 scipy 导入 ndimage

classifier=load_model(&#39;cnn_svhn.model&#39;)

]]></description>
      <guid>https://stackoverflow.com/questions/78656789/file-format-not-supported-keras-3-only-supports-keras-and-h5</guid>
      <pubDate>Sat, 22 Jun 2024 17:48:57 GMT</pubDate>
    </item>
    <item>
      <title>自定义数据集的时间序列转换器</title>
      <link>https://stackoverflow.com/questions/78656787/timeseries-transformer-for-custom-dataset</link>
      <description><![CDATA[我正在尝试使用 HuggingFace 的转换器。具体来说是时间序列转换器。我似乎无法弄清楚如何初始化它并只运行一次前向传递。我的数据集基本上是这样的：torch.rand(num_samples, timesteps, features)
这通常是我尝试运行的代码。我已经多次查看了文档和参数，但可能遗漏了一些东西。
from transformers import (
TimeSeriesTransformerConfig,
TimeSeriesTransformerForPrediction,
)
from torch.utils.data import DataLoader
import torch

dataset = torch.rand(1000, 300, 61)
dataloader = DataLoader(dataset=dataset, batch_size=4)

config = TimeSeriesTransformerConfig(prediction_length=24, input_size=61)
model = TimeSeriesTransformerForPrediction(config=config)

for batch in dataloader:
outputs = model.forward(
past_values=batch,
past_time_features=torch.arange(1, 300).expand(4, -1),
past_observed_mask=torch.ones_like(batch),
)
print(outputs)

我想要预测的是 61 个特征的下一个时间步。我可能以与我的数据不兼容的方式初始化模型，但我对这些类型的模型不太熟悉。
如何让它工作？]]></description>
      <guid>https://stackoverflow.com/questions/78656787/timeseries-transformer-for-custom-dataset</guid>
      <pubDate>Sat, 22 Jun 2024 17:47:57 GMT</pubDate>
    </item>
    <item>
      <title>我可以使用简单的 ANN 来预测房价吗</title>
      <link>https://stackoverflow.com/questions/78656549/can-i-use-simple-ann-for-house-price-prediction</link>
      <description><![CDATA[我正在尝试使用 tensorflow 构建一个 ML 模型来预测定制房价。我尝试使用简单的 ANN，但是损失太高，模型无法正常工作。我对 ML 有点陌生，所以不确定我是否使用了正确的方法来解决这个问题。
这是我的数据的样子。其中一个枢轴参数是 no-of-years-old，表示房产有多旧。为了避免使用 RNN，我添加了新的数据点 no-of-years-old（当前日期 - 建造年份），而不是使用记录数据点的年份，
我是否需要使用 LSTM/时间序列预测来正确估计房产价格。
注意：此模型仅根据当前趋势预测价格。



房产类型
无年限
条件
价格




公寓
5
好
150K


公寓
6
好
140K


公寓
7
好
130K


公寓
5
差
140K


公寓
6
差
120K


]]></description>
      <guid>https://stackoverflow.com/questions/78656549/can-i-use-simple-ann-for-house-price-prediction</guid>
      <pubDate>Sat, 22 Jun 2024 15:56:14 GMT</pubDate>
    </item>
    <item>
      <title>深度强化学习中状态和动作序列的动作价值函数的泛化</title>
      <link>https://stackoverflow.com/questions/78656489/generalisation-of-action-value-function-for-sequence-of-state-and-action-in-deep</link>
      <description><![CDATA[我正在尝试理解和实施研究论文《使用深度强化学习玩 Atari》，我理解最佳 Q 函数收敛，但作者指出，简单的方法是不切实际的，因为 Q 函数是针对每个序列分别估计的。这就需要在这种情况下使用函数逼近器或 Q 网络。有人可以验证我的理解并回答我的问题吗？谢谢！
我尝试了 ChatGPT，但找不到满意的答案。]]></description>
      <guid>https://stackoverflow.com/questions/78656489/generalisation-of-action-value-function-for-sequence-of-state-and-action-in-deep</guid>
      <pubDate>Sat, 22 Jun 2024 15:33:49 GMT</pubDate>
    </item>
    <item>
      <title>学习曲线识别机器学习中的过度拟合和欠拟合</title>
      <link>https://stackoverflow.com/questions/78656050/learning-curve-to-identify-overfitting-and-underfitting-in-machine-learning</link>
      <description><![CDATA[请向我解释这两个图表是否正常。是否存在过度拟合和欠拟合？
这是我引用的代码“https://www.kaggle.com/code/jeyasrisenthil/waste-classification”

]]></description>
      <guid>https://stackoverflow.com/questions/78656050/learning-curve-to-identify-overfitting-and-underfitting-in-machine-learning</guid>
      <pubDate>Sat, 22 Jun 2024 12:36:36 GMT</pubDate>
    </item>
    <item>
      <title>修复 TimeSeries Transformer 中的张量形状/维度不匹配错误以进行股票价格预测</title>
      <link>https://stackoverflow.com/questions/78655715/fixing-tensor-shape-dimension-mismatch-errors-in-timeseries-transformer-for-stoc</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/78655715/fixing-tensor-shape-dimension-mismatch-errors-in-timeseries-transformer-for-stoc</guid>
      <pubDate>Sat, 22 Jun 2024 10:08:00 GMT</pubDate>
    </item>
    <item>
      <title>SelectKBest 选择的特征与 ColumnTransformer 转换后的特征不匹配</title>
      <link>https://stackoverflow.com/questions/78655668/the-features-selected-by-selectkbest-do-not-match-those-transformed-by-columntra</link>
      <description><![CDATA[我正在部署一个机器学习模型用于研究，对此我有一些疑问：

我的 POST 方法将向 API 发送我的原始特征（未应用转换）

未转换的数据

我使用与训练阶段相同的管道，并从中获取 ColumnTranformed 和最佳模型：

preprocessor = pipeline.named_steps[&quot;columntransformer&quot;]
model = pipeline.named_steps[&quot;xgbclassifier&quot;]

管道

在 API 内部，我获取了 POST 的数据，并希望使用管道中使用的相同预处理器对其进行转换，但是：

-------------------------------------------------------------------------------------------
KeyError Traceback（最近一次调用最后一次）
&lt;ipython-input-29-f928ce436ece&gt;在 &lt;单元格行：15&gt;()
13 
14 # preprocessor.fit(df[[&quot;tenure&quot;, &quot;OnlineSecurity&quot;, &quot;TechSupport&quot;, &quot;Contract&quot;]])
16 print(preprocessed_df)
17 

17 帧
/usr/local/lib/python3.10/dist-packages/pandas/core/indexes/base.py 在 _raise_if_missing(self, key, indexer, axis_name)
5939 
5940 not_found = list(ensure_index(key)[missing_mask.nonzero()[0]].unique())
-&gt; 5941 引发 KeyError(f&quot;{not_found} 不在索引中&quot;)
5942 
5943 @overload

KeyError: &quot;[&#39;MonthlyCharges&#39;, &#39;TotalCharges&#39;] 不在索引中&quot;


验证 KBest 功能，MonthlyCharges 和 TotalCharges 不存在！

kbest = final_estimator2.named_steps[&quot;selectkbest&quot;].get_support(indices=True)

used_df = formed_df_columns.iloc[:, kbest]

kbest 功能
我是不是忘了哪个步骤？
我仔细检查了所有代码和官方文档。
我希望理解为什么我的预处理要求两个“理论上”不需要的功能在训练阶段未被 KBest 使用和选择。]]></description>
      <guid>https://stackoverflow.com/questions/78655668/the-features-selected-by-selectkbest-do-not-match-those-transformed-by-columntra</guid>
      <pubDate>Sat, 22 Jun 2024 09:47:25 GMT</pubDate>
    </item>
    <item>
      <title>如何使用 C# 和 ml.net 构建自学习模型 [关闭]</title>
      <link>https://stackoverflow.com/questions/78655563/how-to-build-a-self-learning-model-using-c-sharp-and-ml-net</link>
      <description><![CDATA[如何在 Visual Studio 中使用 C# 和 ML.net 根据通过 OCR 从图像中提取的数据构建模型？
我刚刚使用 OCR 获得了提取的数据，但无法构建模型，我不知道从哪里开始以及该做什么。
以下是应该执行的主要步骤：
一旦检测到文本，就会启动 ML 线程进行自学。
这涉及检测任何会计文件（发票、报价、订单、费用报告、银行对账单、采购发票等）。
ML 过程涉及输入检测到的键（AddKey + 措辞）。
一旦捕获模型，就会输入数据（发票表等）。]]></description>
      <guid>https://stackoverflow.com/questions/78655563/how-to-build-a-self-learning-model-using-c-sharp-and-ml-net</guid>
      <pubDate>Sat, 22 Jun 2024 08:58:48 GMT</pubDate>
    </item>
    <item>
      <title>如何在 Coursera 中验证 Jupiter 笔记本分数？[关闭]</title>
      <link>https://stackoverflow.com/questions/78655480/how-to-validate-jupiter-notebook-score-in-coursera</link>
      <description><![CDATA[提交练习时未正确验证，即使通过了测试用例场景，分数仍为“0”。
Jupiter 笔记本嵌入在 Coursera 应用程序中。
我尝试多次保存文件并重新运行服务器。
我希望文件能够针对给定的解决方案进行验证，从而获得分数。
在此处查看屏幕截图]]></description>
      <guid>https://stackoverflow.com/questions/78655480/how-to-validate-jupiter-notebook-score-in-coursera</guid>
      <pubDate>Sat, 22 Jun 2024 08:21:29 GMT</pubDate>
    </item>
    <item>
      <title>如果我使用 PHP 作为后端语言，如何将 ML 模型连接到 Web 应用程序 [关闭]</title>
      <link>https://stackoverflow.com/questions/78655085/how-can-i-connect-ml-model-to-web-app-if-i-use-php-as-backend-language</link>
      <description><![CDATA[我有一个毕业设计，我面临一些问题，首先我已经完成了我的机器学习模型的构建，该模型分析患者的X射线图像，我想让医生通过我的Web应用程序使用这个模型，但在我的Web应用程序中我使用PHP作为后端语言，我该如何将机器学习模型连接到Web应用程序？请帮忙。
我不知道如何连接它们。]]></description>
      <guid>https://stackoverflow.com/questions/78655085/how-can-i-connect-ml-model-to-web-app-if-i-use-php-as-backend-language</guid>
      <pubDate>Sat, 22 Jun 2024 04:24:42 GMT</pubDate>
    </item>
    <item>
      <title>catboost 如何计算树木的边界？[关闭]</title>
      <link>https://stackoverflow.com/questions/78600605/how-catboost-computes-borders-for-its-trees</link>
      <description><![CDATA[我无法弄清楚如何计算 floatfeatures、one-hot-features 和 ctrs 的边界
我尝试查看 catboost 的官方文档，但找不到任何关于如何计算边界值的参考
提前致谢]]></description>
      <guid>https://stackoverflow.com/questions/78600605/how-catboost-computes-borders-for-its-trees</guid>
      <pubDate>Mon, 10 Jun 2024 05:31:30 GMT</pubDate>
    </item>
    <item>
      <title>使用机器学习从图像中提取系统发育树信息</title>
      <link>https://stackoverflow.com/questions/78437477/extracting-phylogenetic-tree-information-from-images-using-machine-learning</link>
      <description><![CDATA[有各种机器学习模型（Claude、chatGPT 等）可用于从图像中提取机器可读信息。有没有人见过成功从已发布的系统发育树图像（互联网上有很多）中提取 Newick 格式数据（或等效数据）的案例？]]></description>
      <guid>https://stackoverflow.com/questions/78437477/extracting-phylogenetic-tree-information-from-images-using-machine-learning</guid>
      <pubDate>Mon, 06 May 2024 15:00:15 GMT</pubDate>
    </item>
    <item>
      <title>将自定义预测例程导入顶点 AI 管道</title>
      <link>https://stackoverflow.com/questions/77996526/import-custom-prediction-routine-to-vertex-ai-pipeline</link>
      <description><![CDATA[我在 Vertex AI 上创建了一个自定义预测例程，上传了模型，并且能够通过 UI 使用它生成预测。现在，我想将其合并到 Vertex AI 管道中，以便在数据生成步骤后运行批量预测。我正在使用 Kubeflow Pipelines SDK。
为此，我考虑使用 ModelBatchPredictOp 预构建组件。为了实现这一点，我需要将模型导入管道，例如使用 导入器组件。但是，导入器组件需要工件 URI，而我的模型没有该 URI，因为它使用自定义容器。它被嵌入到容器镜像中；它不在 GCS 中。
因此我尝试编写一个快速自定义导入器组件，该组件返回模型对象，尽管我并不指望它能起作用，但我得到了类型不匹配的结果。请参阅下面的示例代码：
from helper import data_component
from kfp.dsl import component, pipeline, Output, Model
from google_cloud_pipeline_components.v1.batch_predict_job import ModelBatchPredictOp

@component(packages_to_install=[&quot;google-cloud-aiplatform&quot;])
def custom_importer(model: Output[Model]):
from google.cloud import aiplatform
return aiplatform.Model(model_name=&quot;model-id&quot;)

@pipeline(name=&quot;prediction-pipeline&quot;)
def pipeline():
data_task = data_component()

importer_task = custom_importer()

batch_predict_op = ModelBatchPredictOp(
job_display_name=&quot;batch_predict_job&quot;,
model=importer_task.output,
gcs_source_uris=data_task.outputs[&quot;dataset&quot;],
gcs_destination_output_uri_prefix=&quot;bucket&quot;,
instance_format=&quot;csv&quot;,
predictions_format=&quot;jsonl&quot;,
Starting_replica_count=1,
max_replica_count=1,
)


ModelBatchPredictOp 不喜欢参数 model 的输入类型：InconsistentTypeException：传递给组件“model-batch-predict”的输入“model”的参数不兼容：参数类型“system.Model@0.0.1”与输入类型“google.VertexModel@0.0.1”不兼容
如何将自定义预测例程中的批量预测合并到 Vertex AI 中管道？]]></description>
      <guid>https://stackoverflow.com/questions/77996526/import-custom-prediction-routine-to-vertex-ai-pipeline</guid>
      <pubDate>Wed, 14 Feb 2024 18:27:51 GMT</pubDate>
    </item>
    </channel>
</rss>