<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>标记为机器学习的活跃问题 - 堆栈内存溢出</title>
    <link>https://stackoverflow.com/questions/tagged/?tagnames=machine-learning&sort=active</link>
    <description>来自 stackoverflow.com 的最新 30 条</description>
    <lastBuildDate>Wed, 10 Jul 2024 18:21:59 GMT</lastBuildDate>
    <item>
      <title>为什么 Python 中的 GradientBoostedClassifer() 有 random_state 参数？</title>
      <link>https://stackoverflow.com/questions/78732191/why-does-gradientboostedclassifer-in-python-have-random-state-argument</link>
      <description><![CDATA[在 Python 中运行梯度提升分类器：
clf = GradientBoostingClassifier(n_estimators = 100, max_depth = 8, random_state=1000)
我不明白为什么会有 random_state 参数。我想我明白为什么在随机森林集合中需要它，但是其中的“梯度”部分不是消除了算法中的随机性吗？GDB 算法中的随机性是什么？
我有 528 个数据点，其中有 2 个数值特征和 2 个序数分类特征。算法的每次迭代都从随机选择的 80% 数据的 6 倍交叉验证中进行训练，然后对剩余的 20% 数据进行模型测试。虽然更改 random_state 不会改变我的整体模型准确性，但有时会极大地改变我的特征重要性……可以通过在模型训练的多次迭代中平均特征重要性来解决这个问题，无论随机状态如何都会产生一致的结果，但这对我来说仍然没有意义。我仍然不确定算法本身中的随机性是什么。]]></description>
      <guid>https://stackoverflow.com/questions/78732191/why-does-gradientboostedclassifer-in-python-have-random-state-argument</guid>
      <pubDate>Wed, 10 Jul 2024 18:17:57 GMT</pubDate>
    </item>
    <item>
      <title>使用包含数组的特征训练随机森林模型</title>
      <link>https://stackoverflow.com/questions/78732000/training-random-forest-model-with-features-containing-arrays</link>
      <description><![CDATA[我正在处理一个包含时域 IQ 数据的数据集。我对 IQ 数据应用了 FFT，将其转换为频域，并进一步从中提取功率、幅度和相位角。这些特征中的每一行都包含一个由 1024 个数据点组成的数组。我正在尝试用这些数据训练一个随机森林分类器模型，但在拟合过程中遇到了错误错误图片（抱歉图片模糊）。所有特征都具有相同的形状和大小。
我尝试连接行、展平、转换为列表，但似乎都不起作用。所以我决定使用这些特征的统计数字来训练模型。有没有办法直接传递 FFT 后获得的特征？这对模型来说会不会太复杂了？]]></description>
      <guid>https://stackoverflow.com/questions/78732000/training-random-forest-model-with-features-containing-arrays</guid>
      <pubDate>Wed, 10 Jul 2024 17:29:51 GMT</pubDate>
    </item>
    <item>
      <title>BART 配备所有虚拟功能</title>
      <link>https://stackoverflow.com/questions/78731704/bart-with-all-dummy-features</link>
      <description><![CDATA[我正尝试将 BART 应用于分类问题，其中预测变量是虚拟变量以及 y 变量。我知道这是一种不常见的设置，但不幸的是这就是设置。实际上，0 和 1 值是从 -4 到 4 的分类变量中获得的，将负值设置为 0，将正值添加到 1。我还有数据的分类版本，以防它有用。
现在，我的预测变量包含大量 NA 值（即 70%），由 648x48 的 0-1 虚拟变量矩阵组成。我的 y 变量不包含缺失值，有 648 个值。
我目前正在使用 RSTudio 在 R 中工作。然而，当我执行下面的代码时，结果却令人失望：
bart_machine = build_bart_machine(predictors, response_var,use_missing_data = TRUE, use_missing_data_dummies_as_covars = TRUE)
bart_machine$confusion_matrix

也就是说，我获得了一个 NULL 混淆矩阵，并且
bartMachine v1.3.4.1 用于回归

缺失数据功能开启
训练数据大小：n = 638 和 p = 96
在 8 个核心、50 棵树、250 个 burn-in 和 1000 个 post 上构建，耗时 5.8 秒。样本

事先对 y 的 sigsq 估计：0.016

老化后的平均 sigsq 估计：0.00314

样本内统计数据：
L1 = 9.91
L2 = 1.01
rmse = 0.04
Pseudo-Rsq = 0.9547
残差的 shapiro-wilk 正态性检验的 p-val：0

零均值噪声的 p-val：0.99451

现在我的问题是：1) 您认为我有太多 NA 值而无法执行 BART 吗？您认为我的设置至少应该产生一个混淆矩阵吗？您认为数据的分类版本在这里可能更有帮助，还是上述令人失望的结果是由于更深层次的原因？
谢谢]]></description>
      <guid>https://stackoverflow.com/questions/78731704/bart-with-all-dummy-features</guid>
      <pubDate>Wed, 10 Jul 2024 16:18:19 GMT</pubDate>
    </item>
    <item>
      <title>退出网页后，网络摄像头/Canvas 仍在运行</title>
      <link>https://stackoverflow.com/questions/78731553/webcam-canvas-is-still-running-after-i-exit-a-web-page</link>
      <description><![CDATA[我正在使用 React 上的 ml5 和 p5 创建瑜伽 AI 教练。
我创建了一个组件，其中加载了一个模型和一个网络摄像头。该组件的目标是检测某个瑜伽姿势，并且该组件动态返回从网络摄像头检测到的姿势名称。当检测到某个姿势时，该组件还会返回一个倒计时 15 秒的计时器 - 提示用户保持姿势 15 秒。
我注意到，当我退出页面转到网站上的另一个页面时，网络摄像头正在运行。当我退出页面时，它应该停止运行。
我问 ChatGPT 如何解决这个问题，他们说“您需要在组件卸载时明确停止视频流以确保网络摄像头已关闭”。我在我的组件上使用 useEffect 来包装我的函数。我认为这可能是问题所在，但我不太确定。
这是我的代码链接：https://github.com/laura-nguyen/yoga-ai/blob/feature/page-pose-cam/src/components/PoseCam/PoseCam.jsx]]></description>
      <guid>https://stackoverflow.com/questions/78731553/webcam-canvas-is-still-running-after-i-exit-a-web-page</guid>
      <pubDate>Wed, 10 Jul 2024 15:45:22 GMT</pubDate>
    </item>
    <item>
      <title>tensorflow keras Model.fit 返回：ValueError：无法识别的数据类型</title>
      <link>https://stackoverflow.com/questions/78731508/tensorflow-keras-model-fit-returning-valueerror-unrecognized-data-type</link>
      <description><![CDATA[我尝试用 2 个输入来训练 keras 模型：一个图像部分，即 tf.data.Dataset 和一个由 pd.DataFrame 表示的正常部分&gt;
from tensorflow.keras.optimizers import Adam
opt = Adam(learning_rate=1e-3, decay=1e-3 / 200)

model.compile(loss=&quot;mean_absolute_percentage_error&quot;, optimizer=opt)

model.fit(
x=[df.loc[:, df.columns != &#39;target&#39;], ds.batch(8)], y=df[&quot;target&quot;],
epochs=200)

我尝试拟合模型，但我得到了ValueError
ValueError：无法识别的数据类型：x=[...][401059 行 x 52 列]
，&lt;_BatchDataset element_spec=(TensorSpec(shape=(None, 32, 256, 256, 3), 
dtype=tf.float32, name=None), 
TensorSpec(shape=(None, 32, 256, 256, 3), dtype=tf.float32, name=None))&gt;]（类型为 &lt;class &#39;list&#39;&gt;）
]]></description>
      <guid>https://stackoverflow.com/questions/78731508/tensorflow-keras-model-fit-returning-valueerror-unrecognized-data-type</guid>
      <pubDate>Wed, 10 Jul 2024 15:36:58 GMT</pubDate>
    </item>
    <item>
      <title>需要帮助来找到与击键动力学相关的数据集</title>
      <link>https://stackoverflow.com/questions/78731494/need-assistance-to-find-a-dataset-related-to-keystroke-dynamics</link>
      <description><![CDATA[我一直在尝试为我的一个项目寻找数据集。我需要一个击键动态数据集。我不能使用合成数据。如果有任何线索可以找到它，我将不胜感激。我试过 Kaggle，但遗憾的是我在那里找到的那​​个被很多人使用，与我的项目不符。我希望我能找到另一个，谢谢！
我试过 kaggle 和 gitthub，遗憾的是到处都是相同的数据集。]]></description>
      <guid>https://stackoverflow.com/questions/78731494/need-assistance-to-find-a-dataset-related-to-keystroke-dynamics</guid>
      <pubDate>Wed, 10 Jul 2024 15:32:38 GMT</pubDate>
    </item>
    <item>
      <title>Microsoft ML：预测代码始终预测 0，但在“评估”选项卡中尝试时，它始终有效（非 0 的值）</title>
      <link>https://stackoverflow.com/questions/78731177/microsoft-ml-the-prediction-code-always-predicts-0-but-when-tried-in-the-evalua</link>
      <description><![CDATA[系统信息：

模型构建器版本 17.15.0.2337001
Visual Studio 版本 2022

我创建了一个机器学习模型（值预测），一切都很好

通过这张图片，你可以看到模型正常工作
但是当我使用模型构建器的代码时：
使用 ConsoleApp2;

//加载样本数据
var sampleData = new MLModel1.ModelInput()
{
Device = 1F,
Temperature = 20F,
Weather = 1F,
Time = 2F,
};

//加载模型并预测输出
var result = MLModel1.Predict(sampleData);
Console.WriteLine(result.Predict);

输出始终为 0 或预测始终为 0：
]]></description>
      <guid>https://stackoverflow.com/questions/78731177/microsoft-ml-the-prediction-code-always-predicts-0-but-when-tried-in-the-evalua</guid>
      <pubDate>Wed, 10 Jul 2024 14:28:45 GMT</pubDate>
    </item>
    <item>
      <title>无法部署基于 Flask 的深度学习应用程序</title>
      <link>https://stackoverflow.com/questions/78731060/unable-to-deploy-my-deep-learning-app-based-on-flask</link>
      <description><![CDATA[我的 ml 应用程序基于 flask，它以 pdf 作为输入，让用户提问并利用 BERT 模型来回答，
到目前为止，它在本地运行良好，但在部署中没有运气，我尝试了 vercel、pythonanywhere，但没有任何效果，欢迎您为部署做出贡献
github repo https://github.com/MohdSiddiq12/Natural-Language-Question-Answering-System]]></description>
      <guid>https://stackoverflow.com/questions/78731060/unable-to-deploy-my-deep-learning-app-based-on-flask</guid>
      <pubDate>Wed, 10 Jul 2024 14:04:16 GMT</pubDate>
    </item>
    <item>
      <title>我被困在项目的这个阶段，我已经安装了 catboost 模块，但它仍然显示错误</title>
      <link>https://stackoverflow.com/questions/78730862/i-am-stuck-in-this-stage-of-my-project-where-i-already-install-the-catboost-modu</link>
      <description><![CDATA[---------------------------------------------------------------------------
ValueError Traceback（最近一次调用最后一次）
Cell In[65]，第 2 行
1 # catboost 分类器模型
----&gt; 2 from catboost import CatBoostClassifier
4 # 实例化模型
5 cat = CatBoostClassifier(learning_rate = 0.1, verbose=0)

File c:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\catboost\__init__.py:1
----&gt; 1 从 .core 导入 (
2 FeaturesData、EFstrType、EShapCalcType、EFeaturesSelectionAlgorithm、EFeaturesSelectionGrouping、
3 Pool、CatBoost、CatBoostClassifier、CatBoostRegressor、CatBoostRanker、CatBoostError、cv、sample_gaussian_process、train、
4 sum_models、_have_equal_features、to_regressor、to_classifier、to_ranker、MultiRegressionCustomMetric、
5 MultiRegressionCustomObjective、MultiTargetCustomMetric、MultiTargetCustomObjective
6 ) # noqa
7 从 .version 导入 VERSION 作为 __version__ # noqa
8 __all__ = [
9 &#39;FeaturesData&#39;、&#39;EFstrType&#39;、&#39;EShapCalcType&#39;、&#39;EFeaturesSelectionAlgorithm&#39;， &#39;EFeaturesSelectionGrouping&#39;,
10 &#39;Pool&#39;, &#39;CatBoost&#39;, &#39;CatBoostClassifier&#39;, &#39;CatBoostRegressor&#39;, &#39;CatBoostRanker&#39;, &#39;CatboostError&#39;,
(...)
13 &#39;MultiTargetCustomMetric&#39;, &#39;MultiTargetCustomObjective&#39;
14 ]

文件 c:\Users\Asus\AppData\Local\Programs\Python\Python312\Lib\site-packages\catboost\core.py:45
40 pass
...
9 def try_plot_offline(figs):

文件 _catboost.pyx:1，在 init _catboost() 中

ValueError: numpy.dtype 大小已更改，可能表示二进制不兼容。预期 C 标头为 96，PyObject 为 88
# 输出被截断。以可滚动元素的形式查看或在文本编辑器中打开。调整单元格输出设置...

# catboost 分类器模型
来自 catboost 导入 CatBoostClassifier

# 实例化模型
cat = CatBoostClassifier(learning_rate = 0.1, verbose=0)

# 拟合模型
cat.fit(X_train,y_train)
]]></description>
      <guid>https://stackoverflow.com/questions/78730862/i-am-stuck-in-this-stage-of-my-project-where-i-already-install-the-catboost-modu</guid>
      <pubDate>Wed, 10 Jul 2024 13:27:16 GMT</pubDate>
    </item>
    <item>
      <title>训练 PINN 来反演未知参数</title>
      <link>https://stackoverflow.com/questions/78730829/train-a-pinn-to-invert-for-unknown-parameters</link>
      <description><![CDATA[我使用 PINN 求解阻尼振荡器微分方程，同时以阻尼振荡器的噪声观测作为输入，找到后者的摩擦参数。我使用自定义训练程序在 Tensorflow 中编写了代码。问题是我定义的可训练参数没有接近我从噪声观测中知道的正确值。最终，PINN 的解决方案完全不正确。但是，我的代码运行得很好，不需要寻找可训练参数，也就是这里的摩擦参数。
# NN 振荡器系统的实现
def rocks_system_data_loss(t, net, func, params, mu, bc, t_data, u_data, lambda1):
t = t.reshape(-1,1)
t = tf.constant(t, dtype = tf.float32)
t_0 = tf.zeros((1,1))

# 2nd 导数的嵌套循环
with tf.GradientTape() as outer_tape:
outer_tape.watch(t)

with tf.GradientTape() as inner_tape:
inner_tape.watch(t)
x = net(t)

dx_dt = inner_tape.gradient(x, t) # 1st导数

d2x_dt2 = outer_tape.gradient(dx_dt, t) # 二阶导数

# 边界损失
bc_loss_1 = tf.square(net(t_0) - bc[0])
bc_loss_2 = tf.square(dx_dt[0] - bc[1])

# 可学习参数 mu 传递给 ODE
ode_loss = d2x_dt2 - func(x, dx_dt, params[0], mu, params[2])

# 超参数 lambda1 的数据损失
data_loss = u_data - net(t_data)

square_loss = tf.square(ode_loss) + lambda1*tf.square(data_loss) + bc_loss_1 + bc_loss_2
total_loss = tf.reduce_mean(square_loss)

return total_loss, mu

# 带有数据丢失的训练程序
def train_NN_data_loss(epochs, optm, NN, func, bc, lambda1, train_t, train_u, data_t, data_u,
data_u_noised, test_t_plot, true_u_plot, testing_t):
train_loss_record = []
loss_tracker = plotting_points(epochs)

mu = tf.Variable(initial_value=tf.ones((1,1)), trainable=True, dtype=tf.float32)
mu_list = []

waiting = 200
best = float(&#39;inf&#39;)

early_stop = 0

for itr in range(epochs):
with tf.GradientTape() as tape:
#tape.watch(mu)
train_loss, mu = rocksor_system_data_loss(train_t, NN，func，params，mu，bc，data_t，data_u_noised，lambda1)
train_loss_record.append(train_loss)

grad_w = tape.gradient(train_loss，NN.trainable_variables + [mu])
optm.apply_gradients(zip(grad_w，NN.trainable_variables + [mu]))

if itr in loss_tracker:
print(train_loss.numpy())
print(mu.numpy())
plot_epochs_with_noise(train_t，train_u，data_t，data_u_noised，test_t_plot，true_u_plot，testing_t，itr，NN)

mu_list.append(mu.numpy()) 

# 提前停止
# wait += 1
# if train_loss.numpy() &lt; best:
# best = train_loss.numpy()
# wait = 0
# if wait &gt;= waiting:
# print(f&quot;在迭代 {itr} 时停止，损失为 {train_loss_record[itr]}。&quot;)
# early_stop = itr
# break

return train_loss_record, mu_list, early_stop

# 用于 ODE 损失计算/最小化
NN_osc_func = lambda x, dx_dt, k, d, m: -k/m*x - d/m*dx_dt

您可以在此处看到 6000 个 epoch 后的结果。神经网络正在收敛到一条水平线，误差为 5.76，参数估计为 0.84，尽管正确值为 4。这是我的阻尼振荡器设置：
k = 400
d = 4
m = 1
y0 = np.array([1.0, 0.0])

错误结果。
相应损失。
不幸的是，此时我不知道问题可能是什么。我尝试更改 NN_osc_func，并在两个函数中使用了 tape.gradient()。如能得到任何帮助，我将不胜感激。谢谢！]]></description>
      <guid>https://stackoverflow.com/questions/78730829/train-a-pinn-to-invert-for-unknown-parameters</guid>
      <pubDate>Wed, 10 Jul 2024 13:22:04 GMT</pubDate>
    </item>
    <item>
      <title>在 Android Studio 中集成已训练的模型（Java）</title>
      <link>https://stackoverflow.com/questions/78730286/integration-of-a-trained-model-in-android-studio-java</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/78730286/integration-of-a-trained-model-in-android-studio-java</guid>
      <pubDate>Wed, 10 Jul 2024 11:31:14 GMT</pubDate>
    </item>
    <item>
      <title>加载在自定义数据集上训练的 Yolov9 模型：AttributeError：“str”对象没有属性“shape”</title>
      <link>https://stackoverflow.com/questions/78728869/loading-yolov9-model-trained-on-custom-dataset-attributeerror-str-object-has</link>
      <description><![CDATA[我已经在自定义数据集上训练了一个 yolov9 模型，用于实例分割，现在我想在分割后获得分割区域。
输出如下图所示，但针对图像中分割的每个对象。

from pathlib import Path
import numpy as np
import torch
import cv2

model = torch.hub.load(&#39;.&#39;, &#39;custom&#39;, path=&#39;yolov9-inst/runs/train-seg/gelan-c-seg15/weights/best.pt&#39;, source=&#39;local&#39;) 
# Image
img = &#39;WALL-INSTANCEE-2/test/images/5a243513a69b150001f56c31_emptyroom6_jpeg_jpg.rf.7aa8f6a9aefbb1c76adc60a7b392dcd6.jpg&#39;
# 推理
res = model(img)

# 迭代检测结果（对多张图片有帮助）
for r in res:
img = np.copy(r.orig_img)
img_name = Path(r.path).stem # 源图片 base-name

# 迭代每个对象轮廓（多次检测）
for ci, c in enumerate(r):
# 获取检测类名
label = c.names[c.boxes.cls.tolist().pop()]

# 创建二进制掩码
b_mask = np.zeros(img.shape[:2], np.uint8)

# 提取轮廓结果
contour = c.masks.xy.pop()
# 更改类型
contour = contour.astype(np.int32)
# 重塑
contour = contour.reshape(-1, 1, 2)

# 将轮廓绘制到掩码上
_ = cv2.drawContours(b_mask, [contour], -1, (255, 255, 255), cv2.FILLED)

但我在仅查找 res 时收到此错误。
YOLO 🚀 v0.1-104-g5b1ea9a Python-3.10.12 torch-2.1.0+cu118 CUDA:0 (NVIDIA RTX A5000, 24248MiB)

融合层...
gelan-c-seg-custom 摘要：414 层、27364441 个参数、0 个梯度、144.2 GFLOP
警告 ⚠️ YOLO SegmentationModel 尚不兼容 AutoShape。您将无法使用此模型运行推理。
------------------------------------------------------------------------------------------
AttributeError Traceback（最近一次调用最后一次）
Cell In[84]，第 6 行
4 img = &#39;WALL-INSTANCEE-2/test/images/5a243513a69b150001f56c31_emptyroom6_jpeg_jpg.rf.7aa8f6a9aefbb1c76adc60a7b392dcd6.jpg&#39;
5 # 推理
----&gt; 6 结果 = model(img)

文件 /usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py:1518，位于 Module._wrapped_call_impl(self, *args, **kwargs)
1516 返回 self._compiled_call_impl(*args, **kwargs) # 类型：ignore[misc]
1517 else:
-&gt; 1518 return self._call_impl(*args, **kwargs)

File /usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py:1527, in Module._call_impl(self, *args, **kwargs)
1522 # 如果我们没有任何钩子，我们希望跳过此函数中的其余逻辑
1523 # 并只调用 forward。
1524 if not (self._backward_hooks or self._backward_pre_hooks or self._forward_hooks or self._forward_pre_hooks
1525 or _global_backward_pre_hooks or _global_backward_hooks
1526 or _global_forward_hooks or _global_forward_pre_hooks):
-&gt; 1527 返回 forward_call(*args, **kwargs)
1529 尝试：
1530 结果 = 无

文件 /workspace/yolov9-inst/./models/common.py:868，在 DetectMultiBackend.forward(self, im, augment, visualize) 中
866 def forward(self, im, augment=False, visualize=False):
867 # YOLO MultiBackend 推理
--&gt; 868 b, ch, h, w = im.shape # 批次、通道、高度、宽度
869 if self.fp16 and im.dtype != torch.float16:
870 im = im.half() # 到 FP16

AttributeError: &#39;str&#39; 对象没有属性 &#39;shape&#39;

请问有人能帮我解决这个问题吗]]></description>
      <guid>https://stackoverflow.com/questions/78728869/loading-yolov9-model-trained-on-custom-dataset-attributeerror-str-object-has</guid>
      <pubDate>Wed, 10 Jul 2024 06:10:32 GMT</pubDate>
    </item>
    <item>
      <title>ValueError：未在未知的 TensorShape 上定义 as_list()。图像和掩码形状看起来正确</title>
      <link>https://stackoverflow.com/questions/78727412/valueerror-as-list-is-not-defined-on-an-unknown-tensorshape-image-and-mask-s</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/78727412/valueerror-as-list-is-not-defined-on-an-unknown-tensorshape-image-and-mask-s</guid>
      <pubDate>Tue, 09 Jul 2024 19:17:45 GMT</pubDate>
    </item>
    <item>
      <title>使用嵌入技术从数据库中进行人脸识别</title>
      <link>https://stackoverflow.com/questions/78688976/face-recognize-from-the-database-using-embedding-technique</link>
      <description><![CDATA[我正在开展一个项目，旨在识别大学记录中是否存在任何个人的照片。所提出的方法涉及将每个学生照片的嵌入及其详细信息存储在矢量数据库中。当需要比较照片时，系统将生成该照片的嵌入值，然后将该值与数据库进行比较。如果该值在特定阈值内，则表明该个人存在于记录中。
我正在寻求专家建议，以确定这种方法是否可行。如果对此方法有任何疑虑，我将不胜感激最佳解决方案的建议。]]></description>
      <guid>https://stackoverflow.com/questions/78688976/face-recognize-from-the-database-using-embedding-technique</guid>
      <pubDate>Sun, 30 Jun 2024 15:09:55 GMT</pubDate>
    </item>
    <item>
      <title>PyTorch 模型未进行训练</title>
      <link>https://stackoverflow.com/questions/45359111/pytorch-model-is-not-training</link>
      <description><![CDATA[我有一个问题，已经一个星期没法解决了。我正在尝试构建 CIFAR-10 分类器，但每个批次后的损失值都在随机跳跃，而且准确率甚至在同一批次上也没有提高（我甚至无法用一个批次过度拟合模型），所以我猜唯一可能的原因是 - 权重没有更新。 
我的模块类
class Net(nn.Module):
def __init__(self):
super(Net, self).__init__()
self.conv_pool = nn.Sequential(
nn.Conv2d(3, 64, 3, padding=1),
nn.ReLU(),
nn.MaxPool2d(2, 2),
nn.Conv2d(64, 128, 3, padding=1),
nn.ReLU(),
nn.MaxPool2d(2, 2),
nn.Conv2d(128, 256, 3, padding=1),
nn.ReLU(),
nn.MaxPool2d(2, 2),
nn.Conv2d(256, 512, 3, padding=1),
nn.ReLU(),
nn.MaxPool2d(2, 2),
nn.Conv2d(512, 512, 1),
nn.ReLU(),
nn.MaxPool2d(2, 2))

self.fcnn = nn.Sequential(
nn.Linear(512, 2048),
nn.ReLU(),
nn.Linear(2048, 2048),
nn.ReLU(),
nn.Linear(2048, 10)
)

def forward(self, x):
x = self.conv_pool(x)
x = x.view(-1, 512)
x = self.fcnn(x)
return x

我正在使用的优化器：
net = Net()
criterion = nn.CrossEntropyLoss()
optimizer = optim.SGD(net.parameters(), lr=0.001, motivation=0.9)

我的训练函数：
def train():
for epoch in range(5): # 多次循环遍历数据集
for i in range(0, df_size):
# 获取数据

try:
images, labels = loadBatch(ds, i)
except BaseException:
continue

# 包装 
输入 = Variable(images)

optimizer.zero_grad()

输出 = net(inputs)

损失 = criterion(outputs, Variable(labels))

损失.backward()
optimizer.step()
acc = test(images,labels)
print(&quot;损失：&quot; + str(loss.data[0]) + &quot; 准确率 %：&quot; + str(acc) + &quot;迭代：&quot; + str(i))

if i % 40 == 39:
torch.save(net.state_dict(), &quot;model_save_cifar&quot;)

print(&quot;Finished epoch &quot; + str(epoch))

我使用的是 batch_size = 20, image_size = 32 (CIFAR-10)
loadBatch 函数返回 LongTensor 20x3x32x32 的元组（用于图像）和 LongTensor 20x1 的元组（用于标签）
如果您能帮助我或提出可能的解决方案，我将非常高兴（我猜是因为 NN 中的顺序模块，但我传递给优化器的参数似乎是正确的）]]></description>
      <guid>https://stackoverflow.com/questions/45359111/pytorch-model-is-not-training</guid>
      <pubDate>Thu, 27 Jul 2017 19:07:27 GMT</pubDate>
    </item>
    </channel>
</rss>