<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>æ ‡è®°ä¸ºæœºå™¨å­¦ä¹ çš„æ´»è·ƒé—®é¢˜ - Thinbug</title>
    <link>https://stackoverflow.com/questions/tagged/?tagnames=machine-learning&sort=active</link>
    <description>æ¥è‡ª stackoverflow.com çš„æœ€æ–° 30 ä¸ª</description>
    <lastBuildDate>Sun, 04 Feb 2024 09:13:16 GMT</lastBuildDate>
    <item>
      <title>ä¸ºä»€ä¹ˆæˆ‘å¾—åˆ°çš„æ˜¯ç©ºç™½å›¾ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/77935111/why-am-i-getting-a-blank-plot</link>
      <description><![CDATA[ç›®æ ‡æ˜¯å°†æ•°æ®ä¸ä¸ç”¨æˆ·è¾“å…¥çš„æœ€æ–°ä¿¡æ¯ç›¸åŒ¹é…çš„ç›¸åŒâ€œå®¢æˆ·ç¼–å·â€è¿›è¡Œæ¯”è¾ƒã€‚æˆ‘å¾—åˆ°äº†ä¸€ä¸ªç©ºç™½å›¾ã€‚
é‰´äºæˆ‘ä»¥è¿™ç§æ–¹å¼å‘ˆç°æ•°æ®ï¼š
å®¢æˆ·ç¼–å· |å®¢æˆ·ç±»å‹ |è®¢è´­æ—¶é—´ |è®¢å•é‡‘é¢ |è®¢å•æ•°é‡
120023 |éå¸¸è§„| 2023 å¹´ 1 æœˆ 25 æ—¥ 00:00:00 | 470.92 | 470.92 13
120023 |å¸¸è§„ |2023 å¹´ 1 æœˆ 25 æ—¥ 00:00:00 | 64.03 | 7
120024 |éå¸¸è§„| 2023 å¹´ 1 æœˆ 25 æ—¥ 00:00:00 | 143.18 | 143.18 3
120024 |å¸¸è§„ |2023 å¹´ 1 æœˆ 25 æ—¥ 00:00:00 | 143.18 | 143.18 3
120025 |éå¸¸è§„ |2023 å¹´ 1 æœˆ 25 æ—¥ 00:00:00 | 222.14 | 222.14 1
120025 |å¸¸è§„ |2023 å¹´ 1 æœˆ 25 æ—¥ 00:00:00 | 222.14 | 222.14 1
120006 |éå¸¸è§„ |2023 å¹´ 1 æœˆ 25 æ—¥ 00:00:00 | 157.18 | 157.18 5
120007 |éå¸¸è§„ |2023 å¹´ 1 æœˆ 25 æ—¥ 00:00:00 | 151.51 | 151.51 7
120008 |éå¸¸è§„ |2023 å¹´ 1 æœˆ 25 æ—¥ 00:00:00 | 99.7 | 99.7 7
119990 |éå¸¸è§„ |2023 å¹´ 1 æœˆ 25 æ—¥ 00:00:00 | 212.48 | 212.48 1
119991 |éå¸¸è§„ |2023 å¹´ 1 æœˆ 25 æ—¥ 00:00:00 | 96.53 | 3
119992 |éå¸¸è§„ |2023 å¹´ 1 æœˆ 25 æ—¥ 00:00:00 | 62.72 | 7
119993 |éå¸¸è§„ |2023 å¹´ 1 æœˆ 25 æ—¥ 00:00:00 | 87.89 | 7
119994 |éå¸¸è§„ |2023 å¹´ 1 æœˆ 25 æ—¥ 00:00:00 | 96.56 | 1
119995 |éå¸¸è§„ |2023 å¹´ 1 æœˆ 25 æ—¥ 00:00:00 | 95.44 | 1
119996 |éå¸¸è§„ |2023 å¹´ 1 æœˆ 25 æ—¥ 00:00:00 | 97.03 | 3

æˆ‘åˆ›å»ºäº†ä¸€ä¸ªä»£ç æ¥æŸ¥çœ‹æˆ‘æ”¶é›†çš„æ•°æ®ã€‚ç›®çš„æ˜¯å°†æ•°æ®ä¸ä¸ç”¨æˆ·è¾“å…¥çš„æœ€æ–°ä¿¡æ¯ç›¸åŒ¹é…çš„ç›¸åŒâ€œå®¢æˆ·ç¼–å·â€è¿›è¡Œæ¯”è¾ƒã€‚æ‚¨è¿˜å¯ä»¥çœ‹åˆ°ï¼Œå¯¹äºæ¥ä¸‹æ¥çš„ 2 è¡Œï¼Œå®ƒå…·æœ‰ç›¸åŒçš„â€œå®¢æˆ·ç¼–å·â€å‚æ•°ï¼Œä½†å®¢æˆ·ç±»å‹ä»‹äº Non-Regular å’Œ Regular ä¹‹é—´ï¼Œä»»åŠ¡æ˜¯å–è®¢å•é‡‘é¢å’Œè®¢å•æœ€ä½çš„è¡Œæ•°é‡ï¼Œå¹¶ä¸”æ•°æ®ç‚¹å°†ç»˜åˆ¶åœ¨ä¸€èµ·ã€‚
ä»è¿™é‡Œï¼Œæˆ‘æƒ³å•ç‹¬ç»˜åˆ¶å®¢æˆ·ç¼–å·çš„æ•°æ®ï¼Œy è½´æ˜¯â€œè®¢å•æ•°é‡â€å˜é‡ï¼Œx è½´æ˜¯â€œè®¢å•æ—¶é—´â€å˜é‡ã€‚ä¸ºä»€ä¹ˆå®ƒè¿”å›ä¸€ä¸ªç©ºå›¾ï¼Ÿæˆ‘è¯¥å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ
å®Œæ•´ä»£ç ï¼š
&lt;å‰&gt;&lt;ä»£ç &gt;
å°† pandas å¯¼å…¥ä¸º pd
å¯¼å…¥æ—¥æœŸæ—¶é—´
å¯¼å…¥ ipywidgets ä½œä¸ºå°éƒ¨ä»¶
å°† numpy å¯¼å…¥ä¸º np
å°† matplotlib.pyplot å¯¼å…¥ä¸º plt

df = pd.read_excel(&#39;FoodOrder.xlsx&#39;)

input_date = input(&quot;è¯·è¾“å…¥æ—¥æœŸï¼ˆæ ¼å¼ï¼šyyyy/mm/ddï¼‰ï¼š&quot;)
input_date = datetime.datetime.strptime(input_date, &quot;%Y/%m/%d&quot;)

df[&#39;è®¢å•æ—¶é—´&#39;] = pd.to_datetime(df[&#39;è®¢å•æ—¶é—´&#39;])

df[&#39;time_diff&#39;] = (df[&#39;è®¢å•æ—¶é—´&#39;] - input_date).dt.days

df_filtered = df[(df[&#39;time_diff&#39;] &gt;= -20) &amp; (df[&#39;time_diff&#39;] &lt;= 20)]


df_grouped = df_filtered.groupby(&#39;å®¢æˆ·ç¼–å·&#39;).apply(lambda x: x.loc[x[&#39;è®¢å•é‡‘é¢&#39;].idxmax()] if x[&#39;è®¢å•é‡‘é¢&#39;].max() &gt; x[&#39;è®¢å•æ•°é‡&#39;].max() else x.loc[x[&#39;è®¢å•æ•°é‡&#39;].idxmax()])


# é‡ç½®åˆ†ç»„æ•°æ®å¸§çš„ç´¢å¼•
df_grouped = df_grouped.reset_index(drop=True)


# å®šä¹‰ä¸€ä¸ªç»˜å›¾å‡½æ•°
defplot_customer(x):
    plt.plot(x[&#39;è®¢å•æ—¶é—´&#39;], x[&#39;è®¢å•é‡‘é¢&#39;])
    plt.xlabel(&#39;ä¸‹å•æ—¶é—´&#39;)
    plt.ylabel(&#39;è®¢å•é‡‘é¢&#39;)
    plt.title(&#39;å®¢æˆ·ç¼–å·çš„è®¢å•é‡‘é¢ä¸è®¢å•æ—¶é—´ï¼š&#39; + str(x[&#39;å®¢æˆ·ç¼–å·&#39;].iloc[0]))
    plt.gcf().autofmt_xdate()
    plt.ylim(0, x[&#39;è®¢å•é‡‘é¢&#39;].max() * 1.1)
    plt.show()

    plt.show()

# å°†ç»˜å›¾å‡½æ•°åº”ç”¨åˆ°æ¯ä¸ªç»„
df_grouped.groupby(&#39;å®¢æˆ·ç¼–å·&#39;).apply(plot_customer)

]]></description>
      <guid>https://stackoverflow.com/questions/77935111/why-am-i-getting-a-blank-plot</guid>
      <pubDate>Sun, 04 Feb 2024 08:55:45 GMT</pubDate>
    </item>
    <item>
      <title>ä½¿ç”¨ gopro è¿˜æ˜¯ç›¸æœºï¼Ÿä¸ºæˆ‘çš„æœºå™¨å­¦ä¹ é¡¹ç›®é€‰æ‹©æœ€å¥½çš„ç…§ç‰‡</title>
      <link>https://stackoverflow.com/questions/77934857/using-gopro-or-camera-choosing-the-best-photo-for-my-machine-learning-project</link>
      <description><![CDATA[æˆ‘ç›®å‰æ­£åœ¨åšä¸€ä¸ªæ¶‰åŠè®¡ç®—æœºè§†è§‰å’ŒPythonçš„é¡¹ç›®ã€‚åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘æ­£åœ¨å¤„ç†ç…§ç‰‡æ–‡ä»¶ï¼Œè€Œä¸æ˜¯è§†é¢‘ã€‚æˆ‘å°è¯•å°†ç½‘ç»œæ‘„åƒå¤´ä¸ OpenCV ç»“åˆä½¿ç”¨ï¼›è™½ç„¶è¿æ¥èµ·æ¥æ›´æ–¹ä¾¿ï¼Œä½†æ˜¯å¾—åˆ°çš„ç…§ç‰‡è´¨é‡è¾ƒä½ï¼Œè€Œæˆ‘éœ€è¦é«˜è´¨é‡çš„ç…§ç‰‡ã€‚
æˆ‘ç›®å‰æ­£åœ¨å°è¯•å°† GoPro Hero 12 è¿åŠ¨ç›¸æœºä¸ Open GoPro Python åº“ç»“åˆä½¿ç”¨ã€‚ä½†æ˜¯ï¼Œæˆ‘æ— æ³•å°†æ•è·çš„ç…§ç‰‡ç›´æ¥é›†æˆåˆ°æˆ‘çš„é¡¹ç›®æ–‡ä»¶å¤¹ä¸­ã€‚
æˆ‘æ­£åœ¨è€ƒè™‘ä½¿ç”¨ç´¢å°¼æˆ–ä½³èƒ½ç­‰æ•°ç å•åç›¸æœºã€‚æ‚¨èƒ½å¦ç¡®è®¤ä¸€ä¸‹è¿™äº› DSLR ç›¸æœºå’Œè®¡ç®—æœºä¹‹é—´çš„è¿æ¥ï¼ˆå°¤å…¶æ˜¯ä½¿ç”¨ Python æ—¶ï¼‰æ˜¯å¦ç®€å•ï¼Ÿ
æˆ‘å¯ä»¥è·å¾— go pro çš„æœ€ä½³æ›¿ä»£åº“ï¼Œæˆ–è€…æˆ‘å¯ä»¥è·å¾—æœ€å¥½çš„ç›¸æœºä»¥é›†æˆåˆ°æˆ‘çš„ç”µè„‘ä¸Š]]></description>
      <guid>https://stackoverflow.com/questions/77934857/using-gopro-or-camera-choosing-the-best-photo-for-my-machine-learning-project</guid>
      <pubDate>Sun, 04 Feb 2024 06:51:58 GMT</pubDate>
    </item>
    <item>
      <title>å¦‚ä½•åˆ†æä¸åŒç‰ˆæœ¬éšæœºæ£®æ—æ¨¡å‹ä¹‹é—´çš„é¢„æµ‹æ¦‚ç‡æ–¹å·®</title>
      <link>https://stackoverflow.com/questions/77934696/how-to-analyze-prediction-probability-variance-between-different-versions-of-ran</link>
      <description><![CDATA[æˆ‘æƒ³æ¯”è¾ƒéšæœºæ£®æ—æ¨¡å‹ï¼ˆåˆ†ç±»ï¼‰çš„ä¸¤ä¸ªä¸åŒç‰ˆæœ¬ç”Ÿæˆçš„é¢„æµ‹æ¦‚ç‡ï¼Œä»¥äº†è§£è¿™äº›ç‰ˆæœ¬ä¹‹é—´çš„é¢„æµ‹æ–¹å·®å¦‚ä½•å˜åŒ–ã€‚
æˆ‘åœ¨å›¾æ•°æ®é›†ä¸Šä½¿ç”¨ Python å’Œéšæœºæ£®æ—åˆ†ç±»ã€‚è¿™æ˜¯æˆ‘åˆ°ç›®å‰ä¸ºæ­¢æ‰€åšçš„ï¼š
name=[&#39;èè‰&#39;,&#39;çº¦ç¿°&#39;,&#39;äºšå½“&#39;,&#39;è¿ˆå…‹&#39;,&#39;å®‰å¨œ&#39;,&#39;å‰å§†&#39;,&#39;è‰å…¹&#39;,&#39;æ±¤å§†&#39;,&#39;è¿ªå¨œ&#39;,&#39;ä¼Šè±&#39;]
all_class = [é”®å¯¹é”®ï¼Œentity2id.items() ä¸­çš„å€¼]
match = [(str(class), str(name)) åç§°ä¸­çš„åç§° for all_class ä¸­çš„ç±»]
X = np.vstack([
    np.hstack([
        entity_embeddings_dict.get(str(class), np.zeros(node_embeddings.shape[1])),
        entity_embeddings_dict.get(str(name), np.zeros(node_embeddings.shape[1]))
    ]) å¯¹äºç­çº§ï¼ŒåŒ¹é…ä¸­çš„åç§°])

# é¢„æµ‹æ¦‚ç‡
ç»“æœ = RF_model.predict_proba(X)

æ‰“å°ï¼ˆç»“æœï¼‰ï¼š

&lt;è¡¨ç±»=â€œs-è¡¨â€&gt;
&lt;æ ‡é¢˜&gt;


å§“å
class_model1
tp_score_model1
class_model2
tp_score_model2


&lt;æ­£æ–‡&gt;

0
çº¦ç¿°
æ•°å­¦
0.996422
æ•°å­¦
0.996422


1
çº¦ç¿°
æ•°å­¦
0.996422
åŒ–å­¦
0.994451


2
çº¦ç¿°
æ•°å­¦
0.996422
è‰ºæœ¯
0.993411


3
çº¦ç¿°
æ•°å­¦
0.996422
ç”Ÿç‰©å­¦
0.992564


4
çº¦ç¿°
æ•°å­¦
0.996422
åŒ–å­¦
0.992404




æˆ‘å¸Œæœ›åˆ†æåŒä¸€æ•°æ®é›†çš„ä¸¤ä¸ªæ¨¡å‹ç‰ˆæœ¬ä¹‹é—´çš„é¢„æµ‹æ¦‚ç‡å·®å¼‚ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘æƒ³ï¼š

è®¡ç®—ä¸¤ä¸ªæ¨¡å‹ä¹‹é—´æ•°æ®é›†ä¸­æ¯ä¸ªå®ä¾‹çš„é¢„æµ‹æ¦‚ç‡å·®å¼‚ã€‚
å¯è§†åŒ–è¿™äº›å·®å¼‚ä»¥äº†è§£åˆ†å¸ƒå¹¶è¯†åˆ«ä»»ä½•æ¨¡å¼ã€‚

æœ‰äººå¯ä»¥æŒ‡å¯¼æˆ‘å¦‚ä½•æœ‰æ•ˆåœ°æ‰§è¡Œæ­¤åˆ†ææˆ–å»ºè®®ä»»ä½•éå¸¸é€‚åˆæ­¤ç±»åˆ†æçš„å·¥å…·/åº“å—ï¼Ÿ
ä»»ä½•å¸®åŠ©æˆ–æŒ‡ç¤ºå°†ä¸èƒœæ„Ÿæ¿€ï¼]]></description>
      <guid>https://stackoverflow.com/questions/77934696/how-to-analyze-prediction-probability-variance-between-different-versions-of-ran</guid>
      <pubDate>Sun, 04 Feb 2024 05:28:07 GMT</pubDate>
    </item>
    <item>
      <title>æ™ºèƒ½äº¤é€šç¯é¡¹ç›®[å…³é—­]</title>
      <link>https://stackoverflow.com/questions/77934633/project-smart-traffic-light</link>
      <description><![CDATA[å¸®åŠ©è€…æˆ‘åªæ˜¯ä¸€ä¸ªçƒ­å¿ƒçš„å­¦ç”Ÿï¼Œéœ€è¦å¸®åŠ©ã€‚æœ‰ä¸€å¤©ï¼Œæˆ‘èµ°åœ¨ç¹å¿™çš„é©¬è·¯ä¸Šï¼Œçªç„¶çœ‹åˆ°ä¸€è¾†æ ¡è½¦å µåœ¨è·¯ä¸Šï¼Œå› ä¸ºå½“æ—¶æ˜¯ä¸Šç­æ—¶é—´ï¼Œè·¯ä¸ŠæŒ¤æ»¡äº†äººã€‚æˆ‘åœ¨çªç„¶çš„åŠ¨ä½œä¸­æƒ³åˆ°äº†æ™ºèƒ½äº¤é€šç¯çš„æƒ³æ³•ï¼Œå®ƒä¼˜å…ˆè€ƒè™‘è½¦è¾†è€Œä¸æ˜¯è¿‡å»çš„å†³ç­–ï¼ˆæ•°æ®æ”¶é›†ï¼‰ï¼Œä¾‹å¦‚æ ¡è½¦åº”è¯¥ä¼˜å…ˆï¼ŒåŠå…¬æ—¶é—´çš„åŠå…¬è½¦è¾†å’Œç´§æ€¥è½¦è¾†åº”è¯¥ä¸€ç›´ä¼˜å…ˆã€‚
æ‰€ä»¥æˆ‘æƒ³çŸ¥é“å¦‚ä½•ä»¥åŠåœ¨å“ªé‡Œå¼€å§‹è¿™ä¸ªé¡¹ç›®çš„æƒ³æ³•ã€‚æˆ‘å¯¹ DSA æœ‰ä¸€äº›æŠŠæ¡ã€‚
ä½ ä»¬éƒ½å¯ä»¥å‘Šè¯‰æˆ‘å¼€å§‹å’Œå‰è¿›çš„æ­¥éª¤å—ï¼Ÿ
æˆ‘å°è¯•äº†å¾ˆå¤šäººå·¥æ™ºèƒ½å·¥å…·ï¼Œä½†æ‰¾ä¸åˆ°æ˜ç¡®çš„ç­”æ¡ˆä»å“ªé‡Œå¼€å§‹ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/77934633/project-smart-traffic-light</guid>
      <pubDate>Sun, 04 Feb 2024 04:50:45 GMT</pubDate>
    </item>
    <item>
      <title>ppo_trainer ç”Ÿæˆå’Œè®­ç»ƒæ­¥éª¤éå¸¸æ…¢</title>
      <link>https://stackoverflow.com/questions/77934581/ppo-trainer-generate-and-training-step-is-extremely-slow</link>
      <description><![CDATA[æˆ‘æ­£åœ¨è¿è¡Œå®Œå…¨æŒ‰ç…§æ­¤ Github å­˜å‚¨åº“ä¸­æ‰€ç¤ºçš„ä»£ç ï¼š  https://github.com/joeljang/RLPHF/blob/main/training/rlhf.py
å‡ºäºæŸç§åŸå› ï¼Œæ­¤ä»£ç å—ï¼š
æœ‰å…³æ­¥éª¤ï¼Œè¯·åœ¨ tqdm(enumerate(ppo_trainer.dataloader)) ä¸­è¿›è¡Œæ‰¹å¤„ç†ï¼š
    Question_tensors = æ‰¹å¤„ç†[â€œinput_idsâ€]
    å“åº”å¼ é‡ = ppo_trainer.generate(
        é—®é¢˜å¼ é‡ï¼Œ
        return_prompt=å‡ï¼Œ
        é•¿åº¦é‡‡æ ·å™¨=è¾“å‡ºé•¿åº¦é‡‡æ ·å™¨ï¼Œ
        ** Generation_kwargsï¼Œ
    ï¼‰
    æ‰¹å¤„ç†[â€œå“åº”â€] = tokenizer.batch_decode(response_tensors,skip_special_tokens=True)

    texts = [q + r for q, r in zip(batch[â€œqueryâ€], batch[â€œresponseâ€])]
    input_ids = tokenizer(æ–‡æœ¬, max_length=script_args.max_length ,return_tensors=â€œptâ€, padding=True, truncation=True).input_ids
    å¥–åŠ±è¾“å‡º = å¥–åŠ±æ¨¡å‹(input_ids = input_ids.to(reward_model.device))[0]
    å¥–åŠ± = [torch.tensor(output[0].float()) - script_args.reward_baseline ç”¨äºå¥–åŠ±è¾“å‡ºä¸­çš„è¾“å‡º]
    v_min, v_max, v_mean = get_reward_stats(å¥–åŠ±)
    # è¿è¡Œ PPO æ­¥éª¤
    stats = ppo_trainer.step(é—®é¢˜å¼ é‡ã€å“åº”å¼ é‡ã€å¥–åŠ±)

èŠ±è´¹äº†æé•¿çš„æ—¶é—´ï¼Œå°½ç®¡å®ƒä¸»è¦åªæ˜¯ï¼ˆ1ï¼‰ç”Ÿæˆï¼Œï¼ˆ2ï¼‰è·å¾—å¥–åŠ±ï¼Œä»¥åŠï¼ˆ3ï¼‰åå‘ä¼ æ’­ã€‚æˆ‘ä½¿ç”¨å•ä¸ª A100 80GB GPUï¼Œå•ä¸ªè®­ç»ƒæ­¥éª¤å¤§çº¦éœ€è¦ 15 åˆ†é’Ÿã€‚é‚£åº”è¯¥éœ€è¦å¤šé•¿æ—¶é—´ï¼Ÿæˆ‘è¿˜ä½¿ç”¨ .device æ£€æŸ¥äº†æ¨¡å‹ã€question_tensorsã€response_tensors å’Œå¥–åŠ±æ˜¯å¦éƒ½åœ¨ GPU ä¸Šã€‚æˆ‘æ³¨æ„åˆ° Question_tensors æ˜¯å¼ é‡çš„åˆ—è¡¨ï¼Œè€Œä¸æ˜¯å¼ é‡çš„å¼ é‡ã€‚ä½† ppo_trainer.generate ä¸æ¥å—å¼ é‡çš„å¼ é‡ä½œä¸ºè¾“å…¥æ•°æ®ç±»å‹ã€‚è¿™æ˜¯ Llama 7B å‹å·ã€‚
æœ‰äººçŸ¥é“ä¸ºä»€ä¹ˆè¦èŠ±è¿™ä¹ˆé•¿æ—¶é—´å—ï¼Ÿè°¢è°¢ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/77934581/ppo-trainer-generate-and-training-step-is-extremely-slow</guid>
      <pubDate>Sun, 04 Feb 2024 04:17:33 GMT</pubDate>
    </item>
    <item>
      <title>æˆ‘ä¸æ–­æ”¶åˆ° ValueError: æ•°ç»„é•¿åº¦ 2643 ä¸ç´¢å¼•é•¿åº¦ 3281 ä¸åŒ¹é…</title>
      <link>https://stackoverflow.com/questions/77933401/i-keep-getting-valueerror-array-length-2643-does-not-match-index-length-3281</link>
      <description><![CDATA[è¿™æ˜¯æˆ‘çš„ä»£ç ï¼š
# ç›®æ ‡åˆ—æˆ–æˆ‘çš„æ•°æ®é›†ä¸­çš„ AnyNan å€¼
Training_data.dropna(inplace=True, axis=0)
test_data.dropna(inplace=True, axis=0)

# åœ¨ HomePlanet ä¸Šæ‰§è¡Œä¸€æ¬¡çƒ­ç¼–ç ï¼Œ

åŠŸèƒ½ = [&#39;HomePlanet&#39;, &#39;ç›®çš„åœ°&#39;, &#39;CryoSleep&#39;, &#39;VIP&#39; ]
X= pd.get_dummies(training_data[features]).astype(int)
y = pd.get_dummies(training_data.Transported).astype(int)
x_test = æµ‹è¯•æ•°æ®[ç‰¹å¾]

# åˆ›å»ºæˆ‘çš„æ¨¡å‹

X_trainï¼ŒX_testï¼Œy_trainï¼Œy_test = train_test_splitï¼ˆXï¼Œyï¼Œtrain_size = 0.6ï¼Œtest_size = 0.4ï¼Œrandom_state = 42ï¼‰
rt_model = RandomForestRegressor()
rt_model.fit(X_train,y_train)
é¢„æµ‹ = rt_model.predict(X_test)

#ä¿å­˜csv

è¾“å‡º= pd.DataFrameï¼ˆ{&#39;PassengerId&#39;ï¼štesting_data.PassengerIdï¼Œ&#39;è¿è¾“&#39;ï¼šé¢„æµ‹}ï¼‰
output.to_csv(&#39;æäº¤.csv&#39;, index=False)
print(&quot;æ‚¨çš„æäº¤å·²æˆåŠŸä¿å­˜ï¼&quot;)

å½“æˆ‘åœ¨è®­ç»ƒæµ‹è¯•åˆ†å‰²åæ‰“å° X ã€ y å’Œ X_trainã€y_train çš„é•¿åº¦æ—¶å¾—åˆ°ï¼š
&lt;å‰&gt;&lt;ä»£ç &gt;6606 6606
3963 3963
2643 2643

æˆ‘å°è¯•é‡å¡‘ X å’Œ yã€‚
æˆ‘å°è¯•åœ¨æˆ‘çš„ x_test æ•°æ®å¸§ ä¸Šæ‰§è¡Œä¸€ç§çƒ­ç¼–ç ã€‚
æˆ‘åœ¨æ•°ç»„ä¸Šæ‰§è¡Œäº† iloc æ–¹æ³•ã€‚
é—®é¢˜ä»…æ¥è‡ªäºè¯•å›¾å°†å…¶ä¿å­˜ä¸º csv çš„æœ€åä¸€éƒ¨åˆ†ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/77933401/i-keep-getting-valueerror-array-length-2643-does-not-match-index-length-3281</guid>
      <pubDate>Sat, 03 Feb 2024 19:17:26 GMT</pubDate>
    </item>
    <item>
      <title>ç”¨äºå¤´å½±æµ‹é‡æ ‡å¿—æ£€æµ‹çš„éšæœºè£å‰ªæ•°æ®é¢„å¤„ç†</title>
      <link>https://stackoverflow.com/questions/77933062/random-crop-data-preprocessing-for-cephalometric-landmark-detection</link>
      <description><![CDATA[æˆ‘çš„ä»»åŠ¡æ˜¯å¤´å½±æµ‹é‡åœ°æ ‡å®šä½ã€‚æˆ‘çš„å›¾åƒè·¯å¾„çš„åæ ‡æ˜¾ç¤ºåœ¨æ­¤æ•°æ®æ¡†ä¸­ã€‚

&lt;è¡¨ç±»=â€œs-è¡¨â€&gt;
&lt;æ ‡é¢˜&gt;

æ–‡ä»¶å
X1
Y1


&lt;æ­£æ–‡&gt;

/Images_data/Img0006.png
89
80


/Images_data/Img0008.png
37
70


/Images_data/Img0007.png
50
76


/Images_data/Img0003.png
55
92


/Images_data/Img0005.png
91
64


/Images_data/Img0004.png
100
76




æˆ‘æƒ³åœ¨è®­ç»ƒå›¾ä¸­æ‰€ç¤ºçš„æ¨¡å‹ä¹‹å‰åœ¨æ•°æ®é¢„å¤„ç†æ­¥éª¤ä¸­ä½¿ç”¨éšæœºè£å‰ªã€‚
åœ¨æ­¤å¤„è¾“å…¥å›¾åƒæè¿°
æˆ‘å°è¯•ä½¿ç”¨éšæœºè£å‰ªæ¥æå– 10 ä¸ªå›¾åƒå—ã€‚
ä» PIL å¯¼å…¥å›¾åƒ
ä»éšæœºå¯¼å…¥ randrange

img = Image.open(r&quot;/Images_data/Img0006.png&quot;)
a, b = å›¾ç‰‡å¤§å°

çŸ©é˜µ = 250
æ ·æœ¬=10
æ ·æœ¬åˆ—è¡¨ = []

å¯¹äºèŒƒå›´å†…çš„ iï¼ˆæ ·æœ¬ï¼‰ï¼š
    a1 = randrange(0, a - çŸ©é˜µ)
    b1 = randrange(0, b - çŸ©é˜µ)
    Sample_list.append(img.crop((a1, b1, a1 + çŸ©é˜µ, b1 + çŸ©é˜µ)))

å¦‚ä½•å°†åæ ‡ä¸º x1,y1 çš„éšæœºè£å‰ªå›¾åƒå—æ”¾å…¥æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/77933062/random-crop-data-preprocessing-for-cephalometric-landmark-detection</guid>
      <pubDate>Sat, 03 Feb 2024 17:24:43 GMT</pubDate>
    </item>
    <item>
      <title>åœ¨ Rust-linfa ä¸­åŠ è½½ç”¨äºé¢„æµ‹çš„çº¿æ€§å›å½’æ¨¡å‹</title>
      <link>https://stackoverflow.com/questions/77932307/loading-a-linear-regression-model-back-up-for-prediction-in-rust-linfa</link>
      <description><![CDATA[æˆ‘ä¸€ç›´åœ¨ç ”ç©¶ Rust æœºå™¨å­¦ä¹ çš„ linfaï¼Œç‰¹åˆ«æ˜¯çº¿æ€§å›å½’æ¨¡å‹ã€‚æˆ‘å¸Œæœ›èƒ½å¤Ÿä¿å­˜å’ŒåŠ è½½ç»è¿‡è®­ç»ƒçš„çº¿æ€§å›å½’æ¨¡å‹ï¼Œä½†æˆ‘æ— æ³•æ‰¾åˆ°å®ç°æ­¤ç›®çš„çš„æ–¹æ³•ã€‚
æ–¹æ³• 1ï¼š
åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘çš„æ–¹æ³•æ˜¯è·å–è®­ç»ƒä¸­æ¶‰åŠçš„ä¸»è¦å‚æ•°ï¼Œè¿™äº›å‚æ•°å¯ä»¥ä» linfa çš„çº¿æ€§å›å½’å®ç°ä¸­è·å–ï¼Œå¹¶å°†å®ƒä»¬å­˜å‚¨åœ¨ä¸€ä¸ªå¯ä»¥å­˜å‚¨ä¸º JSON æ–‡ä»¶çš„ç»“æ„ä¸­ï¼ˆé€šè¿‡ serde_json å®Œæˆï¼‰ã€‚ç„¶è€Œï¼Œåœ¨æ­¤ä¹‹åæˆ‘ä¸çŸ¥é“å¦‚ä½•å°†å…¶åŠ è½½å›æ¥è¿›è¡Œè®­ç»ƒã€‚
ä»¥ä¸Šå†…å®¹è¯¦æƒ…å¦‚ä¸‹ï¼š
å­˜å‚¨è®­ç»ƒå‚æ•°çš„ç»“æ„ï¼š
struct ModelJson {
    ç³»æ•°ï¼šVec f64 ï¼Œ
    æ‹¦æˆªï¼šf64ï¼Œ
}

å­˜å‚¨è¿‡ç¨‹ï¼š
let model = lin_reg.fit(&amp;dataset)?;
è®© model_json = ModelJson {
    ç³»æ•°ï¼š model.params().to_vec(),
    æ‹¦æˆªï¼š model.intercept(),
};

å­˜å‚¨çš„æ•°æ®çœ‹èµ·æ¥å¦‚ä½•ï¼š
{â€œç³»æ•°â€:[-0.00017907873576254802,-0.00100659702068151,-0.0008275037845519519,0.0004613216043979551,0.00103006349345 99436]ï¼Œâ€œæ‹¦æˆªâ€ï¼š50.525680622870084}

æ–¹æ³• 2ï¼š
å…³äºåºåˆ—åŒ–å’Œååºåˆ—åŒ–æ•´ä¸ªæ¨¡å‹ï¼Œæˆ‘å‘ç°ä»¥ä¸‹ä¿¡æ¯è¡¨æ˜ linfa ä¸­æ”¯æŒç›¸åŒçš„æ“ä½œã€‚
åŠ è½½å’Œä¿å­˜æ¨¡å‹
è¿™å¼•å‡ºäº†æˆ‘çš„ç¬¬äºŒç§æ–¹æ³•ï¼Œå…¶ä¸­æˆ‘ä½¿ç”¨äº† linfa-linear çš„ serde åŠŸèƒ½ï¼ˆåŒ…å« LinearRegression æ¨¡å‹ï¼‰ï¼Œé¦–å…ˆåœ¨æˆ‘çš„ Cargo.toml ä¸­åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š
linfa-clustering = {version=&quot;0.7.0&quot;, features=[&quot;serde&quot;]}
æ ¹æ®æˆ‘å¯¹å®ç°çš„ç†è§£ï¼Œæ­¤åŠŸèƒ½ä¸º LinearRegression å®ç°äº†ä»¥ä¸‹åŠŸèƒ½ï¼š
Serde åºåˆ—åŒ–å’Œååºåˆ—åŒ–å®ç° - æ´¾ç”Ÿ
ä¸Šè¿°å®ç°ï¼š
&lt;å‰&gt;&lt;ä»£ç &gt;#[cfg_attr(
    ç‰¹å¾=â€œserdeâ€ï¼Œ
    æ´¾ç”Ÿï¼ˆåºåˆ—åŒ–ï¼Œååºåˆ—åŒ–ï¼‰ï¼Œ
    serde(crate = â€œserde_crateâ€)
)]
/// å¯ç”¨äºè¿›è¡Œé¢„æµ‹çš„æ‹Ÿåˆçº¿æ€§å›å½’æ¨¡å‹ã€‚
pub struct FittedLinearRegression; {
    æˆªè·ï¼šFï¼Œ
    å‚æ•°ï¼šArray1,
}

å‘ç°äºï¼š linfa-çº¿æ€§å¯¼å‡ºå®ç°
æˆ‘çš„å®ç°å¦‚ä¸‹ï¼š
let model = lin_reg.fit(&amp;dataset)?;
è®©åºåˆ—åŒ– = serde_json::to_string(&amp;model).unwrap();

ä½†æ˜¯æ­¤æ–¹æ³•å‡ºç°ä»¥ä¸‹é”™è¯¯ï¼š
ä¸æ»¡è¶³ç‰¹å¾è¾¹ç•Œ `FittedLinearRegression: serde::ser::Serialize`
ä»¥ä¸‹å…¶ä»–ç±»å‹å®ç°äº†ç‰¹å¾ `serde::ser::Serialize`ï¼š
  å¸ƒå°”å€¼
  å­—ç¬¦
  å¤§å°
  i8
  i16
  i32
  i64
  i128
å’Œå…¶ä»– 133 ä¸ªrustcClick ä»¥è·å–å®Œæ•´çš„ç¼–è¯‘å™¨è¯Šæ–­
main.rs(82, 22)ï¼šæ­¤è°ƒç”¨å¼•å…¥çš„ç»‘å®šæ‰€éœ€

æ˜¯å¦æœ‰å…¶ä»–æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ–è€…æ˜¯å¦æœ‰æŸç§æ–¹æ³•å¯ä»¥ä½¿è¿™äº›æ–¹æ³•ä¹‹ä¸€å‘æŒ¥ä½œç”¨ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/77932307/loading-a-linear-regression-model-back-up-for-prediction-in-rust-linfa</guid>
      <pubDate>Sat, 03 Feb 2024 13:44:24 GMT</pubDate>
    </item>
    <item>
      <title>ç”¨äºæœºå™¨å­¦ä¹ çš„æ•°æ®é›†ï¼Œè‡³å°‘åŒ…å« 100 åˆ—å’Œ 10,000 ä¸ªåŸå§‹æ•°æ® [å·²å…³é—­]</title>
      <link>https://stackoverflow.com/questions/77931469/data-set-for-machine-learning-with-minimum-100-columns-and-10-000-raws</link>
      <description><![CDATA[æˆ‘æƒ³è¦ä¸€ä¸ªè‡³å°‘åŒ…å« 100 åˆ—å’Œ 10000 è¡Œçš„æ•°æ®é›†ã€‚æ‚¨ä¸èƒ½ä½¿ç”¨ä»»ä½•ç¼–ç¨‹è¯­è¨€æ¥ç”Ÿæˆå®ƒï¼Œå› ä¸ºå®ƒå°†ç”¨äºæœºå™¨å­¦ä¹ å®è·µ
æå‰æ„Ÿè°¢æ‚¨çš„å¸®åŠ©ğŸ™]]></description>
      <guid>https://stackoverflow.com/questions/77931469/data-set-for-machine-learning-with-minimum-100-columns-and-10-000-raws</guid>
      <pubDate>Sat, 03 Feb 2024 09:03:55 GMT</pubDate>
    </item>
    <item>
      <title>åœ¨å…¶ä»–å±‚è€Œä¸æ˜¯ç¬¬ä¸€å±‚ä½¿ç”¨ BatchNorm2d çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/77931391/what-is-the-purpose-of-using-batchnorm2d-in-the-other-layers-but-not-in-first</link>
      <description><![CDATA[æˆ‘æ­£åœ¨è®¾è®¡Discriminatorç±»ï¼Œæˆ‘åœ¨githubä¸Šçœ‹åˆ°æœ‰äººçš„å®ç°ï¼Œæˆ‘æ— æ³•å‘è‡ªå·±è§£é‡Šä¸ºä»€ä¹ˆbatchnormalizationè¢«ç”¨åœ¨conv2ï¼Œconv3ä¸­ï¼Œä½†ç‰¹åˆ«æ˜¯åœ¨ç¬¬ä¸€ä¸ªå·ç§¯å±‚ä¸­æ²¡æœ‰ï¼Œæˆ‘ä¸ºæ‚¨æä¾›äº†ä»£ç ç±»è¿˜æœ‰è½¬æ¢å‡½æ•°
ç±»é‰´åˆ«å™¨ï¼ˆnn.Moduleï¼‰ï¼š
    def __init__(self, conv_dim = 32):
        super(é‰´åˆ«å™¨, self).__init__()

        self.conv_dim = conv_dim
        
        self.conv1 = conv(
            3ã€conv_dimã€4ã€batch_norm = False
        ï¼‰
        self.conv2 = conv(
            è½¬æ¢äº®åº¦, è½¬æ¢äº®åº¦ * 2, 4
        ï¼‰
        self.conv3 = conv(
            è½¬æ¢äº®åº¦ * 2, è½¬æ¢äº®åº¦ * 4, 4
        ï¼‰
        self.fc = nn.Linear(
            å·ç§¯æš—åº¦ * 4 * 4 * 4, 1
        ï¼‰
    def å‰å‘ï¼ˆè‡ªèº«ï¼Œxï¼‰ï¼š
        leaky_relu = F.leaky_relu
        è¾“å‡º=leaky_reluï¼ˆ
            è‡ªè½¬æ¢1(x), 0.2
        ï¼‰
        è¾“å‡º=leaky_reluï¼ˆ
            self.conv2(è¾“å‡º), 0.2
        ï¼‰
        è¾“å‡º=leaky_reluï¼ˆ
            self.conv3(è¾“å‡º), 0.2
        ï¼‰
        è¾“å‡º = out.view(-1, self.conv_dim * 4 * 4 * 4)
        è¾“å‡º = self.fc(è¾“å‡º)
        è¿”å›

æˆ‘å°è¯•è¯¢é—® ChatGPTï¼Œä½†å®ƒæ²¡æœ‰ç»™å‡ºä¸€è‡´çš„ç­”æ¡ˆ]]></description>
      <guid>https://stackoverflow.com/questions/77931391/what-is-the-purpose-of-using-batchnorm2d-in-the-other-layers-but-not-in-first</guid>
      <pubDate>Sat, 03 Feb 2024 08:35:38 GMT</pubDate>
    </item>
    <item>
      <title>è¿™ä¸ªelasticsearchè®¾ç½®æ˜¯å¦ä½¿ç”¨MLèŠ‚ç‚¹ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/77923033/does-this-elasticsearch-setup-even-use-ml-node</link>
      <description><![CDATA[æˆ‘æŒ‰ç…§ä»¥ä¸‹ç¤ºä¾‹è®¾ç½®äº†ç”¨äºå›¾åƒç›¸ä¼¼æ€§æœç´¢çš„ Elasticsearch é›†ç¾¤ï¼šhttps ://github.com/radoondas/flask-elastic-image-search
ç”±äºä¸ç†Ÿæ‚‰elasticsearchï¼Œæˆ‘ç›²ç›®åœ°éµå¾ªäº†è¿™ä¸ªç¤ºä¾‹ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸€ä¸ªå¸¦æœ‰é¢„è®­ç»ƒæ¨¡å‹çš„ ML èŠ‚ç‚¹ã€‚æ•ˆæœå¾ˆå¥½ã€‚ä½†æ˜¯ï¼Œæˆ‘æ€€ç–‘æˆ‘ä»¬å®é™…ä¸Šå¹¶æ²¡æœ‰ä½¿ç”¨ ML èŠ‚ç‚¹ã€‚
æˆ‘åœ¨åº”ç”¨ç¨‹åºä¸­æå–å¯†é›†å‘é‡ï¼Œç„¶åå¯¹å®ƒä»¬è¿›è¡Œç´¢å¼•ï¼Œå¹¶ä¸”åœ¨æŸ¥è¯¢æ—¶ä¹Ÿåœ¨åº”ç”¨ç¨‹åºä¸­æå–å‘é‡ã€‚æˆ‘ä¸ä½¿ç”¨elasticsearchæ¥æå–å¯†é›†å‘é‡ã€‚
æœ‰ä»€ä¹ˆâ€œé­”æ³•â€å—ï¼Ÿå½“æˆ‘ç´¢å¼•å¯†é›†å‘é‡æˆ–æ‰§è¡Œ KNN æŸ¥è¯¢æ—¶ï¼Œè¿™ä½¿å¾— Elasticsearch åœ¨å¹•åä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹ï¼Ÿæˆ–è€…é¢„è®­ç»ƒæ¨¡å‹å’Œæœºå™¨å­¦ä¹ èŠ‚ç‚¹éƒ½æ˜¯æˆ‘ä»¬åœ¨å®ç°ä¸­ä¸éœ€è¦çš„é¢å¤–ä¸œè¥¿ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/77923033/does-this-elasticsearch-setup-even-use-ml-node</guid>
      <pubDate>Thu, 01 Feb 2024 20:00:42 GMT</pubDate>
    </item>
    <item>
      <title>æ—¶é—´åºåˆ—é¢„æµ‹è®¿é—®æ—¥æœŸä¸å®¢æˆ·ç±»åˆ«å›¾ä¸å‡†ç¡®</title>
      <link>https://stackoverflow.com/questions/77912045/time-series-forecasting-visit-dates-with-customer-classes-graph-not-accurate</link>
      <description><![CDATA[æˆ‘æ­£åœ¨å°è¯•å¯¹ä¸€å †ç±»å’Œæ—¥æœŸæ—¶é—´è¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹ï¼Œä½†ç”±äºæŸç§åŸå› æˆ‘çš„å›¾è¡¨çœ‹èµ·æ¥åƒè¿™æ ·ï¼Œæˆ‘çš„å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š
ä» google.colab å¯¼å…¥é©±åŠ¨å™¨
drive.mount(&#39;/content/gdrive&#39;,force_remount = True)

å°† pandas å¯¼å…¥ä¸º pd
ä» sklearn.model_selection å¯¼å…¥ train_test_split
ä» sklearn.ensemble å¯¼å…¥ RandomForestRegressor
ä» sklearn.metrics å¯¼å…¥mean_squared_error
å°† matplotlib.pyplot å¯¼å…¥ä¸º plt

data = pd.read_csv(&#39;gdrive/My Drive/Colab_Notebooks/classproject/classdata.csv&#39;, parse_dates=[&#39;time_date&#39;], index_col=&#39;time_date&#39;)
ç±»id = æ•°æ®[&#39;ç±»id&#39;]
æ—¶é—´æ—¥æœŸ = æ•°æ®.ç´¢å¼•.æ—¥æœŸ
æ•°æ®[&#39;æ—¥æœŸ&#39;] = data.index.æ—¥æœŸ

ç±»id = æ•°æ®[&#39;ç±»id&#39;]
time_date = data.index.to_series()
m1 = class_id.ne(class_id.shift())
m2 = time_date.dt.date.ne(time_date.dt.date.shift())
data[&#39;count&#39;] = data.groupby((m1 | m2).cumsum()).cumcount().add(1).values

out = data[data.groupby(data.index.date).transform(&#39;size&#39;).gt(1)]

!pip å®‰è£… pandas-datareader

å°† pandas_datareader.data ä½œä¸º web å¯¼å…¥
å¯¼å…¥æ—¥æœŸæ—¶é—´

å°† pandas å¯¼å…¥ä¸º pd
pd.set_option(&#39;display.max_columns&#39;, None)
pd.set_option(&#39;display.max_rows&#39;, None)

å°† matplotlib.pyplot å¯¼å…¥ä¸º plt
å°†seabornå¯¼å…¥ä¸ºsns

sns.set()

plt.ylabel(&#39;ç±»åˆ«æ•°é‡&#39;)
plt.xlabel(&#39;æ—¥æœŸ&#39;)
plt.xticksï¼ˆæ—‹è½¬=45ï¼‰

out.index = pd.to_datetime(out[&#39;date&#39;], format=&#39;%Y-%m-%d&#39;)
plt.plot(out.index, out[&#39;count&#39;], )



è€Œæˆ‘ä»å…¶ä¸­è·å–æ­¤æ—¶é—´åºåˆ—ä»£ç çš„åšå®¢æœ‰è¿™æ ·çš„ç»“æœ

æ‰€ä»¥æˆ‘ä¸ç¡®å®šæ˜¯å¦åº”è¯¥ç»§ç»­XD
æˆ‘çš„è¾“å…¥æ•°æ®æ˜¯è¿™æ ·çš„ï¼š
æ—¶é—´æˆ³/class_id
2021-09-27 06:00:00 / A
2021-09-27 03:00:00 / A
2021-09-27 01:00:00 / A
2021-09-27 08:29:00 / C
2021-05-23 08:08:49 / B
2021-05-23 03:21:49 / B
2021-05-23 01:22:11 / C
å¤„ç†å®ƒå¹¶æ·»åŠ è®¡æ•°å’Œæ—¥æœŸåˆ—åï¼š
è®¡æ•°/æ—¶é—´æˆ³/class_id/æ—¥æœŸ
1 / 2021-09-27 06:00:00 / A / 2021-09-27
2 / 2021-09-27 03:00:00 / A / 2021-09-27
3 / 2021-09-27 01:00:00 / A / 2021-09-27
1 / 2021-09-27 08:29:00 / C / 2021-09-27
1 / 2021-05-23 08:08:49 / B / 2021-05-23
2 / 2021-05-23 03:21:49 / B / 2021-05-23
1 / 2021-05-23 01:22:11 / C / 2021-05-23]]></description>
      <guid>https://stackoverflow.com/questions/77912045/time-series-forecasting-visit-dates-with-customer-classes-graph-not-accurate</guid>
      <pubDate>Wed, 31 Jan 2024 09:09:33 GMT</pubDate>
    </item>
    <item>
      <title>å°† YOLOv8 é›†æˆåˆ° Transformer æ¨¡å‹ä¸­</title>
      <link>https://stackoverflow.com/questions/77897573/integrating-yolov8-to-an-transformer-model</link>
      <description><![CDATA[æˆ‘éœ€è¦å¸®åŠ©å°† YOLOv8 æ¨¡å‹ æ·»åŠ åˆ°ä¸‹é¢çš„ä»£ç ä¸­ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ InceptionV3ä¸ºæˆ‘çš„é¡¹ç›®æå–å›¾åƒç‰¹å¾ã€‚æˆ‘éœ€è¦ä¼ é€’æ£€æµ‹åˆ°çš„å¯¹è±¡å¹¶ä» YOLOv8 æ¨¡å‹ä¸­æå–ç‰¹å¾ï¼Œä»¥ä½¿ç”¨è½¬æ¢å™¨ç”Ÿæˆæ ‡é¢˜ã€‚
def CNN_Encoder_Incep():
    inception_v3 = tf.keras.applications.InceptionV3(
        include_top=å‡ï¼Œ
        æƒé‡=&#39;imagenet&#39;
    ï¼‰
    inception_v3.trainable = False

    è¾“å‡º= inception_v3.output
    è¾“å‡º = tf.keras.layers.Reshape(
        (-1, è¾“å‡º.å½¢çŠ¶[-1]))(è¾“å‡º)

    cnn_model = tf.keras.models.Model(inception_v3.è¾“å…¥ï¼Œè¾“å‡º)
    è¿”å›cnn_model

ç±» ImageCaptioningModel(tf.keras.Model):

    def __init__(self, cnn_model, ç¼–ç å™¨, è§£ç å™¨, image_aug=None):
        è¶…çº§().__init__()
        self.cnn_model = cnn_model
        self.encoder = ç¼–ç å™¨
        self.decoder = è§£ç å™¨
        self.image_aug = image_aug
        self.loss_tracker = tf.keras.metrics.Mean(name=&quot;loss&quot;)
        self.acc_tracker = tf.keras.metrics.Mean(name=&quot;å‡†ç¡®åº¦&quot;)


    defcalculate_loss(self, y_true, y_pred, mask):
        æŸå¤± = self.loss(y_true, y_pred)
        mask = tf.cast(mask, dtype=loss.dtype)
        æŸå¤±*=æ©æ¨¡
        è¿”å› tf.reduce_sum(loss) / tf.reduce_sum(mask)


    defcalculate_accuracy(self, y_true, y_pred, mask):
        ç²¾åº¦ = tf.equal(y_true, tf.argmax(y_pred, axis=2))
        å‡†ç¡®åº¦ = tf.math.logic_and(æ©ç , å‡†ç¡®åº¦)
        å‡†ç¡®åº¦ = tf.cast(å‡†ç¡®åº¦, dtype=tf.float32)
        æ©ç  = tf.cast(æ©ç , dtype=tf.float32)
        è¿”å› tf.reduce_sum(accuracy) / tf.reduce_sum(mask)


    defcompute_loss_and_acc(self,img_embed,captions,training=True):
        ç¼–ç å™¨è¾“å‡º = self.encoder(img_embed, è®­ç»ƒ=True)
        y_input = æ ‡é¢˜[:, :-1]
        y_true = æ ‡é¢˜[:, 1:]
        æ©ç =ï¼ˆy_trueï¼= 0ï¼‰
        y_pred = self.è§£ç å™¨ï¼ˆ
            y_è¾“å…¥ï¼Œç¼–ç å™¨_è¾“å‡ºï¼Œè®­ç»ƒ=çœŸï¼Œæ©ç =æ©ç 
        ï¼‰
        æŸå¤± = self.calculate_loss(y_true, y_pred, mask)
        acc = self.calculate_accuracy(y_true, y_pred, mask)
        å›æ³¢æŸè€—ï¼ŒACC


    def train_step(è‡ªèº«, æ‰¹æ¬¡):
        imgsã€å­—å¹• = æ‰¹å¤„ç†

        å¦‚æœ self.image_augï¼š
            imgs = self.image_aug(imgs)

        img_embed = self.cnn_model(imgs)

        ä½¿ç”¨ tf.GradientTape() ä½œä¸ºç£å¸¦ï¼š
            æŸå¤±ï¼Œacc = self.compute_loss_and_acc(
                img_embedã€å­—å¹•
            ï¼‰

        è®­ç»ƒå˜é‡ = (
            self.encoder.trainable_variables + self.decoder.trainable_variables
        ï¼‰
        grads = Tape.gradient(æŸå¤±, train_vars)
        self.optimizer.apply_gradients(zip(grads, train_vars))
        self.loss_tracker.update_state(æŸå¤±)
        self.acc_tracker.update_state(acc)

        return {â€œlossâ€ï¼šself.loss_tracker.result()ï¼Œâ€œaccâ€ï¼šself.acc_tracker.result()}


    def test_stepï¼ˆè‡ªèº«ï¼Œæ‰¹æ¬¡ï¼‰ï¼š
        imgsã€å­—å¹• = æ‰¹å¤„ç†

        img_embed = self.cnn_model(imgs)

        æŸå¤±ï¼Œacc = self.compute_loss_and_acc(
            img_embedã€å­—å¹•ã€è®­ç»ƒ=False
        ï¼‰

        self.loss_tracker.update_state(æŸå¤±)
        self.acc_tracker.update_state(acc)

        return {â€œlossâ€ï¼šself.loss_tracker.result()ï¼Œâ€œaccâ€ï¼šself.acc_tracker.result()}

    @è´¢äº§
    å®šä¹‰æŒ‡æ ‡ï¼ˆè‡ªèº«ï¼‰ï¼š
        è¿”å› [self.loss_tracker, self.acc_tracker]

cnn_model = CNN_Encoder_Incep()
æ ‡é¢˜æ¨¡å‹ = ImageCaptioningModel(
    cnn_model=cnn_modelï¼Œç¼–ç å™¨=ç¼–ç å™¨ï¼Œè§£ç å™¨=è§£ç å™¨ï¼Œimage_aug=å›¾åƒå¢å¼ºï¼Œ
ï¼‰

æˆ‘å°è¯•è¿™æ ·åšï¼Œä½†å½“æˆ‘å°è¯•å°†å…¶ä¼ é€’ç»™ cnn_model å˜é‡æ—¶ï¼Œæˆ‘ä¸æ–­æ”¶åˆ°å¤šä¸ªé”™è¯¯ã€‚
def CNN_Encoder():
    yolov8_model = tf.keras.models.load_model(&#39;./content/yolov8n_objdet_oidv7_640x640.pt&#39;)
    yolov8_model.trainable = False
    è¾“å‡º = yolov8_model.output
    è¾“å‡º = tf.keras.layers.Reshape((-1, è¾“å‡º.shape[-1]))(è¾“å‡º)
    cnn_model = tf.keras.models.Model(yolov8_model.è¾“å…¥ï¼Œè¾“å‡º)
    cnn_model_onnx = cnn_model.export(format=&#39;onnx&#39;)
    è¿”å›cnn_model
]]></description>
      <guid>https://stackoverflow.com/questions/77897573/integrating-yolov8-to-an-transformer-model</guid>
      <pubDate>Mon, 29 Jan 2024 05:22:01 GMT</pubDate>
    </item>
    <item>
      <title>XGBoost ç”¨äºå¤šæ ‡ç­¾åˆ†ç±»ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/40916939/xgboost-for-multilabel-classification</link>
      <description><![CDATA[æ˜¯å¦å¯ä»¥ä½¿ç”¨XGBoostè¿›è¡Œå¤šæ ‡ç­¾åˆ†ç±»ï¼Ÿç°åœ¨ï¼Œæˆ‘ä½¿ç”¨ OneVsRestClassifier è€Œä¸æ˜¯ sklearn ä¸­çš„ GradientBoostingClassifierã€‚å®ƒå¯ä»¥å·¥ä½œï¼Œä½†åªä½¿ç”¨æˆ‘çš„ CPU çš„ä¸€ä¸ªæ ¸å¿ƒã€‚åœ¨æˆ‘çš„æ•°æ®ä¸­ï¼Œæˆ‘æœ‰å¤§çº¦ 45 ä¸ªç‰¹å¾ï¼Œä»»åŠ¡æ˜¯ç”¨äºŒè¿›åˆ¶ï¼ˆå¸ƒå°”ï¼‰æ•°æ®é¢„æµ‹å¤§çº¦ 20 åˆ—ã€‚æŒ‡æ ‡æ˜¯å¹³å‡ç²¾åº¦ (map@7)ã€‚å¦‚æœæ‚¨æœ‰ä¸€ä¸ªç®€çŸ­çš„ä»£ç ç¤ºä¾‹å¯ä¾›åˆ†äº«ï¼Œé‚£å°±å¤ªå¥½äº†ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/40916939/xgboost-for-multilabel-classification</guid>
      <pubDate>Thu, 01 Dec 2016 17:33:32 GMT</pubDate>
    </item>
    <item>
      <title>å¦‚ä½•è·å– Tensorflow å¼ é‡å°ºå¯¸ï¼ˆå½¢çŠ¶ï¼‰ä½œä¸º int å€¼ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/40666316/how-to-get-tensorflow-tensor-dimensions-shape-as-int-values</link>
      <description><![CDATA[å‡è®¾æˆ‘æœ‰ä¸€ä¸ª Tensorflow å¼ é‡ã€‚å¦‚ä½•è·å–å¼ é‡çš„å°ºå¯¸ï¼ˆå½¢çŠ¶ï¼‰ä½œä¸ºæ•´æ•°å€¼ï¼Ÿæˆ‘çŸ¥é“æœ‰ä¸¤ç§æ–¹æ³•ï¼Œtensor.get_shape()å’Œtf.shape(tensor)ï¼Œä½†æˆ‘æ— æ³•è·å–æ•´æ•°int32&lt;çš„å½¢çŠ¶å€¼/code&gt; å€¼ã€‚
ä¾‹å¦‚ï¼Œä¸‹é¢æˆ‘åˆ›å»ºäº†ä¸€ä¸ªäºŒç»´å¼ é‡ï¼Œæˆ‘éœ€è¦è·å– int32 çš„è¡Œæ•°å’Œåˆ—æ•°ï¼Œä»¥ä¾¿æˆ‘å¯ä»¥è°ƒç”¨ reshape() åˆ›å»ºå½¢çŠ¶ä¸º (num_rows * num_cols, 1) çš„å¼ é‡ã€‚ä½†æ˜¯ï¼Œtensor.get_shape() æ–¹æ³•ä»¥ Dimension ç±»å‹è¿”å›å€¼ï¼Œè€Œä¸æ˜¯ int32ã€‚
å¯¼å…¥tensorflowä¸ºtf
å°† numpy å¯¼å…¥ä¸º np

sess = tf.Session()
å¼ é‡ = tf.convert_to_tensor(np.array([[1001,1002,1003],[3,4,5]]), dtype=tf.float32)

sess.runï¼ˆå¼ é‡ï¼‰
# æ•°ç»„([[ 1001., 1002., 1003.],
# [ 3., 4., 5.]], dtype=float32)

å¼ é‡å½¢çŠ¶ = å¼ é‡.get_shape()
å¼ é‡å½¢çŠ¶
# TensorShape([ç»´åº¦(2), ç»´åº¦(3)])
æ‰“å°å¼ é‡å½¢çŠ¶
# (2, 3)

num_rows = å¼ é‡_å½¢çŠ¶[0] # ???
num_cols = å¼ é‡_å½¢çŠ¶[1] # ???

å¼ é‡2 = tf.reshape(å¼ é‡, (num_rows*num_cols, 1))
# å›æº¯ï¼ˆæœ€è¿‘ä¸€æ¬¡è°ƒç”¨æœ€åä¸€æ¬¡ï¼‰ï¼š
# æ–‡ä»¶â€œâ€ï¼Œç¬¬ 1 è¡Œï¼Œåœ¨  ä¸­
# æ–‡ä»¶â€œ/usr/local/lib/python2.7/site-packages/tensorflow/python/ops/gen_array_ops.pyâ€ï¼Œç¬¬ 1750 è¡Œï¼Œé‡å¡‘
# åå­—=åå­—ï¼‰
# æ–‡ä»¶â€œ/usr/local/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.pyâ€ï¼Œç¬¬ 454 è¡Œï¼Œåœ¨ apply_op ä¸­
# as_ref=input_arg.is_ref)
# æ–‡ä»¶â€œ/usr/local/lib/python2.7/site-packages/tensorflow/python/framework/ops.pyâ€ï¼Œç¬¬ 621 è¡Œï¼Œconvert_to_tensor
# ret = conversion_func(å€¼, dtype=dtype, name=name, as_ref=as_ref)
# æ–‡ä»¶â€œ/usr/local/lib/python2.7/site-packages/tensorflow/python/framework/constant_op.pyâ€ï¼Œç¬¬ 180 è¡Œï¼Œåœ¨ _constant_tensor_conversion_function ä¸­
# è¿”å›å¸¸é‡(v, dtype=dtype, name=name)
# æ–‡ä»¶â€œ/usr/local/lib/python2.7/site-packages/tensorflow/python/framework/constant_op.pyâ€ï¼Œç¬¬ 163 è¡Œï¼Œå¸¸é‡ä¸­
#tensor_util.make_tensor_proto(å€¼, dtype=dtype, shape=shape))
# æ–‡ä»¶â€œ/usr/local/lib/python2.7/site-packages/tensorflow/python/framework/tensor_util.pyâ€ï¼Œç¬¬ 353 è¡Œï¼Œåœ¨ make_tensor_proto ä¸­
# _AssertCompatible(å€¼, dtype)
# æ–‡ä»¶â€œ/usr/local/lib/python2.7/site-packages/tensorflow/python/framework/tensor_util.pyâ€ï¼Œç¬¬ 290 è¡Œï¼Œåœ¨ _AssertCompatible ä¸­
# (dtype.name, repr(ä¸åŒ¹é…), ç±»å‹(ä¸åŒ¹é…).__name__))
# TypeError: åº”ä¸º int32ï¼Œå´å¾—åˆ°äº†â€œDimensionâ€ç±»å‹çš„ Dimension(6)ã€‚
]]></description>
      <guid>https://stackoverflow.com/questions/40666316/how-to-get-tensorflow-tensor-dimensions-shape-as-int-values</guid>
      <pubDate>Thu, 17 Nov 2016 22:37:28 GMT</pubDate>
    </item>
    </channel>
</rss>