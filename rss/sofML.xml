<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>标记为机器学习的活跃问题 - 堆栈内存溢出</title>
    <link>https://stackoverflow.com/questions/tagged/?tagnames=machine-learning&sort=active</link>
    <description>来自 stackoverflow.com 的最新 30 条</description>
    <lastBuildDate>Tue, 09 Jul 2024 03:18:44 GMT</lastBuildDate>
    <item>
      <title>我无法得到正确的 r 平方</title>
      <link>https://stackoverflow.com/questions/78723283/i-cant-get-the-right-r-squared</link>
      <description><![CDATA[首先，我遇到了一个问题，r 平方值出现奇怪的问题。
如果您能先查看代码，我将不胜感激。
X_train, X_test, y_train, y_test = train_test_split(data, target, test_size=0.3,shuffle = True, random_state=42)

parameters = {
&#39;max_depth&#39;: Integer(3, 30),
&#39;n_estimators&#39;: Integer(100, 1000),
&#39;learning_rate&#39;: Real(0.01, 0.5),
&#39;colsample_bytree&#39;: Real(0.1, 1.0),
&#39;subsample&#39;: Real(0.1, 1.0),
&#39;min_child_weight&#39;: Integer(1, 10),
}

xgb_model = XGBRegressor()

cv = KFold(n_splits=10, shuffle=True, random_state=42)
bayes_search = BayesSearchCV(xgb_model, parameters, cv=cv, n_jobs=-1,scoring=&#39;r2&#39;,verbose=5,random_state=42)
bayes_search.fit(X_train, y_train)

best_params = bayes_search.best_params_
print(&quot;最佳超参数：&quot;, best_params)

# CV R^2 分数
cv_results = bayes_search.cv_results_
cv_mean_score = cv_results[&#39;mean_test_score&#39;][bayes_search.best_index_]
print(&quot;CV R 平方分数：&quot;, cv_mean_score)

# 训练R^2
final_model = XGBRegressor(**best_params)
final_model.fit(X_train, y_train)
y_pred1 = final_model.predict(X_train)
train_r2 = r2_score(y_train, y_pred1)
print(&quot;Train R squared:&quot;, train_r2)

# Test R^2
y_pred = final_model.predict(X_test)
test_r2 = r2_score(y_test, y_pred)
print(&quot;Test R squared:&quot;, test_r2)

当我使用这些代码运行 r squared 时，我得到了以下结果。
CV R squared 分数：0.6303，训练 R squared：0.7647，测试 R squared： 0.6337
问题来了：

我尝试了不同的随机状态，结果训练 r^2 &gt; 测试 r^2 &gt; cv r^2。我的常识告诉我，训练 r^2 和 cv r^2 应该具有相同的值，因为它们使用了相同的参数，并且它们应该始终高于对整个数据集进行 30% 计算的测试 r^2，所以我不知道为什么我会得到这组结果 r^2 &gt; 测试 r^2 &gt; cv r^2。

我尝试了贝叶斯搜索和网格搜索、xgboost 和随机森林以及许多其他方法，但我无法使 r 平方超过 0.8。我应该使用不同模型的集成来增加它吗？我将非常感激任何建议。


如果我误解了某个概念或在代码中犯了错误，请告诉我。
这是一篇很长的文章，非常感谢您的阅读。]]></description>
      <guid>https://stackoverflow.com/questions/78723283/i-cant-get-the-right-r-squared</guid>
      <pubDate>Tue, 09 Jul 2024 00:43:11 GMT</pubDate>
    </item>
    <item>
      <title>关于 CIFAR-10 和迁移学习的问题</title>
      <link>https://stackoverflow.com/questions/78722572/issues-about-cifar-10-and-transfer-learning</link>
      <description><![CDATA[我试了很多次，但那一行不起作用：
history = model.fit(train_generator, epochs=200, steps_per_epoch=167,
callbacks=[modelcheckpoint],
validation_data=validation_generator,validation_steps=50)

我收到错误：
ValueError: `logits` 和 `labels` 必须具有相同的形状，收到 ((None, None, None, 1) vs (None,))。

https://drive.google.com/file/d/1r-TznZVZI9HcPGjfS_i-DfpEJ7mBUw0x/view?usp=sharing
我在 X_train 上做了很多改动，并进行了缩放。但什么也没发生！
我操作了图像读取，但根本不起作用。我甚至找不到根本原因]]></description>
      <guid>https://stackoverflow.com/questions/78722572/issues-about-cifar-10-and-transfer-learning</guid>
      <pubDate>Mon, 08 Jul 2024 19:22:31 GMT</pubDate>
    </item>
    <item>
      <title>eval（predvars、data、env）中出现错误：未找到对象“s_id”</title>
      <link>https://stackoverflow.com/questions/78722442/error-in-evalpredvars-data-env-object-s-id-not-found</link>
      <description><![CDATA[我正在尝试使用 tidymodels 拟合多层模型。当我拟合单个模型时，我没有遇到问题，但当我将它们组合到工作流集中时，我得到了这些错误。
我看到过有类似错误的帖子，并尝试更新我的代码，但似乎仍然不起作用。
当我在应用配方后查看训练和验证集时，我确实在数据框中找到所有列。不确定为什么错误仍然存​​在。当我使用非多级算法时，不会出现此错误。
我希望有人可以帮助解决此错误：
pacman::p_load(labelled,forcats,rstanarm,tidymodels,dplyr,parsnip,baguette,future,finetune,rules,rsample,
multilevelmod,ranger,earth,readr,stacks)

plan(multisession)

load(url(&quot;http://alecri.github.io/downloads/data/dental.RData&quot;))

dental_long &lt;- pivot_longer(dental, cols = starts_with(&quot;y&quot;), 
names_to = &quot;measurement&quot;, values_to = &quot;distance&quot;) %&gt;% 
mutate(
age = parse_number(measurement),
measure = fct_inorder(paste(&quot;测量年龄&quot;, age)),
s_id=as.factor(id)
) %&gt;% 
set_variable_labels(
age = &quot;测量时孩子的年龄&quot;,
measure = &quot;时间测量标签&quot;,
distance = &quot;测量值&quot;
) %&gt;% select(-measurement,-id)

#将数据拆分为训练集、验证集和测试集
set.seed(11)
splitsx &lt;- group_initial_split(dental_long, group = s_id,prop = 0.8)

dental_train &lt;- training(splitsx)
dental_val &lt;- testing(splitsx)

#创建交叉验证折叠
foldsx &lt;- group_vfold_cv(dental_train, v = 3,group = s_id,repeats = 3)

#创建简单的建模配方
simple_recipex &lt;- recipe(distance ~ ., data = dental_train) %&gt;% 
update_role(s_id,new_role = &#39;id&#39;)

#带有多项式项的配方
poly_recipex &lt;- recipe(distance ~ ., data = dental_train) %&gt;% 
update_role(s_id,new_role = &#39;id&#39;) %&gt;%
step_scale(all_numeric_predictors()) %&gt;%
step_poly(all_numeric_predictors(),degree = 2,keep_original_cols = F) %&gt;%
step_dummy(all_nominal_predictors()) %&gt;% 
step_interact(~all_numeric_predictors():all_numeric_predictors())

mixed_basic_recipex &lt;- recipe(distance ~ ., data = dental_train)

mixed_poly_recipex &lt;- recipe(distance ~ ., data = dental_train) %&gt;% 
step_scale(all_numeric_predictors()) %&gt;%
step_poly(all_numeric_predictors(),degree = 2,keep_original_cols = F) %&gt;%
step_dummy(all_nominal_predictors() &amp; !matches(&#39;s_id&#39;)) #%&gt;% 
# step_interact(~all_numeric_predictors():all_numeric_predictors() )

# df1 &lt;- prep(mixed_poly_recipex) %&gt;% bake(dental_train)

#mixed model
lmer_specx &lt;-
linear_reg() %&gt;%
set_mode(&quot;regression&quot;) %&gt;%
set_engine(&quot;lmer&quot;)

bayes_specx &lt;- linear_reg() %&gt;%
set_mode(&quot;regression&quot;) %&gt;%
set_engine(&quot;stan_glmer&quot;)

fullx &lt;- 
workflow_set(
preproc = list(mixed_poly = poly_recipex
), 
models = list(bayesMixed = bayes_specx,lmmixed = lmer_specx

)
)

#贝叶斯调整和度量的设置
bayes_ctrl &lt;-
control_bayes(
save_pred = TRUE,
parallel_over = &quot;everything&quot;,
save_workflow = TRUE,
verbose = TRUE,
no_improve = 20
)
rmse_res &lt;- metric_set(rmse,rsq)

basicbkx &lt;- prep(mixed_basic_recipex) %&gt;% bake(dental_train)
polybkx &lt;- prep(mixed_poly_recipex) %&gt;% bake(dental_train)

polyform &lt;- reformulate(c(setdiff(colnames(polybkx), c(&quot;距离&quot;,&#39;s_id&#39;)),&#39;-s_id + (1 | s_id)&#39;), 
response=&quot;distance&quot;)
basicform &lt;- reformulate(c(setdiff(colnames(basicbkx), c(&quot;distance&quot;,&#39;s_id&#39;)),&#39;-s_id + (1 | s_id)&#39;), 
response=&quot;distance&quot;)

all_wfx1 &lt;- fullx %&gt;% 
# update_workflow_model(id=&#39;basic_bayesMixed&#39;,spec=bayes_specx,
# formula = basicform) %&gt;% 
update_workflow_model(id=&#39;mixed_poly_bayesMixed&#39;,spec=bayes_specx,
formula = polyform) %&gt;%
# update_workflow_model(id=&#39;basic_lmmixed&#39;,spec=lmer_specx,
# formula = basicform) %&gt;%
update_workflow_model(id=&#39;mixed_poly_lmmixed&#39;,spec=lmer_specx,
formula = polyform)

test_results &lt;-
all_wfx1 %&gt;%
working_map(
&quot;tune_bayes&quot;,
seed = 10,
resamples = foldsx,
control = bayes_ctrl
)
]]></description>
      <guid>https://stackoverflow.com/questions/78722442/error-in-evalpredvars-data-env-object-s-id-not-found</guid>
      <pubDate>Mon, 08 Jul 2024 18:42:06 GMT</pubDate>
    </item>
    <item>
      <title>scikit学习交叉验证分数负值</title>
      <link>https://stackoverflow.com/questions/78722250/scikit-learn-cross-validation-score-negative-value</link>
      <description><![CDATA[我试图建立一个线性回归模型来预测房价，以便从机器学习开始，但在使用以下代码中的交叉验证时遇到负分数值：
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split
x = df.drop([&#39;MedHouseVal&#39;], axis=1)
y = df[&#39;MedHouseVal&#39;]
x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.2, random_state=0)
model = LinearRegression()
model.fit(x_train, y_train)
model.score(x_test, y_test)
from sklearn.model_selection import cross_val_score
scores = cross_val_score(model, x, y, cv=100)
plt.plot(scores)

我注意到，随着 cv 的增加，平均分数下降。因此，我决定绘制它，并意识到分数在某些时候会呈现负值，但真实预测/样本大小怎么会是负数呢？它是用 (TP + TN - FP - FN)/样本大小计算的吗？
在此处输入图片描述]]></description>
      <guid>https://stackoverflow.com/questions/78722250/scikit-learn-cross-validation-score-negative-value</guid>
      <pubDate>Mon, 08 Jul 2024 17:40:02 GMT</pubDate>
    </item>
    <item>
      <title>Jupyter Notebook 中的运行时溢出[关闭]</title>
      <link>https://stackoverflow.com/questions/78721859/runtime-overflow-in-jupyter-notebook</link>
      <description><![CDATA[我在计算梯度下降时遇到了这个问题
RuntimeWarning: 在 add theta1_slope = (-2/n) + sum(y - thetas[1]*x)*x) 时遇到溢出

如何解决？]]></description>
      <guid>https://stackoverflow.com/questions/78721859/runtime-overflow-in-jupyter-notebook</guid>
      <pubDate>Mon, 08 Jul 2024 15:58:56 GMT</pubDate>
    </item>
    <item>
      <title>如何定义/改变非分类卷积神经网络的准确性？</title>
      <link>https://stackoverflow.com/questions/78721703/how-do-i-define-change-the-accuracy-for-a-non-classification-convolutional-neura</link>
      <description><![CDATA[我正在使用 Keras 制作一个预测模型。它接受两个时间序列并输出一个介于 0 和 1 之间的数字。目前，我的准确度非常低，因为只有当模型得到准确的数字时，它才被认为是“正确的”。例如，正确的数字是 0.34，如果它预测 0.35，则会被视为不正确。我希望能够将范围内的所有数字视为正确的，例如：在真实值的 0.05 以内。另一个选择可能是四舍五入，但我遇到了输出 6 位小数的问题。

我如何将范围内的所有数字视为“正确的”准确率是多少？
我该如何对 CNN 的输出进行四舍五入？

这是我的 CNN 代码：
def networkModel():
model = tf.keras.Sequential([

tf.keras.layers.Conv2D(filters = 16, kernel_size=(2, 2),activation=&#39;relu&#39;,padding=&#39;same&#39;),
tf.keras.layers.Conv2D(filters = 9, kernel_size=(2, 2),activation=&#39;relu&#39;,padding=&#39;same&#39;),
tf.keras.layers.MaxPooling2D(pool_size=(2, 2)),
tf.keras.layers.Flatten(),
tf.keras.layers.Dense(256,激活=&#39;relu&#39;),
tf.keras.layers.Dense(1, 激活=&#39;sigmoid&#39;)

])

model.compile(optimizer=&#39;adam&#39;,
loss = tf.keras.losses.BinaryCrossentropy(),
metrics=[&#39;accuracy&#39;])

返回模型
]]></description>
      <guid>https://stackoverflow.com/questions/78721703/how-do-i-define-change-the-accuracy-for-a-non-classification-convolutional-neura</guid>
      <pubDate>Mon, 08 Jul 2024 15:24:04 GMT</pubDate>
    </item>
    <item>
      <title>我的预测张量值太低</title>
      <link>https://stackoverflow.com/questions/78721417/my-tensor-values-in-the-prediction-are-too-low</link>
      <description><![CDATA[我正在训练一个语义分割模型，使用 PyTorch 和 U-net 架构。数据集由视网膜摄影图像组成，带有渗出性疾病的掩码。我遇到了张量值不一致的问题，当我尝试进行新的预测时，我在训练时跟踪了张量，并且在训练期间值是一致的，但在执行新的预测时，值不一致且奇怪，导致掩码毫无意义。
def train_epoch(model, loader, criterion, optimizer, device):
model.train()
epoch_loss = 0

for i, (images, mask) in enumerate(loader):
unique_values = torch.unique(masks)
assert unique_values.numel() == 2, f&quot;Expected mask values to be either 0 or 1, but got {unique_values}&quot;

images = images.to(device)
mask = mask.to(device)

output = model(images)
unique_values_output_train = torch.unique(outputs)
print(f&#39;唯一值输出训练：{unique_values_output_train}&#39;)

output_bin = torch.sigmoid(outputs)
unique_values_output_bin = torch.unique(outputs_bin)
print(f&#39;唯一值输出训练 BIN：{unique_values_output_bin}&#39;)

loss = criterion(outputs, mask)
unique_values_loss_train = torch.unique(loss)
print(f&#39;值损失训练：{unique_values_loss_train}&#39;)

optimizer.zero_grad()
loss.backward()
optimizer.step()

epoch_loss += loss.item()

return epoch_loss / len(loader)


唯一值输出训练：张量（[-1.6558, -1.6541, -1.6541, ..., 0.4275, 0.4280, 0.4322],
device=&#39;cuda:0&#39;, grad_fn=&lt;Unique2Backward0&gt;)
唯一值输出训练 BIN：张量（[0.1474, 0.1475, 0.1475, ..., 0.7301, 0.7314, 0.7320], device=&#39;cuda:0&#39;,
grad_fn=&lt;Unique2Backward0&gt;)

def plot_predictions(dataset, model, device, num_samples=3):
model.eval()
fig, axs = plt.subplots(num_samples, 3, figsize=(15, num_samples * 5))

with torch.no_grad():
for i in range(num_samples):
idx = np.random.randint(0, len(dataset)) 
image, mask = dataset[idx]
image = image.to(device).unsqueeze(0)
mask = mask.to(device)

preds = torch.sigmoid(model(image))
print(f&#39;预测值：{preds}&#39;)

preds = (preds &gt; 0.5).float().cpu().numpy().squeeze(0)
unique_values_sigmoid = np.unique(preds)
print(f&#39;唯一值 sigmoid：{unique_values_sigmoid}&#39;)

image_np = image.cpu().squeeze(0).permute(1, 2, 0).numpy()
if image_np.shape[-1] == 1: 
image_np = image_np.squeeze(-1)

axs[i][0].imshow(image_np, cmap=&#39;gray&#39; if image_np.ndim == 2 else None)
axs[i][0].set_title(f&#39;图像 {idx}&#39;)
axs[i][0].axis(&#39;off&#39;)

mask_np = mask.cpu().numpy()
if mask_np.ndim == 3 和 mask_np.shape[0] == 1: 
mask_np = mask_np.squeeze(0)
elif mask_np.ndim == 3 和 mask_np.shape[-1] == 1:
mask_np = mask_np.squeeze(-1)

axs[i][1].imshow(mask_np, cmap=&#39;gray&#39;)
axs[i][1].set_title(f&#39;Mask {idx}&#39;)
axs[i][1].axis(&#39;off&#39;)

如果 preds.ndim == 3 和 preds.shape[0] == 1:
preds = preds.squeeze(0)

axs[i][2].imshow(preds, cmap=&#39;gray&#39;)
axs[i][2].set_title(f&#39;Prediction {idx}&#39;)
axs[i][2].axis(&#39;off&#39;)

plt.tight_layout()
plt.show()

预测值：张量([[[[0.0970, 0.0935, 0.0969, ..., 0.0962, 0.0990, 0.1000],
[0.0958, 0.0983, 0.1032, ..., 0.1014, 0.1013, 0.1044],
[0.0990, 0.0993, 0.1037, ..., 0.0998, 0.0996, 0.1008],
...,
[0.0981, 0.0985, 0.1002, ..., 0.1003, 0.0990, 0.1010],
[0.0986, 0.0993, 0.0993, ..., 0.1000, 0.0990, 0.1008],
[0.0917, 0.0949, 0.0965, ..., 0.0961, 0.0943, 0.0984]]]],
device=&#39;cuda:0&#39;)
唯一值 sigmoid：[0.]

我做了几次尝试，例如使用另一个损失函数、将 sigmoid 直接应用于 U-net 架构、更改 sigmoid 二值化值、将二值化应用于掩码等。]]></description>
      <guid>https://stackoverflow.com/questions/78721417/my-tensor-values-in-the-prediction-are-too-low</guid>
      <pubDate>Mon, 08 Jul 2024 14:28:47 GMT</pubDate>
    </item>
    <item>
      <title>经过微调的 Mask2Former 模型在训练后仅返回空张量</title>
      <link>https://stackoverflow.com/questions/78721111/fine-tuned-mask2former-model-only-returning-null-tensors-after-training</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/78721111/fine-tuned-mask2former-model-only-returning-null-tensors-after-training</guid>
      <pubDate>Mon, 08 Jul 2024 13:25:50 GMT</pubDate>
    </item>
    <item>
      <title>平衡机器学习和移动应用程序开发[关闭]</title>
      <link>https://stackoverflow.com/questions/78720753/balancing-machine-learning-and-mobile-app-development</link>
      <description><![CDATA[我现在是基督大学计算机应用学士学位 (BCA) 的第二年。在探索了技术领域的各个领域后，我对移动应用开发和机器学习产生了浓厚的兴趣。
我陷入了两难境地，希望社区能就以下问题提供一些指导：
重点决策：同时追求机器学习和移动应用开发的专业知识是否可行且实用？还是专注于一个领域以最大限度地提高熟练程度和职业前景会更有益？
学习路径：如果建议平衡两个领域，我应该从使用 Android Studio 和 Kotlin 进行原生 Android 开发开始，还是从 Flutter 开始更有益？
过渡到 Flutter：如果我从原生开发开始，过渡到 Flutter 有多顺利？业界是否普遍从原生开发开始，然后转向 Flutter，还是专业人士经常直接从 Flutter 开始？
对 Flutter 的需求：业界目前对 Flutter 开发人员的需求如何？Flutter 专业知识是否有重大的机会和增长前景，尤其是与原生 Android 开发相比？
实习策略：考虑到需要获得实习机会，先专注于一个领域，然后再扩展到另一个领域，这是否有利？如果是这样，您建议优先考虑哪个领域以获得更好的实习机会和职业发展？
您的见解和建议将非常宝贵，可以帮助我做出明智的决定，决定我的学习路径和职业轨迹。]]></description>
      <guid>https://stackoverflow.com/questions/78720753/balancing-machine-learning-and-mobile-app-development</guid>
      <pubDate>Mon, 08 Jul 2024 12:05:36 GMT</pubDate>
    </item>
    <item>
      <title>如何使用预训练模型改进森林卫星图像中的树木检测和计数？[关闭]</title>
      <link>https://stackoverflow.com/questions/78720461/how-to-improve-tree-detection-and-counting-in-forest-satellite-imagery-using-pre</link>
      <description><![CDATA[我正在开发一个人工智能林业管理系统，使用来自 Google Earth 的卫星图像来监测和分析树木种群。主要目标是准确计数树木并识别濒危或本土物种。我已经实施了一个用于图像分割的 U-Net 模型，但准确性并不令人满意，许多树木被遗漏或错误计数。
我当前的工作流程：

数据采集：从 Google Earth 收集卫星图像。
预处理：规范化和增强图像。
图像分割：使用 U-Net 进行初始树冠分割。
树木计数：应用轮廓检测​​来计数树木。
物种识别：旨在根据分割区域对树种进行分类（尚未实施）。

我面临的问题

准确性：U-Net 模型无法准确检测和计数树木。

我尝试过的方法：

实施 U-Net 进行分割。
尝试使用来自segmentation_models 库的预训练 U-Net 模型，但面临层形状和输入维度错误。

问题：

预训练模型：可用于卫星图像中树木检测的最佳预训练模型有哪些，我如何有效地将它们集成到我的项目中？
在哪里可以找到高质量的数据集用于卫星或航空图像中的树木检测和物种识别？
我可以采取哪些技术或其他预处理步骤来提高树木检测和计数的准确性？

其他信息：

我正在使用 Python 和 TensorFlow、Keras 和 OpenCV 等库。

我探索了各种数据集，但不确定哪些数据集对于训练稳健模型最有效。

]]></description>
      <guid>https://stackoverflow.com/questions/78720461/how-to-improve-tree-detection-and-counting-in-forest-satellite-imagery-using-pre</guid>
      <pubDate>Mon, 08 Jul 2024 11:02:08 GMT</pubDate>
    </item>
    <item>
      <title>术语“./darknet”未被识别为 cmdlet、函数、脚本文件或可运行程序的名称</title>
      <link>https://stackoverflow.com/questions/78719712/the-term-darknet-is-not-recognized-as-the-name-of-a-cmdlet-function-script</link>
      <description><![CDATA[在运行此最终命令时，我在本地笔记本电脑上执行自定义数据集上的 yolov3 操作，所有操作均已完成
./darknet detector train DATASET/voc.data cfg/yolov3-voc.cfg darknet53.conv.74

当我使用 Windows Power Shell 时，出现错误，即
./darknet：术语“./darknet”未被识别为 cmdlet、函数、脚本文件或可操作程序的名称。请检查名称的拼写，或者如果包含路径，请验证路径是否正确，然后重试。
在第 1 行，字符：1
+ ./darknet detector train DATASET/voc.data cfg/yolov3-voc.cfg darknet5 ...
+ ~~~~~~~~~
+ CategoryInfo : ObjectNotFound: (./darknet:String) [], CommandNotFoundException
+ FullyQualifiedErrorId : CommandNotFoundException

那么我该如何解决此错误
我尝试更改系统环境变量路径，也尝试运行某些命令，但仍然抛出相同的错误，那么我应该尝试什么呢]]></description>
      <guid>https://stackoverflow.com/questions/78719712/the-term-darknet-is-not-recognized-as-the-name-of-a-cmdlet-function-script</guid>
      <pubDate>Mon, 08 Jul 2024 08:00:10 GMT</pubDate>
    </item>
    <item>
      <title>生存分析 - 估计预期寿命</title>
      <link>https://stackoverflow.com/questions/78719590/survival-analysis-estimating-life-expectancy</link>
      <description><![CDATA[我正在探索生存分析，我的目标是找到一个预测预期寿命（以年为单位）的模型，而不是基于几种生活方式变量的风险比。我有很多饮食变量和二元变量——死亡率。
我使用 Kaplan Meyer 并计算间隔内的 AUC（死亡年龄/审查直到队列的最后一个年龄）来估计预期寿命损失年数。但是，我无法用这种方法使用这些变量。
我也看到了 Cox 比例模型中的函数 predict_survival_function，但曲线没有收敛到 0，因此计算 AUC 没有意义。
我遇到了加速失效时间模型，它似乎允许考虑变量并计算生存时间。有人将它用于类似的目的吗？
有人对预期寿命估计有什么建议吗？有人探索过与随机生存森林相关的任何内容吗？]]></description>
      <guid>https://stackoverflow.com/questions/78719590/survival-analysis-estimating-life-expectancy</guid>
      <pubDate>Mon, 08 Jul 2024 07:31:51 GMT</pubDate>
    </item>
    <item>
      <title>Keras 模型输入形状与层不兼容（尽管是兼容形状）</title>
      <link>https://stackoverflow.com/questions/78719585/keras-model-input-shapes-are-incompatible-with-the-layer-despite-being-a-compat</link>
      <description><![CDATA[为了解决这个问题，我在过去两天里费尽心机。我创建了一个文件 test.py，通过预测单个样本来测试我的模型：
import os
import keras
import numpy as np
import tensorflow as tf
from main_copy import path_to_fft

model = keras.models.load_model(os.path.join(os.getcwd(), &quot;model.keras&quot;))

model.summary()
model.summary(expand_nested=True)

first_sample = path_to_fft(os.path.join(os.getcwd(), &#39;Sounds&#39;, &#39;Thomas&#39;, &#39;thomas_original.wav&#39;))
second_sample = path_to_fft(os.path.join(os.getcwd(), &#39;Sounds&#39;, &#39;Thomas&#39;, &#39;thomas_original.wav&#39;))

print(&quot;First: &quot;, first_sample.shape)

print(&quot;Second: &quot;, second_sample.shape)

prediction = model.predict([first_sample, second_sample])
print(prediction)

path_to_fft 函数解码 .wav 文件并应用快速傅里叶变换，然后返回该变换的前半部分正频率，将 5 秒 16kHz 音频从形状 (80000, 1) 转换为 (40000, 1)，这是我的模型的正确大小。但是，当我尝试使用 model.predict 预测两个样本之间的距离时，我收到此错误消息：
Model: &quot; functional&quot;
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ ━ ...�
┃ 层（类型） ┃ 输出形状 ┃ 参数编号 ┃ 连接到┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━ ━━━━━━━╇━ ...输入A (输入层) │ (无，40000，1) │ 0 │ - │
│ ...输入A[0][0]，输入B[0][0] │
═──────────────────────────────┼──────────────────────────┼──────────────────────┼──────────────────────────┤
│ lambda (Lambda) │ (None, 1) │ 0 │ SiameseBranch[0][0]，│
│ │ │ │ SiameseBranch[1][0] │
└────────────────────────────┴────────────────────────┴──────────────────────┴────────────────────────┘

层“SiameseBranch”的输入 0与层不兼容：预期形状=(None, 40000, 1)，发现形状=(32, 1)

Functional.call() 接收的参数：
• 输入=(&#39;tf.Tensor(shape=(32, 1), dtype=float32)&#39;, &#39;tf.Tensor(shape=(32, 1), dtype=float32)&#39;)
• 训练=False
• 掩码=(&#39;None&#39;, &#39;None&#39;)

向上滚动时，我看到 Tensorflow 生成了三个 (?????) 参数：
级别 1：tensorflow：为 Python 函数 &lt;function StructuredFunctionWrapper.__init__.&lt;locals&gt;.trace_tf_function.&lt;locals&gt;.wrapped_fn at 创建新的 FuncGraph 0x0000027A795AE480&gt; (key: FunctionContext(context=EagerContext(parent_graph=None, device_functions=(), colocation_stack=(), in_cross_replica_context=False, variable_policy=None, xla_context_id=0), scope_type=&lt;ScopeType.VARIABLE_CREATION: 2&gt;), 输入参数:
args_0 (POSITIONAL_ONLY): TensorSpec(shape=(32,), dtype=tf.int64, name=None)
args_1 (POSITIONAL_ONLY): TensorSpec(shape=(40000, 1), dtype=tf.float32, name=None)
args_2 (POSITIONAL_ONLY): TensorSpec(shape=(40000, 1), dtype=tf.float32, name=None)
输出类型:
无
捕获:
无)

我完全不知道该做什么或如何处理这些错误日志。这是我第一次使用已保存为文件的模型，这绝对是一场噩梦。
作为参考，这里是 GitHub 存储库的链接（包含 path_to_fft 函数和用于拟合模型的代码以及模型本身）：https://github.com/brainage04/WestpacHackathon
这是运行 test.py 函数的完整错误日志，从头到尾：https://pastebin.com/iVZ7dUWn]]></description>
      <guid>https://stackoverflow.com/questions/78719585/keras-model-input-shapes-are-incompatible-with-the-layer-despite-being-a-compat</guid>
      <pubDate>Mon, 08 Jul 2024 07:30:43 GMT</pubDate>
    </item>
    <item>
      <title>使用python在机器学习中将未经训练的对象分类为未知对象</title>
      <link>https://stackoverflow.com/questions/53275530/categorize-a-not-trained-object-as-unknown-object-in-machine-learning-using-pyth</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/53275530/categorize-a-not-trained-object-as-unknown-object-in-machine-learning-using-pyth</guid>
      <pubDate>Tue, 13 Nov 2018 07:02:51 GMT</pubDate>
    </item>
    <item>
      <title>如何绘制决策边界？</title>
      <link>https://stackoverflow.com/questions/19054923/how-to-plot-decision-boundary</link>
      <description><![CDATA[如何使用 matplotlib 绘制决策边界，即 [w1,w2] 形式的权重向量，它基本上将两个类（比如 C1 和 C2）分开？
这是否像绘制一条从 (0,0) 到点 (w1,w2) 的线一样简单（因为 W 是权重“向量”）如果是，如果需要，我该如何在两个方向上延伸它？
现在我所做的就是：
 import matplotlib.pyplot as plt
plt.plot([0,w1],[0,w2])
plt.show()
]]></description>
      <guid>https://stackoverflow.com/questions/19054923/how-to-plot-decision-boundary</guid>
      <pubDate>Fri, 27 Sep 2013 15:45:08 GMT</pubDate>
    </item>
    </channel>
</rss>