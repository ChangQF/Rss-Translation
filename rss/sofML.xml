<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>æ ‡è®°ä¸ºæœºå™¨å­¦ä¹ çš„æ´»è·ƒé—®é¢˜ - å †æ ˆå†…å­˜æº¢å‡º</title>
    <link>https://stackoverflow.com/questions/tagged/?tagnames=machine-learning&sort=active</link>
    <description>æ¥è‡ª stackoverflow.com çš„æœ€æ–° 30 æ¡</description>
    <lastBuildDate>Sat, 24 Aug 2024 01:06:52 GMT</lastBuildDate>
    <item>
      <title>å¦‚ä½•åœ¨è°ƒç”¨ MessageGraph æœŸé—´ä¼ é€’å¤šä¸ªè¾“å…¥ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/78907608/how-to-pass-multiple-inputs-during-invoke-to-a-messagegraph</link>
      <description><![CDATA[æˆ‘ä»¬æœ‰ä¸€ä¸ªç”¨äº LLMCompiler å®ç°çš„ MessageGraphï¼Œå¹¶ä¸”æ­£å¦‚é¢„æœŸçš„é‚£æ ·ï¼Œæˆ‘ä»¬åœ¨è¿è¡Œè°ƒç”¨æ—¶å°†ç”¨æˆ·çš„é—®é¢˜ä½œä¸º HumanMessage å¯¹è±¡åˆ—è¡¨ä¼ é€’ï¼ˆè¿™äº›å¯¹è±¡æ˜ å°„åˆ°é»˜è®¤çš„&quot;messages&quot; é”®å¹¶ä¼ é€’ç»™æç¤ºæ¨¡æ¿ï¼‰ï¼Œè¿™å¯¹äºç®€å•çš„ç”¨ä¾‹æ¥è¯´å·¥ä½œå¾—å¾ˆå¥½ï¼Œä½†ç°åœ¨æˆ‘ä»¬éœ€è¦åœ¨è°ƒç”¨æ—¶ï¼ˆè€Œä¸æ˜¯åœ¨æ„å»ºå›¾å½¢æ—¶ï¼‰ä¼ é€’é¢å¤–çš„ä¿¡æ¯/ä¸Šä¸‹æ–‡ï¼Œæˆ‘ä»¬å¯¹ React ä»£ç†åšäº†ç±»ä¼¼çš„äº‹æƒ…ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“ä¼ é€’ç±»ä¼¼äº invoke({&quot;messages&quot;:input, &quot;context&quot;:context}) çš„å­—å…¸ã€‚ä½†å¯¹äº MessageGraphï¼Œè¿™ä¸èµ·ä½œç”¨ï¼Œçœ‹èµ·æ¥è¿è¡Œ invoke(messages) æ—¶ä¼ é€’çš„æ¶ˆæ¯åˆ—è¡¨ä¼šåœ¨æç¤ºä¸­è‡ªåŠ¨æ˜ å°„åˆ°&quot;messages&quot;é”®ï¼Œæ— æ³•æ·»åŠ å…¶ä»–è¾“å…¥ï¼Œæˆ‘å°è¯•ä¼ é€’ä¸€ä¸ªå­—å…¸ invoke({&quot;messages&quot;:messages, &quot;context&quot;:context})ï¼Œä½†æ²¡æœ‰æˆåŠŸï¼Œé”™è¯¯å¤±è´¥ï¼š

æ¶ˆæ¯å­—å…¸å¿…é¡»åŒ…å«â€œroleâ€å’Œâ€œcontentâ€é”®ï¼Œå¾—åˆ°
{&quot;messages&quot;:messages,&quot;context&quot;:context
]]></description>
      <guid>https://stackoverflow.com/questions/78907608/how-to-pass-multiple-inputs-during-invoke-to-a-messagegraph</guid>
      <pubDate>Fri, 23 Aug 2024 21:30:27 GMT</pubDate>
    </item>
    <item>
      <title>å¦‚ä½•åœ¨ Google Colab ä¸­è¿è¡Œè‡ªå®šä¹‰ Segment Anything æ¨¡å‹ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/78907597/how-can-i-run-a-custom-segment-anything-model-in-google-colab</link>
      <description><![CDATA[ç”±äºæˆ‘çš„ç¬”è®°æœ¬ç”µè„‘æ²¡æœ‰å¿…è¦çš„ç¡¬ä»¶ï¼Œæˆ‘è¯•å›¾åœ¨ Google Colab ä¸­è¿è¡Œæ­¤ SAM æ¨¡å‹ï¼šhttps://github.com/htcr/sam_roadï¼Œä½†æˆ‘å¾ˆè¿·èŒ«ã€‚è¯¥å­˜å‚¨åº“åœ¨ README ä¸­æœ‰è®¾ç½®è¯´æ˜ï¼Œä½†æˆ‘ä¸ç¡®å®šå¦‚ä½•ä½¿ç”¨ Colab éµå¾ªè¿™äº›è¯´æ˜ã€‚
è¯¥å­˜å‚¨åº“æ˜¯å…¬å¼€çš„ï¼Œä½†æˆ‘éœ€è¦ä»¤ç‰Œæƒé™æ‰èƒ½å°†å­˜å‚¨åº“ç›´æ¥å®‰è£…åˆ° Colab ä¸­ï¼Œå› æ­¤æˆ‘æƒ³æˆ‘å¯ä»¥å°†ä»£ç å¤åˆ¶å¹¶ç²˜è´´åˆ° Colab ä¸­ï¼Œä½†å½“ç„¶æœ‰å¾ˆå¤šä»£ç éœ€è¦å¤åˆ¶ã€‚å¦‚æœå¤åˆ¶/ç²˜è´´æ˜¯è§£å†³æ­¤é—®é¢˜çš„æ­£ç¡®æ–¹æ³•ï¼Œæˆ‘åº”è¯¥å¦‚ä½•åœ¨ Colab ç¬”è®°æœ¬ä¸­ç»„ç»‡ä»£ç ï¼ˆå› ä¸ºæˆ‘éœ€è¦å¤åˆ¶æ‰€æœ‰å­˜å‚¨åº“çš„ä»£ç ï¼‰ï¼Ÿæˆ–è€…æˆ‘åº”è¯¥ç”¨å…¶ä»–æ–¹å¼æ¥è¿è¡Œæ¨¡å‹è€Œä¸æ˜¯å¤åˆ¶/ç²˜è´´ï¼Ÿ
æˆ‘å°è¯•è¿‡è¿›è¡Œä¸€äº›å¤åˆ¶/ç²˜è´´ï¼Œä½†ç²˜è´´åˆ°ä¸€ä¸ªä»£ç æ–‡ä»¶ä¸­åŒ…å«ä¾èµ–äº repo ä¸­å…¶ä»–ä»£ç æ–‡ä»¶çš„å¯¼å…¥è¯­å¥ï¼Œä½†ç”±äº Colab ç¬”è®°æœ¬ä¼¼ä¹åªæœ‰ä¸€é¡µä»£ç å—ï¼Œæˆ‘ä¸ç¡®å®šæˆ‘æ˜¯å¦å¯ä»¥æ¯ä¸ªä»£ç å—åªåšä¸€ä¸ªä»£ç æ–‡ä»¶ï¼Œæˆ–è€…æ˜¯å¦éœ€è¦ä»»ä½•ç‰¹å®šçš„é¡ºåºã€‚]]></description>
      <guid>https://stackoverflow.com/questions/78907597/how-can-i-run-a-custom-segment-anything-model-in-google-colab</guid>
      <pubDate>Fri, 23 Aug 2024 21:24:12 GMT</pubDate>
    </item>
    <item>
      <title>YOLOv10 è‡ªå®šä¹‰è®­ç»ƒâ€”â€”å¯¼å…¥ YOLO è¿˜æ˜¯ YOLOv10ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/78907557/yolov10-custom-training-import-yolo-or-yolov10</link>
      <description><![CDATA[æˆ‘å¸Œæœ›å¯¹æˆ‘æ‹¥æœ‰çš„æ•°æ®é›†ä½¿ç”¨ YoloV10n è¿›è¡Œè‡ªå®šä¹‰è®­ç»ƒï¼ˆåˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä¸€ç›´åœ¨ä½¿ç”¨ YoloV8ï¼‰ï¼Œä½†æˆ‘ä¸ç¡®å®šæ˜¯å¦è¦ä½¿ç”¨/å¯¼å…¥ YOLO æˆ– YOLOv10ã€‚
æˆ‘æœ€åˆå°è¯•ä½¿ç”¨ YOLOv10ï¼Œå¹¶èƒ½å¤ŸæˆåŠŸå®Œæˆè‡ªå®šä¹‰è®­ç»ƒå’Œæ¨ç†ã€‚ä½†æ˜¯ï¼Œç”±äºæ–­è¨€ä¸ä¸€è‡´ï¼Œæˆ‘æ— æ³•å°†æ¨¡å‹å¯¼å‡ºåˆ° tfliteã€‚ç„¶åæˆ‘åˆ‡æ¢å› YOLOï¼ˆä»é¢„å…ˆè®­ç»ƒçš„ yolov10.pt æ¨¡å‹å¼€å§‹ï¼‰ï¼Œå¹¶èƒ½å¤Ÿå°†å…¶å¯¼å‡ºåˆ° tfliteã€‚æ­¤å¤–ï¼ŒUltralytics çš„å®˜æ–¹æ–‡æ¡£ç¡®å®æŒ‡å¯¼å¦‚ä½•ä½¿ç”¨ YOLOï¼ˆè€Œä¸æ˜¯ YOLOv10ï¼‰è¿›è¡Œ YoloV10 è®­ç»ƒã€‚å¦ä¸€æ–¹é¢ï¼ŒRoboFlow æ•™ç¨‹ç¡®å®æŒ‡å¯¼å¦‚ä½•ä½¿ç”¨ YOLOv10... ğŸ¤”
æˆ‘åº”è¯¥ä½¿ç”¨ from ultralytics import YOLOv10 è¿˜æ˜¯ from ultralytics import YOLOï¼Ÿè¿™æœ‰å…³ç³»å—ï¼Ÿå¯¹äºè®­ç»ƒã€æ¨ç†å’Œå¯¼å‡ºï¼ˆtflite ç­‰ï¼‰ï¼Œç­”æ¡ˆæ˜¯å¦ç›¸åŒï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/78907557/yolov10-custom-training-import-yolo-or-yolov10</guid>
      <pubDate>Fri, 23 Aug 2024 21:07:49 GMT</pubDate>
    </item>
    <item>
      <title>AWS SageMaker é¢„æµ‹å’Œæµ‹è¯•æ•°æ®</title>
      <link>https://stackoverflow.com/questions/78907538/aws-sagemaker-predictions-and-test-data</link>
      <description><![CDATA[import pandas as pd
import itertools
import numpy as np
import s3fs
from sagemaker.predictor import Predictor
from sagemaker.serializers import CSVSerializer

# ä¸ºæ‚¨çš„ CSV æ–‡ä»¶å®šä¹‰ S3 è·¯å¾„
import pandas as pd
import s3fs

# ä¸ºæ‚¨çš„ CSV æ–‡ä»¶å®šä¹‰ S3 è·¯å¾„
s3_path = &quot;s3://{}/{}/{}.csv&quot;

# å¸¦æœ‰é™„åŠ æ£€æŸ¥çš„è¯»å–æ–‡ä»¶å‡½æ•°
def read_and_check_csv(s3_path):
fs = s3fs.S3FileSystem()
with fs.open(s3_path) as f:
try:
# å°è¯•è¯»å– CSV æ–‡ä»¶
df = pd.read_csv(f, header=None, low_memory=False)
# æ£€æŸ¥è¡Œé•¿åº¦æ˜¯å¦ä¸€è‡´
if not df.apply(lambda x: len(x.dropna()), axis=1).nunique() == 1:
raise ValueError(&quot;æ£€æµ‹åˆ°ä¸ä¸€è‡´çš„è¡Œé•¿åº¦&quot;)
print(&quot;æ–‡ä»¶è¯»å–æˆåŠŸï¼Œä¼¼ä¹ä¸º CSV æ ¼å¼ã€‚&quot;)
return df
except Exception as e:
print(f&quot;æ— æ³•è¯»å– CSV æ–‡ä»¶ï¼š{e}&quot;)
return None

# è¯»å–å¹¶æ£€æŸ¥ CSV æ–‡ä»¶
df = read_and_check_csv(s3_path)

å¦‚æœ df ä¸ä¸º None:
print(df.head())
å¦åˆ™:
print(&quot;æ–‡ä»¶æ— æ³•è¯»å–æˆ–ä¸æ˜¯æœ‰æ•ˆçš„ CSV æ ¼å¼ã€‚&quot;)

# å®šä¹‰ç”¨äºåˆ‡ç‰‡æ•°æ®çš„ç´¢å¼•
a = [50 * i for i in range(3)]
b = [40 + i for i in range(10)]
indices = [i + j for i, j in itertools.product(a, b)]

# å‡†å¤‡æµ‹è¯•æ•°æ®
test_data = shape.iloc[indices[:-1]]
test_X = test_data.iloc[:, 1:]

# ç¡®ä¿æ‰€æœ‰è¡Œçš„åˆ—æ•°ç›¸åŒ
min_cols = test_X.shape[1]
test_X = test_X.dropna(axis=1, how=&#39;all&#39;) # åˆ é™¤æ‰€æœ‰ NaN å€¼çš„åˆ—

# éªŒè¯æ²¡æœ‰å…·æœ‰ä¸åŒå€¼çš„è¡Œé•¿åº¦
test_X = test_X.apply(lambda x: x.dropna().reset_index(drop=True), axis=1)

# ä½¿ç”¨ SageMaker ç«¯ç‚¹åç§°åˆå§‹åŒ–é¢„æµ‹å™¨
predictor = Predictor(endpoint_name=&#39;sagemaker-xgboost-2024-08-23-19-59-10-793&#39;)

# ç¡®ä¿é¢„æµ‹å™¨ä½¿ç”¨ CSV åºåˆ—åŒ–å™¨
predictor.serializer = CSVSerializer()

# å°† DataFrame è½¬æ¢ä¸ºç«¯ç‚¹æ‰€éœ€çš„æ ¼å¼
test_X_csv = test_X.to_csv(index=False, header=False, sep=&#39;,&#39;)

# è¿›è¡Œé¢„æµ‹
try:
predictions = predictor.predict(test_X_csv)
# æ‰“å°é¢„æµ‹
print(predictions.decode(&#39;utf-8&#39;))
except Exception as e:
print(f&quot;Error makingé¢„æµ‹ï¼š{e}&quot;)


æˆ‘åœ¨ aws sagemaker Jupyter å®éªŒå®¤ä¸­ä¸ºæˆ‘çš„ xgboost æ¡†æ¶ä½¿ç”¨ä¸Šè¿°è„šæœ¬ã€‚åœ¨æ­¤è„šæœ¬ä¹‹å‰ï¼Œæˆ‘æ­£åœ¨è¿è¡Œä»¥ä¸‹ä»£ç æ¥è®¾ç½®ç«¯ç‚¹ã€‚
predictor = estimator.deploy(
initial_instance_count=1, instance_type=&quot;ml.m5.2xlarge&quot;
)

æˆ‘æ·»åŠ äº†ä¸€äº›é”™è¯¯å¤„ç†ï¼Œè¿™å°±æ˜¯æˆ‘äº†è§£åˆ°æˆ‘çš„æµ‹è¯•æ–‡ä»¶ä¼¼ä¹æ²¡æœ‰è¢«æ­£ç¡®è¯»å–çš„åœ°æ–¹ã€‚æˆ‘å¾—åˆ°çš„å®é™…é”™è¯¯æ˜¯ï¼š
æ— æ³•è¯»å– CSV æ–‡ä»¶ï¼šæ£€æµ‹åˆ°ä¸ä¸€è‡´çš„è¡Œé•¿åº¦
æ— æ³•è¯»å–æ–‡ä»¶æˆ–æ–‡ä»¶ä¸æ˜¯æœ‰æ•ˆçš„ CSV æ ¼å¼ã€‚
è¿›è¡Œé¢„æµ‹æ—¶å‡ºé”™ï¼šè°ƒç”¨ InvokeEndpoint æ“ä½œæ—¶å‘ç”Ÿé”™è¯¯ (ModelError)ï¼šä»ä¸»æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯é”™è¯¯ (415)ï¼Œæ¶ˆæ¯ä¸ºâ€œåŠ è½½ csv æ•°æ®å¤±è´¥ï¼Œå‡ºç°å¼‚å¸¸ï¼Œè¯·ç¡®ä¿æ•°æ®ä¸º csv æ ¼å¼ï¼š
&lt;class &#39;ValueError&#39;&gt;
è®¾ç½®å¸¦æœ‰åºåˆ—çš„æ•°ç»„å…ƒç´ ã€‚è¯·æ±‚çš„æ•°ç»„åœ¨ 1 ç»´ä¹‹åå…·æœ‰éå‡åŒ€å½¢çŠ¶ã€‚æ£€æµ‹åˆ°çš„å½¢çŠ¶ä¸º (29,) + éå‡åŒ€éƒ¨åˆ†ã€‚â€

å…³äºå¦‚ä½•ä¿®å¤æ­¤é—®é¢˜æœ‰ä»»ä½•è§è§£å—ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/78907538/aws-sagemaker-predictions-and-test-data</guid>
      <pubDate>Fri, 23 Aug 2024 20:58:39 GMT</pubDate>
    </item>
    <item>
      <title>å…³äºæœºå™¨å­¦ä¹ æ–¹æ³•å’Œå·¥å…·çš„é—®é¢˜ [å…³é—­]</title>
      <link>https://stackoverflow.com/questions/78907467/questions-about-ml-methods-and-tooling</link>
      <description><![CDATA[æˆ‘é€‰ä¿®äº†ä¸€é—¨éå‚æ•°è®¡é‡ç»æµå­¦è¯¾ç¨‹ï¼Œå¹¶å–œæ¬¢å­¦ä¹ æ ¸ä¼°è®¡ï¼Œå› ä¸ºå®ƒæ˜¯ä¼ ç»Ÿå‚æ•°å›å½’çš„æ›´å‡†ç¡®ã€æ›´ç§‘å­¦çš„ç‰ˆæœ¬ã€‚æˆ‘çš„æ•™æˆæ˜¯éå‚æ•°çš„é“æ†ä¿¡å¾’ï¼Œä»–å˜²ç¬‘æ•°æ®ç§‘å­¦è¡Œä¸šä½¿ç”¨éšæœºæ£®æ—ä¹‹ç±»çš„ä¸œè¥¿ï¼Œå¹¶ç§°å…¶ä¸ºå‰æ²¿æŠ€æœ¯ã€‚æˆ‘æœ‰ç‚¹ç›¸ä¿¡ä»–ï¼Œä½†æœ‰äººèƒ½å¸®æˆ‘ç†è§£äººä»¬æ˜¯å¦‚ä½•ï¼ˆæˆ–ä¸ºä»€ä¹ˆä¸ï¼‰ä½¿ç”¨æ ¸ä¼°è®¡çš„å—ï¼Ÿåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘æ³¨æ„åˆ° Featuretools ä¼¼ä¹åœ¨ä½¿ç”¨å†…æ ¸ä¼°è®¡å’Œå¸¦å®½é€‰æ‹©ç¼©å°ç‰¹å¾èŒƒå›´æ–¹é¢æœ‰ç±»ä¼¼çš„æ–¹æ³•ã€‚
å­¦æœ¯ç•Œä»äº‹ç±»ä¼¼å·¥ä½œçš„äººå‘˜ï¼ˆè®¡é‡ç»æµå­¦å®¶å’Œè®¡ç®—æœºç§‘å­¦å®¶/æœºå™¨å­¦ä¹ ç ”ç©¶äººå‘˜ï¼‰ä¹‹é—´ä¼¼ä¹ä¹Ÿå­˜åœ¨å·¨å¤§å·®è·ï¼Œè¿™ä¹Ÿè®©æˆ‘æ„Ÿåˆ°å›°æƒ‘ã€‚
æ›´é‡è¦çš„æ˜¯ï¼Œæˆ‘å¯¹æ­¤å¾ˆé™Œç”Ÿï¼ˆæ•°å­¦å’Œç»æµå­¦æœ¬ç§‘ï¼Œç»æµå­¦ç¡•å£«ï¼Œè¿‡å» 4 å¹´åˆ†æå¸ˆ/æ•°æ®å·¥ç¨‹å¸ˆï¼Œç›®å‰å¤±ä¸šï¼‰ï¼Œå¹¶ä¸”æ­£åœ¨å°è¯•å¯»æ‰¾å¯ä»¥åˆ©ç”¨æˆ‘ç°æœ‰çŸ¥è¯†çš„æœ‰è¶£é¡¹ç›®ï¼Œå› æ­¤å»ºè®®/è§è§£å¾ˆæœ‰å¸®åŠ©ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/78907467/questions-about-ml-methods-and-tooling</guid>
      <pubDate>Fri, 23 Aug 2024 20:24:29 GMT</pubDate>
    </item>
    <item>
      <title>éœ€è¦å¸®åŠ©éªŒè¯è°·æ­Œ/æœºå™¨å­¦ä¹ è¯¾ç¨‹æä¾›çš„æ•°æ®</title>
      <link>https://stackoverflow.com/questions/78907434/need-help-verifying-data-provided-by-google-machine-learning-course</link>
      <description><![CDATA[åœ¨è°·æ­Œæä¾›çš„æœºå™¨å­¦ä¹ è¯¾ç¨‹ç®€ä»‹ä¸­çš„æ¢¯åº¦ä¸‹é™é¡µé¢ä¸­ï¼Œæä¾›äº†ç‰¹å¾å’Œç›¸åº”çš„æ ‡ç­¾ã€MSE æŸå¤±å‡½æ•°ã€åˆå§‹æ•°æ®é›†å’Œç»“æœã€‚æˆ‘å¾ˆéš¾éªŒè¯ä»–ä»¬çš„ç»“æœï¼Œæˆ‘æƒ³çŸ¥é“æ˜¯å¦æœ‰äººå¯ä»¥å¸®åŠ©ç¡®è®¤æˆ‘æ˜¯å¦çŠ¯äº†é”™è¯¯æˆ–è€…ä»–ä»¬çŠ¯äº†é”™è¯¯ã€‚
æˆ‘æœ‰ä»¥ä¸‹å†…å®¹ï¼š
import pandas as pd
import numpy as np

data = [3.5, 18], [3.69, 15], [3.44, 18], [3.43, 16], [4.34, 15], [4.42, 14], [2.37, 24]
initial_data_df = pd.DataFrame(data,columns=[&#39;pounds&#39;,&#39;mpg&#39;])

number_of_iterations = 6
weight = 0 # åˆå§‹åŒ–æƒé‡
bias = 0 # åˆå§‹åŒ–æƒé‡
weight_slope = 0
bias_slope = 0
final_results_df = pd.DataFrame()
learning_rate = 0.01

å¯¹äº i åœ¨èŒƒå›´å†…ï¼ˆè¿­ä»£æ¬¡æ•°ï¼‰ï¼š
loss = calculate_lossï¼ˆåˆå§‹æ•°æ® dfã€æƒé‡ã€åå·®ï¼‰
final_results_df = update_resultsï¼ˆæœ€ç»ˆç»“æœ dfã€æƒé‡ã€åå·®ã€æŸå¤±ï¼‰
weight_slope = find_weight_slopeï¼ˆåˆå§‹æ•°æ® dfã€æƒé‡ã€åå·®ï¼‰
bias_slope = find_bias_slopeï¼ˆåˆå§‹æ•°æ® dfã€æƒé‡ã€åå·®ï¼‰
weight = new_weight_updateï¼ˆæƒé‡ã€learning_rateã€weight_slopeï¼‰
bias = new_bias_updateï¼ˆåå·®ã€learning_rateã€bias_slopeï¼‰
printï¼ˆæœ€ç»ˆç»“æœ dfï¼‰

def calculate_lossï¼ˆdfã€æƒé‡ã€åå·®ï¼‰ï¼š
loss_summation = []
å¯¹äº i åœ¨èŒƒå›´å†…ï¼ˆ0ã€lenï¼ˆdfï¼‰ï¼‰ï¼š
loss_summation.append((df[&#39;mpg&#39;][i]-((weight*df[&#39;pounds&#39;][i])+bias))**2)
return (sum(loss_summation)//len(df))

def update_results(df,weight,bias,loss):
if df.empty:
df = pd.DataFrame([[weight,bias,loss]],columns=[&#39;weight&#39;,&#39;bias&#39;,&#39;loss&#39;])
else:
df = pd.concat([df,pd.DataFrame([[weight,bias,loss]],columns=df.columns)])
return df

def find_weight_slope(df,weight,bias):
weight_update_summation = []
for i in range(0,len(df)):
wx_plus_b = (weight*df[&#39;pounds&#39;][i])+bias
wx_plus_b_minus_y = wx_plus_b-df[&#39;mpg&#39;][i]
weight_update_summation.append(2*(wx_plus_b_minus_y*df[&#39;pounds&#39;][i]))
return sum(weight_update_summation)//len(df)

def find_bias_slope(df,weight,bias):
bias_update_summation = []
for i in range(0,len(df)):
wx_plus_b = (weight*df[&#39;pounds&#39;][i])+bias
wx_plus_b_minus_y = wx_plus_b-df[&#39;mpg&#39;][i]
bias_update_summation.append(2*wx_plus_b_minus_y)
total_sum = sum(bias_update_summation)
return total_sum//len(df)

def new_weight_update(old_weight,lr,slope):
return old_weight-1*lr*slope

def new_bias_update(old_bias,lr,slope):
return old_bias-1*lr*slope

å¾—å‡ºï¼š
iter weight bias loss
0 0.00 0.00 303.0
0 1.20 0.35 170.0
0 2.06 0.60 102.0
0 2.67 0.79 67.0
0 3.10 0.93 50.0
0 3.41 1.04 41.0

è¿™ä¸æä¾›çš„è§£å†³æ–¹æ¡ˆä¸åŒåœ¨ç½‘ç«™ä¸Šï¼š
è¿­ä»£æƒé‡åå·®æŸå¤±ï¼ˆMSEï¼‰
1 0 0 303.71
2 1.2 0.34 170.67
3 2.75 0.59 67.3
4 3.17 0.72 50.63
5 3.47 0.82 42.1
6 3.68 0.9 37.74
]]></description>
      <guid>https://stackoverflow.com/questions/78907434/need-help-verifying-data-provided-by-google-machine-learning-course</guid>
      <pubDate>Fri, 23 Aug 2024 20:09:14 GMT</pubDate>
    </item>
    <item>
      <title>éæ­£ç»Ÿçš„æ—¶é—´åºåˆ—é¢„å¤„ç†æ–¹æ³•[å…³é—­]</title>
      <link>https://stackoverflow.com/questions/78903433/unorthodox-time-series-preprocessing-methods</link>
      <description><![CDATA[æˆ‘æ­£åœ¨å†™ä¸€ç¯‡å…³äºæ—¶é—´åºåˆ—é¢„å¤„ç†çš„å­¦æ ¡è®ºæ–‡ã€‚åœ¨è¿™ç¯‡è®ºæ–‡ä¸­ï¼Œæˆ‘æƒ³æµ‹è¯•æ—¶é—´åºåˆ—é¢„å¤„ç†çš„éæ­£ç»Ÿæ–¹æ³•ã€‚ç„¶åæˆ‘æƒ³å°†æ•°æ®è¾“å…¥ LSTM æ¨¡å‹å¹¶æµ‹é‡å…¶åœ¨é¢„æµ‹æ—¶é—´åºåˆ—æ–¹é¢çš„å‡†ç¡®æ€§ã€‚æ‰€ä»¥æˆ‘æƒ³é—®é—®ç¤¾åŒºæˆ‘åº”è¯¥æµ‹è¯•å“ªäº›æ–°é¢–/éæ­£ç»Ÿçš„æ–¹æ³•ã€‚æˆ‘ä¸æƒ³æµ‹è¯•ä»»ä½•ç»å…¸æ–¹æ³•ï¼Œå¦‚å»å™ªã€æ­£åˆ™åŒ–ã€å­£èŠ‚æ€§æ¶ˆé™¤ç­‰ã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•æƒ³æ³•ï¼Œè¯·éšæ—¶åˆ†äº«ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/78903433/unorthodox-time-series-preprocessing-methods</guid>
      <pubDate>Thu, 22 Aug 2024 20:35:13 GMT</pubDate>
    </item>
    <item>
      <title>æˆ‘æ€æ ·æ‰èƒ½æ­£ç¡®åœ°è¿æ¥ä¸åŒçš„åŠŸèƒ½ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/78900219/how-can-i-properly-conctenate-the-different-features</link>
      <description><![CDATA[æˆ‘æœ‰ä¸€ä¸ªå½¢çŠ¶ä¸º (100,48) çš„ç‰¹å¾å›¾ï¼Œä»¥åŠå…¶ä»–å½¢çŠ¶ä¸º (100,1) çš„ç‰¹å¾
æˆ‘è¯¥å¦‚ä½•æ­£ç¡®åœ°è¿æ¥è¿™äº›ä¸åŒçš„ç‰¹å¾ï¼Ÿ
æˆ‘æƒ³è¿™æ ·åšæ˜¯å› ä¸ºæˆ‘ç°åœ¨æ­£åœ¨è®­ç»ƒ XGboost æ¨¡å‹ï¼Œä½†å¦‚æœæˆ‘å°†ä¸åŒçš„ç‰¹å¾ç›´æ¥è¿æ¥åœ¨ä¸€èµ·ï¼Œæœºå™¨å°±æ— æ³•åŒºåˆ†ç‰¹å¾å›¾å’Œå•ä¸ªç‰¹å¾ã€‚
æˆ‘å°è¯•äº†ä¸‹é¢çš„ä»£ç ï¼ˆæ¥è‡ª keras å‡½æ•° APIï¼‰ï¼Œä½†æˆ‘è®¤ä¸ºè¿™ä¸æ˜¯æ­£ç¡®çš„æ–¹æ³•ï¼Œæ¯æ¬¡æˆ‘æ“ä½œä»£ç ï¼ˆæ²¡æœ‰éšæœºç§å­ï¼‰æ—¶ï¼Œè¿™æ ·åšçš„ç»“æœéƒ½ä¸åŒã€‚
input_1_layer = Input(shape=(input_1.shape[1],)) density_1 = Dense(48,activation=&#39;relu&#39;)(input_1_layer)

input_2_layer = Input(shape=(input_2.shape[1],)) density_2 = Dense(6,æ¿€æ´»=&#39;relu&#39;)(è¾“å…¥å±‚ 2)

feature_extractor = Model(è¾“å…¥=[è¾“å…¥å±‚ 1, è¾“å…¥å±‚ 2], è¾“å‡º=merged)

new_features = feature_extractor.predict([è¾“å…¥å±‚ 1, è¾“å…¥å±‚ 2])

ä½ èƒ½æä¾›ä»»ä½•è®ºæ–‡æˆ–ç½‘ç«™å—ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/78900219/how-can-i-properly-conctenate-the-different-features</guid>
      <pubDate>Thu, 22 Aug 2024 07:19:22 GMT</pubDate>
    </item>
    <item>
      <title>æ ¹æ® scikit-learn ColumnTransformer è®¿é—®ç”¨äºå½’çº³å’Œè§„èŒƒåŒ–æ–°æ•°æ®çš„å€¼</title>
      <link>https://stackoverflow.com/questions/78896943/accessing-the-values-used-to-impute-and-normalize-new-data-based-upon-scikit-lea</link>
      <description><![CDATA[ä½¿ç”¨ scikit-learnï¼Œæˆ‘åœ¨è®­ç»ƒé›†ä¸Šæ„å»ºæœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œç„¶ååœ¨æµ‹è¯•é›†ä¸Šå¯¹å…¶è¿›è¡Œè¯„ä¼°ã€‚åœ¨è®­ç»ƒé›†ä¸Šï¼Œæˆ‘ä½¿ç”¨ ColumnTransformer æ‰§è¡Œæ•°æ®æ’è¡¥å’Œç¼©æ”¾ï¼Œç„¶åä½¿ç”¨ Kfold CV æ„å»ºé€»è¾‘å›å½’æ¨¡å‹ï¼Œæœ€ç»ˆæ¨¡å‹ç”¨äºé¢„æµ‹æµ‹è¯•é›†ä¸Šçš„å€¼ã€‚æœ€ç»ˆæ¨¡å‹è¿˜ä½¿ç”¨å…¶æ¥è‡ª ColumnTransformer çš„ç»“æœæ¥æ’è¡¥æµ‹è¯•é›†ä¸Šçš„ç¼ºå¤±å€¼ã€‚ä¾‹å¦‚ï¼Œæœ€å°-æœ€å¤§æ ‡é‡å°†ä»è®­ç»ƒé›†ä¸­è·å–æœ€å°å€¼å’Œæœ€å¤§å€¼ï¼Œå¹¶åœ¨ç¼©æ”¾æµ‹è¯•é›†æ—¶ä½¿ç”¨è¿™äº›å€¼ã€‚æˆ‘å¦‚ä½•æ‰èƒ½çœ‹åˆ°è¿™äº›ä»è®­ç»ƒé›†ä¸­å¾—å‡ºç„¶åç”¨äºé¢„æµ‹æµ‹è¯•é›†çš„ç¼©æ”¾å€¼ï¼Ÿæˆ‘åœ¨ scikit-learn æ–‡æ¡£ä¸­æ‰¾ä¸åˆ°æœ‰å…³å®ƒçš„ä»»ä½•ä¿¡æ¯ã€‚ä»¥ä¸‹æ˜¯æˆ‘ä½¿ç”¨çš„ä»£ç ï¼š
æ¥è‡ª sklearn.linear_model å¯¼å…¥ SGDClassifier
æ¥è‡ª sklearn.model_selection å¯¼å…¥ RepeatedStratifiedKFold
æ¥è‡ª sklearn.model_selection å¯¼å…¥ GridSearchCV
æ¥è‡ª sklearn.compose å¯¼å…¥ ColumnTransformer
æ¥è‡ª sklearn.impute å¯¼å…¥ SimpleImputer
æ¥è‡ª sklearn.pipeline å¯¼å…¥ Pipeline
æ¥è‡ª sklearn.preprocessing å¯¼å…¥ MinMaxScalerã€OneHotEncoder

def preprocessClassifierLR(categorical_vars, numeric_vars):###categorical_vars å’Œ numeric_vars æ˜¯å®šä¹‰ X ä¸­å­˜åœ¨çš„åˆ†ç±»å’Œæ•°å­—å˜é‡çš„åˆ—åçš„åˆ—è¡¨

categorical_pipeline = Pipeline(steps=[(&#39;mode&#39;, SimpleImputer(missing_values=np.nan, strategies=&quot;most_frequent&quot;)),
(&quot;one_hot_encode&quot;, OneHotEncoder(handle_unknown=&#39;ignore&#39;))])

numeric_pipeline = Pipeline(steps=[(&#39;numeric&#39;, SimpleImputer(strategy=&quot;median&quot;)),
(&quot;scaling&quot;, MinMaxScaler())])

col_transform = ColumnTransformer(transformers=[(&quot;cats&quot;, categorical_pipeline, categorical_vars),
(&quot;nums&quot;, numeric_pipeline, numeric_vars)])

lr = SGDClassifier(loss=&#39;log_loss&#39;, penalty=&#39;elasticnet&#39;)
model_pipeline = Pipeline(steps=[(&#39;preprocess&#39;, col_transform),
(&#39;classifier&#39;, lr)])

random_grid_lr = {&#39;classifier__alpha&#39;: [1e-1, 0.2, 0.5],
&#39;classifier__l1_ratio&#39;: [1e-3, 0.5]}

kfold = RepeatedStratifiedKFold(n_splits=10, n_repeats=10, random_state=47)

param_search = GridSearchCV(model_pipeline, random_grid_lr,scoring=&#39;roc_auc&#39;, cv=kfold, refit=True)

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.30)

param_search = preprocessClassifierLR(categorical_vars, numeric_vars)
train_mod = param_search.fit(X_train, y_train)
print(&quot;Mod AUC:&quot;, train_mod.best_score_)

test_preds = train_mod.predict_proba(X_)[:,1]

æˆ‘æ— æ³•æä¾›çœŸå®æ•°æ®ï¼Œä½† X æ˜¯ä¸€ä¸ªåŒ…å«ç‹¬ç«‹å˜é‡çš„æ•°æ®æ¡†ï¼Œy æ˜¯äºŒå…ƒç»“æœå˜é‡ã€‚train_mod æ˜¯ä¸€ä¸ªåŒ…å«åˆ—å˜æ¢å™¨å’Œ SGD åˆ†ç±»å™¨æ­¥éª¤çš„ç®¡é“ã€‚æˆ‘å¯ä»¥é€šè¿‡è¿è¡Œ train_mod.best_params_ è½»æ¾ä»åˆ†ç±»å™¨ä¸­è·å–ç±»ä¼¼çš„å‚æ•°ä¿¡æ¯ï¼Œä¾‹å¦‚æœ€ä½³ lambda å’Œ alpha å€¼ï¼Œä½†æˆ‘æ— æ³•æ‰¾å‡ºç”¨äºåˆ—å˜æ¢å™¨çš„ç»Ÿè®¡æ•°æ®ï¼Œä¾‹å¦‚ 1) ç”¨äºåˆ†ç±»ç‰¹å¾çš„ç®€å•æ’è¡¥å™¨çš„æ¨¡å¼ï¼Œ2) ç”¨äºæ•°å­—ç‰¹å¾çš„ç®€å•æ’è¡¥å™¨çš„ä¸­å€¼ï¼Œä»¥åŠ 3) ç”¨äºç¼©æ”¾æ•°å­—ç‰¹å¾çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚å¦‚ä½•è®¿é—®æ­¤ä¿¡æ¯ï¼Ÿ
æˆ‘å‡è®¾ train_mod.best_estimator_[&#39;preprocess&#39;].transformers_ åŒ…å«æ­¤ä¿¡æ¯ï¼Œç±»ä¼¼äº train_mod.best_params_ ä¸ºæˆ‘æä¾›ä»æ¨¡å‹è®­ç»ƒä¸­å¾—å‡ºçš„ alpha å’Œ lambda å€¼ï¼Œç„¶åå°†å…¶åº”ç”¨äºæµ‹è¯•é›†ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/78896943/accessing-the-values-used-to-impute-and-normalize-new-data-based-upon-scikit-lea</guid>
      <pubDate>Wed, 21 Aug 2024 12:24:53 GMT</pubDate>
    </item>
    <item>
      <title>ä½¿ç”¨ Hugging Face Transformers è®­ç»ƒ GPT-2 æ¨¡å‹æ—¶å¦‚ä½•ä¿®å¤åˆ†æ®µé”™è¯¯ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/78841125/how-to-fix-segmentation-fault-when-training-gpt-2-model-using-hugging-face-trans</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/78841125/how-to-fix-segmentation-fault-when-training-gpt-2-model-using-hugging-face-trans</guid>
      <pubDate>Tue, 06 Aug 2024 21:47:06 GMT</pubDate>
    </item>
    <item>
      <title>å¦‚ä½•ä½¿ç”¨pandaså°†å¤§æ•°æ®å—æ‹†åˆ†ä¸ºx_trainå’Œy_trainæ•°æ®ä»¥ä¾›æœºå™¨å­¦ä¹ ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/67367698/how-to-use-pandas-chunk-for-large-data-into-split-the-data-for-x-train-and-y-tra</link>
      <description><![CDATA[df_chunk=pd.read_csv(filename,chunk=1000)
X_train,Y_train,X_test,Y_test=train_test.split(df_chunk)

å¦‚ä½•ä½¿ç”¨ df_chunk å°†å…¶æ‹†åˆ†ä¸º x å’Œ y è®­ç»ƒæ•°æ®ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/67367698/how-to-use-pandas-chunk-for-large-data-into-split-the-data-for-x-train-and-y-tra</guid>
      <pubDate>Mon, 03 May 2021 10:51:38 GMT</pubDate>
    </item>
    <item>
      <title>Tensorflow model.evaluate ç»™å‡ºçš„ç»“æœä¸è®­ç»ƒå¾—åˆ°çš„ç»“æœä¸åŒ</title>
      <link>https://stackoverflow.com/questions/64049608/tensorflow-model-evaluate-gives-different-result-from-that-obtained-from-trainin</link>
      <description><![CDATA[æˆ‘æ­£åœ¨ä½¿ç”¨ tensorflow è¿›è¡Œå¤šç±»åˆ†ç±»
æˆ‘ä»¥ä»¥ä¸‹æ–¹å¼åŠ è½½è®­ç»ƒæ•°æ®é›†å’ŒéªŒè¯æ•°æ®é›†
train_ds = tf.keras.preprocessing.image_dataset_from_directory(
data_dir,
validation_split=0.2,
subset=&quot;training&quot;,
shuffle=True,
seed=123,
image_size=(img_height, img_width),
batch_size=batch_size)

val_ds = tf.keras.preprocessing.image_dataset_from_directory(
data_dir,
validation_split=0.2,
subset=&quot;validation&quot;,
shuffle=True,
seed=123,
image_size=(img_height, img_width),
batch_size=batch_size)

ç„¶åå½“æˆ‘ä½¿ç”¨ model.fit() è®­ç»ƒæ¨¡å‹
history = model.fit(
train_ds,
validation_data=val_ds,
epochs=epochs,
shuffle=True
)

æˆ‘çš„éªŒè¯å‡†ç¡®ç‡çº¦ä¸º 95%ã€‚
ä½†æ˜¯å½“æˆ‘åŠ è½½ç›¸åŒçš„éªŒè¯é›†å¹¶ä½¿ç”¨ model.evaluate() æ—¶
model.evaluate(val_ds)

æˆ‘çš„å‡†ç¡®ç‡éå¸¸ä½ï¼ˆçº¦ä¸º 10%ï¼‰ã€‚
ä¸ºä»€ä¹ˆæˆ‘å¾—åˆ°çš„ç»“æœå¦‚æ­¤ä¸åŒï¼Ÿæˆ‘æ˜¯å¦é”™è¯¯åœ°ä½¿ç”¨äº† model.evaluate å‡½æ•°ï¼Ÿ
æ³¨æ„ï¼šåœ¨ model.compile() ä¸­ï¼Œæˆ‘æŒ‡å®šäº†ä»¥ä¸‹å†…å®¹ï¼Œ
ä¼˜åŒ–å™¨ - Adamï¼Œ
æŸå¤± - SparseCategoricalCrossentropyï¼Œ
æŒ‡æ ‡ - å‡†ç¡®åº¦
Model.evaluate() è¾“å‡º
41/41 [================================] - 5s 118ms/step - æŸå¤±ï¼š0.3037 - å‡†ç¡®åº¦ï¼š0.1032
æµ‹è¯•æŸå¤± - 0.3036555051803589
æµ‹è¯•å‡†ç¡®åº¦ - 0.10315627604722977

æœ€åä¸‰ä¸ªæ—¶æœŸçš„ Model.fit() è¾“å‡º
æ—¶æœŸ8/10
41/41 [==============================] - 3s 80ms/æ­¥ - æŸå¤±ï¼š0.6094 - å‡†ç¡®åº¦ï¼š0.8861 - val_lossï¼š0.4489 - val_accuracyï¼š0.9483
Epoch 9/10
41/41 [=============================] - 3s 80ms/æ­¥ - æŸå¤±ï¼š0.5377 - å‡†ç¡®åº¦ï¼š0.8953 - val_lossï¼š0.3868 - val_accuracyï¼š0.9554
Epoch 10/10
41/41 [==============================] - 3s 80ms/æ­¥ - æŸå¤±ï¼š0.4663 - å‡†ç¡®åº¦ï¼š0.9092 - val_lossï¼š0.3404 - val_accuracyï¼š0.9590
]]></description>
      <guid>https://stackoverflow.com/questions/64049608/tensorflow-model-evaluate-gives-different-result-from-that-obtained-from-trainin</guid>
      <pubDate>Thu, 24 Sep 2020 15:26:53 GMT</pubDate>
    </item>
    <item>
      <title>MLflowï¼šå¦‚ä½•å°†å®éªŒçŠ¶æ€è¿”å›ä¸ºå¤±è´¥</title>
      <link>https://stackoverflow.com/questions/61112113/mlflow-how-to-return-experiment-status-as-failed</link>
      <description><![CDATA[æˆ‘å·²ç»å†™å‡ºäº†æˆ‘çš„ä»£ç ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹å½¢å¼ 
def train(run_name, log_basepath, logger, parameters):

try:
metrics = training_functions(parameters) # &lt;---- å¯èƒ½å¤±è´¥çš„ä»£ç 

# æ¼”ç¤ºå°†å±æ€§åŠ è½½åˆ°ç»™å®šçš„è¿è¡Œ
with mlflow.start_run(run_name=run_name):

# æ—¥å¿—å‚æ•°
mlflow.log_params(parameters)

# æ—¥å¿—æŒ‡æ ‡
mlflow.log_metrics(metrics)

# å®šä¹‰å®éªŒæ ‡ç­¾
mlflow.set_tags(tags)

# ä¸Šä¼ ç›¸å…³æ–‡ä»¶
mlflow.log_artifact(artifact_abspath)

# ä¸»æ¨¡å‹æ–‡ä»¶
mlflow.log_artifact(log_basepath)

except Exception as e:
logger.error(&#39;\næ¨¡å‹è®­ç»ƒå¤±è´¥ã€‚è¿”å›ä»¥ä¸‹é”™è¯¯:\n {} \n\n&#39;.format(e))
logger.info( &#39;ç¬¬ {} è¡Œé”™è¯¯&#39;.format(sys.exc_info()[-1].tb_lineno))

# æ¼”ç¤ºå°†å±æ€§åŠ è½½åˆ°ç»™å®šè¿è¡Œ
ä½¿ç”¨ mlflow.start_run(run_name=run_name):
# å®šä¹‰è¿è¡Œæ ‡ç­¾
logger.info(&#39;å®éªŒåç§°ï¼š{}&#39;.format(experiment_name))
logger.info(&#39;è¿è¡Œåç§°ï¼š{}&#39;.format(run_name))
logger.info(&#39;è¿è¡Œå¤±è´¥&#39;)

mlflow.log_artifact(log_basepath)

æˆ‘çš„ç›®æ ‡æ˜¯å¦‚æœå‘ç”Ÿæ•…éšœï¼Œå°†æ—¥å¿—å‘é€åˆ° mlflow æœåŠ¡å™¨ã€‚æˆ‘çš„é—®é¢˜æ˜¯ï¼Œå¦‚ä½•è®© mlflow å°†æ­¤æ ‡è®°ä¸ºå¤±è´¥ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/61112113/mlflow-how-to-return-experiment-status-as-failed</guid>
      <pubDate>Thu, 09 Apr 2020 00:28:12 GMT</pubDate>
    </item>
    <item>
      <title>å¦‚ä½•ç¡®ä¿è®­ç»ƒé˜¶æ®µä¸ä¼šé¢ä¸´ OOMï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/58366819/how-to-make-sure-the-training-phase-wont-be-facing-an-oom</link>
      <description><![CDATA[æ ¹æ®æˆ‘çš„ç»éªŒï¼Œæœ‰ä¸¤ç§ OOM æƒ…å†µã€‚ä¸€ç§æ˜¯å½“æ‚¨çš„æ¨¡å‹å’Œå°æ‰¹é‡æ‰€éœ€çš„å†…å­˜å¤§äºæ‚¨æ‹¥æœ‰çš„å†…å­˜æ—¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè®­ç»ƒé˜¶æ®µå°†æ°¸è¿œä¸ä¼šå¼€å§‹ã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•æ˜¯ä½¿ç”¨è¾ƒå°çš„æ‰¹é‡å¤§å°ã€‚å°½ç®¡å¦‚æœæˆ‘èƒ½è®¡ç®—å‡ºæˆ‘çš„ç¡¬ä»¶å¯ä»¥ä¸ºæŸä¸ªç‰¹å®šæ¨¡å‹ç®¡ç†çš„æœ€å¤§æ‰¹é‡å¤§å°ï¼Œé‚£å°±å¤ªå¥½äº†ã€‚ä½†å³ä½¿æˆ‘ç¬¬ä¸€æ¬¡å°è¯•æ‰¾ä¸åˆ°æœ€å¤§çš„æ‰¹é‡å¤§å°ï¼Œæˆ‘ä¹Ÿæ€»èƒ½é€šè¿‡åå¤è¯•éªŒæ‰¾åˆ°å®ƒï¼ˆå› ä¸ºè¿™ä¸ªè¿‡ç¨‹é©¬ä¸Šå°±å¤±è´¥äº†ï¼‰ã€‚
æˆ‘é¢ä¸´çš„ OOM çš„ç¬¬äºŒç§æƒ…å†µæ˜¯å½“è®­ç»ƒè¿‡ç¨‹å¼€å§‹æ—¶ï¼Œå®ƒä¼šæŒç»­ä¸€æ®µæ—¶é—´ã€‚ç”šè‡³å¯èƒ½æ˜¯å‡ ä¸ªæ—¶æœŸã€‚ä½†åæ¥ç”±äºæŸç§æœªçŸ¥åŸå› ï¼Œå®ƒé¢ä¸´ OOMã€‚å¯¹æˆ‘æ¥è¯´ï¼Œè¿™ç§æƒ…å†µä»¤äººæ²®ä¸§ã€‚å› ä¸ºå®ƒå¯èƒ½éšæ—¶å‘ç”Ÿï¼Œä½ æ°¸è¿œä¸çŸ¥é“æ­£åœ¨è¿›è¡Œçš„è®­ç»ƒæ˜¯å¦ä¼šç»“æŸã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘å·²ç»æµªè´¹äº†å¥½å‡ å¤©çš„è®­ç»ƒæ—¶é—´ï¼Œè€Œæˆ‘ä»¥ä¸ºä¸€åˆ‡éƒ½è¿›å±•é¡ºåˆ©ã€‚
æˆ‘è®¤ä¸ºéœ€è¦æ¾„æ¸…ä¸€äº›é—®é¢˜ã€‚é¦–å…ˆï¼Œæˆ‘è¯´çš„æ˜¯å¸¦æœ‰ GPU çš„ä¸ªäººè®¡ç®—æœºã€‚å…¶æ¬¡ï¼ŒGPU ä¸“ç”¨äºè®¡ç®—ï¼Œä¸ç”¨äºæ˜¾ç¤ºã€‚å¦‚æœæˆ‘é”™äº†ï¼Œè¯·çº æ­£æˆ‘ï¼Œä½†æˆ‘ç›¸ä¿¡è¿™æ„å‘³ç€è®­ç»ƒè¿‡ç¨‹åœ¨ä¸åŒæ—¶é—´ç‚¹éœ€è¦ä¸åŒçš„å†…å­˜å¤§å°ã€‚æ€ä¹ˆä¼šè¿™æ ·ï¼Ÿå†æ¬¡ï¼Œæˆ‘å¦‚ä½•ç¡®ä¿æˆ‘çš„è®­ç»ƒé˜¶æ®µä¸ä¼šé¢ä¸´ OOMï¼Ÿ
ä»¥è¿™æ¬¡è¿è¡Œä¸ºä¾‹ï¼š
3150/4073 [========================&gt;.......] - ETAï¼š53:39 - æŸå¤±ï¼š0.3323
2019-10-13 21:41:13.096320ï¼šW tensorflow/core/common_runtime/bfc_allocator.cc:314] åˆ†é…å™¨ (GPU_0_bfc) åœ¨å°è¯•åˆ†é… 60.81MiBï¼ˆå››èˆäº”å…¥ä¸º 63766528ï¼‰æ—¶å†…å­˜ä¸è¶³ã€‚å½“å‰åˆ†é…æ‘˜è¦å¦‚ä¸‹ã€‚

ç»è¿‡ä¸‰ä¸ªå°æ—¶çš„è®­ç»ƒï¼ŒTensorFlow è¦æ±‚çš„å†…å­˜è¶…è¿‡äº†æˆ‘çš„ç¡¬ä»¶å¯ä»¥æä¾›çš„å†…å­˜ã€‚æˆ‘çš„é—®é¢˜æ˜¯ï¼Œä¸ºä»€ä¹ˆæ­¤æ—¶å¢åŠ å†…å­˜åˆ†é…ï¼Œè€Œä¸æ˜¯åœ¨è¿›ç¨‹å¼€å§‹æ—¶å¢åŠ ï¼Ÿ
[æ›´æ–°]
é‰´äº Eager æ¨¡å¼çš„å·²çŸ¥é—®é¢˜ï¼Œæˆ‘å°†å¯¹æˆ‘çš„æ¡ˆä¾‹è¿›è¡Œä¸€äº›è¯´æ˜ã€‚æˆ‘æ²¡æœ‰åœ¨ Eager æ¨¡å¼ä¸‹ç¼–ç ã€‚æˆ‘çš„è®­ç»ƒä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š
strategy = tf.distribute.OneDeviceStrategy(device=&quot;/gpu:0&quot;)
training_dataset = tf.data.Dataset.from_tensor_slices(...)
validation_dataset = tf.data.Dataset.from_tensor_slices(...)

withstrategy.scope():
model = create_model()

model.compile(optimizer=&#39;adam&#39;, loss=&#39;categorical_crossentropy&#39;)

pocâ€‹â€‹ket = EarlyStopping(monitor=&#39;val_loss&#39;, min_delta=0.001,
patience=5, verbose=1,
restore_best_weights = True)

history = model.fit(training_dataset.shuffle(buffer_size=1000).batch(30),
epochs=3,
å›è°ƒ=[pocket]ï¼Œ
validation_data=validation_dataset.shuffle(buffer_size=1000).batch(30)ï¼Œ
workers=3ï¼Œuse_multiprocessing=True)
]]></description>
      <guid>https://stackoverflow.com/questions/58366819/how-to-make-sure-the-training-phase-wont-be-facing-an-oom</guid>
      <pubDate>Sun, 13 Oct 2019 18:58:25 GMT</pubDate>
    </item>
    <item>
      <title>è®­ç»ƒæœŸé—´æ”¹å˜æ¨¡å‹</title>
      <link>https://stackoverflow.com/questions/36748574/changing-model-during-training</link>
      <description><![CDATA[æˆ‘æ­£åœ¨ TensorFlow ä¸­åˆ›å»ºä¸€ä¸ªæ¨¡å‹ï¼Œå…¶ä¸­æ‰€æœ‰å±‚éƒ½å…·æœ‰ relu ä½œä¸ºæ¿€æ´»å±‚ã€‚ä½†æ˜¯ï¼Œå½“æ‰¹å¤„ç†å¤§å°å¢åŠ åˆ° 500 æ—¶ï¼Œæˆ‘æƒ³æ›´æ”¹æ¨¡å‹ï¼Œä½¿è¾“å‡ºå±‚çš„å€’æ•°ç¬¬äºŒå±‚å…·æœ‰ sigmoid æ¿€æ´»å±‚ã€‚
æˆ‘æ„Ÿåˆ°å›°æƒ‘çš„æ˜¯ï¼Œç”±äºæˆ‘åœ¨ä¸­é—´æ›¿æ¢äº†ä¼˜åŒ–å™¨ï¼Œæˆ‘æ˜¯å¦éœ€è¦é‡æ–°åˆå§‹åŒ–æ‰€æœ‰å˜é‡ï¼Ÿè¿˜æ˜¯ä¿ç•™æ—§å˜é‡ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/36748574/changing-model-during-training</guid>
      <pubDate>Wed, 20 Apr 2016 15:30:49 GMT</pubDate>
    </item>
    </channel>
</rss>