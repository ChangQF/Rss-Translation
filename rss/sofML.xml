<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>标记为机器学习的活跃问题 - 堆栈内存溢出</title>
    <link>https://stackoverflow.com/questions/tagged/?tagnames=machine-learning&sort=active</link>
    <description>来自 stackoverflow.com 的最新 30 条</description>
    <lastBuildDate>Thu, 04 Jul 2024 18:19:36 GMT</lastBuildDate>
    <item>
      <title>如何将 YoloTinyNet 转换为 YOLO 变量？</title>
      <link>https://stackoverflow.com/questions/78708138/how-to-convert-yolotinynet-to-yolo-variables</link>
      <description><![CDATA[我正在使用从 YoloTinyNet 模型获得的检测结果，如下所示：
results = YoloTinyNet(self._common_params, self._net_params, test=True).inference(image)

进一步处理它们并获得高级计算。
另一方面，我重新训练了 YOLO 模型，并希望使用它代替我的旧 YoloTinyNet 模型，如下所示：
model = YOLO(&#39;/yolov8/weights/yolov8n.pt&#39;)
results = model(source=&#39;./image.jpg&#39;, conf=0.25)[0]

如何链接两个不同的模型，有没有办法在它们之间进行转换？]]></description>
      <guid>https://stackoverflow.com/questions/78708138/how-to-convert-yolotinynet-to-yolo-variables</guid>
      <pubDate>Thu, 04 Jul 2024 16:23:37 GMT</pubDate>
    </item>
    <item>
      <title>训练 yolo 权重来识别一张额外的图像？</title>
      <link>https://stackoverflow.com/questions/78708085/train-yolo-weights-to-recognize-one-additional-image</link>
      <description><![CDATA[所以我有一个正在训练的 YOLO 模型，使其能够识别新数据中定义的新类的新对象，以用于训练。
使用新数据进行训练的完整代码如下：
from ultralytics import YOLO

model = YOLO(&#39;yolov8/weights/yolov8n.pt&#39;)
results = model(source=&#39;./weirdobject.jpg&#39;, conf=0.25, save_txt=None)[0]
print(results)

annotated_frame = results.plot() 

import cv2

import surveillance as sv

sv.plot_image(annotated_frame)

#使用 roboflow 下载带有新图像注释的数据（数据集包含 1 张带注释的图像）
from roboflow import Roboflow

rf = Roboflow(api_key=&quot;idofproject&quot;)
print(rf.workspace().projects())
project = rf.workspace(&quot;id1&quot;).project(&quot;id2&quot;)
version = project.version(4)
#从 roboflow 下载数据以训练模型
dataset = version.download(model_format=&quot;yolov8&quot;, location=&quot;./datasets&quot;)

#使用包含添加注释图像的数据训练模型
results = model.train(data=&quot;roboflow_ml_image_detection/datasets/data.yaml&quot;, epochs=5)

results = model.val()
#产生新的预测，其中应包括具有正确标签的新图像检测
results = model(source=&#39;./weirdobject.jpg&#39;, conf=0.25, save_txt=None)[0]
# 这个结果是错误的，因为模型没有使用包含新图像的新数据进行训练
print(results)

包含一张图片的数据集已下载到 python 项目中，其结构如下：
[![项目中的数据集结构][1]][1]
data.yaml 文件如下：
names:
- small_ball
nc: 1
roboflow:
license: CC BY 4.0
project: nao-s07zd
url: https://universe.roboflow.com/id1/id2/dataset/4
version: 4
working: id2
#test: ../test/images
train: ./train/images
val: ./valid/images

第二个结果与训练之前的结果相同，为什么？
[1]：https://i.sstatic.net/fz19fDF6.png]]></description>
      <guid>https://stackoverflow.com/questions/78708085/train-yolo-weights-to-recognize-one-additional-image</guid>
      <pubDate>Thu, 04 Jul 2024 16:08:46 GMT</pubDate>
    </item>
    <item>
      <title>如何转换日期格式</title>
      <link>https://stackoverflow.com/questions/78708002/how-to-convert-date-formet</link>
      <description><![CDATA[我正在用 python 训练模型，下面是我的代码！
发生了错误。
**
ValueError：无法将字符串转换为浮点数：&#39;2020-03-24&#39;
**
#将数据拆分为 x 和 y
x = tsla.drop(&quot;Date&quot;, axis=1)
y = tsla[&#39;Date&#39;]
#将数据拆分为训练和测试
x_train, x_test, y_train, y_tset = train_test_split(x,y, test_size=0.2, random_state=42)
model
model = LinearRegression()
model.fit(x_train, y_train)
我尝试在 x y 上训练模型。]]></description>
      <guid>https://stackoverflow.com/questions/78708002/how-to-convert-date-formet</guid>
      <pubDate>Thu, 04 Jul 2024 15:47:21 GMT</pubDate>
    </item>
    <item>
      <title>将最优模型应用于测试集</title>
      <link>https://stackoverflow.com/questions/78707916/to-apply-the-optimal-model-to-the-test-set</link>
      <description><![CDATA[我有一个数据集需要训练和测试，另一个数据集作为测试集。
我已经使用训练数据集获得了最佳模型，并希望将该模型应用于测试集进行预测，但遇到了此错误消息：“ValueError：特征名称应与拟合期间传递的特征名称相匹配。”
如何解决此错误？
df = pd.read_csv(&#39;training.csv&#39;)
df.drop([&#39;USAGE(0)&#39;, &#39;CUSTOMERID&#39;], axis=1, inplace=True)

# 初始化编码器并拟合训练数据
encoder = OneHotEncoder(drop=&#39;first&#39;, sparse_output=False)
encoder.fit(df.select_dtypes(include=[&#39;object&#39;]))

# 在训练数据中编码字符串类型变量
for column in df.select_dtypes(include=[&#39;object&#39;]).columns:
coded_result =coder.transform(df[[column]])
coded_df = pd.DataFrame(encoded_result, columns=encoder.get_feature_names_out([column]))
df.drop(column, axis=1, inplace=True)
df = pd.concat([df,coded_df], axis=1)

# 分离特征和标签
label = &#39;PAYMENT(0)&#39;
excluded_columns = [label]
features = [feature for feature in df.columns if feature not in excluded_columns]
X = df[features]
y = df[label]

# 训练-测试分割
test_size = 0.2
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=test_size)

# 构建并训练初始决策树模型
model = DecisionTreeClassifier(criterion=&#39;gini&#39;, min_samples_leaf=3000)
model.fit(X_train, y_train)

# 使用网格搜索和交叉验证进行超参数调整
param_grid = {
&#39;criterion&#39;: [&#39;gini&#39;, &#39;entropy&#39;],
&#39;min_samples_leaf&#39;: [10, 20, 30, 40, 50, 60, 70, 80]
}
cv = KFold(n_splits=10, shuffle=True)
grid_search = GridSearchCV(estimator=model, param_grid=param_grid, cv=cv,scoring=&#39;accuracy&#39;)
grid_search.fit(X_train, y_train)

# 训练最优模型
optimal_model = grid_search.best_estimator_

# 可视化最优决策树
plt.figure(figsize=(100, 20))
plot_tree(optimal_model, filled=True, feature_names=features)
plt.show()

# 加载新测试数据
new_test_df = pd.read_csv(&#39;trial.csv&#39;)

# 保留提交文件的“ID”列
submission_ids = new_test_df[&#39;CUSTOMERID&#39;].copy()

new_test_df.drop(&#39;USAGE(0)&#39;, axis=1, inplace=True)

# 确保所有必需的列都存在
for column in df.select_dtypes(include=[&#39;object&#39;]).columns:
if column not in new_test_df.columns:
new_test_df[column] = 0

# 在新的测试数据中编码字符串类型变量
for column in new_test_df.select_dtypes(include=[&#39;object&#39;]).columns:
coded_result =coder.transform(new_test_df[[column]]) # 使用拟合的编码器进行转换
coded_df = pd.DataFrame(encoded_result, columns=encoder.get_feature_names_out([column]))
new_test_df.drop(column, axis=1, inplace=True)
new_test_df = pd.concat([new_test_df,coded_df], axis=1)

# 确保新的测试数据具有与训练数据相同的特征列
for feature in features:
if feature not in new_test_df.columns:
new_test_df[feature] = 0
X_new_test = new_test_df[features]

# 将最佳模型应用于新测试数据
y_new_test_pred = optimal_model.predict(X_new_test)

# 将预测保存到名为“mapping.csv”的 CSV 文件中
submission = pd.DataFrame({
&#39;CUSTOMERID&#39;: submission_ids,
&#39;PAYMENT(0)&#39;: y_new_test_pred
})

submission.to_csv(&#39;mapping.csv&#39;, index=False)
]]></description>
      <guid>https://stackoverflow.com/questions/78707916/to-apply-the-optimal-model-to-the-test-set</guid>
      <pubDate>Thu, 04 Jul 2024 15:27:01 GMT</pubDate>
    </item>
    <item>
      <title>独热编码和缺失值处理</title>
      <link>https://stackoverflow.com/questions/78707613/one-hot-encoding-and-handling-of-missing-values</link>
      <description><![CDATA[我正在构建一个机器学习模型。
我决定不估算缺失值。我已将它们替换为附加类别：其他
例如，feature_A 将具有类别 A1、A2、A3 和 其他，而 feature_B 将具有类别 B1、B2 和 其他：B1、B2 和 其他。
我使用 pandas 的 get_dummy 来创建虚拟变量。
feature_A_A1、feature_A_A2、feature_A_A3、feature_A_Other、feature_B_B1、feature_B_B2、feature_Other。
最后，我删除了带有 Other 的功能。
我想知道这是否是正确的处理方式，如果它不会导致信息丢失。]]></description>
      <guid>https://stackoverflow.com/questions/78707613/one-hot-encoding-and-handling-of-missing-values</guid>
      <pubDate>Thu, 04 Jul 2024 14:17:28 GMT</pubDate>
    </item>
    <item>
      <title>如何使用 BentoML 部署 h5 格式的模型</title>
      <link>https://stackoverflow.com/questions/78707424/how-to-deploy-model-in-h5-format-with-bentoml</link>
      <description><![CDATA[我有两个项目：

我用 Tensorflow 制作的 CRNN 模型。权重以 h5 格式保存。
我目前正在学习 bentoML，并已使用 BentoML 成功部署了示例中的模型。

我需要什么：我想使用 BentoML 部署我自己的模型。
为什么我不能这样做：因为我是 BentoML 的新手，文档中只有预先训练过的模型的示例，您只需使用一些命令即可下载。还有 obj 格式的模型权重和 h5 格式的模型。
我尝试跟进示例 (https://docs.bentoml.com/en/latest/reference/frameworks/tensorflow.html)，但卡在了这一行：
self.dense = lambda input: tf.matmul(inputs, self.weights)
]]></description>
      <guid>https://stackoverflow.com/questions/78707424/how-to-deploy-model-in-h5-format-with-bentoml</guid>
      <pubDate>Thu, 04 Jul 2024 13:36:51 GMT</pubDate>
    </item>
    <item>
      <title>附加的 TimeSeries 必须在当前时间步之后的一个时间步开始</title>
      <link>https://stackoverflow.com/questions/78707349/appended-timeseries-must-start-one-time-step-after-current-one</link>
      <description><![CDATA[我收到错误
错误：darts.timeseries：ValueError：附加的 TimeSeries 必须在当前时间步后一个时间步开始。
------------------------------------------------------------------------------------------
ValueError 回溯（最近一次调用最后一次）
&lt;ipython-input-87-42786fe5dae7&gt; 在 &lt;cell line: 3&gt;()
19 covariate = covariate[last_date + covariate.freq:] # 选择从最后一个日期之后开始的部分
20 
---&gt; 21 new_covariates.append(covariates[series].append(covariate))

1 帧
/usr/local/lib/python3.10/dist-packages/darts/logging.py in raise_if_not(condition, message, logger)
77 if not condition:
78 logger.error(&quot;ValueError: &quot; + message)
---&gt; 79 raise ValueError(message)
80 
81 

ValueError: 附加的 TimeSeries 必须在当前时间步后一个时间步开始。在此代码中](https://i.sstatic.net/foJsVu6t.png)
]]></description>
      <guid>https://stackoverflow.com/questions/78707349/appended-timeseries-must-start-one-time-step-after-current-one</guid>
      <pubDate>Thu, 04 Jul 2024 13:19:18 GMT</pubDate>
    </item>
    <item>
      <title>为什么验证和训练中重构误差不同？为什么一半的测试集和验证集不同？</title>
      <link>https://stackoverflow.com/questions/78707337/why-there-is-a-different-recontructed-error-in-the-validation-and-train-why-hal</link>
      <description><![CDATA[重建错误 
请帮我理解一下这是过度拟合的问题还是其他问题：我正在用 alexnet 训练自动编码器：这可能是某些数据的拟合不足吗？除了现有的任何调节方法之外？为什么会发生这种情况？]]></description>
      <guid>https://stackoverflow.com/questions/78707337/why-there-is-a-different-recontructed-error-in-the-validation-and-train-why-hal</guid>
      <pubDate>Thu, 04 Jul 2024 13:15:21 GMT</pubDate>
    </item>
    <item>
      <title>增加 CPU 数量后，VM 上本地 LLM 的响应时间没有改善 [关闭]</title>
      <link>https://stackoverflow.com/questions/78705963/response-time-of-local-llm-on-vm-not-improving-after-increasing-number-of-cpus</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/78705963/response-time-of-local-llm-on-vm-not-improving-after-increasing-number-of-cpus</guid>
      <pubDate>Thu, 04 Jul 2024 08:39:19 GMT</pubDate>
    </item>
    <item>
      <title>鉴于我的数据集不大且大多数模型都无法生成正确的响应，我该如何训练我的聊天机器人</title>
      <link>https://stackoverflow.com/questions/78705520/how-do-i-train-my-chatbot-given-that-my-dataset-is-not-vast-large-and-most-mode</link>
      <description><![CDATA[我从 llama 开始，因为我被告知要使用 meta-llama（hugging face 上的任何一种），但由于我的笔记本电脑规格有限，meta-llama 从未进入训练阶段。甚至尝试了 meta 中的 10 亿参数模型，仍然不好。
我有一个包含原始数据的 .txt 文件（未按问题：答案对排列），所以我编写了一个脚本，首先创建一个 json 文件，在该文件中，数据按问题：答案对排列，现在我的目标是使用特定模型对其进行微调和训练。我的数据不是庞大/大，最多是小或中等。所以，我尝试了很多模型。Gpt2 等给了我糟糕的回应，所以我尝试了一些其他模型，如 Albert、tiny-bert、roberta-large，但问题是，有些问题确实得到了机器人的正确回答，但其中很大一部分都失败了。有些问题的答案只是重复的、不完整的。
我尝试了几种方法来提高效率（SBERT/TF-IDF 等），甚至尝试修改微调文件，但都无济于事。我对这一切都很陌生，所以我想知道如何继续。T
尝试了几种模型来训练我的聊天机器人，但几乎都失败了。
希望我的聊天机器人能够使用包含问题：答案对的 json 文件进行适当的训练，但是数据可能不会太大。
笔记本电脑也有一些限制（规格，例如低内存 -&gt; 8GB）]]></description>
      <guid>https://stackoverflow.com/questions/78705520/how-do-i-train-my-chatbot-given-that-my-dataset-is-not-vast-large-and-most-mode</guid>
      <pubDate>Thu, 04 Jul 2024 07:06:35 GMT</pubDate>
    </item>
    <item>
      <title>如何使用 Pytorch 从多幅图像中获取一定数量图像的梯度？而不是所有输入图像的梯度？</title>
      <link>https://stackoverflow.com/questions/78705415/how-can-i-get-the-gradient-of-a-certain-number-of-image-out-of-multiple-images-w</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/78705415/how-can-i-get-the-gradient-of-a-certain-number-of-image-out-of-multiple-images-w</guid>
      <pubDate>Thu, 04 Jul 2024 06:39:42 GMT</pubDate>
    </item>
    <item>
      <title>LangChain 与 AmzonBedrock</title>
      <link>https://stackoverflow.com/questions/78705377/langchain-with-amzonbedrock</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/78705377/langchain-with-amzonbedrock</guid>
      <pubDate>Thu, 04 Jul 2024 06:30:23 GMT</pubDate>
    </item>
    <item>
      <title>nn.Linear 如何应用于高维数据？</title>
      <link>https://stackoverflow.com/questions/78704861/how-is-nn-linear-applied-to-a-higher-dimensional-data</link>
      <description><![CDATA[我试图了解当我有更高维的张量时哪些值被乘以了：
inp = torch.rand(1,2,3) # B,C,W
linear = nn.Linear(3,4)
out = linear(inp)
print(out.shape)
&gt;&gt;&gt; torch.Size([1, 2, 4])

inp = torch.rand(1,2,3,4) # B,C,W,H
linear = nn.Linear(4,5)
out = linear(inp)
print(out.shape)
&gt;&gt;&gt; torch.Size([1, 2, 3, 5])

似乎只有最后一个维度被改变了，但是当我尝试手动将线性权重 (linear.weight.data) 与每个 inp 的最后一个维度相乘时，我无法得到正确的答案（似乎所有值都在改变，只有最后一个维度的大小以某种方式被修改）。]]></description>
      <guid>https://stackoverflow.com/questions/78704861/how-is-nn-linear-applied-to-a-higher-dimensional-data</guid>
      <pubDate>Thu, 04 Jul 2024 02:57:29 GMT</pubDate>
    </item>
    <item>
      <title>如何训练 yolov8 识别另一幅图像</title>
      <link>https://stackoverflow.com/questions/78703688/how-to-train-yolov8-to-recognize-one-additional-image</link>
      <description><![CDATA[因此，我想使用包含一张带注释图像的数据集（使用 roboflow）来训练 yolov8，以将标签添加到当前模型，以便训练后的模型能够识别新图像。
首先，我获取在 roboflow 中注释的单图像数据集，如下所示：
dataset = version.download(model_format=&quot;yolov8&quot;, location=&quot;./datasets&quot;)

然后使用以下命令训练 yolov8 模型：
results = model.train(data=&quot;/roboflow_ml_image_detection/datasets/oups-1/data.yaml&quot;, epochs=5)

然后导出新模型：
success = model.export(format=&quot;onnx&quot;)

我将再次使用它对新图像进行预测：
model = YOLO(&#39;/roboflow_ml_image_detection/runs/detect/train29/weights/last.pt&#39;)

results = model(source=&#39;./weirdobject.jpg&#39;, conf=0.25)[0]

最后尝试使用 supervision 检测图像的标签：
import surveillance as sv

detections = sv.Detections.from_ultralytics(results)

bounding_box_annotator = sv.BoundingBoxAnnotator()

label_annotator = sv.LabelAnnotator()

annotated_image = bounding_box_annotator.annotate(
scene=image, detections=detections)
annotated_image = label_annotator.annotate(
scene=annotated_image, detections=detections)

sv.plot_image(annotated_image)

但最终调用仅显示没有框架和标签的图像。
这里有什么问题？]]></description>
      <guid>https://stackoverflow.com/questions/78703688/how-to-train-yolov8-to-recognize-one-additional-image</guid>
      <pubDate>Wed, 03 Jul 2024 18:21:02 GMT</pubDate>
    </item>
    <item>
      <title>yolov8 在训练后不会启动冻结：扫描</title>
      <link>https://stackoverflow.com/questions/77893385/yolov8-doesn%c2%b4t-initiate-freezes-after-train-scanning</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/77893385/yolov8-doesn%c2%b4t-initiate-freezes-after-train-scanning</guid>
      <pubDate>Sun, 28 Jan 2024 01:33:57 GMT</pubDate>
    </item>
    </channel>
</rss>