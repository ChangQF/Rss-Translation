<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>æ ‡è®°ä¸ºæœºå™¨å­¦ä¹ çš„æ´»è·ƒé—®é¢˜ - Thinbug</title>
    <link>https://stackoverflow.com/questions/tagged/?tagnames=machine-learning&sort=active</link>
    <description>æ¥è‡ª stackoverflow.com çš„æœ€æ–° 30 ä¸ª</description>
    <lastBuildDate>Wed, 27 Mar 2024 15:15:13 GMT</lastBuildDate>
    <item>
      <title>æˆ‘åœ¨å°è¯•å¯¹å¿ƒç”µå›¾å’Œè„‘ç”µå›¾æ•°æ®æ‰§è¡ŒäºŒå…ƒåˆ†ç±»æ—¶éœ€è¦ä¸€äº›å¸®åŠ©æ¥è§£å†³ç±»åˆ«ä¸å¹³è¡¡é—®é¢˜</title>
      <link>https://stackoverflow.com/questions/78232398/i-need-some-help-in-solving-a-class-imbalance-problem-while-trying-to-perform-bi</link>
      <description><![CDATA[æˆ‘æœ‰ä¸€ä¸ªæ•°æ®é›†ï¼Œå…¶ä¸­åŒ…å« 23 åæ‚£è€…çš„å¿ƒç”µå›¾å’Œè„‘ç”µå›¾å€¼ï¼Œæ¯ä¸ªæ‚£è€…æœ‰ 18 ä¸ªè§†é¢‘ã€‚è¿™äº›è§†é¢‘ä¸æˆ‘è¯•å›¾é¢„æµ‹çš„ç›®æ ‡æƒ…ç»ªç›¸å…³ã€‚ç°åœ¨æ ¹æ®æ•°æ®é›†æœ‰ 8 ç§ç›®æ ‡æƒ…ç»ªï¼Œä½†æˆ‘å·²å°†å®ƒä»¬é‡æ–°åˆ†ç±»ä¸º 0 - éææƒ§å’Œ 1 - ææƒ§ã€‚è¿™å¯¼è‡´äº†æ¯”ä¾‹ä¸º 1:7 çš„é˜¶çº§ä¸å¹³è¡¡ï¼ˆææƒ§ï¼šä¸æ˜¯ææƒ§ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘çš„å‡†ç¡®ç‡åœ¨ 90% èŒƒå›´å†…å‡ºç°é”™è¯¯ã€‚æˆ‘çœŸçš„å¾ˆæ„Ÿæ¿€èƒ½å¸®åŠ©è§£å†³è¿™ä¸ªé—®é¢˜ã€‚
å°† numpy å¯¼å…¥ä¸º np
å°† pandas å¯¼å…¥ä¸º pd
ä» sklearn.model_selection å¯¼å…¥ train_test_split
ä» sklearn.neighbors å¯¼å…¥ KNeighborsClassifier
å°† matplotlib.pyplot å¯¼å…¥ä¸º plt
ä»sklearn.metricså¯¼å…¥confusion_matrix
ä» sklearn å¯¼å…¥ svm
ä» sklearn.datasets å¯¼å…¥ make_classification
ä» sklearn.metrics å¯¼å…¥å‡†ç¡®åº¦_åˆ†æ•°ã€ç²¾åº¦_åˆ†æ•°ã€å¬å›_åˆ†æ•°ã€f1_åˆ†æ•°
ä» sklearn.model_selection å¯¼å…¥ cross_val_score
ä» sklearn.linear_model å¯¼å…¥ LogisticRegression
ä»sklearn.metricså¯¼å…¥confusion_matrixã€recall_scoreã€ precision_scoreã€f1_scoreã€accuracy_score
ä» sklearn.model_selection å¯¼å…¥ KFold
å°†seabornå¯¼å…¥ä¸ºsns
ä» sklearn.metrics å¯¼å…¥åˆ†ç±»æŠ¥å‘Š
ä» imblearn.over_sampling å¯¼å…¥ SMOTE

defvaluate_cv_modelï¼ˆæ¨¡å‹ï¼Œæ•°æ®ï¼Œç›®æ ‡ï¼ŒkFoldsï¼‰ï¼š
    a_score = cross_val_score(æ¨¡å‹ã€æ•°æ®ã€ç›®æ ‡ã€cv=kFoldsã€è¯„åˆ†=&#39;å‡†ç¡®åº¦&#39;)
    å‡†ç¡®åº¦ = a_score.mean()
â€‹
    è¿”å›ç²¾åº¦

defplot_confusionMatrixï¼ˆclfï¼Œy_testï¼ŒX_testï¼‰ï¼š
    
    y_pred = clf.predict(X_test)
    cm = æ··æ·†çŸ©é˜µ(y_test, y_pred)
    cm = cm.astype(&#39;float&#39;) / cm.sum(axis=1)[:, np.newaxis]
    sns.heatmap(cm, annot=True, fmt=&#39;.2f&#39;, cmap=â€œè“è°ƒâ€)
    plt.ylabel(&#39;çœŸå®æ ‡ç­¾&#39;)
    plt.xlabel(&#39;é¢„æµ‹æ ‡ç­¾&#39;)
    æŠ¥å‘Š=åˆ†ç±»æŠ¥å‘Šï¼ˆy_testï¼Œy_predï¼‰
    plt.show()

    è¿”å›æŠ¥å‘Š

def KNN(X_train, y_train, X_test, y_test, num_neighbors):
    
    # åˆ›å»ºæ¨¡å‹
    KNN = KNeighborsClassifier(n_neighbors = num_neighbors)
    
    # æ‹Ÿåˆæ¨¡å‹
    KNN.fit(X_train, y_train)
    
    # è·å–å‡†ç¡®ç‡
    test_accuracy = KNN.score(X_test, y_test)
    train_accuracy = KNN.score(X_train, y_train)
    
    # é¢„æµ‹å€¼
    é¢„æµ‹ = KNN.predict(X_test)
    
    è¿”å› test_accuracyã€train_accuracyã€é¢„æµ‹ã€KNN

def SVMï¼ˆX_trainï¼Œy_trainï¼ŒX_testï¼Œy_testï¼Œå†…æ ¸ï¼‰ï¼š

    # åˆ›å»ºå¤šç±»åˆ†ç±»æ¨¡å‹
    SVM = svm.SVC(kernel=kernel, C=1, Decision_function_shape=&#39;ovo&#39;)
    
    # æ‹Ÿåˆæ¨¡å‹
    SVM.fit(X_train, y_train)
    
    # è·å–å‡†ç¡®ç‡
    test_accuracy = SVM.score(X_test, y_test)
    train_accuracy = SVM.score(X_train, y_train)
    
    # é¢„æµ‹å€¼
    é¢„æµ‹ = SVM.predict(X_test)
    
    è¿”å› test_accuracyã€train_accuracyã€é¢„æµ‹ã€SVM
def Logistic_Regression (X_train, y_train, X_test, y_test):
    
    # åˆ›å»ºå¢åŠ  max_iter çš„æ¨¡å‹
    log_reg = LogisticRegression(multi_class=&#39;å¤šé¡¹å¼&#39;, æ±‚è§£å™¨=&#39;lbfgs&#39;, max_iter=1000)

    # æ‹Ÿåˆæ¨¡å‹
    log_reg.fit(X_train, y_train)

    # è·å–å‡†ç¡®ç‡
    test_accuracy = log_reg.score(X_test, y_test)
    train_accuracy = log_reg.score(X_train, y_train)

    # é¢„æµ‹å€¼
    é¢„æµ‹ = log_reg.predict(X_test)

    è¿”å› test_accuracyã€train_accuracyã€é¢„æµ‹ã€log_reg

ECG_data = pd.read_csv(&#39;/kaggle/input/ecgdata/binary_ECG.csv&#39;)
ECG_data.drop([&#39;æœªå‘½å: 0&#39;,&#39;video_name&#39;], axis=1, inplace=True)
y_ECG = ECG_data.target
X_ECG = ECG_data.drop(&#39;ç›®æ ‡&#39;, è½´ = 1)

# åº”ç”¨ SMOTE æ¥å¤„ç†ç±»åˆ«ä¸å¹³è¡¡
smote = SMOTE(sampling_strategy=&#39;auto&#39;, random_state=42)
X_train_resampled, y_train_resampled = smote.fit_resample(X_train_ECG, y_train_ECG)

kf = KFold(n_splits=8, random_state=42 , shuffle = True)
X_train_ECGã€X_test_ECGã€y_train_ECGã€y_test_ECG = train_test_split(X_ECGã€y_ECGã€test_size = 0.2ã€random_state = 42)
y_test_ECG = np.array(y_test_ECG)

def è¯„ä¼°ï¼ˆy_testï¼Œé¢„æµ‹ï¼‰ï¼š
    å‡†ç¡®åº¦=å‡†ç¡®åº¦_åˆ†æ•°ï¼ˆy_æµ‹è¯•ï¼Œé¢„æµ‹ï¼‰
    ç²¾åº¦ = precision_score(y_test, é¢„æµ‹, å¹³å‡å€¼=&#39;åŠ æƒ&#39;)
    å¬å›ç‡=å¬å›ç‡ï¼ˆy_æµ‹è¯•ï¼Œé¢„æµ‹ï¼Œå¹³å‡å€¼=&#39;åŠ æƒ&#39;ï¼‰
    f1 = f1_score(y_test, é¢„æµ‹, å¹³å‡å€¼=&#39;åŠ æƒ&#39;)
    è¿”å›å‡†ç¡®ç‡ã€ç²¾ç¡®ç‡ã€å¬å›ç‡ã€f1

æˆ‘å°è¯•è¿‡ä½¿ç”¨ SVMã€KNN å’Œé€»è¾‘å›å½’è¿›è¡Œè®­ç»ƒã€‚åœ¨å°è¯•å®ç° SMOTE æ—¶ï¼Œæˆ‘é‡åˆ°äº†é€»è¾‘å›å½’çš„æ”¶æ•›é”™è¯¯ï¼Œå³ä½¿æˆ‘å°† max_iter å¢åŠ åˆ° python ä¸­çš„æœ€å¤§å…è®¸é™åˆ¶ï¼Œç®€å•ä¼¼ä¹ä¹Ÿä¸ä¼šæ¶ˆå¤±ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/78232398/i-need-some-help-in-solving-a-class-imbalance-problem-while-trying-to-perform-bi</guid>
      <pubDate>Wed, 27 Mar 2024 14:21:43 GMT</pubDate>
    </item>
    <item>
      <title>å¦‚ä½•å°† tfidfvectorizer çš„åŠŸèƒ½ä»è‹±è¯­ä¿®æ”¹ä¸ºè¥¿ç­ç‰™è¯­</title>
      <link>https://stackoverflow.com/questions/78232328/how-to-modify-features-of-tfidfvectorizer-from-english-to-spanish</link>
      <description><![CDATA[æˆ‘æœ‰ä¸€ä¸ª tfidfvectorizerï¼Œå®ƒé€‚åˆè‹±è¯­æ–‡æœ¬æ•°æ®æ¥é¢„æµ‹è‹±è¯­é€šè¯çš„æƒ…ç»ªã€‚ä»»åŠ¡æ˜¯å°†å…¶è½¬æ¢ä¸ºè¥¿ç­ç‰™è¯­ã€‚æˆ‘æƒ³ä½¿ç”¨æ­¤ tfidfvectorizers çš„æƒé‡ï¼Œå¹¶å¸Œæœ›å°†åŠŸèƒ½ä»è‹±è¯­è½¬æ¢ä¸ºè¥¿ç­ç‰™è¯­ï¼Œä¾‹å¦‚â€œè°¢è°¢â€å˜æˆâ€œgraciasâ€å¹¶ä½¿ç”¨æ—§çš„æƒé‡ã€‚æ‰€ä»¥æœ¬è´¨ä¸Šæˆ‘æƒ³ä½¿ç”¨ç›¸åŒçš„ tfidf çŸ¢é‡å™¨ï¼Œä½†ä¿®æ”¹äº†ç‰¹å¾åç§°ã€‚æœ‰äººå¯ä»¥å»ºè®®ä¸€äº›æ–¹æ³•åœ¨ Python ä¸­åšåˆ°è¿™ä¸€ç‚¹å—ï¼Ÿ
å¸¦æœ‰è§£å†³æ–¹æ¡ˆçš„ä»£ç ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/78232328/how-to-modify-features-of-tfidfvectorizer-from-english-to-spanish</guid>
      <pubDate>Wed, 27 Mar 2024 14:11:46 GMT</pubDate>
    </item>
    <item>
      <title>ä½¿ç”¨éš”ç¦»æ£®æ—è¿›è¡Œå¼‚å¸¸æ£€æµ‹[å…³é—­]</title>
      <link>https://stackoverflow.com/questions/78232159/anomaly-detection-with-isolation-forest</link>
      <description><![CDATA[æˆ‘æœ‰è½¦è¾†æ•°æ®ã€‚è¯¥æ•°æ®æ˜¯åœ¨ä¼šè®®ä¸­æµ‹é‡çš„ã€‚æˆ‘åœ¨æ•°æ®æ¡†ä¸­æœ‰ä¸€åˆ—æ˜¾ç¤ºæµ‹é‡ä¼šè¯ IDã€‚åœ¨â€œæ—¶é—´â€åˆ—ä¸­ï¼Œæ—¶é—´æ¯ 200 æ¯«ç§’ç´¯åŠ ä¸€æ¬¡ã€‚æµ‹é‡çš„å—å…·æœ‰ä¸åŒçš„é•¿åº¦ã€‚æœ‰äº›æ˜¯ 600000 æ¯«ç§’é•¿ï¼Œæœ‰äº›æ˜¯ 400000 æ¯«ç§’é•¿ã€‚å¦‚æœ id å‘ç”Ÿå˜åŒ–ï¼Œæ—¶é—´åˆ—ä¼šå†æ¬¡ä» 0 å¼€å§‹è®¡æ•°ã€‚æˆ‘ç°åœ¨çš„é—®é¢˜æ˜¯ï¼Œæˆ‘å¦‚ä½•å‘éš”ç¦»æ£®æ—æ•™æˆè¿™ä¸€ç‚¹ï¼Œæˆ–è€…æˆ‘å¦‚ä½•å‡†å¤‡æ•°æ®å’Œåˆ—ï¼Œä»¥ä¾¿éš”ç¦»æ£®æ—è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Ÿæˆ‘çœŸçš„éœ€è¦å°½å¿«å¾—åˆ°ä¸€ä¸ªå¥½çš„ç­”æ¡ˆã€‚éå¸¸æ„Ÿè°¢
æˆ‘æ²¡æœ‰ä»»ä½•æƒ³æ³•ã€‚ Time åˆ—ä¹Ÿåªæ˜¯ float64 çš„ç±»å‹ï¼Œå®ƒä¸æ˜¯æ—¥æœŸæ—¶é—´å¯¹è±¡ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/78232159/anomaly-detection-with-isolation-forest</guid>
      <pubDate>Wed, 27 Mar 2024 13:45:39 GMT</pubDate>
    </item>
    <item>
      <title>å¦‚ä½•åœ¨ stylegan2 ä¸­æç¤ºæ–‡æœ¬</title>
      <link>https://stackoverflow.com/questions/78231191/how-to-prompt-a-text-in-stylegan2</link>
      <description><![CDATA[æˆ‘æƒ³åœ¨stylegan2ä¸­è¾“å…¥æ–‡æœ¬æç¤ºã€‚
åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘å·²ç»èƒ½å¤Ÿä½¿ç”¨åŠ è½½ç”Ÿæˆå™¨ (G)
G,D,Gs = load_networks(&#39;gdrive:networks/stylegan2-ffhq-config-a.pkl&#39;)

å®ƒè°ƒç”¨ pretrained_networks.py æ–‡ä»¶ä¸­å®šä¹‰çš„å‡½æ•°ã€‚
ç°åœ¨ï¼Œæˆ‘ä¸çŸ¥é“å¦‚ä½•æŒ‰ç…§æˆ‘æƒ³è¦çš„æ–¹å¼ä½¿ç”¨ç”Ÿæˆå™¨ã€‚
å…·ä½“æ¥è¯´ï¼Œç»™å®šæ–‡æœ¬æç¤ºï¼Œæˆ‘æƒ³æˆ‘åº”è¯¥ï¼š

å¯¹ numpy æ•°ç»„ä¸­çš„æ–‡æœ¬è¿›è¡Œç¼–ç 
ä½¿ç”¨æ­¤ç¼–ç æä¾›ç”Ÿæˆå™¨

ä½†æ˜¯æˆ‘è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/78231191/how-to-prompt-a-text-in-stylegan2</guid>
      <pubDate>Wed, 27 Mar 2024 11:04:39 GMT</pubDate>
    </item>
    <item>
      <title>å°½ç®¡ PyTorch çš„å­¦ä¹ ç‡é™ä½ï¼ŒFISTA ä¼˜åŒ–å¹¶æœªå‡å°‘æŸå¤±</title>
      <link>https://stackoverflow.com/questions/78231057/fista-optimization-not-reducing-loss-despite-decreasing-learning-rate-in-pytorch</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/78231057/fista-optimization-not-reducing-loss-despite-decreasing-learning-rate-in-pytorch</guid>
      <pubDate>Wed, 27 Mar 2024 10:44:19 GMT</pubDate>
    </item>
    <item>
      <title>é›†æˆæ¢¯åº¦ä¸‹é™å’Œ ISTA é€šè¿‡æ­£åˆ™åŒ–æœ€å°åŒ–è‡ªå®šä¹‰æŸå¤±å‡½æ•°</title>
      <link>https://stackoverflow.com/questions/78230490/integrating-gradient-descent-and-ista-for-minimizing-a-custom-loss-function-with</link>
      <description><![CDATA[æˆ‘æ­£åœ¨ç ”ç©¶ä¸€ä¸ªé—®é¢˜ï¼Œç›®æ ‡æ˜¯æœ€å°åŒ–æŸå¤±å‡½æ•°ï¼Œè¯¥æŸå¤±å‡½æ•°æ˜¯æ ‡å‡†æŸå¤±åº¦é‡å’Œæ­£åˆ™åŒ–é¡¹çš„ç»„åˆã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘çš„ç›®æ ‡å‡½æ•°çš„å½¢å¼ä¸ºï¼šL(y, m_t(x))+ l* P(t)
åœ°ç‚¹ï¼š

L ä»£è¡¨æŸå¤±åº¦é‡ã€‚
y æ˜¯å®é™…ç»“æœã€‚
x è¡¨ç¤ºè¾“å…¥æ•°æ®ã€‚
t æ˜¯æ¨¡å‹çš„å‚æ•°å‘é‡ã€‚
m_t æ˜¯ç”± t å‚æ•°åŒ–çš„æ¨¡å‹ã€‚
P(t) æ˜¯å‚æ•°çš„æƒ©ç½šå‡½æ•°ï¼Œä»¥é¼“åŠ±æŸäº›å±æ€§ï¼ˆä¾‹å¦‚ç¨€ç–æ€§ï¼‰ã€‚
Î» æ˜¯æ­£åˆ™åŒ–ç³»æ•°ã€‚

æˆ‘çš„é—®é¢˜å›´ç»•ä¼˜åŒ–ç­–ç•¥ã€‚æˆ‘æ­£åœ¨è€ƒè™‘é¦–å…ˆä½¿ç”¨æ¢¯åº¦ä¸‹é™ï¼ˆGDï¼‰æ¥æœ€å°åŒ–å‡½æ•°ï¼Œç›´åˆ°å®ƒåœæ­¢å–å¾—é‡å¤§è¿›å±•ã€‚åœ¨ GD è¾¾åˆ°è¿™ä¸ªå¹³å°åï¼Œæˆ‘æ­£åœ¨è€ƒè™‘åˆ‡æ¢åˆ°è¿­ä»£æ”¶ç¼©é˜ˆå€¼ç®—æ³•ï¼ˆISTAï¼‰æ¥è¿›ä¸€æ­¥ç»†åŒ–è§£å†³æ–¹æ¡ˆï¼Œç‰¹åˆ«æ˜¯æœ‰æ•ˆåœ°åˆå¹¶æ­£åˆ™åŒ–éƒ¨åˆ†ã€‚
ä½†æ˜¯ï¼Œæˆ‘ä¸ç¡®å®šç»“åˆè¿™ä¸¤ç§ä¼˜åŒ–æŠ€æœ¯çš„æœ€ä½³æ–¹æ³•ã€‚å…·ä½“æ¥è¯´ï¼š
æˆ‘æ˜¯å¦åº”è¯¥å°† GD ä¸“é—¨åº”ç”¨äºæŸå¤±é¡¹ L(y,m_t(x))â€‹ï¼Œç„¶åä½¿ç”¨ ISTA å¤„ç†åŒ…æ‹¬æ­£åˆ™åŒ–é¡¹åœ¨å†…çš„æ•´ä¸ªæˆæœ¬å‡½æ•°ï¼Ÿ
ä¼˜åŒ–è¿‡ç¨‹ä¸­æ˜¯å¦å­˜åœ¨åœ¨ GD å’Œ ISTA ä¹‹é—´è½¬æ¢çš„æ¨èæ–¹æ³•æˆ–æœ€ä½³å®è·µï¼Ÿ
åœ¨é’ˆå¯¹æ­¤ç±»é—®é¢˜é›†æˆè¿™äº›ä¼˜åŒ–æ–¹æ³•æ—¶ï¼Œæˆ‘æ˜¯å¦åº”è¯¥æ³¨æ„ä»»ä½•æ½œåœ¨çš„é™·é˜±æˆ–æ³¨æ„äº‹é¡¹ï¼Ÿ
ä»»ä½•è§è§£ã€å¯¹ç±»ä¼¼å®ç°çš„å‚è€ƒæˆ–æœ‰å…³å¦‚ä½•è§£å†³æ­¤é—®é¢˜çš„æŒ‡å¯¼å°†ä¸èƒœæ„Ÿæ¿€ã€‚
é¢„å…ˆæ„Ÿè°¢æ‚¨çš„å¸®åŠ©ï¼]]></description>
      <guid>https://stackoverflow.com/questions/78230490/integrating-gradient-descent-and-ista-for-minimizing-a-custom-loss-function-with</guid>
      <pubDate>Wed, 27 Mar 2024 09:11:49 GMT</pubDate>
    </item>
    <item>
      <title>å†…æ ¸é‡æ–°â€‹â€‹å¯åŠ¨ Untitled2.ipynb çš„å†…æ ¸ä¼¼ä¹å·²æ­»äº¡ã€‚å­˜å‚¨tfliteæ¨¡å‹æ—¶ä¼šè‡ªåŠ¨é‡å¯</title>
      <link>https://stackoverflow.com/questions/78230023/kernel-restarting-the-kernel-for-untitled2-ipynb-appears-to-have-died-it-will-r</link>
      <description><![CDATA[æˆ‘æ­£åœ¨ä½¿ç”¨ ml.g4dn.xlarge å®ä¾‹åœ¨ sagemaker å®ä¾‹ä¸Šè¿è¡Œç¬”è®°æœ¬ã€‚
æˆ‘æ­£åœ¨å°è¯•åˆ›å»ºå¦‚ä¸‹æ‰€ç¤ºçš„ tflite æ¨¡å‹
ä¿å­˜æ¨¡å‹
model.save(os.path.join(model_dir, &#39;model.h5&#39;))
# å°†æ¨¡å‹è½¬æ¢å¹¶ä¿å­˜ä¸º TensorFlow Lite
è½¬æ¢å™¨ = tf.lite.TFLiteConverter.from_keras_model(æ¨¡å‹)
converter.experimental_new_converter = True # å¯ç”¨åŸºäº MLIR çš„è½¬æ¢æµç¨‹
converter.debug_info = True # å¯ç”¨è°ƒè¯•.mliræ–‡ä»¶çš„ç”Ÿæˆ
tflite_model =è½¬æ¢å™¨.convert()

æ‰“å¼€ï¼ˆos.path.joinï¼ˆmodel_dirï¼Œ&#39;model.tflite&#39;ï¼‰ï¼Œ&#39;wb&#39;ï¼‰ä½œä¸ºfï¼š
    f.write(tflite_model)

æˆ‘æ”¶åˆ°é”™è¯¯
å†…æ ¸é‡å¯
Untitled2.ipynb çš„å†…æ ¸ä¼¼ä¹å·²ç»æ­»äº¡ã€‚å®ƒä¼šè‡ªåŠ¨é‡æ–°å¯åŠ¨ã€‚

æˆ‘æ£€æŸ¥äº†ä¸€äº›è¦æ±‚å‡çº§å®ä¾‹ç±»å‹çš„é“¾æ¥ã€‚æˆ‘å°†å…¶å‡çº§åˆ° ml.g4dn.xlarge ä½†ä»ç„¶ç»™å‡ºç›¸åŒçš„é”™è¯¯ã€‚æœ‰ä»€ä¹ˆå»ºè®®å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› å—ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/78230023/kernel-restarting-the-kernel-for-untitled2-ipynb-appears-to-have-died-it-will-r</guid>
      <pubDate>Wed, 27 Mar 2024 07:42:02 GMT</pubDate>
    </item>
    <item>
      <title>ä¸ºä»€ä¹ˆæˆ‘æ— æ³•åœ¨å‡½æ•°è°ƒç”¨ä¸­è®¿é—®å¯¹è±¡é”®</title>
      <link>https://stackoverflow.com/questions/78229600/why-cant-i-access-an-object-key-within-a-function-call</link>
      <description><![CDATA[æˆ‘è¯•å›¾é€šè¿‡åœ¨æ­¤å‡½æ•° graphics.drawPoint(ctx,pixelLoc, utils.æ ·å¼[æ ‡ç­¾].color);
æ¥è‡ª Radu çš„ä»£ç ï¼šæ— é»‘ç›’æœºå™¨å­¦ä¹ 
utils.styles={
    æ±½è½¦ï¼š{é¢œè‰²ï¼š&#39;ç°è‰²&#39;ï¼Œæ–‡æœ¬ï¼š&#39;ğŸš“&#39;}ï¼Œ
    é±¼ï¼š{é¢œè‰²ï¼š&#39;çº¢è‰²&#39;ï¼Œæ–‡æœ¬ï¼š&#39;ğŸ &#39;}ï¼Œ
    æˆ¿å­: { color:&#39;yellow&#39;, text:&#39;ğŸš&#39; },
    æ ‘ï¼š{é¢œè‰²ï¼š&#39;ç»¿è‰²&#39;ï¼Œæ–‡æœ¬ï¼š&#39;ğŸŒ³&#39;}ï¼Œ
    è‡ªè¡Œè½¦: { color:&#39;cyan&#39;, text:&#39;ğŸš²&#39; },
    guiter: { color:&#39;blue&#39;, text:&#39;ğŸ¸&#39; },
    é“…ç¬”ï¼š{é¢œè‰²ï¼š&#39;æ´‹çº¢è‰²&#39;ï¼Œæ–‡æœ¬ï¼š&#39;âœ&#39;}ï¼Œ
    æ—¶é’Ÿï¼š{ é¢œè‰²ï¼š&#39;lightgray&#39;ï¼Œæ–‡æœ¬ï¼š&#39;â²&#39; }
}

forï¼ˆæ ·æœ¬çš„å¸¸é‡æ ·æœ¬ï¼‰{
  const {ç‚¹ï¼Œæ ‡ç­¾}=æ ·æœ¬ï¼›


sample æ˜¯ä»¥æ ‡ç­¾ä½œä¸ºé”®çš„å¯¹è±¡é›†åˆ[&#39;car&#39;,&#39;fish&#39;,&#39;house...&#39;clock&#39;] ä¸ uitils.styles ç›¸åŒ&gt;
graphics.drawPoint(utils.styles[label].color);

è¿™ä¼šäº§ç”Ÿä¸€æ¡é”™è¯¯æ¶ˆæ¯ï¼šUncaught TypeError:
&lt;å—å¼•ç”¨&gt;
æ— æ³•è¯»å–æœªå®šä¹‰çš„å±æ€§ï¼ˆè¯»å–â€œé¢œè‰²â€ï¼‰
]]></description>
      <guid>https://stackoverflow.com/questions/78229600/why-cant-i-access-an-object-key-within-a-function-call</guid>
      <pubDate>Wed, 27 Mar 2024 05:56:17 GMT</pubDate>
    </item>
    <item>
      <title>ç”¨äºè§£æï¼ˆå†³ç­–æ ‘ï¼‰ç»˜åˆ¶å›¾è¡¨çš„æ³•å­¦ç¡•å£«ï¼Ÿ [å…³é—­]</title>
      <link>https://stackoverflow.com/questions/78227894/llm-for-parsing-drawn-diagrams-of-decision-trees</link>
      <description><![CDATA[
æˆ‘æ­£åœ¨å¯»æ‰¾ä¸€ç§å¼€æºæ³•å­¦ç¡•å£«ï¼Œå®ƒèƒ½å¤Ÿæ¥å—ä¸ä¸Šè¿°ç±»ä¼¼çš„å†³ç­–æ ‘æŸ¥è¯¢ã€‚è¿™æ˜¯å¦æ„å‘³ç€æ‰¾åˆ°æœ€å¥½çš„å¼€æº ViT æ¨¡å‹ï¼Ÿæˆ–è€…æ˜¯å¦æœ‰æ›´å¥½çš„æ–¹æ³•ï¼Œä¾‹å¦‚ä»¥æŸç§æ–¹å¼å°†æ ‘é¢„å¤„ç†ä¸ºæ–‡æœ¬å¹¶å‘æ³•å­¦ç¡•å£«è¯¢é—®ï¼Ÿè€ƒè™‘åˆ°æˆ‘ä»…å¯¹å¼€æºæ¨¡å‹çš„é™åˆ¶ï¼Œä»€ä¹ˆæ€§èƒ½ä¼šæ›´å¥½ï¼Ÿ
æˆ‘å·²ç»å°è¯•è¿‡ ChatGPT4ï¼Œå®ƒä¼¼ä¹è¡¨ç°å¾—å¾ˆå¥½ï¼Œä½†æˆ‘å¸Œæœ›åœ¨æœ¬åœ°è¿è¡Œæ‰€æœ‰å†…å®¹ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/78227894/llm-for-parsing-drawn-diagrams-of-decision-trees</guid>
      <pubDate>Tue, 26 Mar 2024 20:03:23 GMT</pubDate>
    </item>
    <item>
      <title>â€œMENACEâ€äº•å­—æ£‹ç”µè„‘éœ€è¦å¤šå°‘åœºæ¯”èµ›æ‰èƒ½è®­ç»ƒ</title>
      <link>https://stackoverflow.com/questions/78219696/how-many-games-will-a-menace-tic-tac-toe-computer-take-to-train</link>
      <description><![CDATA[æˆ‘æœ€è¿‘è¯»åˆ°äº†å”çº³å¾·Â·ç±³å¥‡ (Donald Michie) è®¾è®¡çš„ç”¨ç«æŸ´ç›’å»ºé€ çš„â€œè®¡ç®—æœºâ€ï¼Œå®ƒå¯ä»¥è‡ªå­¦å¦‚ä½•ç©äº•å­—æ¸¸æˆã€‚è¿™æ˜¯å…³äºå®ƒçš„ç»´åŸºç™¾ç§‘æ–‡ç« ï¼š
https://en.m.wikipedia.org/wiki/Matchbox_Educable_Noughts_and_Crosses_Engine 
æˆ‘è§‰å¾—å®ƒçœ‹èµ·æ¥å¾ˆæœ‰è¶£ï¼Œæ‰€ä»¥æˆ‘å†³å®šç”¨ Python åˆ¶ä½œä¸€ä¸ªæ•°å­—ç‰ˆæœ¬ï¼Œä»¥ä¾›å¨±ä¹å’Œç»ƒä¹ ã€‚å®ƒåœ¨å¯¹æŠ—éšæœºèµ°æ£‹æ—¶æ•ˆæœå¾ˆå¥½ï¼ˆæˆ‘åˆšåˆšæ ¹æ®çº¦ 10,000 åœºæ¯”èµ›ç”Ÿæˆçš„æ•°æ®å†æ¬¡è¿è¡Œäº† 5353 åœºæ¯”èµ›ï¼Œå®ƒèµ¢å¾—äº† 5353 åœºæ¯”èµ›ä¸­çš„ 4757 åœºï¼‰ï¼Œä½†å®ƒä»ç„¶ç»å¸¸è¾“ç»™æˆ‘ã€‚
ä»¥ä¸‹æ˜¯å®Œç¾ç­”æ¡ˆåº”è§£å†³çš„ä¸€äº›é—®é¢˜ï¼š

éœ€è¦ç©å¤šå°‘åœºæ¸¸æˆæ‰èƒ½è®©â€œç«æŸ´ç›’ç”µè„‘â€ä¸ Michie è®¾è®¡çš„ç”µè„‘å®Œå…¨ä¸€æ ·ï¼Œæ‰èƒ½å®Œç¾åœ°å¼€å§‹ç©æ¸¸æˆï¼Ÿ

å¸¦æœ‰å®é™…ç«æŸ´ç›’çš„åŸå§‹è®¡ç®—æœºæ˜¯å¦è¾¾åˆ°äº†å®Œç¾çŠ¶æ€
ç©å—ï¼Ÿ

å¦‚æœä»…ä¸è®¡ç®—æœºè¿›è¡Œè®­ç»ƒï¼Œè®¡ç®—æœºèƒ½å¦è¾¾åˆ°å®Œç¾çš„å‘æŒ¥
éšæœºç§»åŠ¨ï¼Ÿ


ç¼–è¾‘ï¼š
è¿™ä¸ªé—®é¢˜å¹¶ä¸æ˜¯å¯»æ±‚ä»£ç æ–¹é¢çš„å¸®åŠ©ï¼Œä½†ä¸‹é¢çš„è¯„è®ºè¡¨æ˜åŒ…å«ä»£ç å¯èƒ½ä¼šæœ‰æ‰€å¸®åŠ©ã€‚ä»¥ä¸‹æ˜¯æˆ‘åˆ›å»ºçš„ GitHub å­˜å‚¨åº“çš„é“¾æ¥ï¼Œä»¥ä¾¿æˆ‘å¯ä»¥åœ¨æ­¤å¤„å…±äº«ï¼š
https://github.com/ACertainArchangel/ Recreation-Of-MENACE-Tic-Tac-Toe..git
æŠ±æ­‰ï¼Œæˆ‘çŸ¥é“è¿™ä¸å¤ªå¥½å¹¶ä¸”ä¸éµå®ˆçº¦å®šï¼›æˆ‘åªå†™äº†å‡ ä¸ªæœˆçš„ä»£ç :)]]></description>
      <guid>https://stackoverflow.com/questions/78219696/how-many-games-will-a-menace-tic-tac-toe-computer-take-to-train</guid>
      <pubDate>Mon, 25 Mar 2024 14:12:37 GMT</pubDate>
    </item>
    <item>
      <title>ä½¿ç”¨ MPI ä¼˜åŒ– Optuna å‚æ•°</title>
      <link>https://stackoverflow.com/questions/78218072/optuna-parameter-optimisation-with-mpi</link>
      <description><![CDATA[æˆ‘æœ‰ä¸€äº›æœºå™¨å­¦ä¹ ä»£ç ï¼Œå®ƒä½¿ç”¨ SVMï¼ˆæ¥è‡ª scikit-learnï¼‰å’Œé¢„è®¡ç®—å†…æ ¸ï¼Œæˆ‘æƒ³ä½¿ç”¨ optuna å¯¹å…¶è¿›è¡Œä¼˜åŒ–ï¼Œå› æ­¤ä»£ç ç®€å•åœ°çœ‹èµ·æ¥æœ‰ç‚¹åƒè¿™æ ·
def ç›®æ ‡ï¼ˆè¯•ç”¨ï¼šè¯•ç”¨ï¼Œfast_check=Trueï¼Œtarget_meter=0ï¼Œreturn_info=Falseï¼‰ï¼š
     #è®¾ç½®å‚æ•°
     C = Trial.suggest_float(â€œCâ€,0.0â€‹â€‹1,5)
     tol = Trial.suggest_loguniform(â€œtolâ€,1e-4,1e-1)
     å†…æ ¸å‚æ•° = ...

     #æ„å»ºç«è½¦å†…æ ¸
     å†…æ ¸è®­ç»ƒ = ...

     #æ„å»ºæµ‹è¯•å†…æ ¸
     å†…æ ¸æµ‹è¯• = ...

     #ç«è½¦æœåŠ¡
     svc = SVC(å†…æ ¸=â€œé¢„è®¡ç®—â€, C=C, tol=tol)
     svc.fit(kernel_train, train_labels)
     test_predict = svc.predict(kernel_test)
     test_auc = roc_auc_score(test_labels,test_predict)

     è¿”å›æµ‹è¯•_auc

Study = optuna.create_study(direction=â€œæœ€å¤§åŒ–â€,study_name=&#39;study_1&#39;)
ç ”ç©¶.ä¼˜åŒ–ï¼ˆç›®æ ‡ï¼Œn_Trials=40ï¼‰


ä½†æ˜¯ï¼Œç”±äºæˆ‘æ­£åœ¨è®¡ç®—çš„å†…æ ¸çš„å¤æ‚æ€§ï¼Œæˆ‘ä½¿ç”¨ mpi4py æ¥å¹¶è¡Œè®¡ç®—ï¼Œä½†åŒâ€‹â€‹æ—¶ä½¿ç”¨ optuna å’Œ MPI æ—¶é‡åˆ°ä¸€äº›é—®é¢˜ã€‚
æ˜¾ç„¶ï¼Œæˆ‘æƒ³è¦å¤šä¸ªå¤„ç†å™¨ä¸Šçš„å†…æ ¸ä»£ç ï¼Œä½†æ˜¯å½“æˆ‘åˆ›å»ºç ”ç©¶å¹¶ä¼˜åŒ–å®ƒæ—¶ï¼Œæˆ‘ä¸æƒ³åœ¨å¤„ç†å™¨ä¸Šåˆ›å»ºå¤šä¸ªä¸åŒçš„ç ”ç©¶ï¼Œæˆ‘åªæƒ³å¯¹æ ¹è¿›è¡Œä¼˜åŒ–çš„ä¸€é¡¹ç ”ç©¶ï¼ˆæˆ‘å‡è®¾ï¼Ÿï¼‰ã€‚æˆ‘å·²ç»å°è¯•äº†ä¸‹é¢çš„æ–¹æ³•ï¼Œå®ƒæœ‰æ•ˆï¼Œä½†æ˜¯å½“æˆ‘ä¸ä½¿ç”¨ MPI æ—¶ï¼Œå®ƒçš„ä¼˜åŒ–æ•ˆæœä¸ä½³ï¼Œæˆ‘è®¤ä¸ºè¿™æ­£åœ¨åˆ›å»ºå¤šé¡¹ç ”ç©¶å¹¶ä¼˜åŒ–å®ƒä»¬ï¼Œè¿™ä¼¼ä¹æ•ˆç‡ä¸é«˜ã€‚ä¼¼ä¹æ›´éš¾ä»¥æ”¶æ•›åˆ°æœ€ä½³å‚æ•°ã€‚
ä» mpi4py å¯¼å…¥ MPI

mpi_comm = MPI.COMM_WORLD
æ’å = mpi_comm.Get_rank()
n_procs = mpi_comm.Get_size()
æ ¹=0

defç›®æ ‡ï¼ˆè¯•éªŒï¼šè¯•éªŒï¼Œfast_check = Trueï¼Œtarget_meter = 0ï¼Œreturn_info = Falseï¼‰ï¼š
     #è®¾ç½®å‚æ•°
     C = Trial.suggest_float(â€œCâ€,0.0â€‹â€‹1,5)
     tol = Trial.suggest_loguniform(â€œtolâ€,1e-4,1e-1)
     å†…æ ¸å‚æ•° = ...

     #ä½¿ç”¨ MPI æ„å»ºè®­ç»ƒå†…æ ¸
     å†…æ ¸è®­ç»ƒ = ...

     #ä½¿ç”¨MPIæ„å»ºæµ‹è¯•å†…æ ¸
     å†…æ ¸æµ‹è¯• = ...

     #ç«è½¦æœåŠ¡
     å¦‚æœæ’å==æ ¹ï¼š
           svc = SVC(å†…æ ¸=â€œé¢„è®¡ç®—â€, C=C, tol=tol)
           svc.fit(kernel_train, train_labels)
           test_predict = svc.predict(kernel_test)
           test_auc = roc_auc_score(test_labels,test_predict)
     åˆ«çš„ï¼š
           æµ‹è¯•_auc = 0
     test_auc = mpi_comm.bcast(test_auc, root=0)

å¦‚æœæ’å==æ ¹ï¼š
     Study = optuna.create_study(direction=â€œæœ€å¤§åŒ–â€,study_name=&#39;study_1&#39;)
åˆ«çš„ï¼š
     ç ”ç©¶ = 0
 ç ”ç©¶= mpi_comm.bcastï¼ˆç ”ç©¶ï¼Œæ ¹= 0ï¼‰

ç ”ç©¶.ä¼˜åŒ–ï¼ˆç›®æ ‡ï¼Œn_Trials=40ï¼‰

è¿™æ˜¯ä¸€ä¸ªéå¸¸å°ä¼—çš„é—®é¢˜ï¼Œä½†åªæ˜¯æƒ³çŸ¥é“æ˜¯å¦æœ‰äººå¯¹è¿™äº›è½¯ä»¶åŒ…æœ‰ä»»ä½•ç»éªŒï¼Œå¹¶ä¸”å¯ä»¥å¸®åŠ©å»ºè®®å¦‚ä½•è¿è¡Œå¤šå¤„ç†ä»£ç ï¼ŒåŒæ—¶ä»…ä¼˜åŒ–ä¸€ä¸ªå¤„ç†å™¨ä¸Šçš„å‚æ•°ã€‚å¦‚æœæœ‰ä»»ä½•æœ¯è¯­ä¸æ­£ç¡®ï¼Œæˆ‘æ·±è¡¨æ­‰æ„ï¼Œæˆ‘æ˜¯ä½¿ç”¨è¿™ä¸¤ä¸ªè½¯ä»¶åŒ…çš„æ–°æ‰‹ï¼Œå› æ­¤è¯·è€å¿ƒç­‰å¾…ã€‚ :)]]></description>
      <guid>https://stackoverflow.com/questions/78218072/optuna-parameter-optimisation-with-mpi</guid>
      <pubDate>Mon, 25 Mar 2024 09:20:08 GMT</pubDate>
    </item>
    <item>
      <title>scikeras.wrappers.KerasClassifier è¿”å› ValueErrorï¼šæ— æ³•è§£é‡ŠæŒ‡æ ‡æ ‡è¯†ç¬¦ï¼šloss</title>
      <link>https://stackoverflow.com/questions/78089332/scikeras-wrappers-kerasclassifier-returning-valueerror-could-not-interpret-metr</link>
      <description><![CDATA[æˆ‘æ­£åœ¨ç ”ç©¶ KerasClassifierï¼Œå› ä¸ºæˆ‘æƒ³å°†å…¶æ’å…¥ scikit-learn ç®¡é“ä¸­ï¼Œä½†æˆ‘æ”¶åˆ°äº†å‰é¢æåˆ°çš„ ValueErrorã€‚
ä»¥ä¸‹ä»£ç åº”è¯¥èƒ½å¤Ÿé‡ç°æˆ‘é‡åˆ°çš„é”™è¯¯ï¼š
ä» sklearn.model_selection å¯¼å…¥ KFoldï¼Œcross_val_score
ä» sklearn.preprocessing å¯¼å…¥ StandardScaler
ä» scikeras.wrappers å¯¼å…¥ KerasClassifier
ä»tensorflow.keras.modelså¯¼å…¥é¡ºåº
ä»tensorflow.keras.layerså¯¼å…¥Dense
ä» sklearn.datasets å¯¼å…¥ load_iris
å°† numpy å¯¼å…¥ä¸º np

æ•°æ® = load_iris()
X = æ•°æ®.æ•°æ®
y = æ•°æ®.ç›®æ ‡

def create_model():
    æ¨¡å‹=é¡ºåºï¼ˆï¼‰
    model.addï¼ˆå¯†é›†ï¼ˆ8ï¼Œinput_dim = 4ï¼Œæ¿€æ´»=&#39;relu&#39;ï¼‰ï¼‰
    model.addï¼ˆå¯†é›†ï¼ˆ3ï¼Œæ¿€æ´»=&#39;softmax&#39;ï¼‰ï¼‰
    model.compile(loss=&#39;sparse_categorical_crossentropy&#39;,
                  ä¼˜åŒ–å™¨=&#39;äºšå½“&#39;,
                  æŒ‡æ ‡=[&#39;å‡†ç¡®æ€§&#39;])
    è¿”å›æ¨¡å‹

clf = KerasClassifier(build_fn=create_model,
                      çºªå…ƒ=100ï¼Œ
                      æ‰¹é‡å¤§å°=10ï¼Œ
                      è¯¦ç»†=1)

ç®¡é“=ç®¡é“([
    (&#39;ç¼©æ”¾å™¨&#39;, StandardScaler()),
    ï¼ˆ&#39;clf&#39;ï¼Œclfï¼‰
]ï¼‰

kf = KFold(n_splits=5, shuffle=True, random_state=42)
ç»“æœ= cross_val_scoreï¼ˆç®¡é“ï¼ŒXï¼Œyï¼Œcv = kfï¼‰
print(&quot;äº¤å‰éªŒè¯å‡†ç¡®åº¦ï¼š&quot;, np.mean(ç»“æœ))

ä¼¼ä¹æˆ‘çš„æ¨¡å‹æ­£åœ¨éšç€çºªå…ƒçš„è¿è¡Œè€Œè¢«ç¼–è¯‘ã€‚ä½†æ˜¯ï¼Œä¹‹åæˆ‘æ”¶åˆ°é”™è¯¯ï¼š
ValueErrorï¼šæ— æ³•è§£é‡ŠæŒ‡æ ‡æ ‡è¯†ç¬¦ï¼šä¸¢å¤±

tensorflow å’Œ scikeras åº“çš„ç‰ˆæœ¬æ˜¯ï¼š
scikeras==0.12.0
å¼ é‡æµ==2.15.0

ç¼–è¾‘ï¼š
æœ€ç»ˆæˆ‘å°è¯•äº†ä¸åŒçš„åº“ç‰ˆæœ¬ï¼Œä»¥ä¸‹å†…å®¹è®©æˆ‘æˆåŠŸè¿è¡Œäº†ä»£ç ï¼Œçœ‹æ¥é—®é¢˜æ˜¯ç”± scikit-learn çš„ç‰ˆæœ¬å¼•èµ·çš„ï¼š
scikeras==0.12.0
å¼ é‡æµ==2.15.0
scikitå­¦ä¹ ==1.4.1
]]></description>
      <guid>https://stackoverflow.com/questions/78089332/scikeras-wrappers-kerasclassifier-returning-valueerror-could-not-interpret-metr</guid>
      <pubDate>Fri, 01 Mar 2024 17:03:39 GMT</pubDate>
    </item>
    <item>
      <title>ValueErrorï¼šå±‚equential_40çš„è¾“å…¥0ä¸è¯¥å±‚ä¸å…¼å®¹ï¼šé¢„æœŸmin_ndim = 3ï¼Œå‘ç°ndim = 2ã€‚æ”¶åˆ°å®Œæ•´å½¢çŠ¶ï¼šï¼ˆæ— ï¼Œ58ï¼‰</title>
      <link>https://stackoverflow.com/questions/72743778/valueerror-input-0-of-layer-sequential-40-is-incompatible-with-the-layer-expec</link>
      <description><![CDATA[æˆ‘æ­£åœ¨ç ”ç©¶æœ‰å…³å­¦ç”Ÿåœ¨è¯¾ç¨‹ä¸­è¡¨ç°çš„æ•°æ®é›†ï¼Œæˆ‘æƒ³æ ¹æ®å­¦ç”Ÿä¸Šä¸€å¹´çš„æˆç»©æ¥é¢„æµ‹å­¦ç”Ÿçš„æ°´å¹³ï¼ˆä½ã€ä¸­ã€é«˜ï¼‰ã€‚æˆ‘æ­£åœ¨ä½¿ç”¨ CNN æ¥å®ç°æ­¤ç›®çš„ï¼Œä½†æ˜¯å½“æˆ‘æ„å»ºå¹¶æ‹Ÿåˆæ¨¡å‹æ—¶ï¼Œæˆ‘æ”¶åˆ°æ­¤é”™è¯¯ï¼š
ValueErrorï¼šå±‚equential_40çš„è¾“å…¥0ä¸å±‚ä¸å…¼å®¹ï¼šï¼šé¢„æœŸmin_ndim = 3ï¼Œå‘ç°ndim = 2ã€‚æ”¶åˆ°å®Œæ•´å½¢çŠ¶ï¼šï¼ˆæ— ï¼Œ58ï¼‰

è¿™æ˜¯ä»£ç ï¼š
#é‡å¡‘æ•°æ®
X_train = X_train.reshape((X_train.shape[0], X_train.shape[1]))
X_test = X_test.reshape((X_test.shape[0], X_test.shape[1]))

#æ£€æŸ¥é‡å¡‘åçš„å½¢çŠ¶
æ‰“å°ï¼ˆX_train.shapeï¼‰
æ‰“å°ï¼ˆX_test.shapeï¼‰

#æ ‡å‡†åŒ–åƒç´ å€¼
X_train=X_train/255
X_æµ‹è¯•=X_æµ‹è¯•/255

#å®šä¹‰æ¨¡å‹
æ¨¡å‹=é¡ºåº()

#æ·»åŠ å·ç§¯å±‚
model.add(Conv1D(32,3ï¼Œæ¿€æ´»=&#39;relu&#39;ï¼Œinput_shape=(28,1)))

#æ·»åŠ æ± åŒ–å±‚
model.add(MaxPool1D(pool_size=2))

#æ·»åŠ å…¨è¿æ¥å±‚
æ¨¡å‹.add(å‹å¹³())
model.add(å¯†é›†(100,activation=&#39;relu&#39;))

#æ·»åŠ è¾“å‡ºå±‚
model.add(å¯†é›†(10,activation=&#39;softmax&#39;))

#ç¼–è¯‘æ¨¡å‹
model.compile(loss=&#39;sparse_categorical_crossentropy&#39;,optimizer=&#39;adam&#39;,metrics=[&#39;accuracy&#39;])

æ¨¡å‹.summary()

#æ‹Ÿåˆæ¨¡å‹
model.fit(X_train,y_train,epochs=10)

è¿™æ˜¯è¾“å‡ºï¼š
å‹å·ï¼šâ€œsequential_40â€
_________________________________________________________________
å±‚ï¼ˆç±»å‹ï¼‰è¾“å‡ºå½¢çŠ¶å‚æ•°#
=================================================== ===============
conv1d_23ï¼ˆConv1Dï¼‰ï¼ˆæ— ã€9ã€32ï¼‰128
_________________________________________________________________
max_pooling1d_19ï¼ˆæœ€å¤§æ± åŒ–ï¼ˆæ— ã€4ã€32ï¼‰0
_________________________________________________________________
flatten_15ï¼ˆå‹å¹³ï¼‰ï¼ˆæ— ï¼Œ128ï¼‰0
_________________________________________________________________
å¯†é›†_30ï¼ˆå¯†é›†ï¼‰ï¼ˆæ— ï¼Œ100ï¼‰12900
_________________________________________________________________
å¯†é›†_31ï¼ˆå¯†é›†ï¼‰ï¼ˆæ— ï¼Œ10ï¼‰1010
=================================================== ===============
æ€»å‚æ•°ï¼š14,038
å¯è®­ç»ƒå‚æ•°ï¼š14,038
ä¸å¯è®­ç»ƒå‚æ•°ï¼š0
]]></description>
      <guid>https://stackoverflow.com/questions/72743778/valueerror-input-0-of-layer-sequential-40-is-incompatible-with-the-layer-expec</guid>
      <pubDate>Fri, 24 Jun 2022 12:01:17 GMT</pubDate>
    </item>
    <item>
      <title>ç¥ç»ç½‘ç»œæ”¶æ•›åˆ°é›¶è¾“å‡º</title>
      <link>https://stackoverflow.com/questions/44213659/neural-network-converging-to-zero-output</link>
      <description><![CDATA[æˆ‘æ­£åœ¨å°è¯•è®­ç»ƒè¿™ä¸ªç¥ç»ç½‘ç»œæ¥å¯¹æŸäº›æ•°æ®è¿›è¡Œé¢„æµ‹ã€‚
æˆ‘åœ¨ä¸€ä¸ªå°æ•°æ®é›†ï¼ˆå¤§çº¦ 100 æ¡è®°å½•ï¼‰ä¸Šè¿›è¡Œäº†å°è¯•ï¼Œæ•ˆæœéå¸¸å¥½ã€‚ç„¶åæˆ‘æ’å…¥æ–°çš„æ•°æ®é›†ï¼Œå‘ç°ç¥ç»ç½‘ç»œæ”¶æ•›åˆ° 0 è¾“å‡ºï¼Œå¹¶ä¸”è¯¯å·®è¿‘ä¼¼æ”¶æ•›äºæ­£ä¾‹æ•°ä¸ç¤ºä¾‹æ€»æ•°ä¹‹é—´çš„æ¯”ç‡ã€‚
æˆ‘çš„æ•°æ®é›†ç”±æ˜¯/å¦ç‰¹å¾ (1.0/0.0) ç»„æˆï¼ŒåŸºæœ¬äº‹å®ä¹Ÿæ˜¯æ˜¯/å¦ã€‚
æˆ‘çš„å‡è®¾ï¼š
1ï¼‰æœ‰ä¸€ä¸ªè¾“å‡ºä¸º0çš„å±€éƒ¨æœ€å°å€¼ï¼ˆä½†æˆ‘å°è¯•äº†å­¦ä¹ ç‡å’Œåˆå§‹æƒé‡çš„è®¸å¤šå€¼ï¼Œå®ƒä¼¼ä¹æ€»æ˜¯æ”¶æ•›åœ¨é‚£é‡Œï¼‰
2ï¼‰æˆ‘çš„ä½“é‡æ›´æ–°æ˜¯é”™è¯¯çš„ï¼ˆä½†å¯¹æˆ‘æ¥è¯´çœ‹èµ·æ¥ä¸é”™ï¼‰
3ï¼‰è¿™åªæ˜¯ä¸€ä¸ªè¾“å‡ºç¼©æ”¾é—®é¢˜ã€‚æˆ‘å°è¯•ç¼©æ”¾è¾“å‡ºï¼ˆå³è¾“å‡º/æœ€å¤§ï¼ˆè¾“å‡ºï¼‰å’Œè¾“å‡º/å¹³å‡å€¼ï¼ˆè¾“å‡ºï¼‰ï¼‰ï¼Œä½†ç»“æœå¹¶ä¸å¥½ï¼Œæ­£å¦‚æ‚¨åœ¨ä¸‹é¢æä¾›çš„ä»£ç ä¸­çœ‹åˆ°çš„é‚£æ ·ã€‚æˆ‘åº”è¯¥ä»¥ä¸åŒçš„æ–¹å¼ç¼©æ”¾å®ƒå—ï¼Ÿè½¯æœ€å¤§ï¼Ÿ 
è¿™æ˜¯ä»£ç ï¼š
å¯¼å…¥ pandas ä½œä¸º pd
å°† numpy å¯¼å…¥ä¸º np
è¿›å£æ³¡èœ
éšæœºå¯¼å…¥
ä»é›†åˆå¯¼å…¥defaultdict

é˜¿å°”æ³• = 0.1
N_å±‚ = 10
N_ITER = 10
#N_åŠŸèƒ½ = 8
åˆå§‹åŒ–è§„æ¨¡ = 1.0

train = pd.read_csv(&quot;./data/prediction.csv&quot;)

y = train[&#39;y_true&#39;].as_matrix()
y = np.vstack(y).astype(æµ®ç‚¹æ•°)
yæµ‹è¯• = y[18000:]
y = y[:18000]

X = train.drop([&#39;y_true&#39;], axis = 1).as_matrix()
Xtest = X[18000:].astype(float)
X = X[:18000]

def tanh(x,deriv=False):
    å¦‚æœï¼ˆå¯¼æ•°==çœŸï¼‰ï¼š
        è¿”å› (1 - np.tanh(x)**2) * alpha
    åˆ«çš„ï¼š
        è¿”å› np.tanh(x)

def sigmoid(x,deriv=False):
    å¦‚æœï¼ˆå¯¼æ•°==çœŸï¼‰ï¼š
        è¿”å› x*(1-x)
    åˆ«çš„ï¼š
        è¿”å› 1/(1+np.exp(-x))

def relu(x,deriv=False):
    å¦‚æœï¼ˆå¯¼æ•°==çœŸï¼‰ï¼š
        è¿”å› 0.01 + 0.99*(x&gt;0)
    åˆ«çš„ï¼š
        è¿”å› 0.01*x + 0.99*x*(x&gt;0)

np.random.seed()

syn = defaultdict(np.array)

å¯¹äºèŒƒå›´å†…çš„ i (N_LAYERS-1)ï¼š
    syn[i] = INIT_SCALE * np.random.random((len(X[0]),len(X[0]))) - INIT_SCALE/2
syn[N_LAYERS-1] = INIT_SCALE * np.random.random((len(X[0]),1)) - INIT_SCALE/2

l = defaultdict(np.array)
delta = defaultdict(np.array)

å¯¹äº xrange(N_ITER) ä¸­çš„ jï¼š
    l[0] = X
    å¯¹äºèŒƒå›´ (1,N_LAYERS+1) å†…çš„ iï¼š
        l[i] = relu(np.dot(l[i-1],syn[i-1]))

    é”™è¯¯ = (y - l[N_LAYERS])

    e = np.mean(np.abs(è¯¯å·®))
    å¦‚æœï¼ˆjï¼…1ï¼‰== 0ï¼š
        print &quot;\nè¿­ä»£ &quot; + str(j) + &quot; of &quot; + str(N_ITER)
        æ‰“å°â€œé”™è¯¯ï¼šâ€ + str(e)

    delta[N_LAYERS] = error*relu(l[N_LAYERS],deriv=True) * alpha
    å¯¹äºèŒƒå›´å†…çš„ i(N_LAYERS-1,0,-1)ï¼š
        é”™è¯¯ = delta[i+1].dot(syn[i].T)
        delta[i] = error*relu(l[i],deriv=True) * alpha

    å¯¹äºèŒƒå›´å†…çš„ iï¼ˆN_LAYERSï¼‰ï¼š
        syn[i] += l[i].T.dot(delta[i+1])



pickle.dump(syn, open(&#39;neural_weights.pkl&#39;, &#39;wb&#39;))

# ä½¿ç”¨ f1-measure è¿›è¡Œæµ‹è¯•
# å¬å›ç‡ = çœŸé˜³æ€§ / (çœŸé˜³æ€§ + å‡é˜´æ€§)
# ç²¾åº¦ = çœŸé˜³æ€§ /ï¼ˆçœŸé˜³æ€§ + å‡é˜³æ€§ï¼‰

l[0] = Xæµ‹è¯•
å¯¹äºèŒƒå›´ (1,N_LAYERS+1) å†…çš„ iï¼š
    l[i] = relu(np.dot(l[i-1],syn[i-1]))

è¾“å‡º = l[N_LAYERS]/max(l[N_LAYERS])

tp = æµ®ç‚¹æ•°(0)
fp = æµ®ç‚¹æ•°(0)
fn = æµ®ç‚¹æ•°(0)
tn = æµ®ç‚¹æ•°(0)

å¯¹äº l[N_LAYERS][:50] ä¸­çš„ iï¼š
    æ‰“å°æˆ‘

å¯¹äºèŒƒå›´å†…çš„ i(len(ytest))ï¼š
    å¦‚æœè¾“å‡º[i]&gt; 0.5 ä¸” ytest[i] == 1ï¼š
        tp += 1
    å¦‚æœ out[i] &lt;= 0.5 ä¸” ytest[i] == 1ï¼š
        fn += 1
    å¦‚æœè¾“å‡º[i]&gt; 0.5 ä¸” ytest[i] == 0ï¼š
        ç„¦è· += 1
    å¦‚æœ out[i] &lt;= 0.5 ä¸” ytest[i] == 0ï¼š
        tn += 1

æ‰“å°â€œtpï¼šâ€ + strï¼ˆtpï¼‰
æ‰“å°â€œfpï¼šâ€ + strï¼ˆfpï¼‰
æ‰“å°â€œtn:â€+str(tn)
æ‰“å°â€œfn:â€+str(fn)

print &quot;\nç²¾åº¦: &quot; + str(tp/(tp + fp))
print &quot;å›å¿†ï¼š&quot; + str(tp/(tp + fn))

f1 = 2 * tp /(2 * tp + fn + fp)
print &quot;\nf1-æµ‹é‡:&quot; + str(f1)

è¿™æ˜¯è¾“å‡ºï¼š
ç¬¬ 0 æ¬¡è¿­ä»£ï¼ˆå…± 10 æ¬¡ï¼‰
é”™è¯¯ï¼š0.222500767998

ç¬¬ 1 æ¬¡è¿­ä»£ï¼ˆå…± 10 æ¬¡ï¼‰
é”™è¯¯ï¼š0.222500771157

ç¬¬ 2 æ¬¡è¿­ä»£ï¼ˆå…± 10 æ¬¡ï¼‰
é”™è¯¯ï¼š0.222500774321

ç¬¬ 3 æ¬¡è¿­ä»£ï¼ˆå…± 10 æ¬¡ï¼‰
é”™è¯¯ï¼š0.22250077749

ç¬¬ 4 æ¬¡è¿­ä»£ï¼ˆå…± 10 æ¬¡ï¼‰
é”™è¯¯ï¼š0.222500780663

ç¬¬ 5 æ¬¡è¿­ä»£ï¼ˆå…± 10 æ¬¡ï¼‰
é”™è¯¯ï¼š0.222500783841

ç¬¬ 6 æ¬¡è¿­ä»£ï¼ˆå…± 10 æ¬¡ï¼‰
é”™è¯¯ï¼š0.222500787024

ç¬¬ 7 æ¬¡è¿­ä»£ï¼ˆå…± 10 æ¬¡ï¼‰
é”™è¯¯ï¼š0.222500790212

ç¬¬ 8 æ¬¡è¿­ä»£ï¼ˆå…± 10 æ¬¡ï¼‰
é”™è¯¯ï¼š0.222500793405

è¿­ä»£ç¬¬ 9 æ¬¡ï¼ˆå…± 10 æ¬¡ï¼‰
é”™è¯¯ï¼š0.222500796602


[0ã€‚]
[0ã€‚]
[5.58610895e-06]
[0ã€‚]
[0ã€‚]
[0ã€‚]
[0ã€‚]
[0ã€‚]
[4.62182626e-06]
[0ã€‚]
[0ã€‚]
[0ã€‚]
[0ã€‚]
[5.58610895e-06]
[0ã€‚]
[0ã€‚]
[0ã€‚]
[0ã€‚]
[4.62182626e-06]
[0ã€‚]
[0ã€‚]
[5.04501079e-10]
[5.58610895e-06]
[0ã€‚]
[0ã€‚]
[0ã€‚]
[0ã€‚]
[0ã€‚]
[0ã€‚]
[0ã€‚]
[0ã€‚]
[0ã€‚]
[0ã€‚]
[0ã€‚]
[5.04501079e-10]
[0ã€‚]
[0ã€‚]
[4.62182626e-06]
[0ã€‚]
[5.58610895e-06]
[0ã€‚]
[0ã€‚]
[0ã€‚]
[5.58610895e-06]
[0ã€‚]
[0ã€‚]
[0ã€‚]
[5.58610895e-06]
[0ã€‚]
[1.31432294e-05]

ç›®æ ‡ç‚¹ï¼š28.0
ç„¦è·ï¼š119.0
ç”µè¯å·ç ï¼š5537.0
å·ç ï¼š1550.0

ç²¾åº¦ï¼š0.190476190476
å¬å›ç‡ï¼š0.0177439797212

f1-æµ‹é‡ï¼š0.0324637681159
]]></description>
      <guid>https://stackoverflow.com/questions/44213659/neural-network-converging-to-zero-output</guid>
      <pubDate>Sat, 27 May 2017 06:21:36 GMT</pubDate>
    </item>
    <item>
      <title>å¦‚ä½•è®¡ç®—çº¿æ€§å›å½’ä¸­çš„æ­£åˆ™åŒ–å‚æ•°</title>
      <link>https://stackoverflow.com/questions/12182063/how-to-calculate-the-regularization-parameter-in-linear-regression</link>
      <description><![CDATA[å½“æˆ‘ä»¬æœ‰ä¸€ä¸ªé«˜æ¬¡çº¿æ€§å¤šé¡¹å¼ç”¨äºæ‹Ÿåˆçº¿æ€§å›å½’è®¾ç½®ä¸­çš„ä¸€ç»„ç‚¹æ—¶ï¼Œä¸ºäº†é˜²æ­¢è¿‡åº¦æ‹Ÿåˆï¼Œæˆ‘ä»¬ä½¿ç”¨æ­£åˆ™åŒ–ï¼Œå¹¶åœ¨æˆæœ¬å‡½æ•°ä¸­åŒ…å« lambda å‚æ•°ã€‚ç„¶åä½¿ç”¨è¯¥ lambda æ›´æ–°æ¢¯åº¦ä¸‹é™ç®—æ³•ä¸­çš„ theta å‚æ•°ã€‚
æˆ‘çš„é—®é¢˜æ˜¯æˆ‘ä»¬å¦‚ä½•è®¡ç®—è¿™ä¸ª lambda æ­£åˆ™åŒ–å‚æ•°ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/12182063/how-to-calculate-the-regularization-parameter-in-linear-regression</guid>
      <pubDate>Wed, 29 Aug 2012 16:04:04 GMT</pubDate>
    </item>
    </channel>
</rss>