<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>æ ‡è®°ä¸ºæœºå™¨å­¦ä¹ çš„æ´»è·ƒé—®é¢˜ - Thinbug</title>
    <link>https://stackoverflow.com/questions/tagged/?tagnames=machine-learning&sort=active</link>
    <description>æ¥è‡ª stackoverflow.com çš„æœ€æ–° 30 ä¸ª</description>
    <lastBuildDate>Mon, 18 Dec 2023 18:17:28 GMT</lastBuildDate>
    <item>
      <title>è§£é‡Š AutoGluon è¡¨æ ¼åˆ†ç±»å™¨çš„æ–‡æœ¬ç‰¹å¾</title>
      <link>https://stackoverflow.com/questions/77680786/explaining-text-features-of-autogluon-tabular-classifier</link>
      <description><![CDATA[æˆ‘æ­£åœ¨è®­ç»ƒ AutoGluon è¡¨æ ¼åˆ†ç±»å™¨ã€‚
æˆ‘çš„æ‰€æœ‰æ•°æ®éƒ½æ˜¯è¡¨æ ¼æ ¼å¼ï¼Œå¹¶ä¸”å¤§å¤šæ•°ç‰¹å¾éƒ½æ˜¯æ•°å­—ã€‚ç„¶è€Œï¼Œè®­ç»ƒä¸­ä½¿ç”¨çš„ä¸€äº›ç‰¹å¾æ˜¯æ–‡æœ¬ç‰¹å¾ã€‚æ˜¯å¦å¯ä»¥è§£é‡Šæ–‡æœ¬ç‰¹å¾å¦‚ä½•å½±å“é¢„æµ‹ï¼Ÿä¾‹å¦‚ï¼Œæˆ‘æ„Ÿå…´è¶£çš„æ˜¯æ˜¯å¦æœ‰ä»»ä½•ç‰¹å®šçš„å•è¯ä¼šå¯¼è‡´é¢„æµ‹å‘ç”Ÿè¿™æ ·æˆ–é‚£æ ·çš„å˜åŒ–ã€‚æˆ‘å°è¯•ä½¿ç”¨ SHAP çš„ KernelExplainerï¼Œä½†æˆ‘ä¸ç¡®å®šè¿™æ˜¯å¦æ˜¯æ­£ç¡®çš„æ–¹æ³•æˆ–å¦‚ä½•åœ¨è¿™ç§æƒ…å†µä¸‹ä½¿ç”¨å®ƒã€‚
æˆ‘æœ€åˆä½¿ç”¨ AutoGluon çš„ TabularPredictor.feature_importanceï¼Œä½†è¿™åªèƒ½å‘Šè¯‰æˆ‘å“ªäº›ç‰¹å¾åœ¨æœ€ç»ˆé¢„æµ‹ä¸­æƒé‡æœ€å¤§ã€‚ç„¶è€Œï¼Œæƒé‡æœ€é«˜çš„ç‰¹å¾æ˜¯æ–‡æœ¬ç‰¹å¾ã€‚æˆ‘æ— æ³•æ‰¾å‡º AutoGluon åœ¨è¯¥åŠŸèƒ½ä¸­å…·ä½“æŸ¥çœ‹ä»€ä¹ˆå†…å®¹æ¥è¿›è¡Œé¢„æµ‹ï¼Œæ— è®ºæ˜¯ç‰¹å®šå•è¯è¿˜æ˜¯å…¶ä»–å•è¯ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/77680786/explaining-text-features-of-autogluon-tabular-classifier</guid>
      <pubDate>Mon, 18 Dec 2023 17:28:53 GMT</pubDate>
    </item>
    <item>
      <title>å¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰æ•°æ®é›†æ ¼å¼è®­ç»ƒè‡ªå®šä¹‰ Transformer æ¨¡å‹</title>
      <link>https://stackoverflow.com/questions/77680618/how-to-train-a-customized-transformer-model-with-custom-dataset-formatting</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/77680618/how-to-train-a-customized-transformer-model-with-custom-dataset-formatting</guid>
      <pubDate>Mon, 18 Dec 2023 16:56:58 GMT</pubDate>
    </item>
    <item>
      <title>åŠ æƒæœºå™¨å­¦ä¹ é›†æˆç»™å‡ºçš„ç»“æœå¾ˆå·®[å…³é—­]</title>
      <link>https://stackoverflow.com/questions/77680479/weighted-machine-learning-ensemble-giving-poor-results</link>
      <description><![CDATA[æˆ‘æ­£åœ¨ä¸ºåŸºäºæ–‡æœ¬çš„ csv æ–‡ä»¶æƒ…æ„Ÿåˆ†æå®æ–½åŠ æƒé›†æˆæ¨¡å¼ã€‚æˆ‘å°è¯•è¿‡æ ¹æ®å‡†ç¡®åº¦ã€ç²¾ç¡®åº¦ã€å¬å›ç‡è¿›è¡Œæƒé‡åˆ†é…ï¼Œä½†å®ƒç»™æˆ‘çš„ç»“æœä¸å•ä¸ª ML æˆ–æ·±åº¦å­¦ä¹ æ¨¡å‹ç›¸ä¼¼æˆ–æ›´å·® ğŸ¤”
æˆ‘å·²ç»åˆ¶ä½œäº†å¤§çº¦ 23 ä¸ªå…·æœ‰ä¸åŒç»„åˆçš„æ¨¡å‹
ã€‚
Python
è¾“å…¥æ˜¯åŸºäºæ–‡æœ¬çš„æ¨æ–‡
è¾“å‡ºä¸º3ç±»åˆ†ç±»
è¯åµŒå…¥æ˜¯tfidf
æˆ‘æ€æ ·æ‰èƒ½æé«˜æ€§èƒ½ä»¥åŠæˆ‘åº”è¯¥ä½¿ç”¨ä»€ä¹ˆæƒé‡æŒ‡æ ‡ï¼Ÿé‡é‡åº¦é‡çš„æ–¹ç¨‹åº”è¯¥æ˜¯..]]></description>
      <guid>https://stackoverflow.com/questions/77680479/weighted-machine-learning-ensemble-giving-poor-results</guid>
      <pubDate>Mon, 18 Dec 2023 16:33:10 GMT</pubDate>
    </item>
    <item>
      <title>å¦‚ä½•å°† OHLCV äº¤æ˜“æ•°æ®åŠ è½½åˆ° TensorflowJS å·ç§¯å±‚ä¸­ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/77680420/how-to-load-ohlcv-trading-data-into-tensorflowjs-convolution-layer</link>
      <description><![CDATA[æˆ‘çš„ç›®æ ‡
è·å–æœ¬å‘¨å‰ 5 ä¸ªè‚¡ç¥¨äº¤æ˜“æ—¥çš„é«˜ä½æ•°æ®ï¼Œçœ‹çœ‹æˆ‘æ˜¯å¦å¯ä»¥é¢„æµ‹å‘¨æœ«ä»·æ ¼ä¸Šæ¶¨æˆ–ä¸‹è·Œã€‚
æ•°æ®
åœ¨äº¤æ˜“ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ OHLCV æ•°æ®æ¥æè¿°äº¤æ˜“æ—¥çš„æƒ…å†µï¼š
ï¼ˆO=å½“æ—¥å¼€ç›˜ä»·ï¼ŒH=å½“æ—¥æœ€é«˜ä»·ï¼ŒL=å½“æ—¥æœ€ä½ä»·ï¼ŒC=å½“æ—¥æ”¶ç›˜ä»·ï¼ŒV=å½“æ—¥æˆäº¤é‡ï¼‰ã€‚
//1å¤©çš„æ•°æ®
[oã€hã€lã€cã€v]

// ä¾‹å¦‚
[10ã€12ã€9ã€11ã€100]

å› æ­¤ 5 å¤©çš„æ•°æ®å¦‚ä¸‹ï¼š
//5å¤©çš„æ•°æ®
[[oã€hã€lã€cã€v]ã€[oã€hã€lã€cã€v]ã€[oã€hã€lã€cã€v]ã€[oã€hã€lã€cã€v]ã€[ oã€hã€lã€cã€v]]

// ä¾‹å¦‚
[[10, 12, 9, 11, 100], [11, 13, 11, 12, 200], [12, 12, 11, 11, 150], [11, 14, 11, 14, 300], [ 14, 14, 11, 12, 200]]

æˆ‘è¯»åˆ°ï¼Œå¤„ç†è¿™äº›æ•°æ®çš„æœ€ä½³æ–¹æ³•æ˜¯ä½¿ç”¨å·ç§¯å±‚ï¼Œç‰¹åˆ«æ˜¯ Tensorflow ä¸­çš„ conv2d å±‚ã€‚æ®æˆ‘äº†è§£ï¼Œè¯¥å±‚éœ€è¦ 4dTensor ä½œä¸ºè¾“å…¥ã€‚å› æ­¤ï¼Œæˆ‘ä½¿ç”¨tensor4d()ä»åŒ…å«4å‘¨è®­ç»ƒæ•°æ®ï¼ˆ4å€5å¤©æ•°æ®ï¼‰çš„æ•°æ®æ•°ç»„åˆ›å»ºè¿™æ ·çš„å¼ é‡
// 4 æ¬¡ 5 å¤©çš„ javascript æ•°ç»„
å¸¸é‡æ•°æ® = [10, 12, 9, 11, 100, 11, 13, 11, 12, 200, 12, 12, 11, 11, 150, 11, 14, 11, 14, 300, 14, 14, 11, 12, 200, 10, 12, 9, 11, 100, 11, 13, 11, 12, 200, 12, 12, 11, 11, 150, 11, 14, 11, 14, 300, 14, 14, 11, 12, 200, 10, 12, 9, 11, 100, 11, 13, 11, 12, 200, 12, 12, 11, 11, 150, 11, 14, 11, 14, 300, 14, 14, 11, 12, 200, 10, 12, 9, 11, 100, 11, 13, 11, 12, 200, 12, 12, 11, 11, 150, 11, 14, 11, 14, 300, 14, 14, 11, 12, 200]

// è½¬æ¢ä¸º 4d å¼ é‡
const input_tensor = tf.tensor4d(data, [data.length / (5 * 5), 5, 5, 1]);

ç›®æ ‡ç”±æ¯å‘¨ 1 ä¸ªç»“æœç»„æˆï¼ˆå‘¨æœ«äº¤æ˜“çš„ç»“æœï¼‰ã€‚
const target = [-1, 2, -3, 1] // % ç›ˆåˆ©æˆ–äºæŸ

// è½¬æ¢ä¸ºä¸€ç»´å¼ é‡
const target_tensor = tf.tensor1d(ç›®æ ‡);

æ¨¡å‹
æˆ‘çš„æ¨¡å‹çœ‹èµ·æ¥åƒè¿™æ ·ï¼Œæ˜¯æ ¹æ®æ­¤å¤„æ‰¾åˆ°çš„ç¤ºä¾‹æ„å»ºçš„ï¼šhttps:// blog.quantinsti.com/å·ç§¯ç¥ç»ç½‘ç»œ/
const model = tf.sequential();
model.add(tf.layers.conv2d({

    æ¿€æ´»ï¼š&#39;relu&#39;ï¼Œ
    è¿‡æ»¤å™¨ï¼š32ï¼Œ
    inputShape: [5, 5, 1], // 5 ä¸ª ohlcvï¼Œå…± 5 ä¸ªå€¼ï¼Œæ¯ä¸ªå€¼ 1
    å†…æ ¸å¤§å°ï¼š1ï¼Œ
}));
model.add(tf.layers.maxPooling2d([2, 2]));
model.add(tf.layers.conv2d({

    æ¿€æ´»ï¼š&#39;relu&#39;ï¼Œ
    è¿‡æ»¤å™¨ï¼š64ï¼Œ
    å†…æ ¸å¤§å°ï¼š1ï¼Œ
}));
model.add(tf.layers.maxPooling2d([2, 2]));
model.add(tf.layers.flatten());
model.add(tf.layers.dense({

    æ¿€æ´»ï¼š&#39;relu&#39;ï¼Œ
    å•ä½ï¼š64ï¼Œ
}));
model.add(tf.layers.dense({

    å•ä½ï¼š1ï¼Œ
    æ¿€æ´»ï¼š&#39;relu&#39;ï¼Œ
}));

æˆ‘ä½¿ç”¨ä¹‹å‰åˆ›å»ºçš„å¼ é‡è®­ç»ƒæ¨¡å‹
//è®­ç»ƒæ¨¡å‹
ç­‰å¾… model.fit(input_tensor, target_tensor, {
                    
    æ‰¹é‡å¤§å°ï¼š32ï¼Œ
    çºªå…ƒï¼š50ï¼Œ
    éšæœºæ’­æ”¾ï¼šæ­£ç¡®ï¼Œ
});

é”™è¯¯
åœ¨æ­¤æ­¥éª¤ä¸­ï¼Œæˆ‘æ”¶åˆ°ä»¥ä¸‹é”™è¯¯
unhandledRejection: TypeError: æ— æ³•å°† undefined æˆ– null è½¬æ¢ä¸ºå¯¹è±¡

æœ€åä¸€æ­¥
model.predict([10, 12, 9, 11, 100], [5, 1])

é—®é¢˜

æˆ‘ä½¿ç”¨å·ç§¯å±‚æ˜¯å› ä¸ºæˆ‘æƒ³ä¿ç•™ 1 å¤©çš„ OHLCV æ•°æ®ä¹‹é—´çš„å…³ç³»ï¼Œæˆ‘çš„æ¨¡å‹æ˜¯å¦å±äºè¿™ç§æƒ…å†µï¼Ÿæœ‰å¿…è¦å—ï¼Ÿ
æˆ‘æ­£ç¡®åˆ›å»ºäº† 4d å’Œ 1d å¼ é‡å—ï¼Ÿ
å†…æ ¸å¤§å°ä¸º [1, 1] çš„å·ç§¯å±‚æ˜¯å¦æœ‰æ„ä¹‰ï¼Ÿä¼¼ä¹è¿èƒŒäº†å·ç§¯å±‚çš„ç›®çš„ï¼Ÿ
å¦‚ä½•ä¿®å¤è¯¥é”™è¯¯ï¼Ÿ
æˆ‘æ˜¯èµ°åœ¨æ­£ç¡®çš„é“è·¯ä¸Šè¿˜æ˜¯å®Œå…¨çœ‹é”™äº†æ–¹å‘ï¼Ÿåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨èƒ½å¦ä¸ºæˆ‘æŒ‡æ˜å¦‚ä½•æ„å»ºæ¨¡å‹çš„æ­£ç¡®æ–¹å‘ï¼Ÿ
]]></description>
      <guid>https://stackoverflow.com/questions/77680420/how-to-load-ohlcv-trading-data-into-tensorflowjs-convolution-layer</guid>
      <pubDate>Mon, 18 Dec 2023 16:22:48 GMT</pubDate>
    </item>
    <item>
      <title>åœ¨æ‰‹åŠ¨äº¤å‰éªŒè¯å’Œ cross_val_score ä¹‹é—´è·å–ä¸åŒçš„åˆ†æ•°å€¼</title>
      <link>https://stackoverflow.com/questions/77680320/getting-different-score-values-between-manual-cross-validation-and-cross-val-sco</link>
      <description><![CDATA[æˆ‘åˆ›å»ºäº†ä¸€ä¸ª python for å¾ªç¯ï¼Œå°†è®­ç»ƒæ•°æ®é›†åˆ†å‰²æˆåˆ†å±‚çš„ KFoldï¼Œå¹¶åœ¨å¾ªç¯å†…ä½¿ç”¨åˆ†ç±»å™¨æ¥è®­ç»ƒå®ƒã€‚ç„¶åä½¿ç”¨ç»è¿‡è®­ç»ƒçš„æ¨¡å‹é€šè¿‡éªŒè¯æ•°æ®è¿›è¡Œé¢„æµ‹ã€‚ä½¿ç”¨æ­¤è¿‡ç¨‹å®ç°çš„æŒ‡æ ‡ä¸ä½¿ç”¨ cross_val_score å‡½æ•°å®ç°çš„æŒ‡æ ‡å®Œå…¨ä¸åŒã€‚æˆ‘æœŸæœ›ä½¿ç”¨è¿™ä¸¤ç§æ–¹æ³•å¾—åˆ°ç›¸åŒçš„ç»“æœã€‚
æ­¤ä»£ç ç”¨äºæ–‡æœ¬åˆ†ç±»ï¼Œæˆ‘ä½¿ç”¨ TF-IDF å¯¹æ–‡æœ¬è¿›è¡ŒçŸ¢é‡åŒ–
è¿™æ˜¯ä»£ç ï¼š
æ‰‹åŠ¨å®ç°äº¤å‰éªŒè¯çš„ä»£ç ï¼š
#å¯¼å…¥æŒ‡æ ‡å‡½æ•°æ¥è¡¡é‡æ¨¡å‹çš„æ€§èƒ½
ä» sklearn.metrics å¯¼å…¥ f1_scoreã€accuracy_scoreã€ precision_scoreã€recall_score
ä» sklearn.model_selection å¯¼å…¥ StratifiedKFold
data_validation = [] # ç”¨äºå­˜å‚¨ä½¿ç”¨äº¤å‰éªŒè¯çš„æ¨¡å‹éªŒè¯ç»“æœçš„åˆ—è¡¨
skf = StratifiedKFold(n_splits=5, shuffle=True, random_state=42)
å‡†ç¡®åº¦å€¼ = []
f1_val = []

# ä½¿ç”¨ravelå‡½æ•°å°†å¤šç»´æ•°ç»„å±•å¹³ä¸ºä¸€ç»´
å¯¹äº (skf.split(X_train, y_train)) ä¸­çš„ train_indexã€val_indexï¼š
    X_tr, X_val = X_train.ravel()[train_index], X_train.ravel()[val_index]
    y_tr, y_val = y_train.ravel()[train_index] , y_train.ravel()[val_index]
    tfidf=TfidfVectorizer()
    X_tr_vec_tfidf = tfidf.fit_transform(X_tr) # å¯¹è®­ç»ƒæŠ˜å è¿›è¡Œå‘é‡åŒ–
    X_val_vec_tfidf = tfidf.transform(X_val) # å¯¹éªŒè¯æŠ˜å è¿›è¡Œå‘é‡åŒ–
    #å®ä¾‹åŒ–æ¨¡å‹
    æ¨¡å‹= MultinomialNB(alpha=0.5, fit_prior=False)
    #ç”¨æˆ‘ä»¬çš„è®­ç»ƒæ•°æ®é›†è®­ç»ƒç©ºæ¨¡å‹
    model.fit(X_tr_vec_tfidf, y_tr)
    Predictions_val = model.predict(X_val_vec_tfidf) # ä½¿ç”¨éªŒè¯æ•°æ®é›†è¿›è¡Œé¢„æµ‹
    acc_val = å‡†ç¡®åº¦_åˆ†æ•°ï¼ˆy_valï¼Œé¢„æµ‹_valï¼‰
    Accuracy_val.append(acc_val)
    f_val = f1_scoreï¼ˆy_valï¼Œé¢„æµ‹å€¼ï¼‰
    f1_val.append(f_val)

avg_accuracy_val = np.mean(accuracy_val)
avg_f1_val = np.mean(f1_val)

# å­˜å‚¨æŒ‡æ ‡çš„ä¸´æ—¶åˆ—è¡¨
temp = [&#39;NaiveBayes&#39;]
temp.append(avg_accuracy_val) #éªŒè¯å‡†ç¡®ç‡åˆ†æ•°
temp.append(avg_f1_val) #éªŒè¯f1åˆ†æ•°
data_validation.append(ä¸´æ—¶)
#ä½¿ç”¨æ•°æ®å¸§åˆ›å»ºä¸€ä¸ªè¡¨ï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰ç»è¿‡è®­ç»ƒå’Œæµ‹è¯•çš„ ML æ¨¡å‹çš„æŒ‡æ ‡
result = pd.DataFrame(data_validation, columns = [&#39;ç®—æ³•&#39;,&#39;å‡†ç¡®åº¦åˆ†æ•°ï¼šéªŒè¯&#39;,&#39;F1-åˆ†æ•°ï¼šéªŒè¯&#39;])
result.reset_index(drop=True, inplace=True)
ç»“æœ

è¾“å‡ºï¼š
 ç®—æ³•å‡†ç¡®åº¦åˆ†æ•°ï¼šéªŒè¯ F1-Scoreï¼šéªŒè¯
0 å¤©çœŸçš„è´å¶æ–¯ 0.77012 0.733994

ç°åœ¨ä½¿ç”¨ cross_val_score å‡½æ•°çš„ä»£ç ï¼š
ä» sklearn.model_selection å¯¼å…¥ cross_val_score
ä» sklearn.feature_extraction.text å¯¼å…¥ CountVectorizerã€TfidfVectorizer
åˆ†æ•° = [&#39;å‡†ç¡®åº¦&#39;, &#39;f1&#39;]
#ä½¿ç”¨NLPæŠ€æœ¯TF-IDFå¯¹è®­ç»ƒå’Œæµ‹è¯•æ•°æ®é›†è¿›è¡Œæ–‡æœ¬å‘é‡åŒ–
tfidf=TfidfVectorizer()
X_tr_vec_tfidf = tfidf.fit_transform(X_train)
skf = StratifiedKFold(n_splits=5, shuffle=True, random_state=42)
nb=å¤šé¡¹å¼NB(alpha=0.5, fit_prior=False)
å¯¹äº [â€œaccuracyâ€, â€œf1â€] ä¸­çš„åˆ†æ•°ï¼š
    print (f&#39;{score}: {cross_val_score(nb,X_tr_vec_tfidf,y_train,cv=skf,scoring=score).mean()} &#39;)

è¾“å‡ºï¼š
å‡†ç¡®åº¦ï¼š0.7341283583255231
f1ï¼š0.7062017090972422

å¯ä»¥çœ‹å‡ºï¼Œä½¿ç”¨è¿™ä¸¤ç§æ–¹æ³•çš„å‡†ç¡®æ€§å’Œ f1 æŒ‡æ ‡æœ‰å¾ˆå¤§ä¸åŒã€‚å½“æˆ‘ä½¿ç”¨ KNeighborsClassfier æ—¶ï¼ŒæŒ‡æ ‡çš„å·®å¼‚æ›´åŠ ä¸¥é‡ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/77680320/getting-different-score-values-between-manual-cross-validation-and-cross-val-sco</guid>
      <pubDate>Mon, 18 Dec 2023 16:05:36 GMT</pubDate>
    </item>
    <item>
      <title>å¤„ç† CNN äºŒå…ƒåˆ†ç±»çš„åˆ†å¸ƒå¤–æ ·æœ¬å’Œå¼‚å¸¸</title>
      <link>https://stackoverflow.com/questions/77679785/handling-out-of-distribution-samples-and-anomalies-for-cnn-binary-classification</link>
      <description><![CDATA[æˆ‘å¯¹æœºå™¨å­¦ä¹ é¢†åŸŸæ¯”è¾ƒé™Œç”Ÿï¼Œå¹¶ä¸”å¯¹åˆ›å»ºåŸºæœ¬è‡ªå®šä¹‰æ¨¡å‹æœ‰åŸºæœ¬çš„äº†è§£ã€‚
åˆ†é…ç»™æˆ‘çš„ä»»åŠ¡
æˆ‘çš„ç»ç†è¦æ±‚æˆ‘å¼€å‘ä¸€ç§æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œèƒ½å¤Ÿåœ¨æ”»å‡»æ€§å›¾åƒå‘é€åˆ°æœåŠ¡å™¨ä¹‹å‰è¯†åˆ«å®ƒä»¬ã€‚è¿™äº›å›¾åƒå¯ä»¥åˆ†ä¸ºä¸åŒçš„ç±»åˆ«ï¼Œä¾‹å¦‚æ­¦å™¨æˆ–æˆäººå†…å®¹ã€‚
é—®é¢˜
ä½†æ˜¯ï¼Œæˆ‘åœ¨æ¨¡å‹æ£€æµ‹å¼‚å¸¸æˆ–åˆ†å¸ƒå¤–æ ·æœ¬çš„èƒ½åŠ›æ–¹é¢é‡åˆ°äº†é—®é¢˜ã€‚
æˆ‘å°è¯•è¿‡çš„
æˆ‘å°è¯•äº†ä¸åŒçš„æ–¹æ³•ï¼Œåˆ©ç”¨&#39;binary_crossentropy&#39;ä½œä¸ºæˆ‘çš„æŸå¤±å‡½æ•°ï¼Œä½†é‡åˆ°äº†åŒæ ·çš„é—®é¢˜ã€‚æˆ‘è¿˜æ„å»ºäº†ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªç±»çš„æ¨¡å‹ï¼š

12,278 ä¸æ­¦å™¨ç›¸å…³çš„å›¾ç‰‡ class_name = æ­¦å™¨
3,000 å¼ é£Ÿç‰© å•†å“å›¾ç‰‡ class_name = å…¶ä»–

ä½†æ˜¯ï¼Œæˆ‘ä¸ç¡®å®š â€œå…¶ä»–â€ ç±»åˆ«ä¸­åº”åŒ…å«å“ªäº›å†…å®¹ã€‚ä½¿ç”¨ MobileNet ä½œä¸ºåŸºç¡€æ¨¡å‹æ„å»ºæ¨¡å‹åï¼Œå®ƒæˆåŠŸåœ°å‡†ç¡®é¢„æµ‹äº†æ­¦å™¨ï¼Œå¹¶æä¾›äº† 0.4 åˆ° 0.6 èŒƒå›´å†…çš„é£Ÿå“é¢„æµ‹ï¼Œè¿™ä¼¼ä¹æ˜¯å¯ä»¥æ¥å—çš„ã€‚ç„¶è€Œï¼Œå½“æˆ‘å¼•å…¥å¤§è±¡æˆ–æ±½è½¦çš„å›¾åƒæ—¶ï¼Œæ¨¡å‹å€¾å‘äºå°†å®ƒä»¬é¢„æµ‹ä¸ºæ­¦å™¨ï¼Œæ˜¾ç¤ºçš„ç½®ä¿¡åº¦æ¥è¿‘ 1ã€‚
æˆ‘ä¸çŸ¥é“å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘å°è¯•ç ”ç©¶è¿™ä¸ªé—®é¢˜ï¼Œå¹¶å‘ç°äº†ä¸€äº›å…³äºåˆ†å¸ƒå¤–æ£€æµ‹çš„çº¿ç´¢ä»¥åŠä¸å¼‚å¸¸æˆ–ç¦»ç¾¤å€¼ç›¸å…³çš„æ¦‚å¿µã€‚å½“æ¨¡å‹çš„è¾“å…¥åŒ…å«ä¸å±äºè®­ç»ƒæ•°æ®çš„å›¾åƒæ—¶ï¼Œå¦‚ä½•è·å¾—ä¸ç¡®å®šæ€§å€¼ï¼Ÿ
å¦‚æœæ‚¨èƒ½æä¾›ä»»ä½•æŒ‡å¯¼ã€å»ºè®®ï¼Œç”šè‡³å‚è€ƒèƒ½å¤Ÿæœ‰æ•ˆè§£å†³æ­¤é—®é¢˜çš„è§†é¢‘æˆ–èµ„æºï¼Œæˆ‘å°†ä¸èƒœæ„Ÿæ¿€ã€‚æ„Ÿè°¢æ‚¨çš„å¸®åŠ©ã€‚
æ•°æ®åŠ è½½ï¼š
train_ds, test_ds = keras.utils.image_dataset_from_directory(
    ç›®å½•=â€œ/å†…å®¹/æ­¦å™¨â€ï¼Œ
    æ ‡ç­¾=â€œæ¨æ–­â€ï¼Œ
    label_mode =â€œäºŒè¿›åˆ¶â€ï¼Œ
    æ‰¹é‡å¤§å°=32ï¼Œ
    å­é›†=â€œä¸¤è€…â€ï¼Œ
    å›¾åƒå¤§å°=(224,224),
    éªŒè¯åˆ†å‰²=0.2ï¼Œ
    éšæœºæ’­æ”¾=çœŸï¼Œ
    ç§å­=1337
ï¼‰

ç°åœ¨æ ‡å‡†åŒ–è¾“å…¥å›¾åƒæ•°æ®ï¼š
def processï¼ˆå›¾åƒï¼Œæ ‡ç­¾ï¼‰ï¼š
  å›¾åƒ=tf.cast(å›¾åƒ/255, tf.float32)
  è¿”å›å›¾åƒã€æ ‡ç­¾
train_ds = train_ds.map(è¿›ç¨‹)
test_ds = test_ds.map(è¿›ç¨‹)

åˆ›å»º CNN æ¨¡å‹ï¼š
input_shape = (224,224,3)
mobilenet = MobileNet(input_shape,weights=&#39;imagenet&#39;,include_top=False)
æ¨¡å‹=é¡ºåºï¼ˆï¼‰
 
model.addï¼ˆç§»åŠ¨ç½‘ç»œï¼‰
æ¨¡å‹.add(å‹å¹³())
model.addï¼ˆå¯†é›†ï¼ˆ256ï¼Œæ¿€æ´»=&#39;relu&#39;ï¼‰ï¼‰
æ¨¡å‹.add(Dropout(0.5))
model.addï¼ˆå¯†é›†ï¼ˆ1ï¼Œæ¿€æ´»=&#39;sigmoid&#39;ï¼‰ï¼‰
æ¨¡å‹.summary()



sgd = SGD(å­¦ä¹ ç‡=0.0001ï¼ŒåŠ¨é‡=0.9ï¼Œnesterov=True)
model.compileï¼ˆæŸå¤±=&#39;binary_crossentropy&#39;ï¼Œä¼˜åŒ–å™¨=sgdï¼ŒæŒ‡æ ‡=[&#39;å‡†ç¡®æ€§&#39;]ï¼‰
å†å²= model.fitï¼ˆtrain_dsï¼Œvalidation_data = test_dsï¼Œbatch_size = 4ï¼Œepochs = 6ï¼‰


çºªå…ƒ 6/6
382/382 [==============================] - 58s 150ms/æ­¥ - æŸå¤±ï¼š0.0042 - ç²¾åº¦ï¼š0.9984 - val_loss ï¼š0.0063 - val_accuracyï¼š0.997
]]></description>
      <guid>https://stackoverflow.com/questions/77679785/handling-out-of-distribution-samples-and-anomalies-for-cnn-binary-classification</guid>
      <pubDate>Mon, 18 Dec 2023 14:34:38 GMT</pubDate>
    </item>
    <item>
      <title>ä½¿ç”¨YOLOv5æ—§æ¨¡å‹è¿›è¡Œé¢„æµ‹</title>
      <link>https://stackoverflow.com/questions/77678969/using-yolov5-old-models-to-make-a-prediction</link>
      <description><![CDATA[æˆ‘ç›®å‰æ­£åœ¨å°è¯•ä½¿ç”¨ .pt æ–‡ä»¶ä½œä¸º YOLOv5 æ¨¡å‹ï¼Œè¯¥æ¨¡å‹æ˜¯åœ¨ 2 å¹´å‰è®­ç»ƒçš„ï¼Œæ¯å½“æˆ‘å°è¯•è¿™æ ·åšæ—¶ï¼Œæˆ‘éƒ½ä¼šæ”¶åˆ°ä»¥ä¸‹é”™è¯¯ã€‚
è¿è¡Œæ—¶é”™è¯¯ï¼šPytorchStreamReader è¯»å– zip å­˜æ¡£å¤±è´¥ï¼šæ‰¾ä¸åˆ°ä¸­å¿ƒç›®å½•ã€‚

æ¯æ¬¡æˆ‘å°è¯•ä½¿ç”¨ä¸åŒçš„ model.pt æ–‡ä»¶æ—¶ï¼Œå®ƒéƒ½ä¼šä¸‹è½½æœ€æ–°ç‰ˆæœ¬ï¼ˆä¾‹å¦‚ï¼šyolov5mu.ptï¼‰ã€‚
æˆ‘åœ¨ VSCode å’Œ anaconda æç¤ºç¬¦ä¸‹è¿è¡Œç±»ä¼¼çš„å‘½ä»¤ï¼š
yolo æ£€æµ‹é¢„æµ‹ model=yolov5/yolov5m.pt source=&#39;datasets\Testing_images\20210823_112536.jpg&#39;ï¼Œåœ¨ VSCode ä¸Šã€‚

yoloä»»åŠ¡=æ£€æµ‹æ¨¡å¼=é¢„æµ‹æ¨¡å‹=ganuza.ptæº=&#39;test1.jpg&#39;show=Trueï¼Œåœ¨anacondaæç¤ºç¬¦ä¸‹ã€‚

æˆ‘æŒ‰ç…§æ•™ç¨‹è¿›è¡Œæ“ä½œï¼Œæ–‡ä»¶å¤¹ç»„ç»‡çœ‹èµ·æ¥ä¸é”™ã€‚å¦‚æœæˆ‘ä½¿ç”¨å¦ä¸€ç§æ¨¡å‹ï¼ˆä¾‹å¦‚å®ƒä¸‹è½½çš„æ¨¡å‹ï¼‰ï¼Œå®ƒå°±å¯ä»¥æ­£å¸¸å·¥ä½œã€‚
æœ‰è°çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆå—ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/77678969/using-yolov5-old-models-to-make-a-prediction</guid>
      <pubDate>Mon, 18 Dec 2023 12:06:31 GMT</pubDate>
    </item>
    <item>
      <title>å°†é—®é¢˜æ ‡è®°ä¸ºç®€å•ã€ä¸­ç­‰å’Œå›°éš¾ [å…³é—­]</title>
      <link>https://stackoverflow.com/questions/77678858/labelling-questions-as-easy-medium-and-hard</link>
      <description><![CDATA[æˆ‘ç›®å‰æ­£åœ¨ä»äº‹ä¸€ä¸ªæœºå™¨å­¦ä¹ é¡¹ç›®ï¼Œä¸“æ³¨äºå¼€å‘é—®é¢˜æ ‡ç­¾æ¨¡å‹ã€‚ æŒ‘æˆ˜åœ¨äºç¡®å®šå¦‚ä½•å°†é—®é¢˜åˆ†ç±»ä¸ºâ€œç®€å•â€ã€â€œä¸­ç­‰â€æˆ–â€œå›°éš¾â€ã€‚æ›´å…·ä½“åœ°è¯´ï¼Œæˆ‘æ­£åœ¨å¯»æ±‚æœ‰å…³å“ªäº›æŒ‡æ ‡å¯ä»¥å‡†ç¡®ç¡®å®šé—®é¢˜éš¾åº¦çº§åˆ«çš„æŒ‡å¯¼ç®€å•ã€ä¸­ç­‰æˆ–å›°éš¾ã€‚å¦‚æœæœ‰äººæœ‰æœºå™¨å­¦ä¹ ç»éªŒï¼Œæˆ‘ä»¬å°†ä¸èƒœæ„Ÿæ¿€æ‚¨çš„å¸®åŠ©ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/77678858/labelling-questions-as-easy-medium-and-hard</guid>
      <pubDate>Mon, 18 Dec 2023 11:44:50 GMT</pubDate>
    </item>
    <item>
      <title>å°†å˜é‡ä»ä¸€ä¸ªæ¨¡å—å¯¼å…¥åˆ°å¦ä¸€ä¸ªæ¨¡å—</title>
      <link>https://stackoverflow.com/questions/77678535/importing-variables-from-one-module-to-other</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/77678535/importing-variables-from-one-module-to-other</guid>
      <pubDate>Mon, 18 Dec 2023 10:44:18 GMT</pubDate>
    </item>
    <item>
      <title>åˆ†å‰²æ¨¡å‹æ¨ç†å»¶è¿Ÿé—®é¢˜</title>
      <link>https://stackoverflow.com/questions/77678168/segmentation-model-inference-latency-issue</link>
      <description><![CDATA[æˆ‘ä½¿ç”¨äº† pyannote çš„å¼€æºåˆ†å‰²æ¨¡å‹å’Œ Diart diarization çš„è¯´è¯è€…äºŒå€¼åŒ–å­˜å‚¨åº“ï¼Œä½¿ç”¨ diart==0.5.1ï¼Œ
åœ¨ diart/blocks/segmentation.py ä¸­ï¼Œæˆ‘è¿›è¡Œäº†ä»¥ä¸‹æ›´æ”¹::
 ä¸ torch.no_grad()ï¼š
        wave=rearrange(self.formatter.cast(waveform),â€œæ‰¹é‡é‡‡æ ·é€šé“-&gt;æ‰¹é‡é€šé“é‡‡æ ·â€)
        # æ³¢ç«ç‚¬.Tensor (1, 1, 80000)
        æ‰“å°ï¼ˆwave.get_deviceï¼ˆï¼‰ï¼‰
        å¼€å§‹ = æ—¶é—´.time()
        è¾“å‡º = self.model(wave.to(self.device)).cpu()
        åœæ­¢=æ—¶é—´.time()
        print(&#39;åˆ†æ®µæ—¶é—´:&#39;)
        æ‰“å°ï¼ˆåœæ­¢-å¼€å§‹ï¼‰
        # è¾“å‡ºï¼štorch.Tensor (1, 293, 3)
    è¿”å› self.formatter.restore_type(è¾“å‡º)

åœ¨è¾“å‡ºä¸­ï¼Œseg timeL 0.4s
ä½†æ˜¯å¦‚æœæˆ‘å°è¯•åœ¨ diart å­˜å‚¨åº“ä¹‹å¤–è¿›è¡Œæ¨æ–­ï¼ˆåœ¨ç‹¬ç«‹çš„å­˜å‚¨åº“ä¸­ï¼‰ï¼š
defegmentation_model(self,batch:np.ndarray) -&gt;; np.ndarrayï¼š
    å— = torch.tensor(batch)
    print(chunks.get_device()) # -1

    ä½¿ç”¨ torch.no_grad()ï¼š
        å°è¯•ï¼š
            æ‰“å°ï¼ˆå—.å½¢çŠ¶ï¼‰
            è¾“å‡º = self.model(chunks.to(self.device)).cpu()
        é™¤äº† RuntimeError ä½œä¸ºä¾‹å¤–ï¼š
            å¦‚æœ is_oom_errorï¼ˆå¼‚å¸¸ï¼‰ï¼š
                å¼•å‘å†…å­˜é”™è¯¯ï¼ˆ
                    f&quot;batch_size ({self.batch_size: d}) å¯èƒ½å¤ªå¤§ã€‚ â€
                    fâ€œå°è¯•ä½¿ç”¨è¾ƒå°çš„å€¼ï¼Œç›´åˆ°å†…å­˜é”™è¯¯æ¶ˆå¤±ã€‚â€
                ï¼‰
            åˆ«çš„ï¼š
                å¼•å‘å¼‚å¸¸

    è¿”å›è¾“å‡º.numpy()

æ­¤å¤„åˆ†æ®µæ—¶é—´ï¼š10s
èµ„æºã€è¾“å…¥æ ¼å¼ã€å½¢çŠ¶ã€ç±»å‹ä¸€åˆ‡éƒ½æ˜¯ç›¸åŒçš„
ä¸ºä»€ä¹ˆå»¶è¿Ÿä¸åŒï¼Ÿ
æœŸæœ›å»¶è¿Ÿç›¸åŒ]]></description>
      <guid>https://stackoverflow.com/questions/77678168/segmentation-model-inference-latency-issue</guid>
      <pubDate>Mon, 18 Dec 2023 09:38:17 GMT</pubDate>
    </item>
    <item>
      <title>è¿è¡Œ fmri æ·±åº¦å­¦ä¹ æ¨¡å‹æ—¶å‡ºç°é”™è¯¯</title>
      <link>https://stackoverflow.com/questions/77677389/getting-error-while-running-fmri-deep-learning-model</link>
      <description><![CDATA[æˆ‘æ­£åœ¨å¤„ç† fmri æ•°æ®ï¼Œæˆ‘æœ‰ä¸¤ç»„æ•°æ®é›†ç–¾ç—…å’Œæ­£å¸¸æ•°æ®çš„å½¢çŠ¶æ˜¯æ­£å¸¸æ•°æ®å½¢çŠ¶ï¼š(91, 109, 91, 1200)
ç–¾ç—…æ•°æ®å½¢çŠ¶ï¼š(91, 109, 91, 210)
æˆ‘å†™äº†pythonè„šæœ¬
å°† numpy å¯¼å…¥ä¸º np
å°† nibabel å¯¼å…¥ä¸º nib
ä» sklearn.model_selection å¯¼å…¥ train_test_split


# å®šä¹‰æ­£å¸¸å’Œç–¾ç—…æ•°æ®æ–‡ä»¶å¤¹çš„è·¯å¾„
ç–¾ç—…æ•°æ®è·¯å¾„ = glob(&#39;/media/aish/Backup Plus1/ABIDE/scan_data001/**/**/**/**/**/**/**/**/swa*&#39;)
Normal_data_path = glob(&#39;/media/aish/rs2/hcp/s*&#39;)

# åŠ è½½æ­£å¸¸å’Œç–¾ç—…æ•°æ®
æ­£å¸¸æ•°æ® = []
ç–¾ç—…æ•°æ® = []
å¯¹äºnormal_data_path[0:400]ä¸­çš„æ–‡ä»¶ï¼š
    Normal_data.append(nib.load(file).get_data())
å¯¹äºç–¾ç—…æ•°æ®è·¯å¾„ä¸­çš„æ–‡ä»¶ï¼š
    ç–¾ç—…æ•°æ®.append(nib.load(æ–‡ä»¶).get_data())

print(â€œæ­£å¸¸æ•°æ®å½¢çŠ¶ï¼šâ€, normal_data[1].shape)
print(â€œç–¾ç—…æ•°æ®å½¢çŠ¶ï¼šâ€,ç–¾ç—…æ•°æ®[1].shape)

# åˆ›å»ºæ ‡ç­¾
æ ‡ç­¾ = np.concatenate((np.zeros(len(normal_data)), np.ones(len(disease_data))))

# å°†æ•°æ®åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†
X_trainï¼ŒX_testï¼Œy_trainï¼Œy_test = train_test_splitï¼ˆnp.arrayï¼ˆæ­£å¸¸æ•°æ®+ç–¾ç—…æ•°æ®ï¼‰ï¼Œæ ‡ç­¾ï¼Œtest_size = 0.2ï¼Œrandom_state = 42ï¼‰

ä½†æ˜¯æˆ‘æ”¶åˆ°é”™è¯¯
å®Œæ•´é”™è¯¯æ˜¯
ValueError Tracebackï¼ˆæœ€è¿‘ä¸€æ¬¡è°ƒç”¨æœ€åä¸€æ¬¡ï¼‰
[7]ï¼Œç¬¬ 32 è¡Œä¸­çš„å•å…ƒæ ¼
     29 ä¸ªæ ‡ç­¾ = np.concatenate((np.zeros(len(normal_data)), np.ones(len(disease_data))))
     31 # å°†æ•°æ®åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†
---&gt; 32 X_trainï¼ŒX_testï¼Œy_trainï¼Œy_test = train_test_splitï¼ˆnp.arrayï¼ˆæ­£å¸¸æ•°æ®+ç–¾ç—…æ•°æ®ï¼‰ï¼Œæ ‡ç­¾ï¼Œtest_size = 0.2ï¼Œrandom_state = 42ï¼‰
     34 # å®šä¹‰CNNæ¨¡å‹
     35 æ¨¡å‹ = é¡ºåº()

ValueErrorï¼šæ— æ³•å°†è¾“å…¥æ•°ç»„ä»å½¢çŠ¶ (91,109,91,1200) å¹¿æ’­åˆ°å½¢çŠ¶ (91,109,91)

æˆ‘æ— æ³•è§£å†³æ­¤é”™è¯¯]]></description>
      <guid>https://stackoverflow.com/questions/77677389/getting-error-while-running-fmri-deep-learning-model</guid>
      <pubDate>Mon, 18 Dec 2023 06:53:58 GMT</pubDate>
    </item>
    <item>
      <title>LightGBM ä¸­çš„æ•°æ®é‡‡æ ·æ–¹æ³•</title>
      <link>https://stackoverflow.com/questions/77578111/data-sample-methods-in-lightgbm</link>
      <description><![CDATA[æˆ‘çš„é—®é¢˜
æˆ‘ä¸å¤ªæ¸…æ¥šæ‰€æœ‰å‚æ•°çš„ç”¨æ³•ä»¥åŠå®ƒä»¬å¦‚ä½•ç›¸äº’äº¤äº’ï¼ˆæˆ–åº”è¯¥ä½¿ç”¨ï¼‰ã€‚
æˆ‘æ‰€çŸ¥é“çš„
æ®æˆ‘äº†è§£ï¼ŒLightGBMä¸­æœ‰3ç§ç®—æ³•ï¼š

GBDTï¼Œé»˜è®¤çš„ï¼Œä½¿ç”¨ boosting
DART æ˜¯ä¸€ç§å¸¦æœ‰ dropout çš„ boosting ç®—æ³•
éšæœºæ£®æ—ï¼Œä¸ä½¿ç”¨å¢å¼ºï¼ˆç¡®å®å¦‚æ­¤ï¼Œä½†ä»…åœ¨ä¸€æ¬¡è¿­ä»£ä¸­ï¼‰

å¹¶ä¸”æœ‰ä¸¤ç§æ•°æ®é‡‡æ ·ç­–ç•¥ï¼š

Baggingï¼Œç”¨äºé›†æˆå­¦ä¹ ã€‚è¿™æ˜¯é»˜è®¤å€¼ï¼Œä½†å…³è”å‚æ•°çš„å€¼ï¼ˆä¾‹å¦‚ bagging_freqï¼‰ä¼šä½¿ bagging åœç”¨ã€‚
GOSS é€‰æ‹©æ›´å¤šå¯¹è¯¯å·®æ¢¯åº¦è´¡çŒ®æœ€å¤§çš„æ•°æ®ï¼ˆæˆ‘ä»¬çš„æƒ³æ³•æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦å¯¹è¿œç¦»åŸºçº¿çš„æ•°æ®è¿›è¡Œæ›´å¤šè®­ç»ƒï¼‰ï¼Œè€Œå¯¹â€œå¼±â€æ•°æ®è¿›è¡Œæ›´å°‘çš„è®­ç»ƒã€‚æ•°æ®ç‚¹ï¼ˆå¯¹è¯¯å·®æ¢¯åº¦è´¡çŒ®è¾ƒå°çš„æ•°æ®ç‚¹ï¼‰ã€‚

é—®é¢˜
æ‰€ä»¥æˆ‘çš„é—®é¢˜å¦‚ä¸‹ï¼š

ä¸ºä»€ä¹ˆ Bagging å’Œ GOSS ä¸å…¼å®¹ï¼Ÿå®ƒä»¬ä¼¼ä¹ä¸ä¼šå½±å“åŒä¸€ä»¶äº‹ã€‚
LightGBM çš„ä¸»è¦åˆ›æ–°ä¼¼ä¹æ˜¯ GOSSï¼Œä½†å®ƒå¹¶ä¸æ˜¯é»˜è®¤é€‰æ‹©ï¼Œè¿™æ ·åšçš„åŠ¨æœºæ˜¯ä»€ä¹ˆï¼Ÿ
æœ€åï¼Œæˆ‘ä»¬èƒ½å¤Ÿå°† boosting_type=goss ä½œä¸ºå‚æ•°ä¼ é€’ã€‚å½“æˆ‘ä»¬è¿™æ ·åšæ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿç®—æ³•ä¼šæ˜¯GBDTï¼Œè€Œæ•°æ®æ ·æœ¬ç­–ç•¥æ˜¯gosså—ï¼Ÿ

éå¸¸æ„Ÿè°¢æ‚¨æŠ½å‡ºæ—¶é—´ã€‚
ç¥ä½ æœ‰ç¾å¥½çš„ä¸€å¤©ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/77578111/data-sample-methods-in-lightgbm</guid>
      <pubDate>Thu, 30 Nov 2023 11:34:21 GMT</pubDate>
    </item>
    <item>
      <title>LLMæ¨¡å‹éå¸¸æ…¢</title>
      <link>https://stackoverflow.com/questions/77199972/llm-model-is-very-slow</link>
      <description><![CDATA[æˆ‘æ­£åœ¨ nvidia g5 ä¸Šè¿è¡Œ 34b LLM æ¨¡å‹ã€‚ 8xlarge å®ä¾‹ï¼ˆ1 ä¸ª Nvidia A10G GPUã€24GB GPU RAMã€32 ä¸ª vCPUã€128GB RAMï¼‰
è¿™æ˜¯æ¨ç†ä»£ç 
ä»å˜å‹å™¨å¯¼å…¥ AutoTokenizer,LlamaForCausalLM, AutoConfig, AutoModelForCausalLM
ä»åŠ é€Ÿå¯¼å…¥ infer_auto_device_map, init_empty_weights
è¿›å£ç«ç‚¬

model_path = â€œPhind/Phind-CodeLlama-34B-v2â€

model = LlamaForCausalLM.from_pretrained(model_path, device_map=â€œè‡ªåŠ¨â€, offload_folder=â€œå¸è½½â€, torch_dtype=torch.float16, offload_state_dict = True)
tokenizer = AutoTokenizer.from_pretrained(model_path)

defgenerate_one_completionï¼ˆæç¤ºï¼šstrï¼‰ï¼š
    tokenizer.pad_token = tokenizer.eos_token
    è¾“å…¥=åˆ†è¯å™¨ï¼ˆæç¤ºï¼Œreturn_tensors =â€œptâ€ï¼Œæˆªæ–­= Trueï¼Œmax_length = 4096ï¼‰

    ï¼ƒ äº§ç”Ÿ
    generate_ids = model.generate(inputs.input_ids.to(â€œcudaâ€), max_new_tokens=384, do_sample=True, top_p=0â€‹â€‹.75, top_k=10, æ¸©åº¦=0.1)
    å®Œæˆ= tokenizer.batch_decodeï¼ˆgenerate_idsï¼Œskip_special_tokens = Trueï¼Œclean_up_tokenization_spaces = Falseï¼‰[0]
    å®Œæˆ = å®Œæˆ.replace(prompt, &quot;&quot;).split(&quot;\n\n\n&quot;)[0]

    è¿”å›å®Œæˆ

text = â€œä½ å¥½ï¼Œè¯·é—®æ˜¯ä½ å—ï¼Ÿâ€
æ‰“å°ï¼ˆç”Ÿæˆ_ä¸€ä¸ª_å®Œæˆï¼ˆæ–‡æœ¬ï¼‰ï¼‰


åŠ è½½æ£€æŸ¥ç‚¹åˆ†ç‰‡ - è¿™éœ€è¦ 4 åˆ†é’Ÿã€‚å¦‚ä½•æ‰èƒ½åŠ å¿«é€Ÿåº¦ï¼Ÿ
å³ä½¿æ˜¯ç®€å•çš„æ¨ç†ä¹Ÿéœ€è¦ 60 ç§’ä»¥ä¸Šã€‚ä»£ç å¡«å†™/æç¤ºéœ€è¦ 10 å¤šåˆ†é’Ÿã€‚å¯ä»¥åœ¨æ­¤ ec2 å®ä¾‹ä¸ŠåŠ é€Ÿå—ï¼Ÿ
]]></description>
      <guid>https://stackoverflow.com/questions/77199972/llm-model-is-very-slow</guid>
      <pubDate>Fri, 29 Sep 2023 06:54:14 GMT</pubDate>
    </item>
    <item>
      <title>å¦‚ä½•ä½¿ç”¨GANç”Ÿæˆæ‹‰æ›¼å…‰è°±çš„åˆæˆæ•°æ®æ ·æœ¬ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/76906588/how-to-generate-synthetic-data-samples-of-raman-spectroscopy-by-using-gan</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/76906588/how-to-generate-synthetic-data-samples-of-raman-spectroscopy-by-using-gan</guid>
      <pubDate>Tue, 15 Aug 2023 14:05:29 GMT</pubDate>
    </item>
    <item>
      <title>æ— æ³•åœ¨pythonä¸­å®‰è£…lap==0.4.0åº“</title>
      <link>https://stackoverflow.com/questions/76463707/unable-to-install-lap-0-4-0-library-in-python</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/76463707/unable-to-install-lap-0-4-0-library-in-python</guid>
      <pubDate>Tue, 13 Jun 2023 09:55:26 GMT</pubDate>
    </item>
    </channel>
</rss>