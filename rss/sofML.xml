<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>æ ‡è®°ä¸ºæœºå™¨å­¦ä¹ çš„æ´»è·ƒé—®é¢˜ - Thinbug</title>
    <link>https://stackoverflow.com/questions/tagged/?tagnames=machine-learning&sort=active</link>
    <description>æ¥è‡ª stackoverflow.com çš„æœ€æ–° 30 ä¸ª</description>
    <lastBuildDate>Wed, 13 Dec 2023 15:14:37 GMT</lastBuildDate>
    <item>
      <title>Llama2 å›å½’è¯­è¨€æ¨¡å‹ (huggingface)</title>
      <link>https://stackoverflow.com/questions/77654285/llama2-language-model-for-regression-huggingface</link>
      <description><![CDATA[æˆ‘å°è¯•åˆ©ç”¨ç»™å®šæ•´ä¸ªè¾“å…¥åºåˆ—çš„æ¨¡å‹çš„æœ€åä¸€ä¸ªéšè—çŠ¶æ€ï¼Œè°ƒæ•´ Llama2 æ¥è§£å†³å›å½’ä»»åŠ¡ã€‚
å¦‚æœéšåæå‡ºé—®é¢˜â€œ2+2 çš„ç­”æ¡ˆæ˜¯ä»€ä¹ˆâ€ï¼Œåˆ™åº”å›ç­” 4ï¼ˆè™šæ‹Ÿé—®é¢˜ï¼Œç”¨äºè§£é‡Šé—®é¢˜ï¼‰ã€‚&lt; /p&gt;
ä¸ºæ­¤ï¼Œæˆ‘å°†åœ¨ pytorch æ¨¡å‹ä¸­ä½¿ç”¨å®ƒ
å¯¼å…¥ç«ç‚¬
å°† torch.nn å¯¼å…¥ä¸º nn
ä» Transformer å¯¼å…¥ LlamaModelã€LlamaTokenizer

ç±» TransformerModel(nn.Module):
    def __init__(self, æ¨¡å‹åç§°:str, é™„åŠ å±‚å¤§å°:int = 1):
        super(TransformerModel, self).__init__()
        self.transformer = LlamaModel.from_pretrained(model_name, torch_dtype=torch.float32, cache_dir=â€œhugginface_cache/modelsâ€)
        self.tokenizer = LlamaTokenizer.from_pretrained(model_name,cache_dir=â€œhugginface_cache/tokenizerâ€)

        # æ·»åŠ ä¸€ä¸ªå¸¦æœ‰ä¸€ä¸ªè¾“å‡ºçš„é™„åŠ å±‚
        self.additional_layer = nn.Linear(self.transformer.config.hidden_â€‹â€‹size,additional_layer_size)
        
    defforward(self, input_text):
        # å¯¹è¾“å…¥æ–‡æœ¬è¿›è¡Œæ ‡è®°
        input_ids = self.tokenizer(input_text, return_tensors=â€œptâ€).input_ids.to(â€œcudaâ€)
        æ‰“å°ï¼ˆâ€œè¾“å…¥IDï¼šâ€ï¼Œè¾“å…¥IDï¼‰

        # è·å–å˜å‹å™¨çš„è¾“å‡º
        è¾“å‡º = self.transformer(input_ids)
        
        # ä½¿ç”¨æ•´ä¸ªæœ€åçš„éšè—çŠ¶æ€ä½œä¸ºé™„åŠ å±‚çš„è¾“å…¥
        æœ€åéšè—çŠ¶æ€ = è¾“å‡º.æœ€åéšè—çŠ¶æ€
        æ‰“å°ï¼ˆ&#39;last_hidden_â€‹â€‹state_shapeï¼š&#39;ï¼Œlast_hidden_â€‹â€‹state.sizeï¼ˆï¼‰ï¼‰

        # åº”ç”¨é™„åŠ å±‚
        é™„åŠ è¾“å‡º= self.é™„åŠ å±‚ï¼ˆæœ€åéšè—çŠ¶æ€ï¼‰

        è¿”å›é¢å¤–çš„è¾“å‡º


model_url = â€œmeta-llama/Llama-2-7b-hfâ€

æ¨¡å‹ = TransformerModel(model_url)

ä½†æ˜¯ï¼Œå¯¹äºç»™å®šçš„è¾“å…¥æ¨¡å‹ï¼ˆâ€œHello worldï¼â€ï¼‰ï¼Œè¾“å‡ºæ˜¯å¤§å°ä¸º 1,4,1 çš„å¼ é‡ã€‚
æˆ‘å¯ä»¥éªŒè¯æ ‡è®°ç”Ÿæˆå™¨æ˜¯å¦å°†å­—ç¬¦ä¸²æ‹†åˆ†ä¸º 4 ä¸ªæ ‡è®°ï¼Œæˆ‘é¢„è®¡è¿™ä¼šå¯¼è‡´é—®é¢˜ã€‚ä½†æ˜¯ï¼Œæˆ‘ä¸ç¡®å®šå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/77654285/llama2-language-model-for-regression-huggingface</guid>
      <pubDate>Wed, 13 Dec 2023 14:22:48 GMT</pubDate>
    </item>
    <item>
      <title>åƒ Google Photo-Image è¿™æ ·çš„å›¾åƒæœç´¢è¢«èµ‹äºˆæ¨¡å‹[å…³é—­]</title>
      <link>https://stackoverflow.com/questions/77653804/image-search-like-google-photo-image-with-face-is-given-to-model</link>
      <description><![CDATA[å½“ç”¨æˆ·ä¸Šä¼ è‡ªæ‹ç…§æ—¶ï¼Œæ¨¡å‹ä¼šåœ¨å¤šäººå›¾åƒæ•°æ®é›†ä¸­æœç´¢åŒä¸€ä¸ªäººï¼Œå¹¶è¿”å›åŒ…å«è¯¥äººçš„æ‰€æœ‰å›¾åƒã€‚
ç¬¬ 1 æ­¥ï¼šä»å›¾åƒæ•°æ®é›†ä¸­æ£€æµ‹æ‰€æœ‰äººè„¸ï¼Œå¹¶é€šè¿‡ DeepFace(RetinaFace) å’Œ OpenCV ä¿å­˜è£å‰ªåçš„äººè„¸ã€‚
ç¬¬2æ­¥ï¼šé€šè¿‡OpenCVè¯»å–æ‰€æœ‰è£å‰ªåçš„é¢ï¼Œè°ƒæ•´å…¶å¤§å°ï¼Œå­˜å‚¨åˆ°numpyæ•°ç»„ä¸­å¹¶æ ‡å‡†åŒ–ã€‚
ç¬¬ 3 æ­¥ï¼šå°†å…¶è¾“å…¥ VGG16(Keras) æ¨¡å‹ï¼Œä¸åŒ…æ‹¬å…·æœ‰ 0 ä¸ªå¯è®­ç»ƒå‚æ•°çš„é¡¶å±‚ï¼ˆä½¿ç”¨æƒé‡ï¼‰ï¼Œå¹¶ä»å›¾åƒ numpy æ•°ç»„ä¸­æå–ç‰¹å¾ã€‚
ç¬¬4æ­¥ï¼šå°†è¿™äº›æå–çš„ç‰¹å¾è¾“å…¥èšç±»æ¨¡å‹ï¼ˆæ— ç›‘ç£ï¼‰
æˆ‘å°è¯•äº† KMeans å’Œå‡èšå±‚æ¬¡èšç±»ï¼Œä½†æ²¡æœ‰è¾¾åˆ°é¢„æœŸæ•ˆæœã€‚
èšç±»æ ¹æœ¬ä¸å‡†ç¡®ï¼Œæ›´ä¸å‡†ç¡®ã€‚
ä»»ä½•äººéƒ½å¯ä»¥å¸®åŠ©æˆ‘è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¦‚ä½•å®Œæˆè¿™é¡¹ä»»åŠ¡ï¼Œæˆ‘åœ¨å“ªä¸€æ­¥çŠ¯äº†é”™è¯¯......
å›¾åƒ/æ•°æ®æœªæ ‡è®°ï¼Œæƒ³è¦æ„å»ºæ— ç›‘ç£çš„èšç±»æ¨¡å‹ã€‚
è¿™é‡Œæœ‰ C# çš„å¼€æºæ¡†æ¶å—ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/77653804/image-search-like-google-photo-image-with-face-is-given-to-model</guid>
      <pubDate>Wed, 13 Dec 2023 13:04:01 GMT</pubDate>
    </item>
    <item>
      <title>æˆ‘åº”è¯¥åœ¨ Adam ä¼˜åŒ–å™¨çš„é¡¶éƒ¨åº”ç”¨ä½™å¼¦é€€ç«è°ƒåº¦ç¨‹åºå—ï¼Ÿ [å…³é—­]</title>
      <link>https://stackoverflow.com/questions/77653513/should-i-apply-a-cosine-annealing-scheduler-on-the-top-of-the-adam-optimizer</link>
      <description><![CDATA[Adam ä¼˜åŒ–å™¨ä»¥å…¶è‡ªé€‚åº”è°ƒæ•´å­¦ä¹ ç‡çš„èƒ½åŠ›è€Œé—»åï¼Œé‚£ä¹ˆä½™å¼¦é€€ç«è°ƒåº¦å™¨è¿˜æœ‰ç”¨å—ï¼Ÿ
æˆ‘è¿˜æ²¡æœ‰å®Œæˆå®éªŒï¼Œéƒ¨åˆ†åŸå› æ˜¯æˆ‘æ²¡æœ‰å¹²å‡€çš„ä½™å¼¦é€€ç«ä»£ç ç¤ºä¾‹ã€‚ç‰¹åˆ«æ„Ÿè°¢é‚£äº›å¯ä»¥æä¾›ä»£ç ç‰‡æ®µçš„äººã€‚]]></description>
      <guid>https://stackoverflow.com/questions/77653513/should-i-apply-a-cosine-annealing-scheduler-on-the-top-of-the-adam-optimizer</guid>
      <pubDate>Wed, 13 Dec 2023 12:16:11 GMT</pubDate>
    </item>
    <item>
      <title>æ‰§è¡Œä¸è‡ªç„¶è¯­è¨€å¤„ç†ç›¸å…³çš„ä»£ç æ—¶å‡ºé”™[å…³é—­]</title>
      <link>https://stackoverflow.com/questions/77653463/error-in-execution-of-code-related-to-natural-language-processing</link>
      <description><![CDATA[æ­¤ä»£ç æ˜¾ç¤ºäº†å›¾åƒä¸­ç»™å‡ºçš„é”™è¯¯ã€‚æˆ‘æ— æ³•ç†è§£å…¶ä¸­çš„åŸå› ã€‚

æˆ‘ä¸çŸ¥é“å¦‚ä½•åœ¨Pythonä¸­ä½¿ç”¨å¯¼å…¥å‘½ä»¤ã€‚æˆ‘å°è¯•äº†æ‰€æœ‰å¯èƒ½çš„æ–¹æ³•è¿›è¡Œæ£€æŸ¥ï¼ŒåŒ…æ‹¬åˆ é™¤å¸¦æœ‰å…¶ä»–æ–°é—»é—¨æˆ·åç§°çš„â€œè·¯é€ç¤¾â€ï¼Œä½†æ²¡æœ‰ä»»ä½•æ•ˆæœã€‚ç°åœ¨ï¼Œå¦‚æœæœ‰äººå¸®åŠ©æˆ‘æ­£ç¡®ç¼–å†™ä»£ç çš„â€œå¯¼å…¥â€éƒ¨åˆ†ï¼Œé‚£å°±æ›´å¥½äº†ã€‚æˆ‘è®¤ä¸ºå…¶ä»–éƒ¨åˆ†æ²¡é—®é¢˜ï¼Œå› ä¸ºæ²¡æœ‰æ˜¾ç¤ºå…¶ä»–æ¶ˆæ¯ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/77653463/error-in-execution-of-code-related-to-natural-language-processing</guid>
      <pubDate>Wed, 13 Dec 2023 12:07:23 GMT</pubDate>
    </item>
    <item>
      <title>æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨éœ€è¦ä¼°è®¡å¤šå°‘ä¸ªå‚æ•°ï¼Ÿ [å…³é—­]</title>
      <link>https://stackoverflow.com/questions/77652867/how-many-parameters-need-to-be-estimated-for-na%c3%afve-bayes-classifier</link>
      <description><![CDATA[è¿™æ˜¯æ¥è‡ª GATE æ•°æ®ç§‘å­¦ä¸äººå·¥æ™ºèƒ½ (DA) æ ·æœ¬è®ºæ–‡çš„ MCQ é—®é¢˜ï¼š
Q.28
&lt;å—å¼•ç”¨&gt;
ç»™å®šä¸€ä¸ªåŒ…å«ğ‘ç‚¹çš„ğ¾ç±»æ•°æ®é›†ï¼Œå…¶ä¸­æè¿°äº†æ ·æœ¬ç‚¹
ä½¿ç”¨ ğ· ç¦»æ•£ç‰¹å¾ï¼Œæ¯ä¸ªç‰¹å¾éƒ½èƒ½å¤Ÿå– ğ‘‰ å€¼ï¼Œå¦‚ä½•
æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨éœ€è¦ä¼°è®¡å¾ˆå¤šå‚æ•°ï¼Ÿ
(A) (ğ‘‰^D)ğ¾ 
(B) (ğ¾^V)^D 
(C) ğ‘‰ğ·ğ¾ + K 
(D) ğ¾(ğ‘‰ + ğ·)

æ ¹æ®chatgptæ­£ç¡®ç­”æ¡ˆæ˜¯(A)ï¼š
æ€»å‚æ•°=ç±»çš„æ•°é‡Ã—(æ¯ä¸ªç‰¹å¾çš„å€¼çš„æ•°é‡)^ç‰¹å¾çš„æ•°é‡+ç±»çš„æ•°é‡
è€Œ Bard é€šè¿‡å– Kã€V å’Œ D çš„ä¸€äº›å€¼ç»™å‡ºäº†æ­£ç¡®ç­”æ¡ˆ (C)ã€‚
æˆ‘æƒ³çŸ¥é“è¿™æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœå¯èƒ½çš„è¯ï¼Œè¿›ä¸€æ­¥é˜…è¯»æœ‰å…³è¯¥ä¸»é¢˜çš„å†…å®¹ä¼šå¾ˆå¥½ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/77652867/how-many-parameters-need-to-be-estimated-for-na%c3%afve-bayes-classifier</guid>
      <pubDate>Wed, 13 Dec 2023 10:38:01 GMT</pubDate>
    </item>
    <item>
      <title>ç”¨è½¬æ¢å±‚æ›¿æ¢å¹³å‡æ± å±‚</title>
      <link>https://stackoverflow.com/questions/77652246/replacing-a-avg-pool-layer-with-a-conv-layer</link>
      <description><![CDATA[æˆ‘æœ‰ä¸€ä¸ªå†…æ ¸å¤§å°ä¸º (4,3) çš„å¹³å‡æ± å±‚ï¼Œå…¶æ­¥é•¿ä¸º (4,3) å’Œ 0 å¡«å……ã€‚æˆ‘æƒ³å°†å…¶è½¬æ¢ä¸ºç­‰æ•ˆçš„è½¬æ¢å±‚ï¼Œä»¥ä¾¿åœ¨æˆ‘çš„ç¥ç»ç½‘ç»œä¸­å®ç°ã€‚
æ‰€ä»¥ï¼Œåœ¨æˆ‘çš„æ¨¡å‹ä¸­ï¼Œæˆ‘æ›¿æ¢äº†è¿™ä¸ªï¼š
self.pool = nn.AvgPool2d((4, 3))

ä½¿ç”¨è¿™ä¸€è¡Œï¼ˆ32 æ˜¯è¾“å…¥é€šé“æ•°ï¼‰ï¼š
self.pool = nn.Conv2d(32, 32, (4, 3), stride=(4, 3), åå·®=False)

å¯¹æˆ‘æ¥è¯´ï¼Œè¿™ä¸¤ä¸ªå±‚ä¼¼ä¹åº”è¯¥æ˜¯ç­‰æ•ˆçš„ï¼Œå¹¶ä¸”è¿™ä¸¤ä¸ªå±‚çš„è¾“å‡ºå¤§å°éƒ½æ˜¯ (1, 32, 32, 13) ï¼ˆå®ƒæœ‰ 32 ä¸ªé€šé“ï¼‰ï¼›å¯¹äºå¤§å°ä¸º (1, 32, 129, 40) çš„è¾“å…¥ï¼ˆ32 ä¸ªé€šé“ï¼ŒX ç»´åº¦ 129ï¼ŒY ç»´åº¦ 40ï¼‰ã€‚
æˆ‘ä¸ç¡®å®šæˆ‘å¯¹æ± åŒ–å±‚å’Œè½¬æ¢å±‚çš„åŸºç¡€çŸ¥è¯†æ˜¯å¦æœ‰é”™è¯¯çš„ç†è§£ã€‚æœ‰äººå¯ä»¥å¸®æˆ‘å—ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/77652246/replacing-a-avg-pool-layer-with-a-conv-layer</guid>
      <pubDate>Wed, 13 Dec 2023 09:06:48 GMT</pubDate>
    </item>
    <item>
      <title>SEEM æ¨¡å‹åœ¨å‘å…¶ä¼ é€’å›¾åƒåŠå…¶æ¨ç†æ—¶é¢ä¸´çš„é—®é¢˜</title>
      <link>https://stackoverflow.com/questions/77651185/facing-issues-with-seem-model-in-passing-images-to-it-and-its-inferencing</link>
      <description><![CDATA[æˆ‘æ­£åœ¨ç ”ç©¶ SEEM æ¨¡å‹ï¼Œè¿™æ˜¯ä¸€ç§å¯æ¨å¹¿çš„äº¤äº’å¼æ¨¡å‹ï¼Œç”¨äºä¸€æ¬¡æ€§åˆ†å‰²å›¾åƒä¸­ä»»ä½•åœ°æ–¹çš„æ‰€æœ‰å†…å®¹ã€‚ç”±äºèµ„æºæœ‰é™ï¼Œæˆ‘åœ¨å°†å›¾åƒä¼ é€’ç»™å®ƒåŠå…¶æ¨ç†æ—¶é¢ä¸´é—®é¢˜ã€‚æˆ‘å·²ç»å®‰è£…äº†æ‰€æœ‰ä¾èµ–é¡¹å¹¶å•ç‹¬åŠ è½½äº† SEEM æ¨¡å‹ã€‚æœ‰è°å¯¹æ­¤æœ‰ä»»ä½•æƒ³æ³•å¹¶ç›¸åº”åœ°æŒ‡å¯¼æˆ‘ã€‚
æˆ‘æœŸå¾…æœ‰äººèƒ½å¤Ÿæ ¹æ®ä»–ä»¬çš„çŸ¥è¯†æŒ‡å¯¼æˆ‘ï¼Œæˆ‘å¯ä»¥å°½å¿«è§£å†³è¿™ä¸ªé—®é¢˜]]></description>
      <guid>https://stackoverflow.com/questions/77651185/facing-issues-with-seem-model-in-passing-images-to-it-and-its-inferencing</guid>
      <pubDate>Wed, 13 Dec 2023 04:53:29 GMT</pubDate>
    </item>
    <item>
      <title>å°è¯•å°†è‡ªå®šä¹‰æ¨¡å‹éƒ¨ç½²åˆ°ç»ˆç«¯èŠ‚ç‚¹æ—¶ä» AWS Sagemaker è·å–ï¼ˆè¶…æ—¶ï¼‰ModelError</title>
      <link>https://stackoverflow.com/questions/77649384/getting-timed-out-modelerror-from-aws-sagemaker-when-trying-to-deploy-a-custom</link>
      <description><![CDATA[æˆ‘ç›®å‰åœ¨ä½¿ç”¨ PyTorchModel å’Œæˆ‘çš„è‡ªå®šä¹‰æ¨¡å‹åœ¨ AWS SageMaker ä¸Šéƒ¨ç½²ç»ˆç«¯èŠ‚ç‚¹æ—¶é‡åˆ°é—®é¢˜ã€‚å°½ç®¡éµå¾ª Amazon å®˜æ–¹ç½‘ç«™ï¼ˆæ‰€æœ‰ä»£ç å‡å¯åœ¨ä¸€ä¸ª Github ä¸Šæ‰¾åˆ°ï¼‰ï¼Œæˆ‘é‡åˆ°ä»¥ä¸‹é”™è¯¯ï¼š
&lt;å—å¼•ç”¨&gt;
sagemaker è°ƒç”¨ InvokeEndpoint æ“ä½œæ—¶å‘ç”Ÿé”™è¯¯ (ModelError)ï¼šä»ä¸»å®¹å™¨æ”¶åˆ°æœåŠ¡å™¨é”™è¯¯ (0)ï¼Œå¹¶æ˜¾ç¤ºæ¶ˆæ¯æ‚¨çš„è°ƒç”¨åœ¨ç­‰å¾…å®¹å™¨ä¸»å®¹å™¨çš„å“åº”æ—¶è¶…æ—¶ã€‚æ£€æŸ¥ Amazon CloudWatch ä¸­æ¯ä¸ªå®¹å™¨çš„å»¶è¿ŸæŒ‡æ ‡ï¼Œè§£å†³é—®é¢˜ï¼Œç„¶åé‡è¯•ã€‚

æˆ‘å°è¯•é€šè¿‡æŸ¥çœ‹ Amazon CloudWatch ä¸­çš„æ—¥å¿—æ¥è§£å†³è¯¥é—®é¢˜ï¼Œä½†æ— æ³•æ‰¾åˆ°è§£å†³æ–¹æ¡ˆã€‚æˆ‘è¿˜å°† SAGEMAKER_MODEL_SERVER_TIMEOUT æ›´æ”¹ä¸º 180ï¼Œä½†å®ƒä¸èµ·ä½œç”¨ã€‚è¯·è®©æˆ‘çŸ¥é“å¦‚ä½•ä¿®å¤å®ƒã€‚æˆ‘å·²ç»å°è¯•è¿‡ AWS ç½‘ç«™ä¸Šçš„å…¶ä»–ç¤ºä¾‹å’Œæ–‡æ¡£ï¼Œä½†æ²¡æœ‰ä¸€ä¸ªå¯¹æˆ‘æœ‰ç”¨ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/77649384/getting-timed-out-modelerror-from-aws-sagemaker-when-trying-to-deploy-a-custom</guid>
      <pubDate>Tue, 12 Dec 2023 22:37:01 GMT</pubDate>
    </item>
    <item>
      <title>å¦‚ä½•ä½¿ç”¨ openai å’Œ langchain å°†å·²åˆ›å»ºçš„ chromadb é›†åˆä¸æ³•å­¦ç¡•å£«ä¸€èµ·ä½¿ç”¨ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/77642444/how-can-you-use-an-already-created-chromadb-collection-with-a-llm-using-openai-a</link>
      <description><![CDATA[æˆ‘å·²ç»ä½¿ç”¨å…¶æ–‡æ¡£å’Œå…ƒæ•°æ®åˆ›å»ºäº† chromadb é›†åˆã€‚
é—®é¢˜æ˜¯å½“æˆ‘æƒ³ä½¿ç”¨ langchain åˆ›å»º llm å¹¶ä¼ é€’æ­¤ chromadb é›†åˆä»¥ç”¨ä½œçŸ¥è¯†åº“æ—¶ã€‚
langchain_chroma = è‰²åº¦(
å®¢æˆ·ç«¯=æŒä¹…å®¢æˆ·ç«¯ï¼Œ
é›†åˆåç§°=é›†åˆ.åç§°,
embedding_function = openai_efï¼Œ
ï¼‰

llm_model =â€œgtp35turbo-æœ€æ–°â€

llm = AzureChatOpenAI(
   api_key=openai_api_key,
   api_version=openai_api_version,
   azure_endpoint=openai_api_base,
   æ¨¡å‹=llm_æ¨¡å‹ï¼‰

qa_chain = RetrievalQA.from_chain_type(
   å—¯ï¼Œ
   æ£€ç´¢å™¨=langchain_chroma.as_retriever(),
   chain_type=&quot;ç²¾ç‚¼&quot;
ï¼‰

å½“æˆ‘æƒ³è·‘æ­¥æ—¶ï¼š
qa_chain.run(â€œå¯¹è±¡æ£€æµ‹é—®é¢˜éœ€è¦å¤šå°‘æ•°æ®ç§‘å­¦å®¶â€)

æˆ‘æ”¶åˆ°æ­¤é”™è¯¯ï¼š
AttributeError Tracebackï¼ˆæœ€è¿‘ä¸€æ¬¡è°ƒç”¨æœ€åä¸€æ¬¡ï¼‰
&lt;ipython-input-81-3cdb65aeb43e&gt;åœ¨&lt;ç»†èƒç³»ï¼š1&gt;()
----&gt; 1 qa.run(â€œå¯¹è±¡æ£€æµ‹é—®é¢˜éœ€è¦å¤šå°‘æ•°æ®ç§‘å­¦å®¶â€)

9å¸§
/usr/local/lib/python3.10/dist-packages/langchain/vectorstores/chroma.py ä¸­ç›¸ä¼¼æ€§_search_with_score(self, query, k, filter, where_document, **kwargs)
    ç¬¬430ç« ï¼‰
    ç¬¬431ç« ï¼š
--&gt;ç¬¬432ç« 
    ç¬¬433ç« 
    ç¬¬434ç« 

AttributeErrorï¼šâ€œOpenAIEmbeddingFunctionâ€å¯¹è±¡æ²¡æœ‰å±æ€§â€œembed_queryâ€

å¦‚ä½•è§£å†³ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/77642444/how-can-you-use-an-already-created-chromadb-collection-with-a-llm-using-openai-a</guid>
      <pubDate>Mon, 11 Dec 2023 21:17:23 GMT</pubDate>
    </item>
    <item>
      <title>è°ƒæ•´å›¾åƒåˆ†å‰²æ¨¡å‹ï¼ˆæ¥è‡ª TF æ•™ç¨‹ï¼‰ä»¥è¿›è¡ŒäºŒå…ƒæ©è”½</title>
      <link>https://stackoverflow.com/questions/77635064/adjust-image-segmentaion-model-from-tf-tutorial-for-binary-masking</link>
      <description><![CDATA[æˆ‘éœ€è¦ Tensorflow çš„å›¾åƒåˆ†å‰²æ¨¡å‹ã€‚è¾“å…¥ä¸ºå›¾åƒå’Œæ©ç ï¼ˆäºŒè¿›åˆ¶ã€æ©ç æˆ–éæ©ç ï¼‰ï¼Œè¾“å‡ºä¸ºå¸¦æœ‰ 0 å’Œ 1 çš„å›¾åƒæ©ç ã€‚
æˆ‘éµå¾ªäº† https://www.tensorflow.org/tutorials/ ä¸­çš„å›¾åƒåˆ†å‰²æ•™ç¨‹å›¾åƒ/åˆ†å‰²
ä½†ç°åœ¨æˆ‘æƒ³åœ¨æˆ‘çš„æ•°æ®é›†ä¸Šè¿è¡Œå®ƒçš„äºŒè¿›åˆ¶æ©ç ï¼ˆæ²¡æœ‰è¾¹æ¡†ç±»ï¼‰
æ–°æ•°æ®é›†å·²å‡†å¤‡å¥½å¹¶è¾“å…¥åˆ° model.fit ä¸­ã€‚åº”è¯¥æ²¡é—®é¢˜å§ã€‚
å¦‚ä½•å°†æ­¤æ¨¡å‹æ›´æ”¹ä¸ºåªæœ‰ 2 ä¸ªç±»ï¼ˆéå±è”½å’Œå±è”½ï¼‰ï¼Ÿ
base_model: keras.Model = tf.keras.applications.MobileNetV2(input_shape=[128, 128, 3], include_top=False)

# ä½¿ç”¨è¿™äº›å±‚çš„æ¿€æ´»
å›¾å±‚åç§° = [
    &#39;block_1_expand_relu&#39;, # 64x64
    &#39;block_3_expand_relu&#39;, # 32x32
    &#39;block_6_expand_relu&#39;, # 16x16
    &#39;block_13_expand_relu&#39;, # 8x8
    &#39;block_16_project&#39;, # 4x4
]
base_model_outputs = [base_model.get_layer(name).layer_names ä¸­åç§°çš„è¾“å‡º]

# åˆ›å»ºç‰¹å¾æå–æ¨¡å‹
down_stack = æ¨¡å‹ï¼ˆè¾“å…¥=base_model.è¾“å…¥ï¼Œè¾“å‡º=base_model_outputsï¼‰

down_stack.trainable = False

ä¸Šå±‚å †æ ˆ = [
    pix2pix.upsample(512, 3), # 4x4 -&gt; 8x8
    pix2pix.upsample(256, 3), # 8x8 -&gt; 16x16
    pix2pix.upsample(128, 3), # 16x16 -&gt; 32x32
    pix2pix.upsample(64, 3), # 32x32 -&gt; 64x64
]

def unet_model(output_channels:int):
  è¾“å…¥ = å±‚.Input(å½¢çŠ¶=[128, 128, 3])

  # é€šè¿‡æ¨¡å‹è¿›è¡Œä¸‹é‡‡æ ·
  è·³è¿‡= down_stackï¼ˆè¾“å…¥ï¼‰
  x = è·³è¿‡[-1]
  è·³è¿‡ = åè½¬(è·³è¿‡[:-1])

  # ä¸Šé‡‡æ ·å¹¶å»ºç«‹è·³è·ƒè¿æ¥
  å¯¹äº upï¼Œåœ¨ zip ä¸­è·³è¿‡ï¼ˆup_stackï¼Œskipsï¼‰ï¼š
    x = ä¸Š(x)
    concat = å±‚.Concatenate()
    x = concat([x, è·³è¿‡])

  # è¿™æ˜¯æ¨¡å‹çš„æœ€åä¸€å±‚
  æœ€å=å±‚.Conv2DTranspose(
      è¿‡æ»¤å™¨=output_channelsï¼Œkernel_size=3ï¼Œæ­¥é•¿=2ï¼Œ
      padding=&#39;ç›¸åŒ&#39;) #64x64 -&gt; 128x128

  x = æœ€åä¸€ä¸ª(x)

  è¿”å›æ¨¡å‹ï¼ˆè¾“å…¥=è¾“å…¥ï¼Œè¾“å‡º=xâ€‹â€‹ï¼‰

è¾“å‡ºç±» = 3

æ¨¡å‹ = unet_model(output_channels=OUTPUT_CLASSES)

model.compile(ä¼˜åŒ–å™¨=&#39;äºšå½“&#39;,
              æŸå¤±=&#39;binary_crossentropy&#39;,
              æŒ‡æ ‡=[&#39;å‡†ç¡®æ€§&#39;])

å½“æˆ‘å°† OUTPUT_CLASSES æ›´æ”¹ä¸º 2 æ—¶ï¼Œå‡ºç°é”™è¯¯ï¼š
W tensorflow/core/kernels/data/generator_dataset_op.cc:108] å®Œæˆ GeneratorDataset è¿­ä»£å™¨æ—¶å‘ç”Ÿé”™è¯¯ï¼šFAILED_PRECONDITIONï¼šPython è§£é‡Šå™¨çŠ¶æ€æœªåˆå§‹åŒ–ã€‚è¯¥è¿‡ç¨‹å¯ä»¥è¢«ç»ˆæ­¢ã€‚

å½“OUTPUT_CLASSESä¸º1æ—¶ï¼Œé¢„æµ‹æ©ç ä¸ºç©ºã€‚
ä¹Ÿè®¸è¿˜å¿…é¡»æ”¹å˜å…¶ä»–ä¸œè¥¿ï¼Ÿæˆ‘è¿˜ä¸ç†Ÿæ‚‰ç¥ç»ç½‘ç»œæ¶æ„ï¼Œæ‰€ä»¥æˆ‘å¯èƒ½çœ‹ä¸åˆ°æ˜æ˜¾çš„ä¸œè¥¿ã€‚
ç¼–è¾‘ï¼š
æˆ‘å·²å°†activation=&#39;sigmoid&#39;æ·»åŠ åˆ°è¾“å‡ºå±‚
 æœ€å = tf.keras.layers.Conv2DTranspose(
      è¿‡æ»¤å™¨=output_channelsï¼Œkernel_size=3ï¼Œæ­¥é•¿=2ï¼Œ
      å¡«å…… = &#39;ç›¸åŒ&#39;, æ¿€æ´» = &#39;sigmoid&#39;) #64x64 -&gt; 128x128

  x = æœ€åä¸€ä¸ª(x)

å’ŒOUTPUT_CLASSES = 1
å¥‡æ€ªçš„è¡Œä¸ºæ˜¯ä¸‹ä¸€ä¸ªï¼š
é¢„æœŸçš„æ©æ¨¡æ˜¯å½“æˆ‘åœ¨ä¸€ä¸ªéå¸¸å°çš„æ•°æ®é›†ä¸Šè®­ç»ƒå®ƒæ—¶ï¼ˆè¯¥æ•°æ®é›†ä¸­åŒ…å«çš„æµ‹è¯•çš„å›¾ç‰‡å’Œæ©æ¨¡ï¼Œåªæ˜¯ä¸ºäº†æµ‹è¯•å®ƒå¦‚ä½•æ£€æµ‹æ‰€çœ‹åˆ°çš„å›¾åƒï¼‰ï¼Œæˆ‘åœ¨ç¬¬ä¸€ä¸ªæ—¶æœŸå¾—åˆ°äº†ä¸€äº›ä¸œè¥¿ã€‚ä½†çºªå…ƒè¶Šå¤šï¼Œç»“æœè¶Šå·®ã€‚ç„¶è€Œï¼Œå‡†ç¡®åº¦çº¦ä¸º 0.99ã€‚
é¢„æœŸæ©ç ï¼š

é¢„æµ‹æ©ç çºªå…ƒ 0ï¼š

å¦‚æœæ‰“å¼€å›¾åƒï¼Œæ‚¨å¯èƒ½ä¼šåœ¨é¢„æœŸçš„é®ç½©éƒ¨åˆ†çœ‹åˆ°è½»å¾®çš„é˜´å½±ã€‚
é¢„æµ‹æ©ç çºªå…ƒ1ï¼š

...
çºªå…ƒ 4ï¼š

æ‰€ä»¥æ¯æ¬¡è¿­ä»£éƒ½ä¼šå˜å¾—æ›´ç³Ÿã€‚
æ•°æ®é›†åŒ…å«ä¸åº”æ˜¾ç¤ºä»»ä½•è’™ç‰ˆçš„å›¾åƒã€‚ä¹Ÿè®¸è¿™å°±æ˜¯é—®é¢˜æ‰€åœ¨ï¼Ÿ ï¼ˆç¼–è¾‘ï¼šä»æ•°æ®é›†ä¸­æ’é™¤æ²¡æœ‰æ©ç çš„æ•°æ® - æ²¡æœ‰å¸®åŠ©ï¼‰
ç¼–è¾‘2ï¼š
x = tf.keras.layers.BatchNormalization()(x)

æœ‰å¸®åŠ©ï¼Œè™½ç„¶ä¸å®Œç¾ï¼Œä½†æ˜¯æœ‰æ‰€å¸®åŠ©]]></description>
      <guid>https://stackoverflow.com/questions/77635064/adjust-image-segmentaion-model-from-tf-tutorial-for-binary-masking</guid>
      <pubDate>Sun, 10 Dec 2023 13:55:04 GMT</pubDate>
    </item>
    <item>
      <title>minMax TicTacToe ä»£ç è¿”å›é”™è¯¯çš„æœ€ä½³å¯èƒ½ç§»åŠ¨</title>
      <link>https://stackoverflow.com/questions/77596870/minmax-tictactoe-code-returning-the-wrong-best-possible-move</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/77596870/minmax-tictactoe-code-returning-the-wrong-best-possible-move</guid>
      <pubDate>Mon, 04 Dec 2023 02:07:13 GMT</pubDate>
    </item>
    <item>
      <title>ValidationErrorï¼šStuffDocumentsChain __root__ å‡ºç° 1 ä¸ªéªŒè¯é”™è¯¯</title>
      <link>https://stackoverflow.com/questions/76776695/validationerror-1-validation-error-for-stuffdocumentschain-root</link>
      <description><![CDATA[æˆ‘æ”¶åˆ°æ­¤é”™è¯¯ValidationErrorï¼šåœ¨ llm_chain input_variables ä¸­æ‰¾ä¸åˆ° StuffDocumentsChain __root__ document_variable_name ä¸Šä¸‹æ–‡çš„ 1 ä¸ªéªŒè¯é”™è¯¯ï¼š[&#39;chat_history&#39;ã€&#39;user_query&#39;ã€&#39;relevant_context&#39;] (type=value_error)
åœ¨ä½¿ç”¨ load_qa_chain æ—¶ï¼Œæˆ‘æœç´¢äº†æ­¤é”™è¯¯ï¼Œä½†æ²¡æœ‰æ‰¾åˆ°ä¸æ­¤ç›¸å…³çš„ä»»ä½•å†…å®¹ã€‚è°èƒ½å‘Šè¯‰æˆ‘è¿™é‡Œç¼ºå°‘ä»€ä¹ˆã€‚
ä»£ç ï¼š
template = &quot;&quot;&quot;æ‚¨æ˜¯ä¸€ä¸ªæ­£åœ¨ä¸äººç±»å¯¹è¯çš„èŠå¤©æœºå™¨äººã€‚

ç»™å®šé•¿æ–‡æ¡£å’Œé—®é¢˜çš„ä»¥ä¸‹æå–éƒ¨åˆ†ï¼Œåˆ›å»ºæœ€ç»ˆç­”æ¡ˆã€‚

{ç›¸å…³ä¸Šä¸‹æ–‡}

{èŠå¤©è®°å½•}
äººç±»ï¼š{user_query}
èŠå¤©æœºå™¨äººï¼šâ€œâ€â€œâ€

æç¤º=æç¤ºæ¨¡æ¿(
input_variables=[â€œchat_historyâ€, â€œuser_queryâ€, â€œrelevant_contextâ€],
æ¨¡æ¿=æ¨¡æ¿
ï¼‰

å†…å­˜ = ConversationBufferMemory(memory_key=â€œchat_historyâ€, input_key=â€œuser_queryâ€)

llm = OpenAI()
llm_chain = LLMChain(
    llm=llm,
    æç¤º=æç¤ºï¼Œ
    å†…å­˜=å†…å­˜ï¼Œ
ï¼‰

é“¾ = load_qa_chain(
    llm, chain_type=â€œä¸œè¥¿â€, å†…å­˜=å†…å­˜, æç¤º=æç¤º
ï¼‰
]]></description>
      <guid>https://stackoverflow.com/questions/76776695/validationerror-1-validation-error-for-stuffdocumentschain-root</guid>
      <pubDate>Thu, 27 Jul 2023 05:20:25 GMT</pubDate>
    </item>
    <item>
      <title>Google Colab å…è´¹å¥—é¤ï¼šä½¿ç”¨è‡ªå®šä¹‰æ•°æ®é›†å¾®è°ƒ LLAMA 2 æ—¶ï¼Œä»£ç åœæ­¢åœ¨ 51,000 ä¸ªç¤ºä¾‹</title>
      <link>https://stackoverflow.com/questions/76765564/google-colab-free-tier-code-stops-at-51-000-examples-while-fine-tuning-llama-2</link>
      <description><![CDATA[æˆ‘åœ¨ä½¿ç”¨è‡ªå®šä¹‰æ•°æ®é›†åœ¨ Google Colab ä¸Šå¾®è°ƒ Llama 2 æ—¶é‡åˆ°é—®é¢˜ã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œä»£ç æ°å¥½åœ¨ 51,000 ä¸ªç¤ºä¾‹å¤„åœæ­¢ï¼Œå°½ç®¡æˆ‘çš„æ•°æ®é›†åŒ…å« 61,609 ä¸ªç¤ºä¾‹ã€‚å¥‡æ€ªçš„æ˜¯ï¼Œå½“æˆ‘ä½¿ç”¨æ›´å¤§çš„æ•°æ®é›†æµ‹è¯•ä»£ç æ—¶ï¼Œå®ƒè¿è¡Œå¾—éå¸¸å¥½ã€‚æˆ‘æŒ‰ç…§ YouTube ä¸Šçš„æ•™ç¨‹å¯¹ Llama 2 è¿›è¡Œäº†å¾®è°ƒï¼Œæ‚¨å¯ä»¥åœ¨ä¸‹é¢æ‰¾åˆ°åŸå§‹ Colab å’Œæ•™ç¨‹é“¾æ¥ï¼š
æ•™ç¨‹é“¾æ¥ï¼šYouTube æ•™ç¨‹
åŸå§‹ Colabï¼šGoogle Colab
æ•°æ®é›†é“¾æ¥ï¼šæˆ‘çš„è‡ªå®šä¹‰æ•°æ®é›†
ä»£ç ï¼š
!pip install -q -U trl å˜å‹å™¨åŠ é€Ÿ git+https://github.com/huggingface/peft.git
!pip install -q æ•°æ®é›† BitsandBytes einops wandb

ä»æ•°æ®é›†å¯¼å…¥load_dataset
ä» Transformer å¯¼å…¥ AutoTokenizerã€TrainingArguments
ä» peft å¯¼å…¥ LoraConfigï¼Œget_peft_model
ä» trl å¯¼å…¥ SFTTrainer

# åŠ è½½æ•°æ®é›†
dataset_name = &#39;harpyerr/merged-pf&#39;
æ•°æ®é›† = load_dataset(dataset_name, split=&quot;train&quot;)

# å®šä¹‰model_nameã€lora_alphaã€lora_dropoutã€lora_rç­‰é…ç½®
model_name = â€œyour_pretrained_model_nameâ€ # æ›¿æ¢ä¸ºä½ çš„é¢„è®­ç»ƒæ¨¡å‹çš„åç§°
åŠ³æ‹‰é˜¿å°”æ³• = 16
åŠ³æ‹‰_dropout = 0.1
åŠ³æ‹‰_r = 64

# åˆå§‹åŒ–åˆ†è¯å™¨
tokenizer = AutoTokenizer.from_pretrained(model_name, trust_remote_code=True)
tokenizer.pad_token = tokenizer.eos_token

# å®šä¹‰ LoraConfig
peft_config = LoraConfigï¼ˆ
    åŠ³æ‹‰_é˜¿å°”æ³•=åŠ³æ‹‰_é˜¿å°”æ³•,
    lora_dropout=lora_dropout,
    r=åŠ³æ‹‰_r,
    åå·®=â€œæ— â€ï¼Œ
    task_type=â€œCAUSAL_LMâ€
ï¼‰

# å®šä¹‰è®­ç»ƒå‚æ•°
è¾“å‡ºç›®å½•=â€œ./ç»“æœâ€
æ¯ä¸ªè®¾å¤‡è®­ç»ƒæ‰¹æ¬¡å¤§å° = 4
æ¢¯åº¦ç´¯ç§¯æ­¥æ•° = 4
optim = â€œpaged_adamw_32bitâ€
ä¿å­˜æ­¥æ•° = 100
è®°å½•æ­¥éª¤ = 10
å­¦ä¹ ç‡ = 2e-4
æœ€å¤§æ¢¯åº¦èŒƒæ•° = 0.3
æœ€å¤§æ­¥æ•° = 100
é¢„çƒ­æ¯”ç‡ = 0.03
lr_scheduler_type = â€œå¸¸é‡â€

è®­ç»ƒå‚æ•° = è®­ç»ƒå‚æ•°ï¼ˆ
    è¾“å‡ºç›®å½•=è¾“å‡ºç›®å½•ï¼Œ
    per_device_train_batch_size = per_device_train_batch_sizeï¼Œ
    æ¢¯åº¦ç´¯ç§¯æ­¥æ•°=æ¢¯åº¦ç´¯ç§¯æ­¥æ•°ï¼Œ
    ä¼˜åŒ–=ä¼˜åŒ–ï¼Œ
    ä¿å­˜æ­¥éª¤=ä¿å­˜æ­¥éª¤ï¼Œ
    æ—¥å¿—è®°å½•æ­¥éª¤=æ—¥å¿—è®°å½•æ­¥éª¤ï¼Œ
    å­¦ä¹ ç‡=å­¦ä¹ ç‡ï¼Œ
    fp16=æ­£ç¡®ï¼Œ
    max_grad_norm=max_grad_norm,
    æœ€å¤§æ­¥æ•°=æœ€å¤§æ­¥æ•°ï¼Œ
    Warmup_ratio=warmup_ratio,
    group_by_length=çœŸï¼Œ
    lr_scheduler_type = lr_scheduler_typeï¼Œ
ï¼‰

# åˆå§‹åŒ– SFTTrainer
æœ€å¤§åºåˆ—é•¿åº¦ = 512
è®­ç»ƒå¸ˆ = SFTTrainer(
    å‹å·=å‹å·ï¼Œ
    train_dataset=æ•°æ®é›†ï¼Œ
    pft_config=peft_config,
    dataset_text_field=&quot;æ–‡æœ¬&quot;,
    max_seq_length = max_seq_lengthï¼Œ
    åˆ†è¯å™¨=åˆ†è¯å™¨ï¼Œ
    args=è®­ç»ƒå‚æ•°ï¼Œ
ï¼‰

# å°†æ‰€æœ‰æ ‡å‡†åŒ–å±‚è½¬æ¢ä¸º float32
è¿›å£ç«ç‚¬
å¯¹äºåç§°ï¼Œtrainer.model.named_modules() ä¸­çš„æ¨¡å—ï¼š
    å¦‚æœâ€œæ­£å¸¸â€åç§°ï¼š
        æ¨¡å— = module.to(torch.float32)

# å¼€å§‹è®­ç»ƒ
è®­ç»ƒå¸ˆ.train()

æˆ‘å°è¯•ä½¿ç”¨è¾ƒå¤§å°ºå¯¸çš„ä¸åŒæ•°æ®é›†æ¥æ£€æŸ¥é—®é¢˜æ˜¯å¦ç‰¹å®šäºæˆ‘çš„è‡ªå®šä¹‰æ•°æ®é›†ã€‚ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œå½“æˆ‘ä½¿ç”¨å…¶ä»–æ›´å¤§çš„æ•°æ®é›†æ—¶ï¼Œä»£ç è¿è¡Œå¾—éå¸¸å¥½ï¼Œæ²¡æœ‰ä»»ä½•åœæ­¢é—®é¢˜ã€‚å› æ­¤ï¼Œæˆ‘æ¨æ–­é—®é¢˜ä¸åœ¨äºä»£ç æˆ–è®­ç»ƒå™¨ï¼Œè€Œå¯èƒ½ä¸æˆ‘çš„è‡ªå®šä¹‰æ•°æ®é›†çš„å…·ä½“ç‰¹å¾æœ‰å…³ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/76765564/google-colab-free-tier-code-stops-at-51-000-examples-while-fine-tuning-llama-2</guid>
      <pubDate>Tue, 25 Jul 2023 18:25:00 GMT</pubDate>
    </item>
    <item>
      <title>HuggingFace AutoModelForCasualLM â€œä»…è§£ç å™¨æ¶æ„â€è­¦å‘Šï¼Œå³ä½¿åœ¨è®¾ç½® padding_side='left' åä¹Ÿæ˜¯å¦‚æ­¤</title>
      <link>https://stackoverflow.com/questions/74748116/huggingface-automodelforcasuallm-decoder-only-architecture-warning-even-after</link>
      <description><![CDATA[æˆ‘æ­£åœ¨ä½¿ç”¨
AutoModelForCausalLM å’Œ AutoTokenizer ä½¿ç”¨ DialoGPT ç”Ÿæˆæ–‡æœ¬è¾“å‡ºã€‚
æ— è®ºå‡ºäºä½•ç§åŸå› ï¼Œå³ä½¿ä½¿ç”¨ Huggingface æä¾›çš„ç¤ºä¾‹ï¼Œæˆ‘ä¹Ÿä¼šæ”¶åˆ°æ­¤è­¦å‘Šï¼š
&lt;å—å¼•ç”¨&gt;
æ­£åœ¨ä½¿ç”¨ä»…è§£ç å™¨æ¶æ„ï¼Œä½†æ£€æµ‹åˆ°å³å¡«å……ï¼ä¸ºäº†æ­£ç¡®çš„ç”Ÿæˆç»“æœï¼Œè¯·åœ¨åˆå§‹åŒ–åˆ†è¯å™¨æ—¶è®¾ç½® padding_side=&#39;left&#39;ã€‚

ä»å˜å‹å™¨å¯¼å…¥ AutoModelForCausalLM, AutoTokenizer
è¿›å£ç«ç‚¬


tokenizer = AutoTokenizer.from_pretrained(â€œmicrosoft/DialoGPT-mediumâ€)
æ¨¡å‹ = AutoModelForCausalLM.from_pretrained(â€œmicrosoft/DialoGPT-mediumâ€)

# æˆ‘ä»¬èŠ5è¡Œå§
å¯¹äºèŒƒå›´ï¼ˆ5ï¼‰ä¸­çš„æ­¥éª¤ï¼š
    # å¯¹æ–°çš„ç”¨æˆ·è¾“å…¥è¿›è¡Œç¼–ç ï¼Œæ·»åŠ  eos_token å¹¶åœ¨ Pytorch ä¸­è¿”å›ä¸€ä¸ªå¼ é‡
    new_user_input_ids = tokenizer.encode(input(â€œ&gt;&gt;ç”¨æˆ·:â€) + tokenizer.eos_token, return_tensors=&#39;pt&#39;)

    # å°†æ–°çš„ç”¨æˆ·è¾“å…¥æ ‡è®°é™„åŠ åˆ°èŠå¤©å†å²è®°å½•ä¸­
    bot_input_ids = torch.cat([chat_history_ids, new_user_input_ids], dim=-1) å¦‚æœæ­¥éª¤ &gt; 0 å…¶ä»– new_user_input_ids

    # ç”Ÿæˆå“åº”ï¼ŒåŒæ—¶å°†æ€»èŠå¤©å†å²è®°å½•é™åˆ¶ä¸º 1000 ä¸ªä»¤ç‰Œï¼Œ
    chat_history_ids = model.generate(bot_input_ids, max_length=1000, pad_token_id=tokenizer.eos_token_id)

    # æ¼‚äº®åœ°æ‰“å°æœºå™¨äººæœ€åçš„è¾“å‡ºä»¤ç‰Œ
    print(â€œDialoGPT: {}â€.format(tokenizer.decode(chat_history_ids[:, bot_input_ids.shape[-1]:][0],skip_special_tokens=True)))

ä»£ç ç”± å¾®è½¯åœ¨ Huggingface çš„æ¨¡å‹å¡ä¸Š
æˆ‘å°è¯•å°† padding_side=&#39;left&#39; æ·»åŠ åˆ°æ ‡è®°ç”Ÿæˆå™¨ä¸­ï¼Œä½†è¿™ä¸ä¼šæ”¹å˜ä»»ä½•å†…å®¹ã€‚
æ˜¾ç„¶ï¼ˆä»ä¸€äº›é˜…è¯»æ¥çœ‹ï¼‰DialoGPT æƒ³è¦åœ¨å³ä¾§å¡«å……ï¼Ÿ
æˆ‘æ— æ³•å¼„æ¸…æ¥šè¿™ä¸€ç‚¹ï¼Œå½“æˆ‘å°è¯•è°·æ­Œæœç´¢æ—¶å‡ ä¹æ²¡æœ‰ç»“æœã€‚
æˆ‘èƒ½å¤Ÿåƒè¿™æ ·æŠ‘åˆ¶è­¦å‘Šï¼š
from Transformers.utils å¯¼å…¥æ—¥å¿—è®°å½•

è®°å½•.set_verbosity_info()

ä½†è¿™ä¼¼ä¹ä¸æ˜¯æœ€å¥½çš„ç­”æ¡ˆï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/74748116/huggingface-automodelforcasuallm-decoder-only-architecture-warning-even-after</guid>
      <pubDate>Fri, 09 Dec 2022 20:39:39 GMT</pubDate>
    </item>
    <item>
      <title>OpenAI å¥èº«æˆ¿ç©å®¶æ¨¡å¼</title>
      <link>https://stackoverflow.com/questions/46762083/openai-gym-player-mode</link>
      <description><![CDATA[æœ‰è°çŸ¥é“å¦‚ä½•ä½œä¸ºç©å®¶è¿è¡Œ OpenAI å¥èº«æˆ¿ç¯å¢ƒä¹‹ä¸€ã€‚å°±åƒè®©äººç±»ç©å®¶ç©ä¸€è½®è½¦ç«¿ä¸€æ ·ï¼Ÿæˆ‘å·²ç»çœ‹åˆ°æœ‰ env.mode = &#39; human&#39; ä½†æˆ‘æ— æ³•è®©å®ƒæ­£å¸¸è¿è¡Œã€‚æˆ‘å°è¯•æŒ‰ç…§æ­¤å¤„ç»™å‡ºçš„ç¤ºä¾‹ https://www.pinchofintelligence.com/getting -started-openai-gym/ ä½†å®ƒä¼¼ä¹å¯¹æˆ‘ä¸èµ·ä½œç”¨ã€‚
å¦‚æœæ‚¨èƒ½æä¾›ä»»ä½•å¸®åŠ©ï¼Œæˆ‘ä»¬å°†ä¸èƒœæ„Ÿæ¿€ã€‚
è°¢è°¢]]></description>
      <guid>https://stackoverflow.com/questions/46762083/openai-gym-player-mode</guid>
      <pubDate>Mon, 16 Oct 2017 02:21:38 GMT</pubDate>
    </item>
    </channel>
</rss>