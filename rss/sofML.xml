<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>æ ‡è®°ä¸ºæœºå™¨å­¦ä¹ çš„æ´»è·ƒé—®é¢˜ - å †æ ˆå†…å­˜æº¢å‡º</title>
    <link>https://stackoverflow.com/questions/tagged/?tagnames=machine-learning&sort=active</link>
    <description>æ¥è‡ª stackoverflow.com çš„æœ€æ–° 30 æ¡</description>
    <lastBuildDate>Mon, 23 Sep 2024 21:15:41 GMT</lastBuildDate>
    <item>
      <title>å¦‚ä½•ä½¿ç”¨ llm å¯¹è±¡é€šè¿‡å•ä¸ªè„šæœ¬ä½¿ç”¨ vLLM åœ¨å¤šä¸ª gpu ä¸ŠåŠ è½½å¤šä¸ªæ¨¡å‹ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/79016077/how-does-one-load-multiple-models-on-multiple-gpus-with-vllm-with-a-single-scrip</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/79016077/how-does-one-load-multiple-models-on-multiple-gpus-with-vllm-with-a-single-scrip</guid>
      <pubDate>Mon, 23 Sep 2024 19:45:51 GMT</pubDate>
    </item>
    <item>
      <title>å¦‚ä½•å®ç°å¤šå…ƒ N èŠ‚æ‹æ¨¡å‹</title>
      <link>https://stackoverflow.com/questions/79015943/how-to-implement-multivariate-n-beats-model</link>
      <description><![CDATA[å¯¹äºåŸºäºæ—¥æœŸå’Œä¸€ä¸ªç‰¹å¾çš„å•å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºï¼Œä½†æˆ‘æœ‰ 6 ä¸ªç‰¹å¾ï¼Œå¦‚ä½•å°†å®ƒä»¬å®ç°åˆ°å•ä¸ª N èŠ‚æ‹æ¨¡å‹ä¸­
æˆ‘æœ‰åº“å­˜ç‰¹å¾ï¼Œ6 ä¸ªç‰¹å¾å’Œä¸€ä¸ªç›®æ ‡å˜é‡ã€‚æˆ‘åº”è¯¥æ€ä¹ˆåšï¼Œå¦‚ä½•è®­ç»ƒï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/79015943/how-to-implement-multivariate-n-beats-model</guid>
      <pubDate>Mon, 23 Sep 2024 18:52:34 GMT</pubDate>
    </item>
    <item>
      <title>æˆ‘ä»¬å¦‚ä½•åœ¨ R ä¸­è®¡ç®—ä¸€ä¸ªæ•°æ®é›†ä¸­çš„ä¸€ä¸ªè®°å½•ä¸ç¬¬äºŒä¸ªæ•°æ®é›†ä¸­çš„æ‰€æœ‰è®°å½•ä¹‹é—´çš„ Gower è·ç¦»ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/79015729/how-do-we-calculate-the-gower-distance-between-one-record-in-one-dataset-and-all</link>
      <description><![CDATA[æˆ‘æƒ³è®¡ç®—æ•°æ®é›† 1 çš„ä¸€æ¡è®°å½•ä¸æ•°æ®é›† 2 çš„æ‰€æœ‰è®°å½•ä¹‹é—´çš„ Gower è·ç¦»ã€‚ç¬¬ä¸€ç§æ–¹æ³•å¦‚ä¸‹
library(gower)

data(iris)
dat1 &lt;- iris[1:10,]
dat2 &lt;- iris[11:30,]

# ç¬¬ä¸€ç§æ–¹æ³•
gower::gower_dist(dat1[1,], dat2)

è¿™ç»™äº†æˆ‘é•¿åº¦ä¸º 20 çš„ç»“æœã€‚
0.09079365 0.09873016 0.16142857 0.29476190 0.20920635 0.33079365 
0.21936508 0.05000000 0.23952381 0.11507937 0.12095238 0.15079365 
0.16984127 0.24523810 0.16539683 0.12920635 0.17206349 0.03555556 
0.02761905 0.14063492

æˆ‘å¯ä»¥å°†ç¬¬ä¸€ä¸ªå€¼è§£é‡Šä¸º dat1[1,] å’Œ dat2[1,] ä¹‹é—´çš„ gower è·ç¦»ï¼Œå°†ç¬¬äºŒä¸ªå€¼è§£é‡Šä¸º dat1[1,] å’Œ dat2[2,] ä¹‹é—´çš„ gower è·ç¦»ï¼Œä¾æ­¤ç±»æ¨å—ï¼Ÿ
è®©æˆ‘æ„Ÿåˆ°å›°æƒ‘çš„æ˜¯ï¼Œå¦‚æœæˆ‘è®¡ç®—
gower::gower_dist(dat1[1,],dat2[1,])

è¿™ç»™äº†æˆ‘
0.75

è¿™ä¸ 0.09079365 ä¸åŒã€‚æœ€ç»ˆï¼Œæˆ‘æƒ³è®¡ç®— dat1 ä¸­æ¯ä¸ªè§‚æµ‹å€¼ä¸ dat2 ä¸­æ¯ä¸ªè§‚æµ‹å€¼çš„ Gower è·ç¦»ã€‚å¦‚æœæˆ‘ä½¿ç”¨ç¬¬äºŒç§æ–¹æ³•ï¼Œæˆ‘å°†éœ€è¦åœ¨ dat2 ä¸­çš„æ‰€æœ‰è§‚æµ‹å€¼ä¸Šæ·»åŠ ä¸€ä¸ª for å¾ªç¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚
# ç¬¬äºŒç§æ–¹æ³•
for(i in 1:nrow(dat2)) {
print(gower::gower_dist(dat1[1,],dat2[i,]))
}

ç”±äºè¿™ä¸¤ç§æ–¹æ³•ç»™å‡ºçš„ç»“æœä¸åŒï¼Œæˆ‘åº”è¯¥ä½¿ç”¨å“ªä¸€ç§æ–¹æ³•æ¥å®ç°ç›®çš„ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/79015729/how-do-we-calculate-the-gower-distance-between-one-record-in-one-dataset-and-all</guid>
      <pubDate>Mon, 23 Sep 2024 17:37:36 GMT</pubDate>
    </item>
    <item>
      <title>æœ‰äººçŸ¥é“å¦‚ä½•ä¿®å¤åº“é”™è¯¯å—ï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/79015388/does-anyone-know-how-to-fix-library-error</link>
      <description><![CDATA[æ—©ä¸Šå¥½ï¼Œæˆ‘é‡åˆ°äº†è¿™ä¸ªé”™è¯¯ï¼Œå°è¯•äº†æ‰€æœ‰æ–¹æ³•ï¼Œä½†è¿˜æ˜¯æ— æ³•è§£å†³ï¼Œå¦‚æœæœ‰äººçŸ¥é“ crewapi åº“æ˜¯ä»€ä¹ˆï¼Œé‚£å°†éå¸¸æœ‰å¸®åŠ©ã€‚
æˆ‘æ­£åœ¨å°è¯•æœ€ä¼˜è§£å†³æ–¹æ¡ˆä»¥ç»§ç»­
è¿™æ˜¯ä»£ç å’Œé”™è¯¯
ModuleNotFoundError Tracebackï¼ˆæœ€è¿‘ä¸€æ¬¡è°ƒç”¨æœ€åä¸€æ¬¡ï¼‰
&lt;ipython-input-13-6c7180fd4822&gt; in &lt;cell line: 1&gt;()
----&gt; 1 from crewapi_module import CrewAPI # ç”¨æ­£ç¡®çš„å¯¼å…¥è·¯å¾„æ›¿æ¢
2 
3 crew_api = CrewAPI(api_key=&quot;your_crewai_api_key&quot;)
4 
5 # ç°åœ¨æ‚¨å¯ä»¥ä¸ API äº¤äº’ï¼Œä¾‹å¦‚ï¼š

ModuleNotFoundErrorï¼šæ²¡æœ‰åä¸ºâ€œcrewapi_moduleâ€çš„æ¨¡å—
]]></description>
      <guid>https://stackoverflow.com/questions/79015388/does-anyone-know-how-to-fix-library-error</guid>
      <pubDate>Mon, 23 Sep 2024 15:52:13 GMT</pubDate>
    </item>
    <item>
      <title>å—ä¸åŒèšç±»å¤§å°çº¦æŸçš„ KMeans</title>
      <link>https://stackoverflow.com/questions/79015120/kmeans-constrained-with-different-cluster-size</link>
      <description><![CDATA[æˆ‘æœ‰ä¸€ä¸ªåŒ…å«å•†åº—åæ ‡çš„æ•°æ®æ¡†ï¼Œæˆ‘æƒ³æ ¹æ®ä¾›åº”å•†åº”è¯¥è®¿é—®è¯¥å•†åº—çš„æ—¥æœŸå°†å®ƒä»¬åˆ’åˆ†ä¸ºç°‡ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä¾›åº”å•†åº”è¯¥è®¿é—® 180 å®¶å•†åº—ã€‚ä»–åº”è¯¥åœ¨å‘¨ä¸€åˆ°å‘¨äº”è®¿é—® 30-34 å®¶å•†åº—ï¼Œå‘¨å…­ï¼Œä»–åº”è¯¥è®¿é—®å…¶ä»–æ—¥å­çš„ 60%ã€‚
ä½ ä»¬çŸ¥é“æˆ‘è¯¥æ€ä¹ˆåšå—ï¼Ÿä½¿ç”¨ kmeans-constrainedï¼Œæˆ‘åªèƒ½å°†å®ƒä»¬åˆ’åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„ç°‡ã€‚ä¹Ÿè®¸æˆ‘éœ€è¦ä½¿ç”¨æŸç§è§£ç®—å™¨æˆ–åœ¨é›†ç¾¤ä¹‹é—´ç§»åŠ¨ç‚¹ä»¥è¾¾åˆ°æˆ‘æƒ³è¦çš„æ•°å­—ï¼Œä½†æˆ‘ä¸çŸ¥é“å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ã€‚
ä»¥ä¸‹æ˜¯å°†å®ƒä»¬å‡ç­‰åˆ’åˆ†çš„ä»£ç ï¼š
# å¾ªç¯éå†ä¾›åº”å•†é›†ç¾¤
for vendor in df[&quot;vendor&quot;].unique():

# æ¯ä¸ªä¾›åº”å•†çš„å•†åº—æ•°é‡
n_shops = df.loc[df[&quot;vendor&quot;] == vendor][&quot;cod_shop&quot;].count()

# ç´¢å¼•
idx = df.loc[df[&quot;vendor&quot;] == vendor].index

# ä¸€å‘¨ä¸­å„å¤©çš„é›†ç¾¤æ•°é‡
num_clusters = 5 # æ˜ŸæœŸä¸€è‡³æ˜ŸæœŸäº”

# é›†ç¾¤çš„å¹³å‡å¤§å°
avg_size = n_shops / (num_clusters + 0.6)

# å®šä¹‰é™åˆ¶
min_shops = round(avg_size - n_shops * pct, 0)
max_shops = math.ceil(avg_size + n_shops * pct)

# æ¨¡å‹
kmeans = KMeansConstrained(n_clusters=num_clusters, size_min=min_shops, size_max=max_shops, random_state=42)
labels = kmeans.fit_predict(df.loc[df[&quot;vendor&quot;] == vendor][[&quot;latitude&quot;, &quot;longitude&quot;]])

# å‘æ•°æ®æ¡†æ·»åŠ æ ‡ç­¾
df.loc[idx, &quot;visit_day&quot;] = labels
]]></description>
      <guid>https://stackoverflow.com/questions/79015120/kmeans-constrained-with-different-cluster-size</guid>
      <pubDate>Mon, 23 Sep 2024 14:42:09 GMT</pubDate>
    </item>
    <item>
      <title>å›¾åƒæ‹¼æ¥ä¸­çš„æ³Šæ¾æ··åˆå¯¼è‡´å›¾åƒæ¨¡ç³Šã€é¬¼å½±é‡é‡</title>
      <link>https://stackoverflow.com/questions/79014990/poisson-blending-in-image-stitching-results-in-blurred-ghostly-images</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/79014990/poisson-blending-in-image-stitching-results-in-blurred-ghostly-images</guid>
      <pubDate>Mon, 23 Sep 2024 14:11:23 GMT</pubDate>
    </item>
    <item>
      <title>å¦‚ä½•ä½¿ç”¨ coremltools å°† TensorFlow ConcreteFunction æˆ– AutoTrackable å¯¹è±¡è½¬æ¢ä¸º Core MLï¼Ÿ</title>
      <link>https://stackoverflow.com/questions/79014855/how-to-convert-a-tensorflow-concretefunction-or-autotrackable-object-to-core-ml</link>
      <description><![CDATA[æˆ‘æ­£åœ¨å°è¯•ä½¿ç”¨ coremltools å°† TensorFlow å¯¹è±¡æ£€æµ‹æ¨¡å‹ (ssd_mobilenet_v1_coco) è½¬æ¢ä¸º Core ML æ ¼å¼ã€‚è¯¥æ¨¡å‹é‡‡ç”¨ SavedModel æ ¼å¼ï¼Œä½†æˆ‘åœ¨å°è¯•è½¬æ¢æ—¶é‡åˆ°äº†å„ç§é—®é¢˜ã€‚ä»¥ä¸‹æ˜¯æˆ‘åˆ°ç›®å‰ä¸ºæ­¢é‡‡å–çš„æ­¥éª¤ä»¥åŠæˆ‘å¾—åˆ°çš„é”™è¯¯ï¼š
æˆ‘åˆ°ç›®å‰ä¸ºæ­¢æ‰€åšçš„ï¼š

åŠ è½½äº† TensorFlow SavedModelï¼š
import tensorflow as tf

model = tf.saved_model.load(&quot;ssd_mobilenet_v1_coco_2017_11_17/saved_model&quot;)
concrete_func = model.signatures[tf.saved_model.DEFAULT_SERVING_SIGNATURE_DEF_KEY]`



å°è¯•ä½¿ç”¨ coremltools å°†æ¨¡å‹è½¬æ¢ä¸º Core MLï¼š


mlmodel = ct.convert(concrete_func, source=&quot;tensorflow&quot;)
mlmodel.save(&quot;ssd_mobilenet_v1_coco.mlmodel&quot;) 

å°è¯•è½¬æ¢ ConcreteFunction æ—¶ï¼Œæˆ‘ä¸æ–­æ”¶åˆ°ä»¥ä¸‹é”™è¯¯ï¼š
NotImplementedErrorï¼šé¢„æœŸæ¨¡å‹æ ¼å¼ï¼š[SavedModel | concrete_function | tf.keras.Model | .h5 | GraphDef]ï¼Œå¾—åˆ°äº† ConcreteFunction

æˆ‘å°è¯•å°†æ¨¡å‹å¯¼å‡ºä¸º SavedModel å¹¶å°†è¯¥è·¯å¾„ç›´æ¥ä¼ é€’ç»™ coremltoolsï¼š
tf.saved_model.save(model, &quot;exported_saved_model&quot;)
mlmodel = ct.convert(&quot;exported_saved_model&quot;, source=&quot;tensorflow&quot;)

å¦‚ä½•ä½¿ç”¨ coremltools æˆåŠŸå°†æ­¤ TensorFlow æ¨¡å‹ï¼ˆæˆ– ConcreteFunctionï¼‰è½¬æ¢ä¸º Core MLï¼Ÿæ˜¯å¦æœ‰ç‰¹å®šçš„æ–¹æ³•æ¥å¤„ç† AutoTrackable æˆ– ConcreteFunction å¯¹è±¡ï¼Ÿåœ¨æ­¤è½¬æ¢è¿‡ç¨‹ä¸­æˆ‘é—æ¼äº†ä»€ä¹ˆæˆ–åšé”™äº†ä»€ä¹ˆï¼Ÿ
å…¶ä»–ä¿¡æ¯ï¼š
â€¢ TensorFlow ç‰ˆæœ¬ï¼šX.X.Xï¼ˆä¾‹å¦‚ 2.10.0ï¼‰
â€¢ coremltools ç‰ˆæœ¬ï¼šX.X.Xï¼ˆä¾‹å¦‚ 5.0b3ï¼‰
â€¢ Python ç‰ˆæœ¬ï¼šX.X.Xï¼ˆä¾‹å¦‚ 3.10ï¼‰
]]></description>
      <guid>https://stackoverflow.com/questions/79014855/how-to-convert-a-tensorflow-concretefunction-or-autotrackable-object-to-core-ml</guid>
      <pubDate>Mon, 23 Sep 2024 13:36:52 GMT</pubDate>
    </item>
    <item>
      <title>æ˜¯å¦æœ‰ä»»ä½•æ–¹æ³•å¯ä»¥æ‰©å±•æˆ‘ä»¬çš„æ•°æ®é›†ï¼Œä»å…·æœ‰ 200 è¡Œçš„åˆå§‹æ•°æ®é›†å¼€å§‹ã€‚æˆ‘å¸Œæœ›ä»ä¸­è‡³å°‘è·å¾— 2000 è¡Œæ¥åº”ç”¨ ML æ¨¡å‹ [å…³é—­]</title>
      <link>https://stackoverflow.com/questions/79014580/is-there-any-method-about-how-to-expand-our-dataset-from-initial-dataset-having</link>
      <description><![CDATA[æˆ‘çš„é¡¹ç›®æ˜¯åˆ©ç”¨ ML æŠ€æœ¯é¢„æµ‹æŠ‘éƒç¨‹åº¦æˆ–å‘å­©å­çš„çˆ¶æ¯æå‡ºä¸€äº›é¢„é˜²æªæ–½å»ºè®®ã€‚
æˆ‘æƒ³åº”ç”¨ ML æ¨¡å‹æ ¹æ®æˆ‘ä»¬çš„æ•°æ®é›†é¢„æµ‹æŠ‘éƒç¨‹åº¦æˆ–å…¶ç—‡çŠ¶ã€‚å› æ­¤ï¼Œæˆ‘éœ€è¦è‡³å°‘ 2000 ä¸ªè®­ç»ƒæ•°æ®å…ƒç»„æ¥è®­ç»ƒå®ƒä»¬ã€‚æˆ‘æ€æ ·æ‰èƒ½åœ¨ä¸æ”¹å˜å±æ€§ä¹‹é—´çš„å…³ç³»ï¼ˆç›¸å…³æ€§ï¼‰çš„æƒ…å†µä¸‹å®ç°è¿™ä¸€ç‚¹ã€‚
æˆ‘çš„æ•°æ®é›†åŒ…å«è®¸å¤šå±æ€§ï¼Œä¾‹å¦‚å±å¹•æ—¶é—´ã€æŠ‘éƒç¨‹åº¦ã€‚å¦‚ä½•ä½¿ç”¨ä¸€äº›ä»£ç æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚
æˆ‘å°è¯•ä½¿ç”¨ CTGANï¼Œä½†å®ƒç»™äº†æˆ‘å¾ˆå¤šé”™è¯¯ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/79014580/is-there-any-method-about-how-to-expand-our-dataset-from-initial-dataset-having</guid>
      <pubDate>Mon, 23 Sep 2024 12:21:48 GMT</pubDate>
    </item>
    <item>
      <title>ä½¿ç”¨ NumPy å®ç°åŸºæœ¬ç¥ç»ç½‘ç»œçš„é—®é¢˜</title>
      <link>https://stackoverflow.com/questions/79014083/problem-implementing-a-basic-neural-network-with-numpy</link>
      <description><![CDATA[]]></description>
      <guid>https://stackoverflow.com/questions/79014083/problem-implementing-a-basic-neural-network-with-numpy</guid>
      <pubDate>Mon, 23 Sep 2024 09:49:44 GMT</pubDate>
    </item>
    <item>
      <title>ä½¿ç”¨ Deepface Deepface.represent ä» ROI è·å–åµŒå…¥æ—¶å‡ºé”™</title>
      <link>https://stackoverflow.com/questions/79013712/error-getting-embeddings-from-a-roi-using-deepface-deepface-represent</link>
      <description><![CDATA[æˆ‘åœ¨ä½¿ç”¨ Deepface ä» Retinaface è¯†åˆ«çš„è£å‰ª ROI è·å–åµŒå…¥æ—¶é‡åˆ°äº†é—®é¢˜ã€‚
æˆ‘æ­£å°è¯•ä½¿ç”¨ä¸€äº›åäººçš„æ•°æ®é›†ï¼ˆå›¾åƒï¼‰å­¦ä¹ å¯¹è±¡è¯†åˆ«ï¼Œå¹¶å¯èƒ½è€ƒè™‘å°†å…¶ç”¨äºæˆ‘çš„ä¸ªäººç…§ç‰‡åº“ã€‚æˆ‘å°è¯•ä½¿ç”¨ Haar Cascade è¿›è¡Œäººè„¸æ£€æµ‹ï¼Œå¹¶ä½¿ç”¨ Open Cv ä¸­çš„ LBPHFaceRecognize è¿›è¡Œäººè„¸è¯†åˆ«ï¼Œæ•ˆæœå¾ˆå¥½ã€‚ç„¶åæˆ‘æƒ³å°è¯•ä½¿ç”¨ Retinafce è¿›è¡Œäººè„¸æ£€æµ‹å¹¶è·å¾— ROIã€‚ROI å­˜å‚¨åœ¨åˆ—è¡¨ä¸­ï¼Œå¹¶ä½¿ç”¨ Deepface ä»é€‰å®šçš„ ROI è·å–åµŒå…¥å¹¶å­˜å‚¨åœ¨å¦ä¸€ä¸ªåˆ—è¡¨ä¸­ã€‚æˆ‘æ­£åœ¨å°è¯•å°†åµŒå…¥å­˜å‚¨åˆ°åˆ—è¡¨ä¸­ï¼Œä½†æˆ‘ä¸€ç›´å¾—åˆ°
 raise ValueError(
ValueError: æ— æ³•åœ¨ numpy æ•°ç»„ä¸­æ£€æµ‹åˆ°äººè„¸ã€‚è¯·ç¡®è®¤å›¾ç‰‡

æ˜¯äººè„¸ç…§ç‰‡æˆ–è€ƒè™‘å°† force_detection å‚æ•°è®¾ç½®ä¸º Falseã€‚
è™½ç„¶æ‰€æœ‰å›¾åƒéƒ½æœ‰ä¸€å¼ è¢«æ¸…æ¥šæ£€æµ‹åˆ°çš„äººè„¸ã€‚è¿™æ˜¯æˆ‘çš„ä»£ç ä¾›å‚è€ƒï¼š
import os
import cv2 as cv
from retinaface import RetinaFace
from deepface import DeepFace
import numpy as np
from sklearn.svm import SVC
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score

artist = [&#39;50cent&#39;] # type: ignore #MJ the GOAT!! , &#39;Kanye&#39;, &#39;Eminem&#39;, &#39;MichaelJackson&#39;
ROOT_DIR = &#39;asset/Face_Recon_Dataset&#39; #å›¾åƒæ•°æ®é›†çš„è·¯å¾„
faces_roi =[]
labels = []
embeddings = []
#ç°åœ¨åœ¨è„¸éƒ¨åæ ‡ä¸Šç”»ä¸€ä¸ªçŸ©å½¢
#è„¸éƒ¨èŒƒå›´æœ‰ï¼š
# x1, y1) = (28, 51) #å·¦ä¸Šè§’
# (x2, y2) = (61, 98) #å³ä¸‹è§’
&quot;&quot;&quot; è¿™å®šä¹‰äº†æ£€æµ‹åˆ°çš„è„¸éƒ¨å‘¨å›´çš„çŸ©å½¢è¾¹ç•Œæ¡†ã€‚
- x1 (28)ï¼šè„¸éƒ¨çš„å·¦è¾¹ç¼˜
- y1 (51)ï¼šè„¸éƒ¨çš„ä¸Šè¾¹ç¼˜
- x2 (61)ï¼šè„¸éƒ¨çš„å³è¾¹ç¼˜
- y2 (98)ï¼šè„¸éƒ¨çš„ä¸‹è¾¹ç¼˜&quot;&quot;&quot;

def get_roi():
for artist_name in artist:
# è·å–è‰ºæœ¯å®¶å§“åçš„ç´¢å¼•
label = artist.index(artist_name)
image_folder = os.path.join(ROOT_DIR,artist_name) # è·å–åŒ…å«å›¾åƒçš„å®é™…æ–‡ä»¶å¤¹
for artist_images in os.listdir(image_folder): # åˆ—å‡ºè¯¥ç›®å½•ä¸­çš„æ‰€æœ‰å›¾åƒ
image = os.path.join(image_folder,artist_images)
resp = RetinaFace.detect_faces(image)
# ç¡®ä¿äººè„¸å­˜åœ¨
if isinstance(resp,dict):
img = cv.imread(image)
for face_id, face_data in resp.items():
# print(face_id)
# print(&quot;x1: &quot;, face_data[&#39;facial_area&#39;][0])
# print(&quot;y1: &quot;, face_data[&#39;facial_area&#39;][1])
# print(&quot;x2: &quot;, face_data[&#39;facial_area&#39;][2])
# print(&quot;y2: &quot;, face_data[&#39;facial_area&#39;][3], &quot;\n&quot;)
# è¯»å–å›¾åƒ

# æ£€æµ‹äººè„¸
x1 = face_data[&#39;facial_area&#39;][0]
y1 = face_data[&#39;facial_area&#39;][1]
x2 = face_data[&#39;facial_area&#39;][2]
y2 = face_data[&#39;facial_area&#39;][3]

# ä¸ºäººè„¸ç»˜åˆ¶è¾¹ç•Œæ¡† 
# faces_rect = cv.rectangle(img, (x1, y1), (x2, y2), (0, 255, 0), 2)
face_roi = img[y1:y2,x1:x2]

#ç”¨å…¶åç§°æ ‡è®°è£å‰ªåçš„ roi äººè„¸
faces_roi.append(face_roi)

labels.append(label)
print(len(faces_roi))
print(len(labels))
print(&quot;å·²æ ‡è®°å’Œç´¢å¼•çš„å›¾åƒ&quot;)
print(&quot;æ­£åœ¨åˆå§‹åŒ–åµŒå…¥è¿‡ç¨‹.....&quot;)
get_embeddings()

def get_embeddings():
&quot;&quot;&quot; ä½¿ç”¨ deepface ä»æ¯ä¸ªäººè„¸ roi ä¸­æå–åµŒå…¥&quot;&quot;&quot;
print(&quot;Satarting embedding: ğŸš€ğŸš€ &quot;)
for roi in faces_roi:
face_roi_resized = cv.resize(roi, (160, 160)) # å°†äººè„¸ ROI è°ƒæ•´ä¸º 160x160 åƒç´ 
embedding = DeepFace.represent(face_roi_resized, model_name=&quot;Facenet&quot;)
print(embedding)
embeddings.append(embedding)
print(&quot;Vectors storage in list..&quot;)

get_roi()

# æ˜¯æ—¶å€™ä½¿ç”¨ svm åˆ†ç±»å™¨æµ‹è¯•å’Œè®­ç»ƒè¿™ä¸ªåå®¶ä¼™äº†
# å°†åµŒå…¥å’Œç´¢å¼•æ ‡è®°ä¸º numpy æ•°ç»„
X = np.array(embeddings) #feature
y = np.array(labels) #label

# å°†æ•°æ®åˆ†æˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# è®­ç»ƒ SVM åˆ†ç±»å™¨
svm_model = SVC(kernel=&#39;linear&#39;) # çº¿æ€§æ ¸æ˜¯åµŒå…¥çš„è‰¯å¥½é»˜è®¤å€¼
svm_model.fit(X_train, y_train)

# è¯„ä¼°æ¨¡å‹
y_pred = svm_model.predict(X_test)
accuracy = accuracy_score(y_test, y_pred)
print(f&quot;SVM æ¨¡å‹å‡†ç¡®ç‡ï¼š{accuracy * 100:.2f}%&quot;)


æœ‰äººèƒ½å¸®æˆ‘ç†è§£ä¸ºä»€ä¹ˆå³ä½¿ ROI å·²è¢«è£å‰ªï¼Œè¯¥é”™è¯¯ä»ç„¶æŒç»­å­˜åœ¨å—ï¼Ÿè§£å†³è¯¥é”™è¯¯çš„æœ€ä½³æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/79013712/error-getting-embeddings-from-a-roi-using-deepface-deepface-represent</guid>
      <pubDate>Mon, 23 Sep 2024 08:03:12 GMT</pubDate>
    </item>
    <item>
      <title>ä½¿ç”¨ tch-rs åœ¨ rust ä¸­å®ç°æ®‹å·®ç¥ç»ç½‘ç»œ</title>
      <link>https://stackoverflow.com/questions/79006068/residual-neural-network-in-rust-with-tch-rs</link>
      <description><![CDATA[æˆ‘æ­£åœ¨å°è¯•ä½¿ç”¨ tch-rs (Torch) åœ¨ rust ä¸­å®ç°å‰é¦ˆæ®‹å·®ç¥ç»ç½‘ç»œã€‚
åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿™æ˜¯æˆ‘çš„ä»£ç ï¼šï¼ˆè¿™æ˜¯ä¸€ä¸ªæœ€å°çš„å¯é‡ç°ç¤ºä¾‹ï¼‰
use tch::{nn::{self, batch_norm1d, layer_norm, BatchNormConfig, ConvConfigND, LayerNormConfig, Module, ModuleT}, Tensor};
const NUM_HIDDEN: i64 = 10;

fn res_block(vs: &amp;nn::Path) -&gt; impl ModuleT {
let mut default = ConvConfigND::default();
default.padding = 1;
let conv1 = nn::conv1d(vs, NUM_HIDDEN, NUM_HIDDEN, 3, default);
è®© bn1 = batch_norm1d(vs, NUM_HIDDEN, BatchNormConfig::default());
è®© conv2 = nn::conv1d(vs, NUM_HIDDEN, NUM_HIDDEN, 3, default);
è®© bn2 = batch_norm1d(vs, NUM_HIDDEN, BatchNormConfig::default());
nn::func_t(|x,train| {
let mut residual = Tensor::new();
x.clone(&amp;residual);
let x = bn1.forward_t(&amp;conv1.forward(x),train).relu();
let x = bn2.forward_t(&amp;conv2.forward(&amp;x),train);
let x = x + residual;
return x.relu();
})
}

å½“æˆ‘ç¼–è¯‘æ­¤ä»£ç æ—¶ï¼Œå‡ºç°æ­¤é”™è¯¯ï¼š
`*mut torch_sys::C_tensor` æ— æ³•åœ¨çº¿ç¨‹ä¹‹é—´å®‰å…¨åœ°å…±äº«
åœ¨ `BatchNorm` ä¸­ï¼Œ`*mut torch_sys::C_tensor` æœªå®ç°ç‰¹å¾ `Sync`ï¼Œè€Œè¿™æ˜¯ `{closure@src\nn.rs:11:16: æ‰€è¦æ±‚çš„11:25}ï¼š`&amp;BatchNorm` å®ç° `Send` æ‰€éœ€çš„ Send

å½“æˆ‘å°† forward_t è¡Œæ”¾å…¥ func_t ä¸­æ—¶ï¼Œä¼šå‘ç”Ÿæ­¤é—®é¢˜ã€‚
æˆ‘è¯¥å¦‚ä½•è®©å®ƒå·¥ä½œï¼Ÿ
æˆ‘ä¹Ÿå°è¯•ä½¿ç”¨é¡ºåºç½‘ç»œï¼Œä½†å®ƒä»¬æ— æ³•è¿›ä¸€æ­¥ä¼ é€’æ®‹å·®å˜é‡ã€‚æœ‰æ²¡æœ‰åŠæ³•è®©å®ƒå·¥ä½œï¼Ÿè¿˜æ˜¯æˆ‘éœ€è¦åšå…¶ä»–äº‹æƒ…ï¼Ÿ]]></description>
      <guid>https://stackoverflow.com/questions/79006068/residual-neural-network-in-rust-with-tch-rs</guid>
      <pubDate>Fri, 20 Sep 2024 09:07:36 GMT</pubDate>
    </item>
    <item>
      <title>ValueErrorï¼šå‚æ•° clone_function å’Œ input_tensors ä»…æ”¯æŒé¡ºåºæ¨¡å‹æˆ–åŠŸèƒ½æ¨¡å‹</title>
      <link>https://stackoverflow.com/questions/78796155/valueerror-arguments-clone-function-and-input-tensors-are-only-supported-for-se</link>
      <description><![CDATA[æˆ‘æ­£åœ¨ä½¿ç”¨Quantization perceived trainingï¼Œå‚è€ƒç½‘ä¸Šçš„lstmä»£ç ï¼Œæƒ³æŠŠQATæ”¾è¿›lstmï¼Œç»“æœé‡åˆ°äº†ValueErrorã€‚
ValueError Traceback (most recent call last)
&lt;ipython-input-11-00669bb76f9d&gt; in &lt;cell line: 6&gt;()
4 return layer
5 
----&gt; 6 annotated_model = tf.keras.models.clone_model(
7 model,
8 clone_function=apply_quantization_to_dense,

/usr/local/lib/python3.10/dist-packages/tf_keras/src/models/cloning.py in clone_model(model, input_tensors, clone_function)
544 # è‡ªå®šä¹‰æ¨¡å‹ç±»çš„æƒ…å†µ
545 if clone_function or input_tensors:
--&gt; 546 raise ValueError(
547 &quot;å‚æ•° clone_function å’Œ input_tensors &quot;
548 &quot;ä»…æ”¯æŒ Sequential æ¨¡å‹ &quot;

ValueError: å‚æ•° clone_function å’Œ input_tensors ä»…æ”¯æŒ Sequential æ¨¡å‹æˆ– Functional æ¨¡å‹ã€‚æ”¶åˆ°ç±»å‹ä¸ºâ€œSequentialâ€çš„æ¨¡å‹ï¼Œå…¶ä¸­ clone_function=&lt;function apply_quantization_to_dense ä½äº0x78b727ec4040&gt; å’Œ input_tensors=None

è¿™æ˜¯æˆ‘çš„ä»£ç 
import keras
ä» keras.layers å¯¼å…¥ LSTM
ä» keras.layers å¯¼å…¥ Denseã€Activation
ä» keras.datasets å¯¼å…¥ mnist
ä» keras.models å¯¼å…¥ Sequential
ä» keras.optimizers å¯¼å…¥ Adam

learning_rate = 0.001
training_iters = 20
batch_size = 128
display_step = 10

n_input = 28
n_step = 28
n_hidden = 128
n_classes = 10

(x_train, y_train), (x_test, y_test) = mnist.load_data()

x_train = x_train.reshape(-1, n_step, n_input)
x_test = x_test.reshape(-1, n_step, n_input)
x_train = x_train.astype(&#39;float32&#39;)
x_test = x_test.astype(&#39;float32&#39;)
x_train /= 255
x_test /= 255

y_train = keras.utils.to_categorical(y_train, n_classes)
y_test = keras.utils.to_categorical(y_test, n_classes)

model = Sequential()
model.add(LSTM(n_hidden,
batch_input_shape=(None, n_step, n_input),
unroll=True))

model.add(Dense(n_classes))
model.add(Activation(&#39;softmax&#39;))

adam = Adam(lr=learning_rate)
model.summary()
model.compile(optimizer=adam,
loss=&#39;categorical_crossentropy&#39;,
metrics=[&#39;accuracy&#39;])

model.fit(x_train, y_train,
batch_size=batch_size,
epochs=training_iters,
verbose=1,
validation_data=(x_test, y_test))

scores = model.evaluate(x_test, y_test, verbose=0)
print(&#39;LSTM æµ‹è¯•åˆ†æ•°ï¼š&#39;, scores[0])
print(&#39;LSTM æµ‹è¯•å‡†ç¡®ç‡ï¼š&#39;, scores[1])

def apply_quantization_to_dense(layer):
if isinstance(layer, tf.keras.layers.LSTM):
return tfmot.quantization.keras.quantize_annotate_layer(layer)
return layer

annotated_model = tf.keras.models.clone_model(
æ¨¡å‹ï¼Œ
clone_function=apply_quantization_to_denseï¼Œ
)
]]></description>
      <guid>https://stackoverflow.com/questions/78796155/valueerror-arguments-clone-function-and-input-tensors-are-only-supported-for-se</guid>
      <pubDate>Fri, 26 Jul 2024 03:41:57 GMT</pubDate>
    </item>
    <item>
      <title>gym_super_mario_bros çš„ DummyVecEnv æ„é€ å‡½æ•°å­˜åœ¨é—®é¢˜</title>
      <link>https://stackoverflow.com/questions/78085766/trouble-with-dummyvecenv-constructor-with-gym-super-mario-bros</link>
      <description><![CDATA[æ‘˜è¦ï¼šæˆ‘æƒ³è¦åšçš„å°±æ˜¯ä½¿ç”¨ DummyVecEnv æ„é€ å‡½æ•°æ¥åŒ…è£…æˆ‘çš„ gym ç¯å¢ƒï¼Œå³
env = DummyVecEnv([lambda: env])ï¼Œä½†æ‰§è¡Œæ­¤æ“ä½œæ—¶æˆ‘ä¸æ–­æ”¶åˆ°é”™è¯¯ã€‚å½“å‰ä½¿ç”¨ https://pypi.org/project/gym-super-mario-bros/ ä½œä¸º Super Mario çš„ gym åŒ…è£…å™¨ã€‚æˆ‘æ„Ÿè§‰æˆ‘è¯¯è§£äº†æˆ‘åº”è¯¥ä¸ºæ„é€ å‡½æ•°æä¾›å“ªäº›å‚æ•°ï¼Œä½†æˆ‘æ˜¯ Python æ–°æ‰‹ï¼Œå¾ˆéš¾ç†è§£æˆ‘é—æ¼äº†ä»€ä¹ˆã€‚
æˆ‘åœ¨ä» gym_super_mario_bros.make() è¿”å›çš„ç¯å¢ƒä¸­ä½¿ç”¨ DummyVecEnv æ„é€ å‡½æ•°æ—¶é‡åˆ°å›°éš¾ã€‚æˆ‘ä¸€ç›´æ”¶åˆ°é”™è¯¯â€œæ‚¨å°è¯•åˆ›å»ºå¤šä¸ªç¯å¢ƒï¼Œä½†åˆ›å»ºå®ƒä»¬çš„å‡½æ•°è¿”å›äº†ç›¸åŒçš„å®ä¾‹ï¼Œè€Œä¸æ˜¯åˆ›å»ºä¸åŒçš„å¯¹è±¡â€ã€‚
æˆ‘æœ€åˆå°è¯•å°†æˆ‘çš„ç¯å¢ƒåŒ…è£…åœ¨ DummyVecEnv ä¸­ï¼Œå°±åƒæˆ‘åœ¨è®¸å¤šè®ºå›ä¸Šçœ‹åˆ°çš„é‚£æ ·ï¼š
env = gym_super_mario_bros.make(&quot;SuperMarioBros-v0&quot;) 
env = JoypadSpace(env, SIMPLE_MOVEMENT) 
env = GrayScaleObservation(env, keep_dim=True) 
env = DummyVecEnv([lambda: env]) #This line é”™è¯¯

ä½†æˆ‘æ”¶åˆ°æ­¤é”™è¯¯ï¼š
æ–‡ä»¶c:\Users\truem\AppData\Local\Programs\Python\Python311\Lib\site-packages\stable_baselines3\common\vec_env\dummy_vec_env.py:30ï¼Œåœ¨ DummyVecEnv.init(self, env_fns) ä¸­
29 def init(self, env_fns: List[Callable[[], gym.Env]]):
---&gt; 30 self.envs = [_patch_env(fn()) for fn in env_fns]
31 if len(set([id(env.unwrapped) for env in self.envs])) != len(self.envs):
32 raise ValueError(
33 &quot;æ‚¨å°è¯•åˆ›å»ºå¤šä¸ªç¯å¢ƒï¼Œä½†åˆ›å»ºå®ƒä»¬çš„å‡½æ•°è¿”å›äº†åŒä¸€ä¸ªå®ä¾‹&quot;
34 &quot;è€Œä¸æ˜¯åˆ›å»ºä¸åŒçš„å¯¹è±¡ã€‚&quot;(...)
39 &quot;è¯·é˜…è¯» https://github.com/DLR-RM/stable-baselines3/issues/1151 äº†è§£æ›´å¤šä¿¡æ¯ã€‚&quot;
40 )

å› æ­¤ï¼Œæˆ‘å°è¯•æŒ‰ç…§ github é“¾æ¥ä¸­åˆ—å‡ºçš„ä¿®å¤ç¨‹åºä»¥åŠæ–‡æ¡£ä¸­æä¾›çš„ç¤ºä¾‹è¿›è¡Œæ“ä½œ
https://stable-baselines.readthedocs.io/en/master/guide/examples.html
æˆ‘ç»§ç»­åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„è¾…åŠ©å‡½æ•° create_default_environmentï¼Œå®ƒåº”è¯¥åˆ›å»ºæ–°çš„ env å®ä¾‹å¹¶è¿”å›å®ƒä»¬ï¼Œä½†å°½ç®¡å¦‚æ­¤ï¼Œå®ƒä»ç„¶ä¸èµ·ä½œç”¨ã€‚
è¿™æ˜¯æˆ‘çš„ä»£ç ç°åœ¨çš„æ ·å­ï¼š
#å°†æˆ‘çš„ env åˆ›å»ºåŒ…è£…åœ¨å‡½æ•°ä¸­
def create_default_environment():
newEnv = gym_super_mario_bros.make(&quot;SuperMarioBros-v0&quot;) 
newEnv = JoypadSpace(newEnv, SIMPLE_MOVEMENT) 
return GrayScaleObservation(newEnv, keep_dim=True)
#åœ¨è°ƒç”¨è¾…åŠ©å‡½æ•°çš„åˆ—è¡¨ä¸­åˆ›å»º lambda
env = DummyVecEnv([lambda: create_default_environment()]) #ä»ç„¶å¤±è´¥

æˆ‘ç»§ç»­å°†æˆ‘çš„åˆå§‹ env æ„é€ åŒ…è£…åœ¨è¾…åŠ©å‡½æ•° create_default_environment() ä¸­ï¼Œæˆ‘å·²ç»éªŒè¯è¯¥å‡½æ•°æ¯æ¬¡è°ƒç”¨éƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„ env å®ä¾‹ã€‚ç„¶åæˆ‘ä½¿ç”¨è¯¥åŒ…è£…å™¨æ’å…¥ DummyVecEnv æ„é€ å‡½æ•°ï¼š
env = DummyVecEnv([lambda: create_default_environment()])
ä½†ç¼–è¯‘å™¨ä»ç„¶æŠ±æ€¨æˆ‘ä¼ å…¥çš„å‡½æ•°åˆ—è¡¨æ²¡æœ‰è¿”å›æ–°å®ä¾‹ã€‚
æˆ‘ä¸€ç›´åœ¨å°è¯•æ¨¡æ‹Ÿæˆ‘åœ¨ baselines æä¾›çš„ç¤ºä¾‹ä»£ç ä¸­çœ‹åˆ°çš„å†…å®¹ï¼š
from stable_baselines.common.vec_env import DummyVecEnv, VecNormalize
from stable_baselines import PPO2

env = DummyVecEnv(\[lambda: gym.make(&quot;HalfCheetahBulletEnv-v0&quot;)]) #ä¸ºä»€ä¹ˆè¿™ä¸ªå¯ä»¥å·¥ä½œè€Œæˆ‘çš„ä¸è¡Œï¼Ÿ

ä½†æˆ‘ä¸ç¡®å®šæˆ‘åšé”™äº†ä»€ä¹ˆã€‚æˆ‘æ˜¯ python æ–°æ‰‹ï¼Œæ‰€ä»¥å¦‚æœæˆ‘é—æ¼äº†ä»€ä¹ˆæ˜æ˜¾çš„ä¸œè¥¿ï¼Œè¯·åŸè°…æˆ‘ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/78085766/trouble-with-dummyvecenv-constructor-with-gym-super-mario-bros</guid>
      <pubDate>Fri, 01 Mar 2024 05:53:20 GMT</pubDate>
    </item>
    <item>
      <title>ValueErrorï¼šå¤šæ ‡ç­¾æŒ‡ç¤ºå™¨ä¸æ”¯æŒæ··æ·†çŸ©é˜µ</title>
      <link>https://stackoverflow.com/questions/76635503/valueerror-multilabel-indicator-is-not-supported-confusion-matrix</link>
      <description><![CDATA[æˆ‘å°è¯•è¿è¡Œæ—¶æ”¶åˆ°çš„é”™è¯¯æ¶ˆæ¯æ˜¯â€œmultilabel-indicator ä¸å—æ”¯æŒâ€ï¼š
æ‚¨èƒ½ç»™æˆ‘ä»»ä½•è§£å†³æ–¹æ¡ˆæˆ–æç¤ºå—ï¼Ÿ
import seaborn as sns
sns.heatmap(confusion_matrix(y_test, y_pred), annot = True)

ValueError Tracebackï¼ˆæœ€è¿‘ä¸€æ¬¡è°ƒç”¨æœ€åä¸€æ¬¡ï¼‰
&lt;ipython-input-21-ee6823d584e9&gt; in &lt;cell line: 1&gt;()
----&gt; 1 sns.heatmap(confusion_matrix(y_test, y_pred), annot = True)

/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py infusion_matrix(y_true, y_pred, labels, sample_weight, normalize)
317 y_type, y_true, y_pred = _check_targets(y_true, y_pred)
318 if y_type not in (&quot;binary&quot;, &quot;multiclass&quot;):
--&gt; 319 raise ValueError(&quot;%s is not supports&quot; % y_type)
320 
321 if labels is None:

ValueError: multilabel-indicator is not supports
]]></description>
      <guid>https://stackoverflow.com/questions/76635503/valueerror-multilabel-indicator-is-not-supported-confusion-matrix</guid>
      <pubDate>Fri, 07 Jul 2023 09:06:01 GMT</pubDate>
    </item>
    <item>
      <title>å¼€æºç¥ç»ç½‘ç»œåº“ [å…³é—­]</title>
      <link>https://stackoverflow.com/questions/11477145/open-source-neural-network-library</link>
      <description><![CDATA[æˆ‘æ­£åœ¨å¯»æ‰¾ä¸€ä¸ªå¼€æºç¥ç»ç½‘ç»œåº“ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘å·²ç»ç ”ç©¶è¿‡ FANNã€WEKA å’Œ OpenNNã€‚æˆ‘è¿˜åº”è¯¥çœ‹çœ‹å…¶ä»–çš„å—ï¼Ÿå½“ç„¶ï¼Œæ ‡å‡†æ˜¯æ–‡æ¡£ã€ç¤ºä¾‹å’Œæ˜“ç”¨æ€§ã€‚]]></description>
      <guid>https://stackoverflow.com/questions/11477145/open-source-neural-network-library</guid>
      <pubDate>Fri, 13 Jul 2012 19:32:11 GMT</pubDate>
    </item>
    </channel>
</rss>