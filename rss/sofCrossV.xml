<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>最近的问题 - 交叉验证</title>
    <link>https://stats.stackexchange.com/questions</link>
    <description>最近 30 个来自 stats.stackexchange.com</description>
    <lastBuildDate>Wed, 13 Dec 2023 06:17:59 GMT</lastBuildDate>
    <item>
      <title>$E(X)*E(X'X)^{-1}$ 当 X 向量包含常量时简化？</title>
      <link>https://stats.stackexchange.com/questions/634782/exexx-1-simplifies-when-x-vector-contains-a-constant</link>
      <description><![CDATA[为了自学，我计算了 $E(X)*E(X&#39;X)^{-1}=[1,0]$ $X=[1,X_2]$ 对于任何标量随机变量 $X_2$ （具有有限均值和方差）。
证明：
$\begin{pmatrix}1 &amp; E(X_2)\end{pmatrix}\begin{pmatrix} 1 &amp; E(X_2) \\ E(X_2) &amp; E(X^2_2)
\end{pmatrix}^{-1}=\begin{pmatrix}1 &amp; E(X_2)\end{pmatrix}\begin{pmatrix} E(X^2_2)/Var(X_2) &amp; -E(X_2)/Var(X_2) \\ -E(X_2)/Var(X_2) &amp; 1/无功(X_2)
\end{pmatrix}=\begin{pmatrix}1 &amp; 0\end{pmatrix}$
模拟显示这应该适用于更高的维度（即 $X_2$ 作为向量）。我无法弄清楚如何推广证明，因为计算超过 3x3 的逆矩阵非常困难。任何帮助将不胜感激。]]></description>
      <guid>https://stats.stackexchange.com/questions/634782/exexx-1-simplifies-when-x-vector-contains-a-constant</guid>
      <pubDate>Wed, 13 Dec 2023 05:45:18 GMT</pubDate>
    </item>
    <item>
      <title>比较使用两种不同抽样方法抽取的两个样本</title>
      <link>https://stats.stackexchange.com/questions/634781/comparing-two-samples-drawn-using-two-different-sampling-methods</link>
      <description><![CDATA[这是一个假设性问题，因此我没有提供太多其他详细信息。
为了提供一些背景信息，我一直在阅读有关“受访者驱动抽样”的内容。 （RDS）这些天；该方法可用于对不存在抽样框架的难以接触到的人群（例如无家可归者或性工作者）进行统计推断。
现在，我一直想知道理论上是否可以在从 RDS 抽取的样本和使用经典简单随机抽样（例如，随机抽样）抽取的样本之间进行测试（例如，比较平均值或百分比）。来自一般人群的样本。目标是将假设的难以接触的人群与一般人群进行比较。
事实上，我真正的问题比这更普遍，不仅仅是 RDS 与简单随机抽样（例如，使用分层抽样抽取的样本与使用 SRS 抽取的样本之间的比较怎么样？）。
我想知道是否绝对不可能在使用不同方法抽取的两个样本之间进行比较（假设单独采取，这些方法适合统计推断），或者是否可以在某些条件下比较这些样本。如果是后者，这些条件是什么？谢谢。]]></description>
      <guid>https://stats.stackexchange.com/questions/634781/comparing-two-samples-drawn-using-two-different-sampling-methods</guid>
      <pubDate>Wed, 13 Dec 2023 05:36:45 GMT</pubDate>
    </item>
    <item>
      <title>如何使用 RFE 进行 RF 和 SVM</title>
      <link>https://stats.stackexchange.com/questions/634780/how-to-use-rfe-for-rf-and-svm</link>
      <description><![CDATA[考虑到我有大数据（大量 OTU 和临床数据），我将使用这些数据输入 RF 和 SVM 进行预测（分类），执行 RFE 作为特征选择步骤是否有意义？ 
我应该采用什么RFE 方法来申请 RF 和 SVM？因为我相信 RF 和 SVM 可以用作 RFE 的方法，但是将 RF-RFE 应用于 RF（对于 SVM 也是如此）是否多余？我不确定如何准确地执行 RF/SVM 的 RFE（即工作流程）。]]></description>
      <guid>https://stats.stackexchange.com/questions/634780/how-to-use-rfe-for-rf-and-svm</guid>
      <pubDate>Wed, 13 Dec 2023 05:32:27 GMT</pubDate>
    </item>
    <item>
      <title>对于交叉验证，screen-while-validate 和 screen-then-validate 之间有什么区别？</title>
      <link>https://stats.stackexchange.com/questions/634778/for-cross-validation-what-is-the-difference-between-screen-while-validate-and-s</link>
      <description><![CDATA[对于交叉验证（K 折），screen-while-validate 和 screen-then-validate 之间有什么区别？
我的教授说我们应该始终在验证时进行筛选。但我不明白其中的区别。
谢谢。
&lt;小时/&gt;
他向我们发送了以下代码：
&lt;前&gt;&lt;代码&gt;n &lt;- 100
p &lt;- 1000
nfolds &lt;- 10 # 折叠数
nvar &lt;- 20 # 要选择的变量数

# 生成数据集
X &lt;- 矩阵(rnorm(n*p),n,p)
y &lt;- rbinom(n,1,0.5)# rbinom(n,1,prob)
data_full &lt;- data.frame(y,X)

# 计算边际回归的 p 值
pval_marg &lt;- 函数(y,X){
  fit_marg &lt;- glm(y~.,data.frame(y,X),family = 二项式())
  pval &lt;- 摘要(fit_marg)$系数[2,4]
  返回（pval）
}

# 指定折叠索引
idx &lt;- 上限(样本(1:n)/n*nfolds)

# 错误示例：先筛选再验证

# 整个数据集的第一个屏幕
pval_all &lt;- apply(data_full[,-1],2,pval_marg,y=data_full[,1])
idx_var &lt;- 顺序(pval_all)[1:nvar]

# 然后对所选变量进行交叉验证
err_wrong &lt;-rep(NA,nfolds)
for(fold_i in 1:nfolds){
  data_train &lt;- data_full[idx!=fold_i,c(1,idx_var+1)]
  data_test &lt;- data_full[idx==fold_i,c(1,idx_var+1)]
  
  fit_i &lt;- glm(y~.,data_train,family = 二项式())
  prob_i &lt;- 预测（fit_i，data_test，type =“响应”）
  pred_i &lt;- ifelse(prob_i&gt;0.5,1,0)
  err_wrong[fold_i] &lt;- 平均值(data_test[,1]!=pred_i)
  cat(fold_i,“第次验证完成。\n”)
}

cat(&quot;screen-then-validate 分类错误:&quot;,mean(err_wrong),&quot;\n&quot;)

#正确示例：验证时屏幕：所选变量在不同折叠中可能有所不同

err_ Correct &lt;-rep(NA,nfolds)
for(fold_i in 1:nfolds){
  data_train &lt;- data_full[idx!=fold_i,]
  data_test &lt;- data_full[idx==fold_i,]
  
  # 训练集上的屏幕
  pval_all &lt;- apply(data_train[,-1],2,pval_marg,y=data_train[,1])
  idx_var &lt;- 顺序(pval_all)[1:nvar]
    
  # 在训练集上拟合模型
  fit_i &lt;- glm(y~.,data_train[,c(1,idx_var+1)],family = 二项式())
  prob_i &lt;- 预测(fit_i,data_test[,c(1,idx_var+1)],type =“响应”)
  pred_i &lt;- ifelse(prob_i&gt;0.5,1,0)
  err_ Correct[fold_i] &lt;- 平均值(data_test[,1]!=pred_i)
  cat(fold_i,&quot;第验证完成。\n&quot;)
}

cat(&quot;验证时屏幕分类错误：&quot;,mean(err_ Correct),&quot;\n&quot;)
]]></description>
      <guid>https://stats.stackexchange.com/questions/634778/for-cross-validation-what-is-the-difference-between-screen-while-validate-and-s</guid>
      <pubDate>Wed, 13 Dec 2023 05:13:02 GMT</pubDate>
    </item>
    <item>
      <title>如何计算多元分布中的自由度？</title>
      <link>https://stats.stackexchange.com/questions/634777/how-do-you-count-degrees-of-freedom-in-multivariate-distributions</link>
      <description><![CDATA[处理多元分布（例如多元 t 分布）时，维数如何影响自由度？假设您有一个 d 维向量的 N 个测量值，并假设一个行为良好（非奇异）的形状参数矩阵。 df 是否只是 N-1，如单变量情况？或者每个测量的每个分量和平均值都有一个自由度，导致 df = d*(N-1)？或者考虑到您正在估计协方差的 d*(d+1)/2 个独立条目，是否存在一些更复杂的计算？]]></description>
      <guid>https://stats.stackexchange.com/questions/634777/how-do-you-count-degrees-of-freedom-in-multivariate-distributions</guid>
      <pubDate>Wed, 13 Dec 2023 05:00:27 GMT</pubDate>
    </item>
    <item>
      <title>OLS - 误差项/残差未通过 ADF/平稳测试，那么这意味着什么？</title>
      <link>https://stats.stackexchange.com/questions/634775/ols-error-term-residuals-failed-the-adf-stationary-test-so-what-is-the-implic</link>
      <description><![CDATA[我有一个简单的线性回归模型，我尝试验证该模型是否适合目的。
其中一项测试是对残差进行 Augmented-Dickey Fuller 测试，但测试结果表明误差项不是平稳的，如果我继续使用这个模型，会产生什么影响？
一般来说，如果我的模型未能通过残差的平稳测试，那又怎样？]]></description>
      <guid>https://stats.stackexchange.com/questions/634775/ols-error-term-residuals-failed-the-adf-stationary-test-so-what-is-the-implic</guid>
      <pubDate>Wed, 13 Dec 2023 04:40:35 GMT</pubDate>
    </item>
    <item>
      <title>二项式分布的条件概率</title>
      <link>https://stats.stackexchange.com/questions/634773/conditional-probability-with-binomial-distribution</link>
      <description><![CDATA[假设我们有 n 次抛硬币的序列，每次抛掷正面的概率为 p。然后，k 个正面朝上的概率由二项式概率 Pr(Y = k) = nCk p^k (1-p)^(n-k) 定义。我正在尝试计算给定头数的特定序列的条件概率。例子：如果我们抛一枚硬币 3 次，并且有 2 个正面朝上，那么第一次和第二次抛掷硬币出现在正面的概率是多少？即 Pr(X = HHT | Y=2)。我尝试将其计算为 1/3C2，因为有 3C2 种可能的方式获得 2 个正面，而序列就是其中之一。但这不是概率分布，因为它加起来为 2 而不是 1。有人可以帮助解决我所缺少的内容吗？]]></description>
      <guid>https://stats.stackexchange.com/questions/634773/conditional-probability-with-binomial-distribution</guid>
      <pubDate>Wed, 13 Dec 2023 04:36:53 GMT</pubDate>
    </item>
    <item>
      <title>ML 之前的特征选择（RF 和 SVM）</title>
      <link>https://stats.stackexchange.com/questions/634772/feature-selection-before-ml-rf-and-svm</link>
      <description><![CDATA[我是机器学习新手，必须处理大数据（大量 OTU 和临床数据），我会将其输入到将使用的 2 个不同的机器学习模型（RF 和 SVM）中用于预测（分类）。样本数量在500个左右。
我的问题是：

对 RF 和 SVM 应用特征选择步骤有意义吗？
想到的特征选择算法是 RFE 和 LASSO - 计划比较两者的表现。考虑到将使用的数据和机器学习算法，其他技术是否会更好
]]></description>
      <guid>https://stats.stackexchange.com/questions/634772/feature-selection-before-ml-rf-and-svm</guid>
      <pubDate>Wed, 13 Dec 2023 04:34:17 GMT</pubDate>
    </item>
    <item>
      <title>当观察到的比例恰好为 1（或 0）时，假设二项式分布的比例的置信区间</title>
      <link>https://stats.stackexchange.com/questions/633772/confidence-interval-for-proportion-assuming-binomial-distribution-when-observed</link>
      <description><![CDATA[我有一个模拟（一组 200 次迭代），用于计算平均统计功效的置信区间。在二项式近似中，我知道标准误差计算为 $\sqrt{\frac{(p(1-p)}{n}})$ 其中 &lt; span class=&quot;math-container&quot;&gt;$p$ 是成功概率，$n$ 是样本大小。正如我之前提到的，我的 $n=200$ 为 200 次迭代。假设在某些实例中，我得到的统计功效恰好等于 1（200 次迭代求平均值时），并且很明显标准误差等于 0（计算为 $\sqrt{\ frac{(p(1-p)}{n}}) = \sqrt{\frac{(1(1-1)}{200}}) = 0$)，因此置信区间为不再是一个区间，而是一个点（即1）。如果我需要获得下限和上限不重叠的置信区间，

我可以使用连续性校正（如果不这么叫，那它是什么）？
如果是，计算公式是什么？
参考文献？

我找不到适用于我的案例的正确参考（当样本大小为 200 范围时 - 以防样本大小存在任何此类限制）。
编辑：作为社区建议，我参考了之前发布的类似问题二项式估计值周围的置信区间为 0 或 1，但我认为这没有帮助，因为样本量太小（通常小于 100 不能近似为正态）。我的案例 n=200，所以我不太确定如何将该回答与我的问题联系起来。另外，我希望引用一个有效的、行之有效的方法，因此，引用的链接不会为我的问题提供答案，尽管它看起来很相似。谢谢。]]></description>
      <guid>https://stats.stackexchange.com/questions/633772/confidence-interval-for-proportion-assuming-binomial-distribution-when-observed</guid>
      <pubDate>Wed, 13 Dec 2023 04:18:16 GMT</pubDate>
    </item>
    <item>
      <title>蜂窝调查数据的数据透视表[关闭]</title>
      <link>https://stats.stackexchange.com/questions/633770/pivot-table-for-cellular-survey-data</link>
      <description><![CDATA[我不太确定解决数据问题的正确方法，我想可能是数据透视表或某种 SQL 语句。我对想法持开放态度。我在 Excel 和 SQLite 中都有这些数据
数据片段：

对于任何给定的“时间”，大约会记录 3 到 5 个“小区 ID”。我需要知道的是每个时间设置接收到的最大“参考信号_接收功率”的“小区 ID”。
例如，第一个时间设置 10:32:25，我们看到四个“小区 ID”：420,214,284 和 420,214,284。 323，很容易看出第一个时间设置的“参考信号_接收功率”为-87.38。我需要数小时的数据，因此非常需要一个编程解决方案。]]></description>
      <guid>https://stats.stackexchange.com/questions/633770/pivot-table-for-cellular-survey-data</guid>
      <pubDate>Wed, 13 Dec 2023 02:14:39 GMT</pubDate>
    </item>
    <item>
      <title>创建优先级矩阵 [已迁移]</title>
      <link>https://stats.stackexchange.com/questions/633769/create-prioritization-matrix</link>
      <description><![CDATA[我有下面的数据来创建可行性数据和业务价值数据，我正在尝试创建优化矩阵，如下面所附，但我不确定如何为此处理数据。我不确定是否像我一样将每一行的每个值相乘，我必须将同一列的每个值相加
# 创建数据框
data_values &lt;- c(“现有客户数据”、“潜在客户数据”、“客户活动”、“销售历史记录”)
客户资料 &lt;- c(4, 3, 4, 4)
异质性 &lt;- c(4, 3, 3, 4)
投资组合质量 &lt;- c(4, 3, 4, 4)

# 将数据组合成数据框
bv_data &lt;- data.frame(
  `业务价值` = data_values,
  `客户资料` = customer_profile,
  ‘异质性’=异质性，
  `投资组合质量`=投资组合_质量
）


# 创建数据框
可行性 &lt;- c(“现有客户数据”、“潜在客户数据”、“客户活动”、“销售历史记录”)
可用性 &lt;- c(4, 1, 3, 4)
数据质量 &lt;- c(4, 1, 3, 4)
数据深度 &lt;- c(4, 1, 3, 4)
价格 &lt;- c(4, 4, 4, 4)

# 将数据组合成数据框
可行性_数据 &lt;- data.frame(
  ‘可行性’=可行性，
  `可用性`=可用性，
  `数据质量` = 数据质量，
  `数据深度` = 数据深度，
  `价格` = 价格
）


我的流程
colnames(bv_data)[1]&lt;-“项目”

# 仅选择数字列进行乘法
numeric_data &lt;- bv_data[, sapply(bv_data, is.numeric)]

# 执行行乘法的函数
row_multiply &lt;- 函数（行）{
  产品（行）
}

# 应用行乘法
row_multiplication &lt;- apply(numeric_data, 1, row_multiply)

# 使用行乘法结果在优化矩阵中创建一个新列
bv_data$Business.Values &lt;- row_multiplication

bv_data&lt;-bv_data[,c(1,5)]



colnames(feasibility_data)[1]&lt;-“项目”

# 仅选择数字列进行乘法
numeric_data &lt;- 可行性_data[, sapply(feasibility_data, is.numeric)]

# 执行行乘法的函数
row_multiply &lt;- 函数（行）{
  产品（行）
}

# 应用行乘法
row_multiplication &lt;- apply(numeric_data, 1, row_multiply)

# 使用行乘法结果在优化矩阵中创建一个新列
Visibility_data$可行性 &lt;- row_multiplication

可行性数据&lt;-可行性数据[,c(1,6)]


# 假设“bv_data”和“feasibility_data”是之前创建的数据帧

# 根据公共列（“业务价值”和“可行性”）合并数据框
optimization_matrix &lt;- 合并（bv_data，可行性_data，by =“项目”）

# 计算优先级（努力 * 影响）
optimization_matrix$优先级 &lt;- optimization_matrix$Business.Values*optimization_matrix$可行性


optimization_matrix$Label&lt;-c(“D”、“A”、“B”、“C”)




库（ggplot2）


# 创建情节
ggplot(optimization_matrix, aes(x = 可行性, y = Business.Values, label = 标签)) +
  xlim(-256, 256) + ylim(-80, 80) + geom_hline(yintercept = 0) + geom_vline(xintercept = 0) +
  geom_text(aes(label = ifelse(Label %in% c(&quot;C&quot;, &quot;A&quot;), ifelse(Label == &quot;C&quot;, &quot;C&quot;, &quot;A&quot;), Label)),
            vjust = ifelse(optimization_matrix$Label == &quot;A&quot;, 1.8, 2.9), hjust = -0.5) +
  实验室（标题=“优化矩阵”，
       x =“可行性”，
       y =“商业价值”) +
  主题_最小（）+
  主题(axis.text.x = element_blank(), axis.text.y = element_blank())

]]></description>
      <guid>https://stats.stackexchange.com/questions/633769/create-prioritization-matrix</guid>
      <pubDate>Wed, 13 Dec 2023 00:49:34 GMT</pubDate>
    </item>
    <item>
      <title>关于弗里德曼 H 统计量计算的问题</title>
      <link>https://stats.stackexchange.com/questions/633768/questions-about-computation-of-friedmans-h-statistic</link>
      <description><![CDATA[背景
Christoph Molnar 的可解释机器学习一书介绍了机器学习的估计通过分解部分依赖性来建模交互：
&lt;块引用&gt;
如果两个特征不相互作用，我们可以编写如下部分依赖函数： $$ PD_{jk}(x_j, x_k) = PD_j(x_j) + PD_k(x_k ）$$。同样，如果一个特征与任何其他特征没有交互，我们可以将预测函数 $\hat{f}(x)$ 表示为部分特征的总和依赖函数，其中第一个被加数仅取决于 $j$，第二个被加数取决于 $j$ 的所有其他功能span&gt;: $$\hat{f}(x) = PD_j(x_j) + PD_{-j}(x_{-j})$$

问题 1
上面第二个方程中第二项的计算是什么，$PD_{-j}(x_{-j})$？它是使用 $x_j$ 网格值的平均预测来计算的吗？
问题 2
在同一章中，据称计算 j-vs-all 交互 H 统计最多需要 $3n^2$ 调用 &lt;代码&gt;预测。这难道不应该取决于grid.size，即评估部分依赖性的分辨率吗？例如，我期望单变量部分依赖需要 grid.size $\times n$ 调用来预测。将其扩展为双向部分依赖 $PD(x, y)$，在最坏的情况下它将是 grid.size &lt; span class=&quot;math-container&quot;&gt;$\times n^2$。莫尔纳的计算从何而来？]]></description>
      <guid>https://stats.stackexchange.com/questions/633768/questions-about-computation-of-friedmans-h-statistic</guid>
      <pubDate>Wed, 13 Dec 2023 00:39:19 GMT</pubDate>
    </item>
    <item>
      <title>如何使用 R 中的 Tidymodels 解决多项分类模型中因变量中的许多因素？</title>
      <link>https://stats.stackexchange.com/questions/633767/how-can-i-address-many-factors-in-the-dependent-variable-in-a-multinomial-classi</link>
      <description><![CDATA[我在 R 中的多项分类模型上遇到了很大的困难。
我有一个 1330 行的数据集。我有两个自变量和一个因变量。
因变量（类别）有 337 个唯一值。
它们分为：
102个值32个值14个值12个值11个值9个值8个值7个值6个值5个值（重复直到完成）
我基本上很难创建任何模型，因为它们都会针对因变量的训练和测试集中的不平衡水平发出警告或错误。
我尝试在initial_split中的strata参数中添加类别，但它说“数据太少，无法分层”
我在配方中尝试了各种重采样参数，但没有一个起作用（参见代码）。
随机森林和 XGBoost 都“有效”但准确性和其他指标都非常低于标准。
我在这里看到了类似的问题，但它与自变量有关。
我的与目标变量有关。
解决我所面临的因变量问题的最佳方法是什么？
我知道您通常需要完整的代码示例，但我觉得这只是理论上的。
感谢您提供的任何意见。
&lt;前&gt;&lt;代码&gt;
设置.种子(123)

data_split &lt;-initial_split(model_data,
                            道具= 0.7，
                            阶层 = 类别）

训练集 &lt;- 训练（data_split）
test_set &lt;- 测试（data_split）

model_recipe &lt;- 配方（类别 ~ .，数据 = 训练集） %&gt;%
  step_novel(all_nominal_predictors()) %&gt;%
  step_dummy(all_nominal_predictors()) %&gt;%
  step_scale(all_numeric_predictors())
  #step_rose(类别)
  # step_downsample(类别)
  # step_smote(类别)
]]></description>
      <guid>https://stats.stackexchange.com/questions/633767/how-can-i-address-many-factors-in-the-dependent-variable-in-a-multinomial-classi</guid>
      <pubDate>Tue, 12 Dec 2023 23:59:48 GMT</pubDate>
    </item>
    <item>
      <title>如何解释广义加性模型的交互图？</title>
      <link>https://stats.stackexchange.com/questions/633766/how-to-interpret-interaction-plots-of-generalized-additive-models</link>
      <description><![CDATA[我正在寻求帮助来解释广义加性模型 (GAM) 的交互图。我想知道：

$y$ 轴上的线性预测器是什么意思？
$x_1$ 和 $x_2$ 上的箭头表示什么？
互动是消极的还是积极的？如何解释积极或消极
情节中的互动？

这是我的模型：
&lt;前&gt;&lt;代码&gt;mod1 &lt;-
  加姆(
    y ~ te(x1, x2, k = 4) + te(x1, x2, k = 5),
    家庭=贝塔（），
    方法=“REML”，
    数据 = 数据
  ）

摘要(mod1)



系列：Beta 回归(8.84)
链接函数：logit

公式：
  y ~ te(x1, x2, k = 4) +
  te(x3, x4, k = 5)

参数系数：
            估计标准。误差z值Pr(&gt;|z|)
（截距）-0.03709 0.12465 -0.298 0.766

平滑项的近似意义：
          edf Ref.df Chi.sq p 值
te(x1, x2) 3.000 3.00 39.62 &lt;2e-16 ***
te(x3, x4) 6.608 6.93 78.30 &lt;2e-16 ***
---
西尼夫。代码： 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

R-sq.(adj) = 0.667 解释的偏差 = 90.9%
-REML = -45.944 规模估计 = 1 n = 50

这是生成绘图的代码：
vis.gam（mod1，view = c（“x1”，“x2”），theta = 120，plot.type =“persp”）
vis.gam(mod1, view = c(&quot;x3&quot;, &quot;x4&quot;), theta = 120, 绘图。Type = &quot;persp&quot;)


]]></description>
      <guid>https://stats.stackexchange.com/questions/633766/how-to-interpret-interaction-plots-of-generalized-additive-models</guid>
      <pubDate>Tue, 12 Dec 2023 23:54:04 GMT</pubDate>
    </item>
    <item>
      <title>在r中手动编程EM以更新多个参数并解决丢失的数据</title>
      <link>https://stats.stackexchange.com/questions/633765/manually-program-em-in-r-to-updated-multiple-parameters-and-solve-missing-data</link>
      <description><![CDATA[我正在尝试使用 EM（期望最大化）来填充 R 中缺失的数据，但不确定如何针对我的具体情况对其进行建模/编码。我通常尝试遵循本文中使用的示例格式（How does期望最大化计算缺失数据？），具有以下 EM 过程结构：
库(“MASS”)
设置.种子(123)
n &lt;- 1000
θ &lt;- 20
β0 &lt;- 3
β1 &lt;- 0.2
x &lt;- runif(n=n, min=1, max=10)
mu &lt;- exp(beta0 + beta1*x)
y &lt;- rnegbin(n=n, mu=mu, theta=theta)
idxm &lt;- 其中(y %in% 样本(y, 100))
y0 &lt;- y[-idxm]
x0 &lt;- x[-idxm]
logy0 &lt;- log(y0)

# 初始化参数值
betaInit &lt;- unname(lm(logy0 ~ x0)$系数)
mu0 &lt;- exp(betaInit[1] + betaInit[2]*x0)
thetaInit &lt;- 平均值(mu0^2/(平均值((mu0 - y0)^2) - mu0))
params1 &lt;- c(thetaInit, betaInit)
params0 &lt;- 数字(3)

# 初始化未观察到的值
y[idxm] &lt;- as.integer(exp(params1[2] + params1[3]*x[idxm]))

# 负对数似然
fNLL &lt;- 函数（参数）{
  -sum(dnbinom(y, params[1], mu = exp(params[2] + params[3]*x), log = TRUE))
}

# 在估算数据上迭代查找最大似然估计，然后重新估算数据
while (max(abs(params1 - params0)) &gt; 1e-9) {
  params1 &lt;- optim(params0 &lt;- params1, fNLL, lower = 0, method = &quot;L-BFGS-B&quot;)$par
  y[idxm] &lt;- as.integer(exp(params1[2] + params1[3]*x[idxm]))
}

但是，就我而言，我的数据有点不同。我正在尝试填补 2 个变量（x1 和 x2）的缺失，这两个变量将成为我的回归中的预测变量（beta）。我不知道 x1 和 x2 的完整数据的参数，但我确实有 x3、x4 和 x5 的完整数据，回归模型中的所有其他预测变量我最终将使用完整数据运行。我的最终回归非常简单，如下所示：
模型 = lm(数据, y ~ x1 + x2 + x3 + x4 + x5)

如何使用 EM 迭代更新 x1 和 x2 以填补它们的缺失，类似于上面的示例？我是否需要使用来自 x3 x4 和 x5 的信息（如多重插补？），或者我可以使用上述的简单 EM 算法并同时更新 x1 和 x2 吗？就我而言，我没有完整的数据（因为这]]></description>
      <guid>https://stats.stackexchange.com/questions/633765/manually-program-em-in-r-to-updated-multiple-parameters-and-solve-missing-data</guid>
      <pubDate>Tue, 12 Dec 2023 23:52:50 GMT</pubDate>
    </item>
    </channel>
</rss>