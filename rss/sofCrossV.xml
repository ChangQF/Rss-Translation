<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>最近的问题 - 交叉验证</title>
    <link>https://stats.stackexchange.com/questions</link>
    <description>最近 30 个来自 stats.stackexchange.com</description>
    <lastBuildDate>Wed, 06 Mar 2024 03:13:47 GMT</lastBuildDate>
    <item>
      <title>线性回归模型构建和假设的顺序</title>
      <link>https://stats.stackexchange.com/questions/641929/sequence-of-linear-regression-model-building-assumptions</link>
      <description><![CDATA[有人可以严格解释我们如何构建线性回归模型的基本步骤，从随机结果变量（Y）和固定变量（X）之间比例的基本怀疑开始，以及假设每一步？
谢谢！]]></description>
      <guid>https://stats.stackexchange.com/questions/641929/sequence-of-linear-regression-model-building-assumptions</guid>
      <pubDate>Wed, 06 Mar 2024 02:04:45 GMT</pubDate>
    </item>
    <item>
      <title>具有条件随机化的工具变量？</title>
      <link>https://stats.stackexchange.com/questions/641928/instrumental-variable-with-conditional-randomization</link>
      <description><![CDATA[我正在进行一项 IV 设计的研究。在我的设置中，IV 仅在一年内且在一个队列内是有条件随机的。在这种情况下，我是否只需将年份和队列作为 IV 回归中的对照？需要明确的是，以下是我当前正在运行的回归：
iv_model &lt;- ivreg(y ~ D + 因子(年份) + 因子(队列) | Z + 因子(年份) + 因子(队列) , data=data)

我需要包含任何交互术语吗？]]></description>
      <guid>https://stats.stackexchange.com/questions/641928/instrumental-variable-with-conditional-randomization</guid>
      <pubDate>Wed, 06 Mar 2024 00:18:47 GMT</pubDate>
    </item>
    <item>
      <title>如何对多个布尔类建模</title>
      <link>https://stats.stackexchange.com/questions/641927/how-to-model-multiple-boolean-classes</link>
      <description><![CDATA[我正在研究SAMHSA 心理健康客户级数据集。我删除了一些不相关的列，将一些列标准化为 0-1，并对其他列进行单热编码。我正在尝试训练分类器来预测本专栏其余部分的混乱情况。然而，根据诊断，有 13 个二元疾病列（躁郁症、精神分裂症、多动症等）。
我已经训练了 RandomForestClassifier 和多类 LogisticRegression。 RandomForest 和 LogisticRegression 的准确率均约为 36%、准确率 30%、召回率 36%。在这种情况下，我使用的标签将疾病分类为 [0 种疾病，1 种疾病，&gt; 1 种疾病。 1 个障碍]共 15 个班级。我还尝试对 2^13=8192 种疾病组合进行二进制编码，其准确度相似，但精确度为 17%。前一种情况的随机猜测应该是 ~7%。
如果我尝试预测 k 均值标签，我会获得约 92% 的准确度、精确度和召回率。我认为这只是意味着簇是由数据明确定义的，而其他标签只是分散的，所以没有希望做得更好。
对于分类，我应该使用 LogisticRegression 并删除所有其他列，并对剩余列执行分类，并以这种方式遍历所有 13 个列，获取每个列的概率，然后除以所有这些列的总和即可得到每个类别的概率？



]]></description>
      <guid>https://stats.stackexchange.com/questions/641927/how-to-model-multiple-boolean-classes</guid>
      <pubDate>Wed, 06 Mar 2024 00:01:34 GMT</pubDate>
    </item>
    <item>
      <title>如何找到最佳或接近的预算分配？</title>
      <link>https://stats.stackexchange.com/questions/641924/how-can-i-find-the-optimal-or-close-to-allocation-for-a-budget</link>
      <description><![CDATA[我想使用支出和收入时间序列数据找到最佳或接近最佳的预算分配？您建议我如何解决这个问题？
我正在考虑尝试 VAR 或可能的稳健线性回归。
如果我还可以添加任何其他内容来使问题变得更好，请告诉我。]]></description>
      <guid>https://stats.stackexchange.com/questions/641924/how-can-i-find-the-optimal-or-close-to-allocation-for-a-budget</guid>
      <pubDate>Tue, 05 Mar 2024 22:52:58 GMT</pubDate>
    </item>
    <item>
      <title>隐式岭回归[关闭]</title>
      <link>https://stats.stackexchange.com/questions/641921/implicit-ridge-regression</link>
      <description><![CDATA[最近，我了解到岭回归有时是隐式完成的。例如，考虑
$$\underset{\beta \in \mathbb{R}}{\operatorname{argmin}} E_\xi (y-x \xi \beta)^2$$&lt; /跨度&gt;
其中 (x,y) 是回归模型的输入和输出 $\in \mathbb{R} \times \mathbb{R}$ 和 $\xi\sim N(1,\sigma^2)$。另外， $x\xi$ 表示我们的原始数据 $x$ 转换为 $x\xi$，之后我们进行 OLS 回归。 x 应该是一个标量。
岭回归是
$$\underset{\beta \in \mathbb{R}}{\operatorname{argmin}} (y-x\beta)^2 + \lambda\beta^2$$.
我们可以看到，当$\sigma^2 = \frac{x^2+\lambda}{x^2}$时，上面的解优化问题是相同的：
\begin{align}
&amp; \underset{\beta \in \mathbb{R}}{\operatorname{argmin}} E_\xi(y-x \xi\beta)^2 \\
&amp;= E_\xi(y^2-2yx\xi\beta + x^2\xi^2\beta^2) \\
&amp;= y^2 - 1 *2yx\beta + \sigma^2x^2\beta^2 \\
&amp;= y^2 - 2yx\beta + \sigma^2 x^2\beta^2
\end{对齐}
然后：
\begin{align}
y^2 - 2yx\beta + \sigma^2x^2\beta^2 &amp;= y^2-2yx\beta+x^2\beta^2 + \lambda\beta^2 \\
\sigma^2x^2\beta^2 &amp;= x^2\beta^2 + \lambda\beta^2 \\
\sigma^2 &amp;= \frac{x^2\beta^2 + \lambda\beta^2}{x^2\beta^2} \\
\sigma^2 &amp;= \frac{x^2 +\lambda}{x^2}
\end{对齐}
我有兴趣尝试 $\xi\sim Bern(p)$:
\begin{align}
&amp; \underset{\beta \in \mathbb{R}}{\operatorname{argmin}} E_\xi(y-x \xi\beta)^2 \\
&amp;= E_\xi(y^2-2yx\xi\beta + x^2\xi^2\beta^2) \\
&amp;= y^2 - p *2yx\beta + p(1-p)x^2\beta^2 \\
&amp;= y^2 - p *2yx\beta + \sigma^2 x^2\beta^2
\end{对齐}
那么，
\begin{align}
y^2 - p *2yx\beta + \sigma^2x^2\beta^2 &amp;= y^2-2yx\beta+x^2\beta^2 + \lambda\beta^2 \\
- p *2yx\beta + \sigma^2x^2\beta^2 &amp;= -2yx\beta+x^2\beta^2 + \lambda\beta^2 \\
\sigma^2x^2\beta^2 &amp;= p2yx\beta - 2yx\beta + x^2\beta^2+\lambda\beta^2 \\
\sigma^2 &amp;= \frac{p2yx\beta - 2yx\beta + x^2\beta^2+\lambda\beta^2}{x^2\beta^2} \\
\sigma^2 &amp;= \frac{p2yx - 2yx + x^2\beta+\lambda\beta}{x^2\beta}
\end{对齐}
这个解决方案对我来说似乎并不完全正确。有没有办法进一步简化这个过程？我尝试将 $\sigma^2$ 保留为 $p(1-p)$，但这似乎没有帮助。任何帮助将不胜感激。]]></description>
      <guid>https://stats.stackexchange.com/questions/641921/implicit-ridge-regression</guid>
      <pubDate>Tue, 05 Mar 2024 21:51:21 GMT</pubDate>
    </item>
    <item>
      <title>使用面板数据或固定效应进行事件研究</title>
      <link>https://stats.stackexchange.com/questions/641920/event-study-using-panel-data-or-fixed-effects</link>
      <description><![CDATA[我希望以约 800 家公司为样本，分析冲突对公司估值（使用每日价格）的影响（因果效应）（我目前拥有约 365 天样本期内的这些数据）。
我想分析总体影响，但也想确定行业之间影响的差异（也许某些行业受到的影响较小/较大）。
但是，我无法决定使用最合适的方法。我分为使用事件研究方法和使用固定效应的面板数据方法。
两者似乎都有其优点和缺点，但考虑到时间范围很短（战争开始只有几天），我不确定面板固定效果是否合适。
感谢任何帮助！
我尝试查找包含类似问题的帖子，但没有找到针对我的问题的任何内容。]]></description>
      <guid>https://stats.stackexchange.com/questions/641920/event-study-using-panel-data-or-fixed-effects</guid>
      <pubDate>Tue, 05 Mar 2024 21:48:47 GMT</pubDate>
    </item>
    <item>
      <title>重复事件的生存分析：“生命线”中的“聚类”方法和 Andersen-Gill 方法有什么区别？</title>
      <link>https://stats.stackexchange.com/questions/641917/survival-analysis-with-recurrent-events-what-is-the-difference-between-the-clu</link>
      <description><![CDATA[下午好，
我想更好地了解 lifelines Python 包中的 cluster 方法与 Andersen-Gill 方法有何不同。根据每个方法的定义（见下文），聚类方法似乎比 Andersen-Gill 方法更保守，因为前者不将重复事件视为独立的。我是否正确地思考了这些差异？
根据生命线文档（链接):
&lt;块引用&gt;
数据集可能具有的另一个属性是相关主题组。这可能是由于：

单个个体出现多次，因此在数据集中多次出现。
具有某些共同属性的主题，例如同一家庭的成员或倾向得分匹配的对象。


&lt;块引用&gt;
我们将这些分组的主题称为“集群”，并假设它们是由 DataFrame 中的某些列指定的（下面的示例）。使用聚类时，模型的点估计不会改变，但标准误差会增加。

相比之下，对于 Andersen-Gill 方法（链接):
&lt;块引用&gt;
Andersen-Gill 模型假设所有观察到的事件时间之间是独立的，无论这些事件时间对应于同一患者还是不同患者。

任何帮助、见解或建议将不胜感激。]]></description>
      <guid>https://stats.stackexchange.com/questions/641917/survival-analysis-with-recurrent-events-what-is-the-difference-between-the-clu</guid>
      <pubDate>Tue, 05 Mar 2024 20:18:20 GMT</pubDate>
    </item>
    <item>
      <title>关于使用 RFpredInterval 包的问题：如何计算与测试数据点相同的终端节点中的数据点的标准差</title>
      <link>https://stats.stackexchange.com/questions/641922/question-about-using-the-rfpredinterval-package-how-to-calculate-the-standard-d</link>
      <description><![CDATA[我正在使用 RFpredInterval 包（特别是 rfpi 函数）来获取随机森林的预测间隔。我想通过采用与每个测试数据点相同的终端节点中的数据点的标准差（也称为 BOP 数据）来估计测试数据集的置信区间。我已经尝试这样做（详细信息如下），但我认为我没有正确地提取正确的 BOP/终端节点数据来获取标准差。
我编辑了 rfpi 函数以返回“BOPtest”在函数内创建的术语，认为这可能是测试数据集中每个数据点的 BOP 数据列表。我通过取 BOPtest 列表中每个元素的平均值来检查这是否是正确的术语，因为这就是随机森林算法计算最终预测输出的方式。然而，这种情况并非如此。如果有人能帮助我破译 rfpi 函数中的代码以提取 BOP 数据，我将不胜感激。预先感谢您。
这是我所做的一个示例
## 加载示例数据
数据（波士顿住房，包=“RFpredInterval”）
设置.种子(2345)
## 定义训练/测试分割
测试指数 &lt;- 1:10
trainindex &lt;- 样本（11：nrow（波士顿住房），大小= 100，替换= FALSE）
traindata &lt;- BostonHousing[trainindex, ]
测试数据 &lt;- BostonHousing[testindex, ]
px &lt;- ncol(波士顿住房) - 1
## 用“l1”构建 90% PI分割规则和“spi”带校准的 PI 方法
out &lt;- rfpi(公式 = medv ~ ., traindata = traindata,
            测试数据=测试数据，
            阿尔法 = 0.1,
            校准=真，
            split_rule =“ls”，
            pi_method =“lm”，
            params_rfsrc = 列表(ntree = 50),
            params_calib = 列表(范围 = c(0.89, 0.91), 开始 = 0.9, 步骤 = 0.01, 精炼 = TRUE))

#拉出BOP测试列表
bop.test&lt;-out$BOPtest
bop.mean&lt;-t(data.frame(lapply(bop.test,mean)))
bop.sd&lt;-t(data.frame(lapply(bop.test,sd)))

#结果数据框
result_df&lt;-data.frame(cbind(out$test_pred,testdata$medv,bop.mean,bop.sd))
colnames(result_df)&lt;-c(“pred”,“meas”,“bop_mean”,“bop_sd”)


我认为 result_df$pred 和 result_df$bop_mean 应该相等。
以下是 github 上 rfpi 功能页面的链接：https: //github.com/cran/RFpredInterval/blob/master/R/rfpi.R
我还必须加载这些函数：

https://github.com/cran/RFpredInterval /blob/master/R/build.bop.R
https://github.com/cran/RFpredInterval /blob/master/R/calibration.functions.R
https://github.com/cran/RFpredInterval /blob/master/R/formpi.functions.R
]]></description>
      <guid>https://stats.stackexchange.com/questions/641922/question-about-using-the-rfpredinterval-package-how-to-calculate-the-standard-d</guid>
      <pubDate>Tue, 05 Mar 2024 19:40:07 GMT</pubDate>
    </item>
    <item>
      <title>作为一组线性变换的简单 ANN</title>
      <link>https://stats.stackexchange.com/questions/641885/simple-ann-as-a-set-of-linear-transformations</link>
      <description><![CDATA[我们无法使用隐藏层中的单个感知器对 XOR 问题的点进行分类。然而，我们可以通过在隐藏层使用两个感知器和在输出层使用一个感知器来实现这一点，而不使用激活函数。输入层由两个感知器组成。有一个隐藏层和一个输出层，有两个权重矩阵：第一个矩阵 $A$ 是 $2*2$ ，第二个矩阵$B$是$1*2$。让我们考虑 $A=[[1,1],[0,1]]$ 和 $B=[-2 ,2]$。在前向传播过程中，我们通过矩阵 $A$ 对 $X$ 向量进行线性变换，得到在 $R²$ 中的新向量中。然后这个新向量通过矩阵 $B$ 进行线性变换以产生输出。这意味着我们需要做的就是 $B(AX)$。这就是我的问题出现的地方：
经过研究，发现矩阵乘法是结合律的，即$B(AX)=(BA)X$，并且两个线性变换的组合是一个线性变换。 $A$ 和 $B$ 的组合会产生另一个矩阵，表示为 $K$，形状为 1x2。因此，$B(AX)=KX$。这里的关键是学习 $K$ ；最初，我们通过处理单独的线性变换来实现这一目标，但我们可以通过在隐藏层中仅选择一个感知器来让人工神经网络 (ANN) 一步完成此任务。然而，这种做法是不正确的。那么，我的问题出在哪里？！！”.]]></description>
      <guid>https://stats.stackexchange.com/questions/641885/simple-ann-as-a-set-of-linear-transformations</guid>
      <pubDate>Tue, 05 Mar 2024 12:40:55 GMT</pubDate>
    </item>
    <item>
      <title>我们如何解释矩阵变量正态分布中的协方差矩阵 $\textbf{U}$ 和 $\textbf{V}$？</title>
      <link>https://stats.stackexchange.com/questions/641849/how-do-we-interpret-the-covariance-matrices-textbfu-and-textbfv-in-the</link>
      <description><![CDATA[考虑矩阵正态分布。我的第一个问题是：我们如何解释随机矩阵 $\textbf{X}_{ij}$ 的条目  $\textbf{X}(n\times p)$？我的第二个问题是：我们如何解释所谓的协方差矩阵 $\textbf{U}$ 和 $\textbf{ V}$？最后，我的第三个问题是：我们如何计算矩阵 $\textbf{U}$ 和 $\textbf{V }$？
如有任何帮助，我们将不胜感激。]]></description>
      <guid>https://stats.stackexchange.com/questions/641849/how-do-we-interpret-the-covariance-matrices-textbfu-and-textbfv-in-the</guid>
      <pubDate>Tue, 05 Mar 2024 01:59:02 GMT</pubDate>
    </item>
    <item>
      <title>使用哪种预测评估指标？</title>
      <link>https://stats.stackexchange.com/questions/641798/which-forecast-evaluation-metric-to-use</link>
      <description><![CDATA[这是一个预测问题。我需要一个评估指标，它对预测不足的惩罚比对预测过度的惩罚更多。另外我希望它的范围在一定的区间内（比如0-100），以便更容易比较不同模型。可能的评估指标/解决方案是什么？
到目前为止，我已经尝试过 MSE、r2 分数、MAPE、WMAPE、AMAPE、SMAPE。]]></description>
      <guid>https://stats.stackexchange.com/questions/641798/which-forecast-evaluation-metric-to-use</guid>
      <pubDate>Mon, 04 Mar 2024 15:02:41 GMT</pubDate>
    </item>
    <item>
      <title>将多个排名合并为一个的最佳方法是什么？</title>
      <link>https://stats.stackexchange.com/questions/641742/what-is-the-best-way-of-combining-multiple-rankings-into-one</link>
      <description><![CDATA[假设我有 $N$ 个不同的项目需要排名，并且 $M$ 个不同的人根据他们的个人喜好提供项目的排名。将所有排名合并为一个的最佳方法是什么？
最简单的方法是计算所有排名的总和，然后将结果从最低到最高排名。但还有其他方法。是否有一种在数学上更正确的方法，可能通过假设一些潜在的分布来实现？
例如，让 $r_{ij}$ 为分配给项目 $i$ 的排名由评估者$j$。上面概述的简单方法相当于将排名转换为分数 $s_{ij} = - r_{ij}$，并为每个项目计算总分 &lt; span class=&quot;math-container&quot;&gt;$S_i = \sum_{j=1}^M{s_{ij}}$ 用于提供项目的最终排名。其他替代方法包括将分数设置为 $s_{ij}=1/r_{ij}$ （调和平均值）或 $ s_{ij}=-\log r_{ij}$（几何平均值）。我如何选择最好的替代方案？]]></description>
      <guid>https://stats.stackexchange.com/questions/641742/what-is-the-best-way-of-combining-multiple-rankings-into-one</guid>
      <pubDate>Sun, 03 Mar 2024 20:25:32 GMT</pubDate>
    </item>
    <item>
      <title>R pwr 包对于极小样本量 (<10) 的有效性</title>
      <link>https://stats.stackexchange.com/questions/641707/validity-of-r-pwr-package-for-extremely-small-sample-sizes-10</link>
      <description><![CDATA[编辑：这个问题不是：

关于编程
关于事后功效分析（至少不是为了在事后分析中使用样本统计数据 - 我有很好的总体估计值，我想向人们展示如何使用这些数据）

这个问题是关于：

正确使用科学界广泛使用的常用工具。
在此（或任何其他）工具中检查假设和近似值，包括默认的假设和近似值。

因此，我相信结束这个问题（甚至没有提供任何提示
在哪里以及如何得到答案）实际上伤害了这个社区，
通过传达这样的信息：这些检查是多余的，而它们
确实应该放在优先事项列表的首位。
我希望这个请求能够得到重新审理。
———————————-
pwr 包是否使用 Cohen 1988 中描述的小样本近似（例如 1 样本 t 检验中的自由度）来实现？我似乎在文档中找不到这个。
如果是这样，对于非常小的样本量功效计算是否有更好的选择？
感谢您的回复。
————————
可选阅读：我的问题的动机：
在工作（制造操作）中，我们发现很难重现测试结果。对我来说，很明显这是因为我们进行的研究动力严重不足。我的老板同意我应该解决一些问题。
我想计算我们使用的一些典型实验“设计”的功效。
R中的pwr包看起来非常方便。该小插图引用了 Cohen 的书：行为科学的统计功效分析 (1988)。不同的应用领域应该有相同的数学，但我还是决定看看这本书。
我注意到书中的一些近似值，当“小样本量”意味着 &gt; 时，这些近似值是有效的。 30. 对我来说，“非常大的样本量”有时意味着 10。我现在注意到 1 样本 t 检验和配对 t 检验的近似值：书中提到它没有具有正确自由度的表格。这导致 n &gt; 的差异非常小。 30，但我怀疑该近似值对于 n &lt; 30 可能无效。 10. 我想检查一下。这就是我的问题。
————————-
编辑：其中一条评论要求引用，这是合理的。
我引用 Cohen, J. (1988) 的话。行为科学的统计功效分析（第二版），如 pwr 包中引用。
这里有两个例子，科恩提到了近似值的使用：
第 42 页脚注 1 中有关样本量不等的 t 检验的一个不太严重的示例：“这是因为该表将 n 的 t 检验视为基于 df = 2n&#39; - 2，而实际上有 df=nA +nB - 2，较大的值。”
第 46 页，关于单样本 t 检验有一个更严重的例子：
“功效表的计算基础是 n 是两个样本中每个样本的大小，因此 t 检验将基于 2(n-1) 个自由度。在单样本情况下，t 必然仅基于 n - 1 个自由度。”并且：“除非样本量很小（比如小于 25 或 30），否则低估自由度的影响可以忽略不计。”
请注意，我同意这种分析和近似。然而，在我的情况下，我可能会误入歧途，因为我违反了其中一个条件。将错误的东西改成同样错误的东西并不是一种改进，所以我想避免这种情况。
对于现代计算机，不再需要这些近似值 - 但我无法在文档中找到 R 包是否是用近似值编写的。
我知道我们应该做什么，但是获得大于 20 的样本量对我们来说极其罕见。话又说回来，我们可以修改我们的实验以获得比科恩认为的“大”更大的效应量。我只需要向人们解释/激励我们应该这样做。要达到这一点需要付出努力。]]></description>
      <guid>https://stats.stackexchange.com/questions/641707/validity-of-r-pwr-package-for-extremely-small-sample-sizes-10</guid>
      <pubDate>Sun, 03 Mar 2024 10:35:10 GMT</pubDate>
    </item>
    <item>
      <title>如果自适应 Lasso 估计的标准误差估计没有用怎么办？</title>
      <link>https://stats.stackexchange.com/questions/641826/what-to-do-if-the-standard-error-estimates-for-adaptive-lasso-estimates-are-usel</link>
      <description><![CDATA[这更多的是一个咨询问题。我正在为我的学士研究在政权切换和其他混杂因素下自适应套索在多维 garch midas 数据上的性能。我知道套索估计有偏差，但我认为自适应套索估计：
&lt;块引用&gt;
“这进一步鼓励了自适应 LASSO 惩罚的使用，
导致渐近无偏估计（参见 Zou 2006）。”。

目前，我正在研究模拟研究的性能指标 (PM)，以量化结果。到目前为止，对于 PM，我主要按照 Tim Morris 和 Ian White 的工作进行工作（随时欢迎进一步的建议）。
事实证明，模型 SE 估计值几乎是垃圾，而 EmpSE 则高得多。不过，模型选择效果很好。 PM 是否像 CI、覆盖率、SE 模型中的相对误差百分比等使用 SE 的模型在 Lasso 案例中值得关注？
我仍然可以查看偏差、方差、测试 MSE/MAD、误报/阴性，也许我会发现更多有趣的内容，但您是否会完全放弃模型 SE 估计或尝试进行引导。我真的不想进行引导，因为这也会增加计算时间，这已经相当长了。]]></description>
      <guid>https://stats.stackexchange.com/questions/641826/what-to-do-if-the-standard-error-estimates-for-adaptive-lasso-estimates-are-usel</guid>
      <pubDate>Sat, 02 Mar 2024 12:25:38 GMT</pubDate>
    </item>
    <item>
      <title>四个不同城市土壤有毒元素与表观遗传老化的关系</title>
      <link>https://stats.stackexchange.com/questions/639266/association-of-soil-toxic-element-with-epigenetic-aging-in-four-different-cities</link>
      <description><![CDATA[我想使用 gam 模型对土壤有毒元素和表观遗传年龄加速进行回归分析（线性/非线性）；在这里，我们使用 ICP-MS 测量了四个不同城市的土壤元素（毫克/千克）。
我将以下代码与交互（城市）术语一起使用。尽管如此，有人建议这不是对交互项建模的正确方法，所以现在我尝试将 gam 模型与交互项一起用于线性和非线性模型。但我不知道该怎么做。我在下面添加了 gam 模型，用于线性和非线性，没有使用 gam 的交互项，但是您能帮助我如何改进交互项（城市）的模型吗？如何在 gam 模型中提及性别、年龄和 Smoking_Status 等协变量。
raw &lt;- read.table(&quot;clean.raw.elements.txt&quot;, header=TRUE, sep=&quot;\t&quot;)
colnames（原始）

model1 &lt;- lm (EpigenicAgeAcceleration_EEAA ~ 0 + 城市 +
    城市：( Zn + Cu + Hg + Mo + Pb + 吸烟状态 + 性别 + 年龄),
    数据=原始）
摘要_模型1 &lt;- 摘要(模型1)
摘要_模型1
# 系数估计
系数 &lt;- coef(summary_model1)
＃ 置信区间
conf_intervals &lt;-confint(model1)

# 结合系数和置信区间
组合输出 &lt;- cbind(系数, conf_intervals)
组合输出
write.table(combined_output, &quot;PCGrimAge_EEAA_elements.txt&quot;, sep=&quot;,&quot;)

没有交互项的 gam 模型；城市
&lt;代码&gt;&gt;线性模型 &lt;- gam(EpigenicAgeAcceleration_EEAA ~ Hg, data=ph1)
&gt; smooth_model &lt;- gam(EpigenicAgeAcceleration_EEAA ~ s(Hg),
                      数据=ph1)
&gt; AIC（线性模型，平滑模型）
                   df AIC
线性模型 3.000000 9721.443
平滑模型 3.314677 9721.311

我也尝试过这个，但我不确定如何获得所有四个城市的效应大小和其他系数；
m.factor &lt;- gam(PCGrimAge_EEAA ~ Hg + te(Hg, by=cities), data=ph1)
&gt;
&gt;摘要（m.因子）

族：高斯
链接功能：身份

公式：
PCGrimAge_EEAA ~ Hg + te（汞，按 = 城市）

参数系数：
              估计标准。误差t值Pr(&gt;|t|)
（截距）1.4009 0.6086 2.302 0.0215 *
           汞 -1.6693 0.6942 -2.405 0.0163 *
---
西尼夫。代码： 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

平滑项的近似意义：
                             edf Ref.df F p 值
te(汞)：桑特 0.7654 0.7552 4.229 0.0741 。
te(汞): 挡板 0.7552 0.7552 0.001 0.9813
te(汞)：帕尼帕 0.7552 0.7552 6.989 0.0217 *
te(汞)：库鲁斯 3.3627 3.6542 1.385 0.3273
---
西尼夫。代码： 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

排名：17/18
R-sq.(adj) = 0.00168 解释的偏差 = 0.532%
GCV = 16.761 规模估计 = 16.691 n = 1813
]]></description>
      <guid>https://stats.stackexchange.com/questions/639266/association-of-soil-toxic-element-with-epigenetic-aging-in-four-different-cities</guid>
      <pubDate>Wed, 14 Feb 2024 14:14:30 GMT</pubDate>
    </item>
    </channel>
</rss>