<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>最近的问题 - 交叉验证</title>
    <link>https://stats.stackexchange.com/questions</link>
    <description>来自 stats.stackexchange.com 的最新 30 条</description>
    <lastBuildDate>Mon, 27 Jan 2025 12:32:47 GMT</lastBuildDate>
    <item>
      <title>类别不平衡的小型生物医学数据集的分类策略</title>
      <link>https://stats.stackexchange.com/questions/660600/classification-strategies-for-small-biomedical-dataset-with-imbalanced-classes</link>
      <description><![CDATA[我有从 10 只不同的猪身上测量的光谱数据。目标是分析三种不同的组织类型。但是，并不是每只猪都测量了所有组织。总数为脂肪：3、肾脏：4、肝脏：9。每种组织都有重复的光谱测量，从中提取了几个特征。我计划通过取每个组织样本的中位数来汇总重复测量特征。
我想通过使用提取的特征和几个模型将样本分为三个不同的类别来分析样本的差异。我知道数据集非常小，因此我最初的计划是利用嵌套留一交叉验证。但是，由于多类分类中最小的类只有 3 个，我怀疑这种方法是否可行。对于如此小的数据集，留一法交叉验证是否合适，或者其他验证方法是否更合适？
数据摘要：

脂肪组织：3（重复次数：33、30、54）
肾脏组织：4（重复次数：155、128、107、74）
肝脏组织：9（重复次数：12、25、21、29、52、63、62）
]]></description>
      <guid>https://stats.stackexchange.com/questions/660600/classification-strategies-for-small-biomedical-dataset-with-imbalanced-classes</guid>
      <pubDate>Mon, 27 Jan 2025 12:30:55 GMT</pubDate>
    </item>
    <item>
      <title>卡方蒙特卡罗模拟</title>
      <link>https://stats.stackexchange.com/questions/660599/chi-square-monte-carlo-simulation</link>
      <description><![CDATA[我有一个列联表，我想在其上应用卡方检验，但某些单元格不大于 5，这意味着我无法使用该检验。我读到过蒙特卡罗模拟是可行的，但我不知道在这种情况下它是否合适，或者是否有替代测试。
这是我的数据：
data &lt;- matrix(c(326, 32, 22, 2, 96, 115, 271, 4, 132, 29), 
nrow = 5, byrow = TRUE,
dimnames = list(c(&quot;GR1&quot;, &quot;GR2&quot;, &quot;GR3&quot;, &quot;GR4&quot;, &quot;GR5&quot;),
c(&quot;No&quot;, &quot;Yes&quot;)))

这是 R 中的结果：
chisq.test(data, mock.p.value = TRUE, B = 10000)

带模拟 p 值的 Pearson 卡方检验（基于 10000 次重复）

数据：数据
X 平方 = 266.48，df = NA，p 值 = 9.999e-05

我的方法好吗，或者是否有更可靠或更有趣的替代方法？
非常感谢！]]></description>
      <guid>https://stats.stackexchange.com/questions/660599/chi-square-monte-carlo-simulation</guid>
      <pubDate>Mon, 27 Jan 2025 12:20:54 GMT</pubDate>
    </item>
    <item>
      <title>用于碳封存分析的混合效应随机森林 (MERF) 的层次结构和模型表示</title>
      <link>https://stats.stackexchange.com/questions/660598/hierarchical-structure-and-model-representation-in-mixed-effects-random-forest</link>
      <description><![CDATA[我计划使用 randomForest 和 lme4packages 在 R 中执行混合效应随机森林 (MERF) 分析。但是，我不确定我的层次结构是否设置正确。
我最终想要了解的是高级和低级因素对城市公园碳封存的影响。
我的数据集包括：

高级（公园级）数据：20 个公园的 4 个变量。
低级（树木级）数据：4 个变量，包括单棵树的碳封存，总共 3,850 个数据点。
每个公园包含的树木数据点数量取决于其大小（例如，较小的公园只有 36 棵树，而较大的公园则有多达 630 棵树）。

以下是我的两个主要问题：

就我而言，许​​多 AI 工具建议使用求和 (Σ) 形式的方程来表示模型。这种表示方式是否也适合我的数据？此外，这种表示方式是否经济实惠？
￼
对于较低级别的数据（单棵树数据），我是否应该将单棵树的碳封存作为变量？或者，既然它已经是公园级总碳封存的一部分，那么将其排除在固定效应之外是否有意义？

此外，如果您认为 MERF 可能不是实现我的目标的最佳方法，我将非常感激您推荐可能更适合的替代方法。
我将非常感激专家的任何建议。谢谢！]]></description>
      <guid>https://stats.stackexchange.com/questions/660598/hierarchical-structure-and-model-representation-in-mixed-effects-random-forest</guid>
      <pubDate>Mon, 27 Jan 2025 12:15:03 GMT</pubDate>
    </item>
    <item>
      <title>多元 Ornstein-Uhlenbeck（Vasicek）过程的最大似然估计</title>
      <link>https://stats.stackexchange.com/questions/660596/maximum-likelihood-estimation-for-multivariate-ornstein-uhlenbeck-vasicek-proc</link>
      <description><![CDATA[我想知道多元 Ornstein-Uhlenbeck (OU) 过程的最大似然估计量 (MLE) 的解析表达式是否可用。
设置如下：考虑一个 $p$ 维 OU 过程 $(\mathbf{X}_t)_{t\geq 0}$，用于求解 SDE
$$d\mathbf{X}_t = \mathbf{\kappa}(\mathbf{\alpha}-\mathbf{X}_t)dt+\mathbf{\Sigma}d\mathbf{W}_t$$
其中 $\mathbf{\kappa}， \mathbf{\Sigma}$ 是 $k\times k$ 正定矩阵，$\mathbf{\alpha}$ 是 $k$ 向量，$\mathbf{W}_t$ 是 $p$ 维维纳过程。
假设我们在等距时间实例中观察到 OU 过程，即观测结果由
$$\mathbf{x}=\{\mathbf{x}_0,\mathbf{x}_\Delta,...,\mathbf{x}_{n\Delta}\}$$
很明显，$\mathbf{X}_{i\Delta}|\mathbf{X}_{(i-1)\Delta}$服从高斯分布，利用OU过程的马尔可夫特性，我们可以写出观测值的对数似然$\mathbf{x}$。现在我想问的是，是否有可能最大化 $(\mathbf{\kappa,\alpha,\Sigma})$ 的对数似然，并获得 MLE 的解析表达式？
我注意到一篇论文“扩散过程的参数估计和偏差校正”对单变量 OU 过程进行了此操作。如果有人能告诉我显示多变量版本的论文/书籍的方向，我将不胜感激。]]></description>
      <guid>https://stats.stackexchange.com/questions/660596/maximum-likelihood-estimation-for-multivariate-ornstein-uhlenbeck-vasicek-proc</guid>
      <pubDate>Mon, 27 Jan 2025 11:35:17 GMT</pubDate>
    </item>
    <item>
      <title>R 过度拟合图表上的拐点[关闭]</title>
      <link>https://stats.stackexchange.com/questions/660595/r-overfitting-inflection-points-on-a-graph</link>
      <description><![CDATA[我对 R 还很陌生，但正在尝试寻找拐点。我正在使用 pracma 包，但发现它经常过度拟合图表，将线条中可能无关紧要的“凸起”找到并标记为拐点。这是我的代码：
if (!require(pracma)) {
install.packages(&quot;pracma&quot;)
}
library(pracma)

data &lt;- Active_dataset_1 %&gt;% 
filter(Sex_update %in% c(&quot;Male&quot;, &quot;Female&quot;)) %&gt;%
filter(!is.na(Age_update))

loess_model &lt;- loess(Combined_SRT ~ Age_update, data = data)

age_seq &lt;- seq(min(data$Age_update), max(data$Age_update), length.out = 1000)

predictions &lt;- predict(loess_model, newdata = data.frame(Age_update = age_seq))
first_derivative &lt;- diff(predictions) / diff(age_seq)
second_derivative &lt;- diff(first_derivative) / diff(age_seq[-length(age_seq)])

inflection_points &lt;- age_seq[which(diff(sign(second_derivative)) != 0) + 1]

print(inflection_points)
plot(inflection_points)

if (!require(pracma)) {
install.packages(&quot;pracma&quot;)
}
library(pracma)

data &lt;- Active_dataset_1 %&gt;% 
filter(Sex_update %in% c(&quot;Male&quot;, &quot;Female&quot;)) %&gt;%
filter(!is.na(Age_update))

loess_model &lt;- loess(Combined_SRT ~ Age_update, data = data)

age_seq &lt;- seq(min(data$Age_update), max(data$Age_update), length.out = 1000)

预测 &lt;- predict(loess_model, newdata = data.frame(Age_update = age_seq))

first_derivative &lt;- diff(predictions) / diff(age_seq)
second_derivative &lt;- diff(first_derivative) / diff(age_seq[-length(age_seq)])

inflection_points &lt;- age_seq[which(diff(sign(second_derivative)) != 0) + 1]

叠加图 &lt;- ggplot(data, aes(x = Age_update)) + 

geom_point(aes(y = Combined_SRT, color = Sex_update), alpha = 0.1) + 
geom_smooth(aes(y = Combined_SRT, color = Sex_update, linetype = &quot;Combined_SRT&quot;), 
method = &quot;loess&quot;, se = FALSE) +

geom_vline(xintercept = inflection_points, linetype = &quot;dashed&quot;, color = &quot;red&quot;) +

scale_y_continuous(name = &quot;反应时间 (ms)&quot;, limits = c(0, 4000), breaks = seq(0, 4000, by = 1000)) +

scale_x_continuous(name = &quot;年龄（岁）&quot;, limits = c(5, 100), breaks = seq(5, 100, by = 10)) +

scale_color_manual(values = c(&quot;女性&quot; = &quot;brown2&quot;, &quot;男性&quot; = &quot;cyan3&quot;),
name = &quot;性别&quot;,
breaks = c(&quot;女&quot;, &quot;男&quot;),
labels = c(&quot;女&quot;, &quot;男&quot;)) +

scale_linetype_manual(values = c(&quot;Combined_SRT&quot; = &quot;solid&quot;),
name = &quot;测试类型&quot;,
labels = c(&quot;Combined_SRT&quot; = &quot;组合简单反应时间&quot;))

print(overlayedplot)
]]></description>
      <guid>https://stats.stackexchange.com/questions/660595/r-overfitting-inflection-points-on-a-graph</guid>
      <pubDate>Mon, 27 Jan 2025 11:04:04 GMT</pubDate>
    </item>
    <item>
      <title>分类预测变量某一级别的数据缺失，多级数据</title>
      <link>https://stats.stackexchange.com/questions/660594/missing-data-in-one-level-of-a-categorical-predictor-multilevel-data</link>
      <description><![CDATA[我拥有结合了 3 项经验抽样研究（参与者每天回答几次简短问卷，例如一周）的数据。在这些研究中，参与者在每份问卷中被问及他们在过去一小时内遇到的情况类型，以及他们在过去一小时内的行为。
共有 175 名参与者，平均每位参与者有 39 份报告。
我想调查不同情况类型之间五个行为维度的平均差异。这 3 项研究中每项都测量了 4 种情况类型，但只有 2 项研究中测量了第五种情况类型。现在，我想知道分析数据的最佳方法是什么（初步而言，我计划使用多级模型，以参与者随机截距和情况类型固定效应作为预测因子）-

完全放弃第五种情况类型（可能，但我宁愿不这样做）
完全放弃缺少第五种情况类型的研究（与上文相同）
调查情况对整个数据的 4 种情况类型行为的影响，然后分别调查精简数据的 5 种情况类型（不包括不包括第五种情况类型的一项研究数据 - 这项研究有 48 名参与者和 2338 份报告）。这感觉很奇怪 - 我基本上会进行两次几乎相同的分析。
对包括第五种情况类型的整个数据集进行分析，而不管大约三分之一的数据在“情况类型”的一个级别上缺少值变量

我意识到，令我感到羞愧的是，我实际上并不知道选项 4 会对估计值和结果产生什么影响。它会扭曲比较结果吗？如何影响？您会怎么做？
感谢您的见解！我也遇到过类似的问题，但它们似乎并没有解决这个确切的问题。]]></description>
      <guid>https://stats.stackexchange.com/questions/660594/missing-data-in-one-level-of-a-categorical-predictor-multilevel-data</guid>
      <pubDate>Mon, 27 Jan 2025 10:53:00 GMT</pubDate>
    </item>
    <item>
      <title>对于大型列联表，Barnard 检验的实现/概括？</title>
      <link>https://stats.stackexchange.com/questions/660593/implementation-generalization-of-barnards-test-for-large-contigency-tables</link>
      <description><![CDATA[上下文。我最近接触了 Fisher 精确检验和 Barnard 检验的 2x2 列联表。据我所知，这两个检验已被广泛比较，对于 2x2 表，我读过一些论文后得到的一般想法是 Barnard 检验对此类表更有效。不过，我也读过几次，随着我们增加表格的大小，功效差异并不大。
我能够使用 SAS 比较 Fisher 精确检验和 Barnard 检验的 2x2 列联表。现在，我想对更大的表格做同样的事情，但我无法找到针对此类表格的 Barnard 检验的概括/实现。
考虑到这一点，我想提出以下问题：
问题。是否有人熟悉针对更大表格的 Barnard 检验的概括/实现（最好在 SAS 中，但我也接受其他软件）？
提前感谢任何帮助！]]></description>
      <guid>https://stats.stackexchange.com/questions/660593/implementation-generalization-of-barnards-test-for-large-contigency-tables</guid>
      <pubDate>Mon, 27 Jan 2025 10:48:53 GMT</pubDate>
    </item>
    <item>
      <title>如何用非参数检验和自举法比较三个分布？</title>
      <link>https://stats.stackexchange.com/questions/660591/how-to-compare-three-distributions-with-the-nonparametric-test-and-bootstrapping</link>
      <description><![CDATA[我正在分析一个包含三种不同相关系数分布的数据集。最初，我使用标准 Kolmogorov-Smirnov (KS) 检验进行成对比较。但是，我意识到由于样本数量巨大，KS 检验返回的 p 值非常小，所以我想通过使用引导来避免这种情况，但我不确定如何做到这一点。鉴于这种情况：

考虑到许多样本，您会推荐哪些方法来比较这三个分布？

我应该如何解释和报告结果，特别是在处理可能导致统计上显着但实际上不显着差异的大样本量时？

我也有点担心我的样本不是完全独立的。有些是从同一只老鼠身上采集的，而另一些是从不同的老鼠身上采集的。但我也不知道该如何解释这一点。

]]></description>
      <guid>https://stats.stackexchange.com/questions/660591/how-to-compare-three-distributions-with-the-nonparametric-test-and-bootstrapping</guid>
      <pubDate>Mon, 27 Jan 2025 10:46:18 GMT</pubDate>
    </item>
    <item>
      <title>预测变量中的随机趋势 (OLS)</title>
      <link>https://stats.stackexchange.com/questions/660588/stochastic-trend-in-predictors-ols</link>
      <description><![CDATA[我正在构建一个 OLS 模型。
据我所知，预测变量中的随机趋势会导致非平稳残差。
为了解决这个问题（我们希望残差是平稳的），有两种方法可以解决：

引入协整变量
差分

首选数字 1，因为差分会从序列中删除对长期预测至关重要的信息。（如果我错了，请纠正我）
假设我们选择数字 1，并引入另一个与具有随机趋势的预测变量协整的预测变量。
现在，将考虑随机趋势，残差应该再次平稳。
现在我的问题/方法：
我以这两个协整预测器作为输入运行 ECM。
此 ECM 的输出将在原始系统中再次引入。
现在：我是否需要删除两个预测因子，只留下 ECM 的输出？
或者我需要将这三个都包含在系统中，并将其作为 OLS 的输入？
所以基本上：
Y = b+ B1*predictor1_stoch_trend + B2*predictor2_cointegrated_w_predictor1 + B3*error_output_ecm + B4*predictor4_linear_trend

或
Y = b + B3*error_output_ecm + B4*predictor4_linear_trend

（对于 predictor4，我会从序列中减去线性趋势以使其平稳）]]></description>
      <guid>https://stats.stackexchange.com/questions/660588/stochastic-trend-in-predictors-ols</guid>
      <pubDate>Mon, 27 Jan 2025 10:12:42 GMT</pubDate>
    </item>
    <item>
      <title>如何量化线性回归拟合中的系统误差？</title>
      <link>https://stats.stackexchange.com/questions/660587/how-to-quantify-the-systematic-error-in-linear-regression-fit</link>
      <description><![CDATA[当对大小为 $N$ 的数据集 $(x_i,y_i)$ 执行线性回归时，使用线性模型 $y(x)=β_0+β_1 x$，估计系数的协方差矩阵、截距 $\hat{β}_0$ 和斜率 $\hat{β}_1$ 可根据数据集中的方差估计拟合中的“统计误差”。
随着数据集大小 $N$ 的增加，协方差矩阵的条目通常会缩小，从而导致统计误差更小。然而，这并不一定意味着拟合是合适的，因为残差 $r_i=\hat{y}(x_i)−y_i$​ 可能仍会揭示观测值和预测值 $y_i$ 和 $\hat{y}(x_i)$ 之间的系统偏差。
基于残差分析，计算预测值 $\hat{y}(x)$ 的“系统误差”的正确数量是多少，这纯粹与线性模型的选择有关？
它与 $R^2$ 或 $RMSE = \sqrt{\frac{1}{N} \sum_{i=1}^N (\hat{y}(x_i) - y_i)^2}$ 相关吗？
如能提供任何理论背景或参考资料以深入研究该主题，我将不胜感激。在此先行致谢。]]></description>
      <guid>https://stats.stackexchange.com/questions/660587/how-to-quantify-the-systematic-error-in-linear-regression-fit</guid>
      <pubDate>Mon, 27 Jan 2025 10:05:30 GMT</pubDate>
    </item>
    <item>
      <title>我如何测试一个预测是否使用了另一个预测作为输入？</title>
      <link>https://stats.stackexchange.com/questions/660585/how-can-i-test-whether-a-forecast-used-another-forecast-as-input</link>
      <description><![CDATA[我们正在举办一场关于可再生能源发电的预测竞赛。目标变量 ($X$) 的预测 $\hat Y_{ref}$ 已经发布（实际上是由我们发布的。但我们无法触及它）。预测者不应该将其用作输入，但我们无法阻止他们。有没有办法测试各种候选预测 $\hat Y_i$ 是否以某种确定性使用该预测作为输入？
我正在考虑使用相关比或某种残差比，但也许有更多设计更完善且更可接受的方法？]]></description>
      <guid>https://stats.stackexchange.com/questions/660585/how-can-i-test-whether-a-forecast-used-another-forecast-as-input</guid>
      <pubDate>Mon, 27 Jan 2025 09:18:03 GMT</pubDate>
    </item>
    <item>
      <title>如何选择和评估重复测量多类分类的分类器？</title>
      <link>https://stats.stackexchange.com/questions/660584/how-to-choose-and-evaluate-classifiers-for-multiclass-classification-with-repeat</link>
      <description><![CDATA[我有一个数据集，其中包含 269 名受试者的 960 个样本，这些样本经过了重复测量。目标变量有 4 个类别。我的目标是完美地对类别进行分类，并提取作为此分类重要标记的特征。
我尚未找到任何关于考虑重复测量的分类器的文献，因此我不确定应该为此使用哪个分类器。
但是，我不确定在这种情况下/目标我应该真正考虑什么。在我看来，有两种选择：

1. 组感知训练测试拆分，并使用随机森林、knn、svm、xgboost 对每个拆分进行 GroupKFold 交叉验证。按均值汇总所有分割结果，然后选择最佳模型。

2.由于我的目标是找到对类别进行分类的标记，忽略受试者内相关性，直接将数据按样本拆分为训练测试集，并对每个分割使用我上面提到的分类器。按均值汇总所有分割结果，然后选择最佳模型。


分组和目标变量的一般结构如下所示。
我应该如何处理这样的数据？
Ps.这是我的分组结构：
&gt; final_data %&gt;% group_by(group) %&gt;%
+ summarise(count = n()) %&gt;%
+ count(count) %&gt;%
+range(desc(count))
# A tibble: 14 × 2
count n
&lt;int&gt; &lt;int&gt;
1 228 1
2 172 1
3 43 1
4 42 1
5 21 2
6 18 1
7 12 3
8 11 2
9 6 4
10 5 5
11 4 1
12 3 5
13 2 49
14 1 193

以及，目标变量分布：
&gt;表（final_data$stage）

0 1 2 3 
123 565 201 73
]]></description>
      <guid>https://stats.stackexchange.com/questions/660584/how-to-choose-and-evaluate-classifiers-for-multiclass-classification-with-repeat</guid>
      <pubDate>Mon, 27 Jan 2025 07:08:06 GMT</pubDate>
    </item>
    <item>
      <title>在 Hastie 中获取身份</title>
      <link>https://stats.stackexchange.com/questions/660580/deriving-identity-in-hastie</link>
      <description><![CDATA[在 Hastie 的书的第 24 页，恒等式 2.25 中，它说：
$$MSE(x_0) = E(\hat{y_0}-E(\hat{y_0}))^2+(E(\hat{y_0})-f(x_0))^2$$
这将导致偏差-方差分解。
我在推导这个方程时遇到了一些麻烦。我以前从未见过这种“期望中的期望”。更具体地说，我必须证明
$$2E(\hat{y_0}E(\hat{y_0}))-E(E^2(\hat{y_0}))-E^2(\hat{y_0}) = 0$$
因为当我从第 1 行到第 2 行时，除了想要的项之外，我还得到了这个。
对于那些没有这本书的人来说，第一个等式是
$$MSE(x_0)=E(f(x_0)-\hat{y_0})^2$$
我想这很简单……]]></description>
      <guid>https://stats.stackexchange.com/questions/660580/deriving-identity-in-hastie</guid>
      <pubDate>Mon, 27 Jan 2025 05:07:56 GMT</pubDate>
    </item>
    <item>
      <title>使用 cor.test() 和附加置换测试对 Spearman 相关性进行有效性检验</title>
      <link>https://stats.stackexchange.com/questions/660577/validity-of-using-cor-test-and-additional-permutation-testing-for-spearman-cor</link>
      <description><![CDATA[在 ?cor.test 帮助信息中，它指出 对于 Spearman 检验，p 值使用算法 AS 89 计算，其中 n &lt; 1290并且exact = TRUE，否则通过渐近 t 近似计算。请注意，对于 n &lt;，这些是“精确的”。 10，并使用 Edgeworth 级数近似来获取更大的样本量（截止值已从原始论文中更改）。
我还注意到这篇文章 https://stackoverflow.com/questions/77384889/how-to-permute-correlations-between-several-pairs-of-variables-in-r 中的评论，其中使用下面的额外排列检验（随机改组其中一个变量后，有多少测试统计数据大于或等于原始/排列数，在分子和分母上都加 1 以避免为 0），实际上是多余的，因为正如回复者所说，cor.test 正在使用排列（尽管与下面的公式并不完全相同）。
sum(abs(perm_stat) &gt;= abs(orig_stat)) + 1)/N+1

这篇文章让我很困惑，因为尽管样本量为 20，但这个陈述仍然成立，这让我不确定如何使用我自己的数据（n=10）。我假设没有使用 n！排列的精确测试，而是 Edgeworth 近似。现在样本量超过 10，从上面的排列代码计算 p 值不会是多余的吗？
因此，我是否继续保留 exact=True 并从上面计算我的排列 p，还是使用 exact=FALSE？如有任何澄清，我将不胜感激。还使用了 Bonferroni 进行多重检验调整。
最后，我使用置换检验的主要原因是，我可以通过 ggplot 可视化看到 x 和 y 之间的某些相关性很可能由一对观察值驱动。我想通过随机重采样来“检查”这一点。]]></description>
      <guid>https://stats.stackexchange.com/questions/660577/validity-of-using-cor-test-and-additional-permutation-testing-for-spearman-cor</guid>
      <pubDate>Sun, 26 Jan 2025 23:01:37 GMT</pubDate>
    </item>
    <item>
      <title>多级（四级）荟萃分析所需的 rho 项数</title>
      <link>https://stats.stackexchange.com/questions/660572/number-of-rho-terms-needed-for-multi-four-level-meta-analysis</link>
      <description><![CDATA[我正在对随机对照试验 (RCT) 进行多层次荟萃分析，以检查治疗 X 对特定情况 (A) 的影响。我的目标是适当地模拟研究内部和研究之间的差异，以考虑治疗配对之间的影响和异质性。
当前方法
我正在使用一个简单的协方差矩阵和一个具有嵌套随机效应的多级模型来捕获研究内部和研究之间的差异。我还应用了 clubSandwich CR-2 型校正来解释集群稳健标准误差。我当前的代码如下：
# 步骤 1：假设单相关性的协方差矩阵 (r = 0.8)
V &lt;- impute_covariance_matrix(vi =filtered_data$var, cluster =filtered_data$study, r = 0.8)

# 步骤 2：具有嵌套随机效应的多层元分析模型
res &lt;- rma.mv(
yi =filtered_data$es,
V = V,
random = ~ 1 | study/es.id,
data =filtered_data,
sparse = TRUE,
method = &quot;REML&quot;
)

# 步骤 3：集群稳健标准误差
robust_res &lt;- robust(res, cluster =filtered_data$study, clubSandwich = TRUE)

问题：治疗配对
我的数据集中的一些研究包括使用治疗 X 的相同平均值和标准差 (m(SD)) 来估计与两种不同治疗 Y 和 Z 的比较效果的效果。例如：
• 效果大小 1：治疗 X 与治疗 Y
• 效果大小 2：治疗 X 与治疗 Z
鉴于治疗 Y 和 Z 的特征有时非常不同，我想估计这些治疗配对之间的异质性。我修改了模型，使其包含治疗配对变量（例如配对）的随机效应，如下所示：
# 步骤 1：协方差矩阵（不变）
V &lt;- impute_covariance_matrix(vi =filtered_data$var, cluster =filtered_data$study, r = 0.8)

# 步骤 2：修改后的模型，包括治疗配对的随机效应
res &lt;- rma.mv(
yi =filtered_data$es,
V = V,
random = ~ 1 | study/pairing/es.id,
data =filtered_data,
sparse = TRUE,
method = &quot;REML&quot;
)

# 步骤 3：集群稳健标准误差
robust_res &lt;- robust(res, cluster =filtered_data$study, clubSandwich = TRUE)

问题
1. 这种方法是否充分说明？
通过假设研究中的单一相关性（r = 0.8），这是否适当地模拟了治疗配对之间的方差（例如，X vs. Y 和 X vs. Z）？还是这过于简化了结构？

2. 我是否需要更复杂的方差-协方差矩阵？
我是否应该生成一个自定义方差-协方差矩阵，除了研究级相关性（r）之外，还包含治疗配对的额外相关参数（例如，rho_pairing）？如果是这样，如何在 metafor 中有效地实现这一点？
我想确保我的模型能够捕捉到效应之间的共享方差，同时准确估计治疗配对导致的异质性。]]></description>
      <guid>https://stats.stackexchange.com/questions/660572/number-of-rho-terms-needed-for-multi-four-level-meta-analysis</guid>
      <pubDate>Sun, 26 Jan 2025 19:47:50 GMT</pubDate>
    </item>
    </channel>
</rss>