<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>最近的问题 - 交叉验证</title>
    <link>https://stats.stackexchange.com/questions</link>
    <description>来自 stats.stackexchange.com 的最新 30 条</description>
    <lastBuildDate>Mon, 08 Jul 2024 15:16:20 GMT</lastBuildDate>
    <item>
      <title>多变量 t 检验等价物 - 对照组与干预组</title>
      <link>https://stats.stackexchange.com/questions/650677/multivariate-t-test-equivalent-control-versus-intervention</link>
      <description><![CDATA[假设有两组具有相同的因变量和自变量。

因变量 = 治疗开始时间 - 连续。
自变量 = 护理点测试 - Y/N。

在上述单变量上下文中，用于评估组间平均差异的非配对 t 检验似乎是合适的（一旦建立了所有 t 检验要求）。
但是，假设您希望控制风险因素（例如，糖尿病状况、社会剥夺等）。
哪种模型可用于控制风险并仍在两组之间进行 t 检验？
任何帮助都将不胜感激。]]></description>
      <guid>https://stats.stackexchange.com/questions/650677/multivariate-t-test-equivalent-control-versus-intervention</guid>
      <pubDate>Mon, 08 Jul 2024 15:01:00 GMT</pubDate>
    </item>
    <item>
      <title>仅对一个个体进行相关观测的回归</title>
      <link>https://stats.stackexchange.com/questions/650676/regression-with-dependent-observations-of-only-one-individual</link>
      <description><![CDATA[上周，我接到一项任务，计划我的团队希望执行的分析。
我的目标是衡量一位医生是否同意某个工具为一组 N 幅医学图像生成的输出。为此，我会让他查看每幅图像和每个模型输出并回答一份简短的问卷。我的 Y 变量可能是二进制（同意/不同意）或李克特量表（1-5）；我还没有决定。其他 X 变量将是其他问题的答案，我想用 X 因子解释 Y 变异性，例如，看看哪些因素与医生的同意有关。
我最初的想法是使用广义线性模型 (GLM)，但我的观察结果不是独立的。虽然我可以要求医生在 10 份问卷之间等待一段时间，以尝试减少遗留效应，但不能保证 (1) 他真的会这样做，并且 (2) 这样做会有效，因为尽管存在哲学问题，但他仍然是同一个人。我可以继续这样做并尝试测试独立性，但如果这个假设不成立，我该怎么办？
经过一些初步研究，我想到了一些选择，但由于我对它们不熟悉，我希望得到一些反馈，如果可能的话，一些参考资料。

在 GAMLSS 模型中添加随机项 - 这可行吗？或者也许使用广义线性混合模型 (GLMM)？如果我只有一个集群变量（一个专家），这是否有意义？

使用时间序列回归分析，例如 $$Y_t \sim Y_{t-1} + X1_t + X2_t + ...$$ 这个选项在我看来过于复杂，而且我不太确定我是否能用它回答我的问题。

]]></description>
      <guid>https://stats.stackexchange.com/questions/650676/regression-with-dependent-observations-of-only-one-individual</guid>
      <pubDate>Mon, 08 Jul 2024 14:29:21 GMT</pubDate>
    </item>
    <item>
      <title>效应量分析：Cohen 的 D、Pearson 的 r，还是其他？</title>
      <link>https://stats.stackexchange.com/questions/650675/effect-size-analysis-cohens-d-pearsons-r-or-something-else</link>
      <description><![CDATA[我正在尝试对大坝泄洪对下游温度的影响进行效应量分析。我有一个大型数据集，其中包含在大坝下游各个站点获取温度读数的数据记录器。我试图将这些下游站点与放置在大坝脚下的温度计（作为我的独立变量）进行比较。问了几个问题后，似乎效应量分析就是我所寻找的。做了一些研究后，我看到很多关于 Cohen&#39;s d 和 Pearson&#39;s r 的提及。
我通过移动数据以适应水的行进时间来控制下游的行进时间。我还对数据进行了 24 小时的中央平均值，试图消除水温的昼夜波动，希望不会对相关性产生偏差（这就是为什么 24hrAVG 列在数据集的开头有这么多 NA 的原因）。这是我的数据集。
&gt; dput(head(SaltData_))
structure(list(Date = structure(c(1709942400, 1709943300, 1709944200, 
1709945100, 1709946000, 1709946900), tzone = &quot;UTC&quot;, class = c(&quot;POSIXct&quot;, 
&quot;POSIXt&quot;)), S1 = c(12.824443359375, 12.824443359375, 12.824443359375, 
12.824443359375, 12.824443359375, 12.78154296875), S2 = c(12.86734375, 
12.86734375, 12.86734375, 12.910244140625, 12.86734375, 12.824443359375
), S3 = c(12.223837890625, 12.223837890625, 12.26673828125, 12.26673828125, 
12.223837890625, 12.26673828125), S4 = c(NA, NA, NA, NA, 7.8908984375, 
7.847998046875), S5 = c(NA_real_, NA_real_, NA_real_, NA_real_, 
NA_real_, NA_real_), S6 = c(NA_real_, NA_real_, NA_real_, NA_real_, 
NA_real_, NA_real_), S7 = c(NA_real_, NA_real_, NA_real_, NA_real_, 
NA_real_, NA_real_), S8 = c(12.309638671875, 12.309638671875, 
12.26673828125, 12.3525390625, 12.3525390625, 12.309638671875
), S9 = c(NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_
), S10 = c(NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, 
NA_real_), S11 = c(NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, 
NA_real_), 仪表温度 = c(8.2, 8.2, 8.2, 8.2, 8.2, 8.2), 仪表高度 = c(70.83, 
70.84, 70.84, 70.85, 70.83, 70.83), 列 1 = c(NA, NA, NA, 
NA, NA), `24hrAVG S1` = c(NA_real_, NA_real_, NA_real_, NA_real_, 
NA_real_, NA_real_), `24 小时平均值 S4` = c(NA_real_, NA_real_, NA_real_, 
NA_real_, NA_real_, NA_real_), `24 小时平均值 S5` = c(NA_real_, NA_real_, 
NA_real_, NA_real_, NA_real_, NA_real_), `24 小时平均值 S6` = c(NA_real_, 
NA_real_, NA_real_, NA_real_, NA_real_, NA_real_), `24 小时平均值 S7` = c(NA_real_, 
NA_real_, NA_real_, NA_real_, NA_real_, NA_real_), `24 小时平均值 S8` = c(NA_real_, 
NA_real_, NA_real_, NA_real_, NA_real_, NA_real_), `24hrAVG S9` = c(NA_real_, 
NA_real_, NA_real_, NA_real_, NA_real_, NA_real_), `24hrAVG S10` = c(NA_real_, 
NA_real_, NA_real_, NA_real_, NA_real_, NA_real_), `24hrAVG S11` = c(NA_real_, 
NA_real_, NA_real_, NA_real_, NA_real_, NA_real_), `24hrAVG GaugeTemp` = c(NA_real_, 
NA_real_, NA_real_, NA_real_, NA_real_, NA_real_), `24hrAVG GaugeHeight` = c(NA_real_, 
NA_real_, NA_real_, NA_real_, NA_real_, NA_real_)), row.names = c(NA, 
-6L), class = c(&quot;tbl_df&quot;, &quot;tbl&quot;, &quot;data.frame&quot;))

在进行了一些 Pearson r 相关性测试后，似乎这个测试没有找到我期望的结果。大坝泄水的相关性/影响最初随着您向下游前进而下降（即 S4 和 GaugeTemp r 为 0.92，S5 和 GaugeTemp r 为 0.843，S6 和 GaugeTemp r 为 0.8276），但只要到达站点 S7（0.828）就会回升并继续保持这种状态。我应该看到的是，随着你向下游前进，相关性/效应大小会稳步下降，因为越来越多的支流冲走了大坝泄洪效应。
所以我想知道的是，科恩的 d 是否能解决我的问题，或者我是否在正确的地方考虑使用 Pearson 的 r 或科恩的 d 来计算效应大小。我在这个问题上挣扎了很长时间，所以任何帮助都会非常感激。如果需要，我还可以提供更多数据/图表，只需在评论中告诉我，我很乐意分享。]]></description>
      <guid>https://stats.stackexchange.com/questions/650675/effect-size-analysis-cohens-d-pearsons-r-or-something-else</guid>
      <pubDate>Mon, 08 Jul 2024 14:25:32 GMT</pubDate>
    </item>
    <item>
      <title>对生物数据的几何平均比率进行 GLS</title>
      <link>https://stats.stackexchange.com/questions/650674/gls-on-geometric-mean-ratio-from-biological-data</link>
      <description><![CDATA[我的数据是生物数据，其中有 10 种蛋白质，我已测量它们在来自 (N=42) 名参与者的不同 (N=8) 个样本中的浓度。所有这些样本均来自同一参与者，因此它们不是独立的。
我已计算每种样本类型每种蛋白质的几何平均比率 (GMR)：
GMR = 样本类型 (y) 中蛋白质 (x) 的几何平均值 / 所有样本类型中蛋白质 (x) 的平均几何平均值
我的问题是，根据样本类型测量的浓度是否存在差异（因此，本质上是比较样本类型）。
因此，我认为使用具有异质化合物对称性的 GMR 可能是探索这个问题的合适方法。但是，我对此还很陌生，我不确定我的方法是否正确。
这是我目前在 R 中得到的结果：
gls(GMR ~ 1 + Sampling_Method , 
correlation=corCompSymm(form = ~Sampling_Method|Proteins),
weights = varIdent(form = ~1 | Sampling_Method), 
data = da)

AIC BIC logLik
226.4127 270.0066 -96.20636

在这种情况下（使用 GMR），这是否是 GLS 模型的适当应用，还是违反直觉？
我很感激任何想法/提示。]]></description>
      <guid>https://stats.stackexchange.com/questions/650674/gls-on-geometric-mean-ratio-from-biological-data</guid>
      <pubDate>Mon, 08 Jul 2024 14:23:34 GMT</pubDate>
    </item>
    <item>
      <title>使用皂膜平滑器进行问题拟合和绘制 GAM</title>
      <link>https://stats.stackexchange.com/questions/650673/issue-fitting-and-plotting-gam-with-soap-film-smoother</link>
      <description><![CDATA[我在使用 R 中的 mgcv 拟合游戏时遇到问题，正在寻求帮助。简而言之，我有一个数据集，其中包含在大型湖泊系统中的接收器处检测到的两组（孵化场或野生）之一的鱼的数量。这些接收器放置在特定位置，具有唯一的经度和纬度。该数据集是在 4 年内收集的。我希望对研究期间每组接收器处检测到的鱼的数量进行建模。我在 R 中使用 mgcv 完成了此操作，代码如下：
mod1 &lt;- gam(number_of_fish ~ s(x, y, by = origin, k = 40) + s(study_year, k = 3) + origin, offset = log(max_fish),
data = n_fish_spring_utm, 
family=nb(link = &#39;log&#39;),
method = &quot;REML&quot;)

这里，我使用偏移量来表示每组中可以检测到的最大鱼数的对数，因为两组的鱼数不同。我还使用了负二项分布。
这个模型似乎运行良好。
参数系数：
估计标准差。误差 z 值 Pr(&gt;|z|) 
(截距) -2.83417 0.02592 -109.327 &lt; 2e-16 ***
originWild 0.31964 0.04188 7.632 2.3e-14 ***
---
Signif。代码：0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

平滑项的近似显著性：
edf Ref.df Chi.sq p 值 
s(x,y):originHatchery 16.393 21.146 252.9 &lt;2e-16 ***
s(x,y):originWild 12.041 16.024 144.5 &lt;2e-16 ***
s(study_year) 1.871 1.983 274.2 &lt;2e-16 ***
---
显著性。代码：0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

R-sq.(adj) = 0.306 偏差解释 = 50.2%
-REML = 2258.5 尺度估计 = 1 n = 1347


但是，我的湖泊系统有很多轮廓和一些大岛屿，我想使用肥皂膜平滑器来解释它们。
我使用湖泊系统的 shapefile 生成了肥皂膜表面，并使用 soapcheckr() 包检查一切是否正常（即没有结落在边界之外）。

然后我运行了以下模型，包括肥皂膜平滑器：
mod2 &lt;- gam(number_of_fish ~ s(x, y, by = origin, k = 40, bs = &quot;so&quot;, xt = list(bnd = border.aut, nmax=1500)) + s(study_year, k = 3) + origin, offset=log(max_fish),
data = n_fish_spring_utm, 
family=nb(link = &#39;log&#39;),
method = &quot;REML&quot;, 
knots = lake_knots)

模型运行良好。
参数系数：
估计标准差。误差 z 值 Pr(&gt;|z|)
(截距) -2.8287 4.4271 -0.639 0.523
originWild 0.2641 13.2274 0.020 0.984

平滑项的近似显著性：
edf Ref.df Chi.sq p 值 
s(x,y):originHatchery 42.000 42.00 216.9 &lt;2e-16 ***
s(x,y):originWild 42.000 42.00 173.2 &lt;2e-16 ***
s(study_year) 1.827 1.97 230.4 &lt;2e-16 ***
---
显著性代码：0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

排名：308/866
R-sq.(adj) = 0.307 偏差解释 = 52.7%
-REML = 1640 尺度估计 = 1 n = 1347

但是，这些图似乎不合理，表明没有检测到任何鱼。


我也无法像以前一样使用 gratia() 包从我的模型生成图表。我收到以下错误消息：
`mutate()` 中的错误：ℹ在参数中：`.loop = rep(seq_along(pts), each = pts)`。由错误引起：！`.loop` 的大小必须是 536 或 1，而不是 1446。

我已经摆弄了大约一个星期，但似乎无法解决这个问题。任何帮助，甚至是正确方向的推动都将不胜感激！
代码、数据和 shapefile 可以在这里找到。
提前致谢！]]></description>
      <guid>https://stats.stackexchange.com/questions/650673/issue-fitting-and-plotting-gam-with-soap-film-smoother</guid>
      <pubDate>Mon, 08 Jul 2024 13:39:39 GMT</pubDate>
    </item>
    <item>
      <title>在期望最大化中，在最大化步骤中，我们是否最大化对数似然的期望（维基百科）或证据下限（cs 229）？</title>
      <link>https://stats.stackexchange.com/questions/650670/in-expectation-maximization-in-the-maximization-step-do-we-maximize-expectatio</link>
      <description><![CDATA[摘自 cs 229 第 6 页：

直观地讲，EM 算法通过以下方式交替更新 Q 和 θ：a) 按照公式 (8) 设置
Q(z) = p(z|x; θ)，使得 ELBO(x; Q, θ) = log p(x; θ)
对于 x 和当前 θ，以及 b) 最大化 ELBO(x; Q, θ) w.r.t θ，同时固定 Q 的选择。

即也就是说，
ELBO 是
$$\Sigma_{z}Q(z)\log[\frac{p(X,Z;\theta)}{Q(Z)}]$$
其中 Q(z) 设置为在期望步骤中给定 x 时 z 的后验。这种 $Q(Z)$ 的选择使 ELBO 最接近证据 ($P(X,Z;\theta)$)
$$Q(Z) = p(Z/X;\theta)$$
来自 维基百科:

哪个一个是正​​确的？分母有$Q(Z)$差异。如果它们都相同，怎么办？]]></description>
      <guid>https://stats.stackexchange.com/questions/650670/in-expectation-maximization-in-the-maximization-step-do-we-maximize-expectatio</guid>
      <pubDate>Mon, 08 Jul 2024 11:36:27 GMT</pubDate>
    </item>
    <item>
      <title>brms 模型中的 Conditional_effects() 图具有一致 0 概率的响应类别（平面图）</title>
      <link>https://stats.stackexchange.com/questions/650668/conditional-effects-plots-from-brms-model-has-a-response-category-with-consist</link>
      <description><![CDATA[]]></description>
      <guid>https://stats.stackexchange.com/questions/650668/conditional-effects-plots-from-brms-model-has-a-response-category-with-consist</guid>
      <pubDate>Mon, 08 Jul 2024 11:18:43 GMT</pubDate>
    </item>
    <item>
      <title>利用时间序列预测能源价格</title>
      <link>https://stats.stackexchange.com/questions/650667/energy-price-prediction-with-time-series</link>
      <description><![CDATA[我正在从事一个涉及时间序列数据的项目。我必须预测$$\text{return}_t=\frac{\text{price}_t - \text{price}_{t-1}}{\text{price}_{t-1}}$$
我通过特征工程选择特征。先前的收益滞后和收益的一阶差分滞后是特征。我读过一些论文，他们使用收益的一阶差分滞后来预测收益序列的一阶差分。我可以使用这些特征来预测收益序列，而不是收益序列的一阶差分吗？]]></description>
      <guid>https://stats.stackexchange.com/questions/650667/energy-price-prediction-with-time-series</guid>
      <pubDate>Mon, 08 Jul 2024 10:13:07 GMT</pubDate>
    </item>
    <item>
      <title>贝塔随机变量的乘积与和的分布</title>
      <link>https://stats.stackexchange.com/questions/650663/distribution-of-product-and-sum-of-beta-random-variables</link>
      <description><![CDATA[我有一组概率，我将其建模为（独立的）$p_{Ai} \sim Beta(\alpha_{Ai},\beta_{Ai})$ 和 $p_{Bi} \sim Beta(\alpha_{Bi},\beta_{Bi})$。我正在计算以下乘积：
$$ Y = \sum_{i=0}^N p_{Ai}^{nA}(1-p_{Bi})^{nB} + p_{Bi}^{nB}(1-p_{Ai})^{nA},$$
其中 $n_{Ai}$ 和 $n_{Bi}$ 为整数。我想推断（近似）$Y$ 的分布。由于 $Y$ 是倾斜的且在实数线中定义，所以我想将 Beta-Prime 分布拟合到我的直方图中。这样对吗？您能否给我一些关于 $Y$ 的真实分布或更好的近似值的见解？
PD。如果之前有人问过类似的问题，请见谅。]]></description>
      <guid>https://stats.stackexchange.com/questions/650663/distribution-of-product-and-sum-of-beta-random-variables</guid>
      <pubDate>Mon, 08 Jul 2024 08:59:56 GMT</pubDate>
    </item>
    <item>
      <title>条件逻辑（离散 Cox PH）回归模型</title>
      <link>https://stats.stackexchange.com/questions/650662/conditional-logistic-discrete-cox-ph-regression-model</link>
      <description><![CDATA[我对离散时间生存模型这个主题非常陌生。我在 R 包 powerSurvEpi 中找到了以下函数。似乎 powerConLogistic.bin 函数可用于 #二元协变量条件逻辑回归的样本量计算#，遵循 Lachin, JM 使用条件逻辑（离散 Cox PH）回归模型的分数检验对多重匹配病例对照研究进行样本量评估。 所以我想知道后续函数是否可以用于离散 Cox PH，因为我的理解是离散 Cox PH 和条件逻辑回归是不同的统计建模。
 powerConLogistic.bin(
N = NULL,
power = 0.8,
OR,
pE,
nD,
nH,
R2 = 0,
alpha = 0.05,
nTests = 1,
OR.low = 1.01,
OR.upp = 100
)
]]></description>
      <guid>https://stats.stackexchange.com/questions/650662/conditional-logistic-discrete-cox-ph-regression-model</guid>
      <pubDate>Mon, 08 Jul 2024 08:51:28 GMT</pubDate>
    </item>
    <item>
      <title>使用 R STM 包分析评论评级-样本平衡问题</title>
      <link>https://stats.stackexchange.com/questions/650661/analyzing-review-rating-using-r-stm-package-sample-balance-issue</link>
      <description><![CDATA[由于在线评论评分呈正偏J型分布/评分分布不平衡，一些学者倾向于平衡样本量，即随机选择正面评分评论，使其数量与负面评分评论数量相等或相似。如下面介绍的论文：
论文1：酒店顾客抱怨什么？使用结构化主题模型进行文本分析
论文 2：药物消费者的声音：使用结构化主题模型进行在线文本评论分析
除了研究主题比例（正面 vs. 负面）的差异（例如论文 1，图 2）之外，我还想使用线性回归研究主题与评分之间的关​​系。如果我对主题比例的差异进行分析，似乎我必须删除一些评论才能实现样本平衡，但如果我只运行线性回归，则没有必要这样做。
在这种情况下，有没有不删除样本同时解决样本不平衡问题的解决方案？]]></description>
      <guid>https://stats.stackexchange.com/questions/650661/analyzing-review-rating-using-r-stm-package-sample-balance-issue</guid>
      <pubDate>Mon, 08 Jul 2024 08:17:13 GMT</pubDate>
    </item>
    <item>
      <title>能否根据先验知识确定 VAR 中的预测步骤数？</title>
      <link>https://stats.stackexchange.com/questions/650660/can-one-determine-the-number-of-forecast-prediction-steps-in-a-var-on-a-priori-g</link>
      <description><![CDATA[我的问题背景：我正在使用两个长度相等的时间序列（n ~ 750 个数据点）运行向量自回归 (VAR) 模型。滞后是根据贝叶斯信息准则 (BIC) 选择的，最后我在两个时间序列之间运行格兰杰因果关系 (GC)。
目前，我在 80% 的数据上训练了 VAR，因此将最后 20% 的数据用于测试或预测。由于这两个时间序列都是非平稳的，因此我在运行 GC 之前对它们都应用了一阶差分来训练 VAR。值得注意的是，原始时间序列（非差分）不包含重复的时间模式，即不包含季节性等。
我最终想评估 VAR 的预测效果，并想到使用所讨论时间序列的实际值和预测值之间的均方根误差 (RMSE) 的想法（假设时间序列 B 是预测值，而 Granger 是由时间序列 A 引起的）。
&quot;问题&quot;：我绘制了预测值与实际值的图表，发现只有前 4 到 5 个值预测得好。从第 6 个值开始的下一个时间点预测毫无意义。在时间点 5 之后，预测收敛为一条水平直线，也就是说，它看起来只是继续预测（差分）时间序列的平均值，而不再大致遵循数据的实际时间模式。
问题：我有两个问题。

根据时间序列的动态或属性，对约 600 个数据点（80% 的数据）进行训练的 VAR 只能很好地预测 4 到 5 个值，这正常吗？这是预料之中的吗？特别是因为我的数据基于一个没有重复时间结构或模式的过程？
最重要的是，有没有办法先验地确定或选择我想要预测的步骤数？是否有统计测试或工具可以定量选择预测步骤的数量，还是这总是取决于上下文和主观标准？第二个问题对我来说很重要，涉及 RMSE。如果我根据对实际值与预测值的目视检查来选择后验预测步数，那么在 RMSE 估计方面感觉就像作弊一样。
]]></description>
      <guid>https://stats.stackexchange.com/questions/650660/can-one-determine-the-number-of-forecast-prediction-steps-in-a-var-on-a-priori-g</guid>
      <pubDate>Mon, 08 Jul 2024 08:14:16 GMT</pubDate>
    </item>
    <item>
      <title>卡方比分布 [关闭]</title>
      <link>https://stats.stackexchange.com/questions/650659/distribution-of-ratio-of-chi-square</link>
      <description><![CDATA[
我遇到了这个问题，我知道这两个卡方随机变量不是独立的，但无法证明这一点，我不知道如何找到两个相关卡方随机变量的比率分布。我不明白第四个选项是如何正确的]]></description>
      <guid>https://stats.stackexchange.com/questions/650659/distribution-of-ratio-of-chi-square</guid>
      <pubDate>Mon, 08 Jul 2024 07:59:36 GMT</pubDate>
    </item>
    <item>
      <title>我可以将与结果变量相关的变量纳入统计分析吗？</title>
      <link>https://stats.stackexchange.com/questions/650656/can-i-include-a-variable-related-to-the-outcome-variable-into-statistical-analys</link>
      <description><![CDATA[我的研究问题是关于疫情期间的接触模式，以及在全国封锁期间接触更多人的人有哪些特征。
结果变量是使用封锁期间（第三波）的接触人数 - 封锁前（第一波）的接触人数计算得出的变量。
例如，一位参与者在第一波期间联系了 24 人，在第二波期间联系了 10 人，在第三波期间联系了 45 人。那么对于这个人，结果变量是 gap = 45 - 24 = 21。
自变量包括：年龄、性别、教育、就业状况、婚姻状况、交通方式和城市。
还有一个变量我想包括，那就是三波接触人数的标准差。对于这个人，那就是：
R
&gt; sd(c(24, 10, 45))
[1] 17.61628

然后我建立了一个广义加性混合效应模型 (GAMMs)。
gamm(gap_adjusted ~ age_cat2 + Sex + Education2 + Employment2 + region + hh_cat3 + Marital2 + Country2 + Transport2 + Weekend + IIV1, random = list(city = ~ 1) , data = part_235_gap, family = Gamma(link = &quot;log&quot;)) 
# 因为 gap 的范围是 -10, 10，所以 gap_adjusted = gap + 11
# IIV1 是三波接触次数的标准差。

结果表明 gap_adjusted 和 IIV1 之间存在统计学上的显著关联。这种方法合适吗？]]></description>
      <guid>https://stats.stackexchange.com/questions/650656/can-i-include-a-variable-related-to-the-outcome-variable-into-statistical-analys</guid>
      <pubDate>Mon, 08 Jul 2024 07:08:26 GMT</pubDate>
    </item>
    <item>
      <title>理解经验贝叶斯</title>
      <link>https://stats.stackexchange.com/questions/650654/understanding-empirical-bayes</link>
      <description><![CDATA[我正在尝试理解经验贝叶斯的基础知识。我发现自己很难理解这一点，所以我尝试创建一个涉及估计硬币成功概率的玩具示例。
1) 传统贝叶斯分析（Beta-二项式共轭）：
考虑一系列 $n$ 次硬币抛掷，其中我们观察到 $X$ 次正面。假设正面朝上的真实概率为 $\theta$，则观察到 $X$ 正面朝上的可能性为二项式：
$$
P(X|\theta) = \binom{n}{X} \theta^X (1-\theta)^{n-X}
$$
为正面朝上概率选择 Beta 先验分布 $\theta$：
$$
P(\theta) = \text{Beta}(\alpha, \beta) = \frac{\theta^{\alpha-1} (1-\theta)^{\beta-1}}{B(\alpha, \beta)}
$$
使用贝叶斯定理，后验分布与似然乘以先验成正比：
$$
P(\theta|X) \propto P(X|\theta) P(\theta)
$$
代入二项式似然和 Beta 先验，我们得到：
$$
P(\theta|X) \propto \theta^X (1-\theta)^{n-X} \cdot \theta^{\alpha-1} (1-\theta)^{\beta-1}
$$
$$
P(\theta|X) \propto \theta^{X+\alpha-1} (1-\theta)^{n-X+\beta-1}
$$
因此，后验分布也是一个Beta 分布：
$$
P(\theta|X) = \text{Beta}(X + \alpha, n - X + \beta)
$$
2) 经验贝叶斯：
在经验贝叶斯中，先验的参数似乎是根据数据估计出来的，而不是事先选择的。
对我来说，使用矩量法（而不是 MLE）来估计 Beta 先验的参数 $\alpha$ 和 $\beta$ 更有意义。
成功的样本均值 $\hat{\theta}$ 和样本方差 $s^2$可以使用概率：
$$
\hat{\theta} = \frac{\sum_{i} X_i}{\sum_{i} n_i}
$$
$$
s^2 = \frac{\sum_{i} X_i (n_i - X_i)}{n_i^2 (n_i - 1)}
$$
使用矩方法，我们将样本均值和方差等同于 Beta 分布的均值和方差：
$$
\hat{\theta} = \frac{\alpha}{\alpha + \beta}
$$
$$
s^2 = \frac{\alpha \beta}{(\alpha + \beta)^2 (\alpha + \beta + 1)}
$$
求解这些方程中的 $\alpha$ 和 $\beta$，我们得到：
$$
\alpha = \hat{\theta} \left( \frac{\hat{\theta} (1 - \hat{\theta})}{s^2} - 1 \right)
$$
$$
\beta = (1 - \hat{\theta}) \left( \frac{\hat{\theta} (1 - \hat{\theta})}{s^2} - 1 \right)
$$
现在，我们继续分析，就像它是常规贝叶斯：
可能性保持不变：
$$
P(X_i|\theta_i) = \binom{n_i}{X_i} \theta_i^{X_i} (1 - \theta_i)^{n_i - X_i}
$$
先验现在基于数据：
$$
P(\theta_i) = \text{Beta}(\hat{\alpha}, \hat{\beta})
$$
后验分布为：
$$
P(\theta_i|X_i) \propto \theta_i^{X_i + \hat{\alpha} - 1} (1 - \theta_i)^{n_i - X_i + \hat{\beta} - 1}
$$
$$
P(\theta_i|X_i) = \text{Beta}(X_i + \hat{\alpha}, n_i - X_i + \hat{\beta})
$$
这是正确的想法吗？经验贝叶斯与传统贝叶斯完全相同......但它使用数据来估计先验的参数？]]></description>
      <guid>https://stats.stackexchange.com/questions/650654/understanding-empirical-bayes</guid>
      <pubDate>Mon, 08 Jul 2024 05:39:30 GMT</pubDate>
    </item>
    </channel>
</rss>