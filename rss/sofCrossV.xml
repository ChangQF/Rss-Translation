<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>最近的问题 - 交叉验证</title>
    <link>https://stats.stackexchange.com/questions</link>
    <description>来自 stats.stackexchange.com 的最新 30 条</description>
    <lastBuildDate>Sun, 13 Oct 2024 12:29:57 GMT</lastBuildDate>
    <item>
      <title>使用边际效应包 - avg_slopes() 或 slopes() 加权后从 brms 模型中提取连续效应？</title>
      <link>https://stats.stackexchange.com/questions/655722/extracting-continuous-effects-from-a-brms-model-after-weighting-using-the-margin</link>
      <description><![CDATA[我想估计连续变量 perc_quality_plus_palms 对 Forest.dependency（3 个类别）和 Trophic.Niche（4 个类别；均为物种级属性）的每个组合中不同鸟类数量数量的因果影响。这是一个相当复杂的分层贝叶斯模型，我事先进行了加权：
brm(
bf(CountVisit | weights(weights) ~ t2(perc_quality_plus_palms, Forest.dependency, Trophic.Niche, bs = c(&quot;cr&quot;, &quot;re&quot;, &quot;re&quot;)) +
(1 + perc_quality_plus_palms | name_latin) +
(1 | square_ID / point_ID) +
(offset(effArea2)),
zi ~ perc_quality_plus_palms + (1|name_latin)
),
data = bird.i,
family = zero_inflated_poisson(),
chains = 4,
cores = 4,
iter = 3000,
warmup = 1000,
prior = my_priors
)
我我一直在关注这篇博文，当时我估计了 perc_quality_plus_palms 对简单 lm 模型中不同结果的影响（即我使用了 avg_predictions 和 avg_slopes）。但是，我现在不确定如何（使用 marginaleffects 包）评估 perc_quality_plus_palms 是否对每个森林依赖性-生态位组合的 perc_quality_plus_palms 连续体产生影响。
我尝试遵循博文的逻辑并使用了 avg_slopes（见下文），但是，通过阅读 marginaleffects 包上的其他信息，我现在不确定这是否合适，以及我是否应该改用 slopes()？
任何对此的见解都将不胜感激！
values &lt;- with(birds.i, seq(quantile(perc_quality_plus_palms, .1),
quantile(perc_quality_plus_palms, .9),
length.out = 100))
avg_slopes(my_brm_wfh_splines_nicedep, newdata = datagridcf(perc_quality_plus_palms = values,Forest.dependency = &quot;Medium&quot;, Trophic.Niche = &quot;Frugivore&quot;, grid_type = &quot;counterfactual&quot;),variables = &quot;perc_quality_plus_palms&quot;, by = &quot;perc_quality_plus_palms&quot;, ndraws = 300, re_formula = NA, dpar = &quot;mu&quot;)]]></description>
      <guid>https://stats.stackexchange.com/questions/655722/extracting-continuous-effects-from-a-brms-model-after-weighting-using-the-margin</guid>
      <pubDate>Sun, 13 Oct 2024 10:30:16 GMT</pubDate>
    </item>
    <item>
      <title>预测序数成绩的评分系统</title>
      <link>https://stats.stackexchange.com/questions/655721/scoring-system-to-predict-ordinal-grades</link>
      <description><![CDATA[我目前正在从事一个医学研究项目。我们正在尝试建立一个评分系统来预测手术难度。我们收集了数据（约 150 例手术），包括术前变量和手术难度等级（1、2 和 3 级）。我们进行了有序回归分析（单变量和多变量），发现 3 个变量（二项式、二项式和有序变量）对难度等级有显著影响。
我们设法为每个变量建立了一个加权分数的系统，并预测二项式难度（1 和 2 为容易，3 为困难），但我们更希望建立一个系统来预测序数等级（1、2 和 3）。
有什么建议，让我们可以建立评分系统来从 3 个变量预测序数难度等级（1、2 和 3）？提前感谢您的帮助！]]></description>
      <guid>https://stats.stackexchange.com/questions/655721/scoring-system-to-predict-ordinal-grades</guid>
      <pubDate>Sun, 13 Oct 2024 10:23:51 GMT</pubDate>
    </item>
    <item>
      <title>如何研究事件$X_1 \geq X_2$和$X_1 \geq X_3$之间的相关性？</title>
      <link>https://stats.stackexchange.com/questions/655719/how-to-study-the-correlation-between-the-events-x-1-geq-x-2-and-x-1-geq-x-3</link>
      <description><![CDATA[考虑$X_1$同时大于或等于$X_2$和$X_3$的概率，其中$X_i \sim N(\mu_i, \sigma_i^2)$，其中$i=1, 2, 3$。我很好奇，当方差发生变化时，这个概率会发生什么变化，或者至少更好地理解$P(X_1 \geq X_2, X_1 \geq X_3)$的行为。
在之前的回答中（这里），使用这个结果，当$\mu_1=\mu_2=\mu_3$时，类似地，我们可以定义$V=X_1-X_2$，$U=X_1- X_3$ 并
获得 $P(X_1 \geq X_2, X_1 \geq X_3)= P(V \geq 0, U\geq0) = \frac{1}{4} \frac{sin^{-1} \rho}{2 \pi}$。
在上述问题 $P(V\geq 0, U \leq 0)$ 中，它从 $\frac{cos^{-1} \rho}{2 \pi}$ 简化为 $\frac{1}{2} cos^{-1} \left( \frac{\sigma_{X_1}^2}{\sqrt{(\sigma_{X_1}^2+\sigma_{X_2}^2)(\sigma_{X_1}^2+\sigma_{X_3}^2})} \right)$，但我不完全明白如何做到这一点，以及如何使用相同的方法获得 $\frac{1}{4} \frac{sin^{-1} \rho}{2 \pi}$ 的值。
此外，对于 $P(V\geq 0, U \geq 0)$，将 $\rho$ 解释为事件 $V 之间的相关性是正确的\geq 0$ 和 $U\geq0$?
如果我可以再问一个问题，关于如何将这种方法推广到 $i=1,...,n$，您有什么想法吗？]]></description>
      <guid>https://stats.stackexchange.com/questions/655719/how-to-study-the-correlation-between-the-events-x-1-geq-x-2-and-x-1-geq-x-3</guid>
      <pubDate>Sun, 13 Oct 2024 09:06:16 GMT</pubDate>
    </item>
    <item>
      <title>使用二元分类查找不平衡数据集的权重[重复]</title>
      <link>https://stats.stackexchange.com/questions/655716/find-weights-for-imbalanced-dataset-with-binary-classification</link>
      <description><![CDATA[我有一个不平衡的数据集，包含二元分类（1 或 0）。如何使用 LSTM 找到两个类别的最佳权重？
数据集中的比例为 886:1 和 30000:0。有人能解释一下如何执行欠采样和过采样来解决数据集不平衡造成的问题吗？我更愿意使用权重方法，而不是欠采样/过采样。]]></description>
      <guid>https://stats.stackexchange.com/questions/655716/find-weights-for-imbalanced-dataset-with-binary-classification</guid>
      <pubDate>Sun, 13 Oct 2024 07:13:24 GMT</pubDate>
    </item>
    <item>
      <title>2 个受试者间，2 个受试者内，以及 2 个 DV</title>
      <link>https://stats.stackexchange.com/questions/655715/2-between-subjects-and-2-within-subjects-and-2-dv</link>
      <description><![CDATA[我的数据包含以下特征：

受试者间因素：组别（干预 A 与干预 B）
受试者内因素：时间（前与后）
因变量：焦虑（量表 A）和行为（量表 B）
个人：48

您会推荐哪种数据分析来处理这些数据？]]></description>
      <guid>https://stats.stackexchange.com/questions/655715/2-between-subjects-and-2-within-subjects-and-2-dv</guid>
      <pubDate>Sun, 13 Oct 2024 06:20:25 GMT</pubDate>
    </item>
    <item>
      <title>我们可以通过对随机效应取平均来计算 GLMM 的总体平均响应吗？</title>
      <link>https://stats.stackexchange.com/questions/655713/can-we-calculate-population-mean-response-from-glmm-by-averaging-over-random-eff</link>
      <description><![CDATA[我试图了解当我们用非线性链接函数拟合数据的广义线性混合模型时，如何估计协变量对总体平均响应的影响。我参考了 Fitzmaurice et al. (2011) 的第 13.3 节来进行讨论。

例如，考虑具有随机变化截距的逻辑回归模型，
$$logit\{E( Y_i|b_i )\} = X_i\beta^* + b_i,$$其中 $b_i \sim {N(0, \sigma_b ^2)}$。

设 $e^{X_i\beta^* \ + \ b_i} = c$。

边际均值或边际成功概率的隐含模型为

$$ 
E(Y_i) = \int_{-\infty}^{\infty}{\frac{c}{(1 + c)\sqrt{2\pi\sigma_b^2}}}e^{\frac{-b_i^2}{2\sigma^2_b}}db_i
$$
在上述积分中，$b_i$ 是随机变量的概念很明显。

[上述] 表达式无法以闭式求值。
$\dots$从纯概率的角度来看，广义线性混合模型似乎比边际模型具有明显的优势，因为边际模型推断的目标$Y_i$的边际分布原则上可以通过对随机效应分布取平均值从广义线性混合效应模型中得出。

由于作者没有明确提到如何进行这种平均，我参考了Molenberghs and Verbeke (2005)的第 16.3 节以获取更多信息：

同样，数值积分方法可以使用，但通常更容易使用数值平均，即从其拟合分布$N(0, \hat{D})$中抽取大量$M$个随机效应向量$b_i$，并估计${E}[Y_i]$，方法是

$$
\hat{E}(Y_i) = \frac{1}{M} \sum_{1}^{M}{\frac{exp(X_i\hat{\beta^*} + b_i)}{1 + exp(X_i\hat{\beta^*} + b_i)}}
$$
在我看来，这个估计程序并不支持$b_i$是随机变量的观点，因为它为$b_i$的所有采样值分配了相同的权重（$\frac{1}{M}$）。以下表达式不是更有帮助吗？
$$
\hat{E}(Y_i) = \sum_{1}^{M}{\frac{exp(X_i\hat{\beta^*} + b_i)}{1 + exp(X_i\hat{\beta^*} + b_i)}\cdot P(b_i)}
$$
无论上述表达式是否有用，Molenberghs 和 Verbeke 建议的计算是否与 emmeans 为 GLMM 计算的估计边际均值相似？

Fitzmaurice, G. M., Laird, N. M., &amp; Ware, J. H. (2012)。应用纵向分析。John Wiley &amp; Sons。
离散纵向数据模型。（2005 年）。在 Springer 统计学丛书中。Springer-Verlag。https://doi.org/10.1007/0-387-28980-1]]></description>
      <guid>https://stats.stackexchange.com/questions/655713/can-we-calculate-population-mean-response-from-glmm-by-averaging-over-random-eff</guid>
      <pubDate>Sun, 13 Oct 2024 05:24:36 GMT</pubDate>
    </item>
    <item>
      <title>协方差阵和的集中不等式</title>
      <link>https://stats.stackexchange.com/questions/655712/concentration-inequality-about-the-sum-of-covariance-matrix</link>
      <description><![CDATA[当我阅读有关集中不等式的笔记时，我遇到了一个关于作者如何证明它的问题。当我们从均值为零但协方差矩阵不同的高斯分布中抽样时，我们得到样本$X_1^1, X_2^1,\dots, X_{n_1}^1 \sim \mathcal{N}\left(0,\Sigma_1\right), X_1^2, X_2^2,\dots, X_{n_2}^2 \sim \mathcal{N}\left(0,\Sigma_2\right),\dots, X_1^{|\mathcal{A}|}, X_2^{|\mathcal{A}|},\dots, X_{n_{|\mathcal{A}|}}^{|\mathcal{A}|} \sim \mathcal{N}\left(0,\Sigma_{|\mathcal{A}|}\right)$并得到估计量
$$
\hat{S}=\frac{1}{n_{\mathcal{A}}}\sum_{k\in\mathcal{A}}\sum_{i=1,\dots,n_{k}} x_{i}^{k}\left(x_{i}^{k}\right)^{\top}, \hat{S_{k}}=\frac{1}{n_{\mathcal{k}}}\sum_{i=1,\dots,n_{k}} x_{i}^{k}\left(x_{i}^{k}\right)^{\top}
$$
我关心的问题是$\hat{S}$的集中不平等。作者写道
$$
\mathbb{P}\left(\|\hat{S}-\sum_{k\in\mathcal{A}}\left(\frac{n_k}{n_{\mathcal{A}}}\Sigma_{k}\right)\|_{\max}\ge t\right)\le \mathbb{P}\left(\sum_{k\in\mathcal{A}}\frac{n_k}{n_{\mathcal{A}}}\left(\hat{S}_k-\Sigma_k\right)\ge t\right)\le\sum_{k\in\mathcal{A}}\mathbb{P}\left(\|\hat{S}_k-\Sigma_k\|_\max\ge \frac{tn_{\mathcal{A}}}{|\mathcal{A}n_k|}\right)\\ \le p^2\sum_{k\in \mathcal{A}}\exp\left(-\frac{1}{2\pi^2}\frac{t^2n_{\mathcal{A}}^2}{|\mathcal{A}|^2n_k}\right)
\le p^2\exp\left(-cn_{\mathcal{A}}t^2\right)
$$
其中 $\mathcal{A}$ 为集合，且 $n_{\mathcal{A}}=n_1+n_2+\cdots+n_{|\mathcal{A}|}$ 且 $|\mathcal{A}|$ 表示集合 $\mathcal{A}$ 中元素的数量。$\|\|_{\max}$ 表示矩阵中元素的最大绝对值。
现在我不知道如何得到最后一个不等式，也没有更多关于 $c$ 的信息。我猜想 $c$ 是一个足够大的常数，并且不依赖于 $|\mathcal{A}|$。
更新：
我们有
$$
\mathbb{P}\left(\|\hat{S}_k-\Sigma_k\|_{\max}\ge t\right) \le p^2\exp\left(-\frac{n_kt^2}{2\pi^2}\right)。
$$
我的尝试：
$$
p^2\sum_{k\in \mathcal{A}}\exp\left(-\frac{1}{2\pi^2}\frac{t^2n_{\mathcal{A}}^2}{|\mathcal{A}|^2n_k}\right) \le p^2|\mathcal{A}| \exp\left(-\frac{1}{2\pi^2}\frac{t^2n_{\mathcal{A}}^2}{|\mathcal{A}|^2n_k}\right)。
$$
然后我不知道该怎么做。我不知道如何处理$|\mathcal{A}|$内部和$\exp\left(x\right)$外部的两个$|\mathcal{A}|$。]]></description>
      <guid>https://stats.stackexchange.com/questions/655712/concentration-inequality-about-the-sum-of-covariance-matrix</guid>
      <pubDate>Sun, 13 Oct 2024 05:04:53 GMT</pubDate>
    </item>
    <item>
      <title>通过与 g 先验积分计算 Y 的边际密度</title>
      <link>https://stats.stackexchange.com/questions/655711/marginal-density-of-y-via-integration-with-g-prior</link>
      <description><![CDATA[在贝叶斯统计中，$ Y $ 的边际密度如何表示为参数$ \beta $的积分？我遇到了以下公式：
$$
p(Y \mid x, \gamma, \sigma^2) = \int p(Y \mid \beta, \gamma, \sigma^2) p(\beta \mid \sigma^2) \, d\beta
$$
$$
\begin{aligned}
Y \mid \beta, \gamma, \sigma^2 &amp;\sim \mathcal{N}_n( x\beta + Z\gamma, \sigma^2 \mathbf{I}_n), \\
\beta \mid \sigma^2 &amp;\sim \mathcal{N}_p\left( 0, \sigma^2 g (x^T x)^{-1} \right)
\end{aligned}
$$
$$
\begin{aligned}
m &amp;= V x^T (Y - Z\gamma) \\ 
&amp; = \frac{g}{1+g} (x^T x)^{-1} x^T (Y - Z \gamma) 
\end{aligned}
\quad \text{y} \quad 
\begin{aligned}
V &amp;= \sigma^2 \left( x^T x \left( \frac{1+g}{g} \right) \right)^{-1} \\ 
&amp; = \frac{g \sigma^2}{1+g} (x^T x)^{-1}
\end{aligned}
$$
有人能解释一下$\beta $边缘化背后的直觉吗？
$$
\begin{aligned}
\int p(Y \mid \beta, \gamma, \sigma^2) p(\beta \mid \sigma^2) d\beta &amp;= \int\left[(2\pi \sigma^2)^{-n/2} \exp\left(-\frac{1}{2\sigma^2}(Y - Z\gamma)^T(Y - Z\gamma)\right)\right] \\
&amp;\times \left[(1+g)^{-p/2} \exp\left(\frac{1}{2}m^T V^{-1} m\right)\right] \\
&amp;\times \left[|2\pi V|^{-1/2} \exp\left(-\frac{1}{2}(\beta - m)^T V^{-1} (\beta - m)\right)d\beta\right].\\
&amp;=\left[(2\pi \sigma^2)^{-n/2} \exp\left(-\frac{1}{2\sigma^2}(Y - Z\gamma)^T(Y - Z\gamma)\right)\right] \\ 
&amp; \times \left[(1+g)^{-p/2} \exp\left(\frac{1}{2}m^T V^{-1} m\right)\right] \\
&amp; =\left[(2\pi \sigma^2)^{-n/2} \exp\left(-\frac{1}{2\sigma^2}(Y - Z\gamma)^T(Y - Z\gamma)\right)\right] \\
&amp; \times \exp\left(\frac{1}{2} (Y - Z \gamma)^T x (x^T x)^{-1} x^T (Y - Z \gamma)\right)
\end{aligned}
$$
这是我目前的进展]]></description>
      <guid>https://stats.stackexchange.com/questions/655711/marginal-density-of-y-via-integration-with-g-prior</guid>
      <pubDate>Sun, 13 Oct 2024 05:02:13 GMT</pubDate>
    </item>
    <item>
      <title>条件不平衡独立变量是回归中的一个问题吗？</title>
      <link>https://stats.stackexchange.com/questions/655709/are-conditional-unbalanced-independent-variables-an-issue-in-regression</link>
      <description><![CDATA[我不确定这种现象是否有名称 - 因此我将对其进行描述：
描述
我有一个具有以下特征的数据集：

Y：平衡的二元因变量（例如 50% 就业/50% 失业）
X1：平衡的二元自变量（例如 50% 治疗/50% 控制）
X2：分类自变量（例如国家）

X1 是感兴趣的变量，目标是估计 X1 对 Y 的因果影响，而不是预测。
可以观察到 X2 和 X1 以及 X2 和 Y 之间的相关性（或关系，因为变量不是度量）。
问题
但是，如果我将 X1 分组为 X2 （例如按国家划分治疗组和未治疗组），我可以观察到子组不平衡。在某些国家，接近 100% 的数据来自治疗组，在其他国家，接近 100% 的数据来自未治疗组，而在某些国家，数据是 50%/50% 平衡的。
问题：

这个问题有名字吗？
条件子组不平衡会成为 x1 系数/估计量及其重要性的问题吗？如果一个子组由 100% 控制或治疗单位组成，会发生什么？
如果是，为什么或何时会出现这种情况？
如果是，我该怎么做才能避免这种情况？我应该删除不平衡的组/国家吗？
我应该添加交互变量吗？

PS：我发现了很多关于不平衡独立变量或因变量的资料 - 但我在寻找“条件独立变量”的资料时遇到了麻烦。]]></description>
      <guid>https://stats.stackexchange.com/questions/655709/are-conditional-unbalanced-independent-variables-an-issue-in-regression</guid>
      <pubDate>Sun, 13 Oct 2024 00:15:01 GMT</pubDate>
    </item>
    <item>
      <title>Nate Silver 的 p(doom) 计算</title>
      <link>https://stats.stackexchange.com/questions/655697/nate-silvers-pdoom-calculation</link>
      <description><![CDATA[在他的最新著作《边缘》中，Nate Silver 概述了一种“贝叶斯”计算方法，用于计算核战争的概率，其前提是自 1946 年以来我们从未目睹过核武器的使用。我发现他的设置和解决方案有点模糊，我想遵循他的逻辑。
他写道：

自 1945 年以来，核武器从未在冲突中使用过，我们应该对此感到多么欣慰？假设在 1946 年 1 月 1 日，你召集了一个由三位专家组成的小组来预测再次发生核爆炸的可能性。Peter Pessimist 告诉你，每年使用核武器的可能性为 10%。Ollie Optimist 说可能性只有 0.1%。而 Mary Middleground 估计可能性为 1%。由于没有真正的证据，你只能将他们的预测平均下来，得出每年 3.7% 的概率。这令人恐惧：这意味着在未来二十年内，核武器被使用的可能性更大。这有助于解释为什么冯·诺依曼等人在二战后认为文明可能不会再存在太久。但在 78 年（1946 年至 2023 年）没有使用核武器之后，我们可以更新我们分配给每个分析师的估计的权重；这是贝叶斯定理的直接应用。例如，我们可以说彼得·佩西米斯特可能是错的。如果真的有 10% 的年核战争概率，那么我们迄今为止仅凭运气就避免核战争的概率不到 1/3,000。然而，我们没有足够的证据来对玛丽·米德尔格兰特的估计做出太多评论。她说每年发生核战争的概率是1/100，而我们只有七十八年的数据来反驳她。 （没错，一个好的贝叶斯主义者会稍微降低她的预测，同时增加我们对 Ollie Optimist 的理论的信任度。）在长崎核爆 78 年后，我们修订后的贝叶斯估计是每年发生核战争的可能性约为 0.35%。&quot;

他附上了一张我一直试图重现的图表：

我对 Nate 的步骤有点困惑，以为我可能想太多了。他似乎在更新他的前因，即三位“专家”的平均值((乐观派 0.1% + 中间派 1.0% + 悲观派 10%)/3 = 3.7%)，通过观察随后 78 年的事件结果，对每位专家（称他们为$p_1, p_2, p_3$）进行加权。也就是说，$p$（$n$ 年内未发生的事件 | 事件概率）= $(1-{p_i})^n$
为了复制此结果，我为每个 $n$ 从 0 到 $N$=78 的专家计算了新的权重：
\begin{align}
p&#39;(n) &amp;= \sum_{i=1}^3\frac{p_i(1-p_i)^n}{Z(n)} \\
Z(n) &amp;= \sum_{i=1}^3(1-p_i)^n
\end{align&gt;
然而，这与 Nate 的情节不太相符：

由于我的信封背面没有起作用，我想知道我是不是走运了，Nate 是否对此进行了更复杂的建模？我很想让这个解决方案更正式，并使这些线条相匹配。欢迎任何意见！谢谢。]]></description>
      <guid>https://stats.stackexchange.com/questions/655697/nate-silvers-pdoom-calculation</guid>
      <pubDate>Sat, 12 Oct 2024 16:57:55 GMT</pubDate>
    </item>
    <item>
      <title>自定义算法从均匀分布创建正态分布，与参数斗争</title>
      <link>https://stats.stackexchange.com/questions/655689/custom-algorithm-to-create-a-normal-distribution-from-a-uniform-distribution-st</link>
      <description><![CDATA[]]></description>
      <guid>https://stats.stackexchange.com/questions/655689/custom-algorithm-to-create-a-normal-distribution-from-a-uniform-distribution-st</guid>
      <pubDate>Sat, 12 Oct 2024 14:42:32 GMT</pubDate>
    </item>
    <item>
      <title>报告缺失数据的分类器准确率</title>
      <link>https://stats.stackexchange.com/questions/655674/report-classifier-accuracy-with-missing-data</link>
      <description><![CDATA[假设我们正在读取血压。有些读数已损坏且无法使用。然后我们训练二元分类器来检测高血压。当我们的模型无法使用某些数据时，实验设计理论对报告分类器准确性有何看法？]]></description>
      <guid>https://stats.stackexchange.com/questions/655674/report-classifier-accuracy-with-missing-data</guid>
      <pubDate>Sat, 12 Oct 2024 00:40:54 GMT</pubDate>
    </item>
    <item>
      <title>多元高斯累积分布函数关于 Sigma 矩阵元素的导数</title>
      <link>https://stats.stackexchange.com/questions/655720/derivative-of-multivariate-gaussian-cdf-with-respect-to-elements-of-sigma-matrix</link>
      <description><![CDATA[我一直在尝试计算多元高斯 cdf 相对于 Sigma 矩阵元素的导数。令 F (f) 代表多元高斯 cdf (pdf)，其均值向量为 mu，相关矩阵为 P，其中 i=j 时其条目 p_ij = 1，否则为 rho。我希望计算 dF/d rho（请原谅这种符号）。
对于双变量情况，结果是已知且简单的。我自己已经能够推导出来，但也找到了一篇包含结果的论文，并且通过使用 R 中的实现，我能够检查解决方案的正确性，见下文。结果为
dF_2 (x1,x2;0,P_2)/d rho = f(x_1,x_2;0,P_2)。
x = rep(0.1,2); rho0 = 0.1; P = matrix(rho0,2,2); diag(P) = 1

F_2 &lt;- function(rho_1){
P.1 = matrix(rho_1,2,2);diag(P.1)=1
mvtnorm::pmvnorm(lower = rep(-Inf,2), upper = x, mean = rep(0,2),corr = P.1, seed = 1)[1]
}

all.equal(numDeriv::grad(F_2,rho0),
mvtnorm::dmvnorm(x = x, mean = rep(0,2), sigma = P))

[1] TRUE

现在，对于高于 2 的维度，它会变得有点复杂。首先，我尝试自己计算，虽然 d f/d rho 非常简单且微不足道，但我不确定如何处理 d F/d rho。然后我在 Tong 和 Plackett 中找到了另一个结果，其中指出，例如对于 3 维，偏导数可以写成
dF_3 (x1,x2,x_3;0,P_3)/d rho = f_2(x_1,x_2;0,P_2) F_c (x_3; mu_c, S_c), 
其中 f_2 是边际联合分布(x_1,x_2) 的均值为 0，相关矩阵 P_2 的对角线元素为 1，其他地方为 rho，F_c 是给定 (x_1,x_2) 时 x_3 的条件密度，在本例中为单变量高斯 cdf，均值为 rho(x_1 + x_2)/(1+rho)，方差为 - (2 rho^2 - rho - 1)/(rho+1)。至少，如果我正确解读了这篇论文的话。但是，当我尝试实现它时，结果在数值上是错误的。
x = rep(0.1,3); rho0 = 0.1; P = matrix(rho0,3,3); diag(P) = 1
mu_c = (rho0/(1+rho0))*sum(x[1:2])
sigma2_c = - (2*rho0^2 - rho0 -1)/(rho0+1)

F_3 &lt;- function(rho_1){
P.1 = matrix(rho_1,3,3);diag(P.1)=1
mvtnorm::pmvnorm(lower = rep(-Inf,3), upper = x, mean = rep(0,3),corr = P.1, seed = 1)[1]
}

numDeriv::grad(F_3,rho0)
[1] 0.2535275

mvtnorm::dmvnorm(x = x[1:2], mean = rep(0,2), sigma = P[1:2,1:2])*pnorm(q = x[3], mean = mu_c, sd = sqrt(sigma2_c), lower.tail = T)
[1] 0.0844702

所以我的问题是：我是否错误地解释了公式，或者实现是否正确，但 R 中存在数值问题？如果是这样，这与 pmvnorm 的计算方式有什么关系吗？我知道它使用基于重要性抽样技术的 Genz-Brent 算法，该算法会产生略微随机的结果，当种子未设置时，会产生完全随机的数值梯度。这与它有什么关系吗？或者与 grad 函数本身有关？我将非常感激任何有关此事的帮助。
F_3_noseed &lt;- function(rho_1){
P.1 = matrix(rho_1,3,3);diag(P.1)=1
mvtnorm::pmvnorm(lower = rep(-Inf,3), upper = x, mean = rep(0,3),corr = P.1)[1]
}

numDeriv::grad(F_3_noseed,rho0)
[1] 16.76862

&gt; numDeriv::grad(F_3_noseed,rho0)
[1] 1.71553

&gt; numDeriv::grad(F_3_noseed,rho0)
[1] -4.708667

提前谢谢您！
我曾尝试通过展开方程式，然后使用矢量微积分来自己计算 d=3 的积分，但我遇到了困难。也就是说，我计算了 d f(x, P)/d rho= tr ( -1/2 P^{-1} - P^{-1} xx&#39; P^{-1} ) A ),，其中 A 是 dP/drho。但我现在不知道如何将其与 x 进行积分。然后我在一篇论文中找到了现有的结果并尝试实施。]]></description>
      <guid>https://stats.stackexchange.com/questions/655720/derivative-of-multivariate-gaussian-cdf-with-respect-to-elements-of-sigma-matrix</guid>
      <pubDate>Fri, 11 Oct 2024 13:47:04 GMT</pubDate>
    </item>
    <item>
      <title>有效影响函数与干预措施，取决于暴露的自然价值[关闭]</title>
      <link>https://stats.stackexchange.com/questions/655646/efficient-influence-function-with-interventions-that-depend-on-the-natural-value</link>
      <description><![CDATA[]]></description>
      <guid>https://stats.stackexchange.com/questions/655646/efficient-influence-function-with-interventions-that-depend-on-the-natural-value</guid>
      <pubDate>Fri, 11 Oct 2024 11:34:19 GMT</pubDate>
    </item>
    <item>
      <title>推导单位 n 球面上均匀分布矢量/点的 k 个坐标平方和的概率密度</title>
      <link>https://stats.stackexchange.com/questions/655611/derivation-for-the-probability-density-of-the-squared-sum-of-k-coordinates-of-a</link>
      <description><![CDATA[
n 球面上均匀分布的向量/点的单个坐标的分布是 beta 分布，如下所述：随机单位向量坐标的平均绝对值？

n 球面上均匀分布的向量/点的多个坐标的平方和的分布也是 beta 分布。


我想尝试以与第一点证明相同的方式推导出第二点。
这种证明将提供一种几何方法来推导 F 分布，该 F 分布可以与 n 球面上均匀点的 k 个坐标的平方和相关联（证明 F 统计量遵循 F 分布)。]]></description>
      <guid>https://stats.stackexchange.com/questions/655611/derivation-for-the-probability-density-of-the-squared-sum-of-k-coordinates-of-a</guid>
      <pubDate>Thu, 10 Oct 2024 16:04:19 GMT</pubDate>
    </item>
    </channel>
</rss>