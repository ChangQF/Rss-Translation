<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>最近的问题 - 交叉验证</title>
    <link>https://stats.stackexchange.com/questions</link>
    <description>来自 stats.stackexchange.com 的最新 30 条</description>
    <lastBuildDate>Mon, 27 Jan 2025 09:18:50 GMT</lastBuildDate>
    <item>
      <title>如何选择和评估重复测量多类分类的分类器？</title>
      <link>https://stats.stackexchange.com/questions/660584/how-to-choose-and-evaluate-classifiers-for-multiclass-classification-with-repeat</link>
      <description><![CDATA[我有一个数据集，其中包含 269 名受试者的 960 个样本，这些样本经过了重复测量。目标变量有 4 个类别。我的目标是完美地对类别进行分类，并提取作为此分类重要标记的特征。
我尚未找到任何关于考虑重复测量的分类器的文献，因此我不确定应该为此使用哪个分类器。
但是，我不确定在这种情况下/目标我应该真正考虑什么。在我看来，有两种选择：

1. 组感知训练测试拆分，并使用随机森林、knn、svm、xgboost 对每个拆分进行 GroupKFold 交叉验证。按均值汇总所有分割结果，然后选择最佳模型。

2.由于我的目标是找到对类别进行分类的标记，忽略受试者内相关性，直接将数据按样本拆分为训练测试集，并对每个分割使用我上面提到的分类器。按均值汇总所有分割结果，然后选择最佳模型。


分组和目标变量的一般结构如下所示。
我应该如何处理这样的数据？
Ps.这是我的分组结构：
&gt; final_data %&gt;% group_by(group) %&gt;%
+ summarise(count = n()) %&gt;%
+ count(count) %&gt;%
+range(desc(count))
# A tibble: 14 × 2
count n
&lt;int&gt; &lt;int&gt;
1 228 1
2 172 1
3 43 1
4 42 1
5 21 2
6 18 1
7 12 3
8 11 2
9 6 4
10 5 5
11 4 1
12 3 5
13 2 49
14 1 193

以及，目标变量分布：
&gt;表（final_data$stage）

0 1 2 3 
123 565 201 73
]]></description>
      <guid>https://stats.stackexchange.com/questions/660584/how-to-choose-and-evaluate-classifiers-for-multiclass-classification-with-repeat</guid>
      <pubDate>Mon, 27 Jan 2025 07:08:06 GMT</pubDate>
    </item>
    <item>
      <title>HPD 可信区间与渐近置信区间 [关闭]</title>
      <link>https://stats.stackexchange.com/questions/660581/hpd-credible-interval-vs-asymptotic-confidence-intervals</link>
      <description><![CDATA[当 R 中某些数据分析时，HPD 可信区间大于参数估计的渐近置信区间时该怎么办？]]></description>
      <guid>https://stats.stackexchange.com/questions/660581/hpd-credible-interval-vs-asymptotic-confidence-intervals</guid>
      <pubDate>Mon, 27 Jan 2025 06:04:12 GMT</pubDate>
    </item>
    <item>
      <title>在 Hastie 中获取身份</title>
      <link>https://stats.stackexchange.com/questions/660580/deriving-identity-in-hastie</link>
      <description><![CDATA[在 Hasties 的书的第 24 页，恒等式 2.25 中，它说：
$$MSE(x_0) = E(\hat{y_0}-E(\hat{y_0}))^2+(E(\hat{y_0})-f(x_0))^2$$
这将导致偏差-方差分解。
我在推导这个等式时遇到了一些麻烦。我以前从未见过这种“期望中的期望”。更具体地说，我必须证明
$$2E(\hat{y_0}E(\hat{y_0}))-E(E^2(\hat{y_0}))-E^2(\hat{y_0}) = 0$$
因为当我从第 1 行到第 2 行时，除了所需的项之外，我还会得到这个结果。
对于那些没有这本书的人来说，第一个等式是
$$MSE(x_0)=E(f(x_0)-\hat{y_0})^2$$
我想这很简单...]]></description>
      <guid>https://stats.stackexchange.com/questions/660580/deriving-identity-in-hastie</guid>
      <pubDate>Mon, 27 Jan 2025 05:07:56 GMT</pubDate>
    </item>
    <item>
      <title>如何从 Cox-PH 恢复生存功能？</title>
      <link>https://stats.stackexchange.com/questions/660578/how-to-recover-the-survival-function-from-cox-ph</link>
      <description><![CDATA[我试图理解如何从拟合的 Cox PH 回归中恢复生存曲线估计值的数学原理。我找到了一些之前讨论过这个问题的问题（例如Cox 回归的生存曲线、根据 Cox 回归结果估计生存曲线、根据 Cox PH 计算时间 (t) 时每人的生存概率），但数学细节对我来说并不清楚。
我首先回顾了累积风险与生存的关系。从定义$f(t) = -\frac{d}{dt}S(t)$、$h(t) = \frac{f(t)}{S(t)}$和$h(t) = -\frac{d}{dt}\ln(S(t))$开始，如果我们将两边积分：
$$\int_0^t h(u)du = -\int_0^t \frac{d}{du}\ln(S(u))du$$
左边是累积​​风险，即根据定义$H(t)$。右侧变为：
$$-[\ln(S(t)) - \ln(S(0))]$$
由于 $S(0) = 1$（在时间 0 之后存活的概率为 1），我们可以写出：
$$H(t) = -\ln(S(t))$$
$$S(t) = \exp(-H(t))$$
因此，现在如果我们从 Cox PH 模型开始，我们可以使用上面的公式来写出累积风险：
$$h_i(t) = h_0(t)\exp(X_i\beta)$$
$$H_i(t) = \int_0^t h_i(u)du = \int_0^t h_0(u)\exp(X_i\beta)du = \exp(X_i\beta)\int_0^t h_0(u)du = \exp(X_i\beta)H_0(t)$$
这是我感到困惑的部分。从上面来看，累积基线风险$H_0(t)$仍需要估算。有一种称为 Breslow 的方法可用于估计累积基线风险：
$$H_0(t) = \sum_{j:t_j \leq t} \frac{d_j}{\sum_{i \in R(t_j)} \exp(X_i\beta)}$$

$d_j$ 表示在时间 $t_j$ 发生的事件数量
虽然我不完全理解 $\sum_{i \in R(t_j)} \exp(X_i\beta)$，但它看起来像是时间 $t_j$
直观地看，分子和分母似乎隐含地捕捉到了一个累积的想法（即由于索引），但我不确定为什么这被认为是累积基线风险的估计值

如果这是正确的，剩下的只是代数和替换：
$$H_i(t) = \exp(X_i\beta)H_0(t) = \exp(X_i\beta)\sum_{j:t_j \leq t} \frac{d_j}{\sum_{k \in R(t_j)} \exp(X_k\beta)}$$
$$S_i(t) = \exp(-H_i(t)) = \exp\left(-\exp(X_i\beta)\sum_{j:t_j \leq t} \frac{d_j}{\sum_{k \in R(t_j)} \exp(X_k\beta)}\right)$$
我这样做对了吗？]]></description>
      <guid>https://stats.stackexchange.com/questions/660578/how-to-recover-the-survival-function-from-cox-ph</guid>
      <pubDate>Mon, 27 Jan 2025 02:13:49 GMT</pubDate>
    </item>
    <item>
      <title>使用 cor.test() 和附加置换测试对 Spearman 相关性进行有效性检验</title>
      <link>https://stats.stackexchange.com/questions/660577/validity-of-using-cor-test-and-additional-permutation-testing-for-spearman-cor</link>
      <description><![CDATA[在 ?cor.test 帮助信息中，它指出 对于 Spearman 检验，p 值使用算法 AS 89 计算，其中 n &lt; 1290并且exact = TRUE，否则通过渐近 t 近似计算。请注意，对于 n &lt;，这些是“精确的”。 10，并使用 Edgeworth 级数近似来获取更大的样本量（截止值已从原始论文中更改）。
我还注意到这篇文章 https://stackoverflow.com/questions/77384889/how-to-permute-correlations-between-several-pairs-of-variables-in-r 中的评论，其中使用下面的额外排列检验（随机改组其中一个变量后，有多少测试统计数据大于或等于原始/排列数，在分子和分母上都加 1 以避免为 0），实际上是多余的，因为正如回复者所说，cor.test 正在使用排列（尽管与下面的公式并不完全相同）。
sum(abs(perm_stat) &gt;= abs(orig_stat)) + 1)/N+1

这篇文章让我很困惑，因为尽管样本量为 20，但这个陈述仍然成立，这让我不确定如何使用我自己的数据（n=10）。我假设没有使用 n！排列的精确测试，而是 Edgeworth 近似。现在样本量超过 10，从上面的排列代码计算 p 值不会是多余的吗？
因此，我是否继续保留 exact=True 并从上面计算我的排列 p，还是使用 exact=FALSE？如有任何澄清，我将不胜感激。还使用了 Bonferroni 进行多重检验调整。
最后，我使用置换检验的主要原因是，我可以通过 ggplot 可视化看到 x 和 y 之间的某些相关性很可能由一对观察值驱动。我想通过随机重采样来“检查”这一点。]]></description>
      <guid>https://stats.stackexchange.com/questions/660577/validity-of-using-cor-test-and-additional-permutation-testing-for-spearman-cor</guid>
      <pubDate>Sun, 26 Jan 2025 23:01:37 GMT</pubDate>
    </item>
    <item>
      <title>Vapnik-Chervonenkis 不等式的证明</title>
      <link>https://stats.stackexchange.com/questions/660576/proof-of-a-vapnik-chervonenkis-inequality</link>
      <description><![CDATA[我的统计学习教授要求我完成关于分类问题的以下定理的证明：
设$\mathcal{Y}=\{0,1\}$和$l:\mathcal{Y}\times\mathcal{Y}\rightarrow \{0,1\}$为成本函数。然后，$\forall \epsilon &gt;0$，我们有大于$1-\epsilon$的概率：
$$R_p(\hat{g}_{n,\mathcal{G}})-R_p(g^*_{p,\mathcal{G}})\leq 2\sqrt{\frac{2V_\mathcal{G}(2n)\ln(4(2n+1)\epsilon^{-1})}{n}}$$
其中

$n$是我们数据样本的大小$\{(X_1,Y_1),\ldots,(X_n,Y_n)\}\subset\mathcal{X}\times\mathcal{Y}$
$\mathcal{G}$ 是预测函数集 $\mathcal{F}(\mathcal{X},\mathcal{Y})$ 的子集
对于预测函数 $g$，$R_p(g)$ 是其在概率定律 $P$ 下的风险，我们的样本来自该概率定律：$R_p(g) = \mathbb{E}_p[l(Y,g(X))]$
$\hat{R}_n$ 是我们样本的经验风险，$\hat{g}_{n,\mathcal{G}}\in\arg\min_{g\in\mathcal{G}}\hat{R}_n(g)=\arg\min_{g\in\mathcal{G}}\frac{1}{n}\sum_{i=1}^nl(Y_i,g(X_i))$
$g^*_{p,\mathcal{G}}$ 是 $\mathcal{G}$ 的 oracle 预测器：$g^*_{p,\mathcal{G}}\in\arg\min_{g\in\mathcal{G}}R_p(g)$
$V_\mathcal{G}(2n)=\sup_{\text{x}\in\mathcal{X^{2n}}}V_\mathcal{G}(\text{x})=\sup_{\text{x}\in\mathcal{X^{2n}}}\max\{J\subset\mathbb{N}:\max_{S\subset\{X_1,\ldots,X_{2n}\},|S|=J}|T_\mathcal{G}(S)|=2^J\}$ 和 $T_\mathcal{G}(S)$ 是 $\mathcal{G}$ 在 $S$ 中的迹

证明的开始如下：
设 $t=\sqrt{\frac{2V_\mathcal{G}(2n)\ln(4(2n+1)\epsilon^{-1})}{n}}$ 使得 $nt^2=2V_\mathcal{G}(2n)\ln(4(2n+1)\epsilon^{-1})$。我们想要证明$\mathbb{P}(R_p(\hat{g}_{n,\mathcal{G}})-R_p(g^*_{p,\mathcal{G}})&gt;2t)\leq\epsilon$。使用引理说明$R_p(\hat{g}_{n,\mathcal{G}})-R_p(g^*_{p,\mathcal{G}})\leq 2\sup_{g\in\mathcal{G}}|R_p(g)-\hat{R}_n(g)|$，我们得到：$\mathbb{P}(R_p(\hat{g}_{n,\mathcal{G}})-R_p(g^*_{p,\mathcal{G}})&gt;2t)\leq\mathbb{P}(2\sup_{g\in\mathcal{G}}|R_p(g)-\hat{R}_n(g)|&lt;2t)=\mathbb{P}(\sup_{g\in\mathcal{G}}|R_p(g)-\hat{R}_n(g)|&lt;t)$.
但是，我真的不确定下一步该怎么做。我们的教授建议我们使用对称化引理（我们没有学过，而且从我在网上看到的内容来看很难理解）和随后的迭代条件（我认为他指的是一些典型的东西，例如 $\mathbb{E}_p[\cdot]=\mathbb{E}_p[\mathbb{E}_p[\cdot|X]]$，其中 $X$ 为随机变量）。
如能得到任何帮助，我们将不胜感激，在此先谢谢了 !]]></description>
      <guid>https://stats.stackexchange.com/questions/660576/proof-of-a-vapnik-chervonenkis-inequality</guid>
      <pubDate>Sun, 26 Jan 2025 23:00:37 GMT</pubDate>
    </item>
    <item>
      <title>逻辑回归系数是否均匀收敛，均匀收敛的速度是多少？</title>
      <link>https://stats.stackexchange.com/questions/660579/does-logistic-regression-coefficient-uniformly-converge-and-what-is-the-rate-of</link>
      <description><![CDATA[假设我有一个回归方程
$$y = 1\{X\beta + \xi\}, \text{ where } \xi \sim \text{Logistic}(0,1).$$
将估计量表示为 ($\hat{\beta}$)。我是否得到了均匀收敛结果：
$$\sup_{\beta \in \Theta} |\hat{\beta} - \beta| \to 0 \text{ in probability}?$$
更好的是，我能得到一个比率吗？例如：
$$\sup_{\beta \in \Theta} \sqrt{n}|\hat{\beta} - \beta| = O_P(1).$$]]></description>
      <guid>https://stats.stackexchange.com/questions/660579/does-logistic-regression-coefficient-uniformly-converge-and-what-is-the-rate-of</guid>
      <pubDate>Sun, 26 Jan 2025 20:42:50 GMT</pubDate>
    </item>
    <item>
      <title>Metafor 中多（四）级荟萃分析中建模效应异质性</title>
      <link>https://stats.stackexchange.com/questions/660572/modeling-effects-heterogeneity-in-a-multi-four-level-meta-analysis-in-metafor</link>
      <description><![CDATA[问题：在多层次荟萃分析中对交叉效应和配对异质性进行建模
我正在对随机对照试验 (RCT) 进行多层次荟萃分析，以检查治疗 X 对特定情况 (A) 的影响。我的目标是适当地对研究内部和研究之间的差异进行建模，以考虑治疗配对之间的影响和异质性。
当前方法
我正在使用一个简单的协方差矩阵和一个具有嵌套随机效应的多层次模型来捕获研究内部和研究之间的差异。我还应用了 clubSandwich CR-2 型校正来解释集群稳健标准误差。我当前的代码如下：
# 步骤 1：假设单相关性的协方差矩阵 (r = 0.8)
V &lt;- impute_covariance_matrix(vi =filtered_data$var, cluster =filtered_data$study, r = 0.8)

# 步骤 2：具有嵌套随机效应的多层元分析模型
res &lt;- rma.mv(
yi =filtered_data$es,
V = V,
random = ~ 1 | study/es.id,
data =filtered_data,
sparse = TRUE,
method = &quot;REML&quot;
)

# 步骤 3：集群稳健标准误差
robust_res &lt;- robust(res, cluster =filtered_data$study, clubSandwich = TRUE)

问题：交叉效应和治疗配对
我的数据集中的一些研究包括使用治疗 X 的相同平均值和标准差 (m(SD)) 来估计与两种不同治疗 Y 和 Z 的比较效应的效应。例如：
• 效应大小 1：治疗 X 与治疗 Y
• 效应大小 2：治疗 X 与治疗 Z
鉴于治疗 Y 和 Z 的特征有时非常不同，我想估计这些治疗配对之间的异质性。我修改了模型，使其包含治疗配对变量（例如配对）的随机效应，如下所示：
# 步骤 1：协方差矩阵（不变）
V &lt;- impute_covariance_matrix(vi =filtered_data$var, cluster =filtered_data$study, r = 0.8)

# 步骤 2：修改后的模型，包括治疗配对的随机效应
res &lt;- rma.mv(
yi =filtered_data$es,
V = V,
random = ~ 1 | study/pairing/es.id,
data =filtered_data,
sparse = TRUE,
method = &quot;REML&quot;
)

# 步骤 3：集群稳健标准误差
robust_res &lt;- robust(res, cluster =filtered_data$study, clubSandwich = TRUE)

问题
1. 这种方法是否充分说明？
通过假设研究中的单一相关性（r = 0.8），这是否适当地模拟了治疗配对之间的方差（例如，X vs. Y 和 X vs. Z）？还是这过于简化了结构？

2. 我是否需要更复杂的方差-协方差矩阵？
我是否应该生成一个自定义方差-协方差矩阵，除了研究级相关性（r）之外，还包含治疗配对的额外相关参数（例如，rho_pairing）？如果是这样，如何在 metafor 中有效地实现这一点？
我想确保我的模型能够捕捉到效应之间的共享方差，同时准确估计治疗配对导致的异质性。]]></description>
      <guid>https://stats.stackexchange.com/questions/660572/modeling-effects-heterogeneity-in-a-multi-four-level-meta-analysis-in-metafor</guid>
      <pubDate>Sun, 26 Jan 2025 19:47:50 GMT</pubDate>
    </item>
    <item>
      <title>非随机化 NP 引理变体，包含一些点，这些点在 $H_1$ 下的可能性恰好是 $H_0$ 下可能性的 $k$ 倍</title>
      <link>https://stats.stackexchange.com/questions/660570/non-randomized-np-lemma-variant-that-includes-some-points-for-which-the-likeliho</link>
      <description><![CDATA[Casella-Berger 中提出的 NP 引理的证明忽略了备选假设下的可能性恰好是零假设下可能性的 $k$ 倍的情况。虽然我们可以考虑使用随机测试来解释这种情况，但我意识到 Casella-Berger 中的 NP 引理已经隐含地包含了这种情况。 
下面，我概述了我的理解——您能验证一下它是否正确吗？
NP-Lemma
考虑测试$H_0: \theta = \theta_0$与$H_1: \theta = \theta_1$，其中对应于$\theta_i$的pdf或pmf是$f(x|\theta_i)$，i=0,1，并且$$L(\theta_i|\textbf{x}) = f(\textbf{x}|\theta_i) = \prod_{j=1}^n f(x_j|\theta_i)$$
设 $k\ge 0$ 为固定数。
设 $A = \bigg\{ \textbf{x} \space\space\bigg| \space\space L(\theta_1|\textbf{x})&gt;kL(\theta_0|\textbf{x})\bigg\} $ 并设 $B = \bigg\{ \textbf{x} \space\space\bigg| \space\space L(\theta_1|\textbf{x})&lt;kL(\theta_0|\textbf{x})\bigg\} $
设 $C = \bigg\{ \textbf{x} \space\space\bigg| \space\space L(\theta_1|\textbf{x})=kL(\theta_0|\textbf{x})\bigg\} $ 
假设 $C_1$ 和 $C_2$ 为任意个集合，使得 $C = C_1\cup C_2$ 和 $C_1\cap C_2 = \phi$
考虑使用拒绝域为 $R$ 的检验，该检验满足
$$
\begin{equation*} \tag{8.3.1}
\textbf{x}\in R \space\space\text{ if, }\space\space \textbf{x}\in A\cup C_1
\\\textbf{x}\in R^C \space\space\text{ if, }\space\space \textbf{x}\in B\cup C_2
\end{equation*} 
$$
and $
\begin{equation*} \tag{8.3.2}
\alpha = \mathbb{P}(\textbf{X}\in R)
\end{equation*}$
然后，
这个满足 (8.3.1) 和 (8.3.2) 的测试是 UMP 级别 $\alpha$ 测试。
草图证明
基本上，Casella-Berger 中给出的证明仍然成立。
即
让具有拒绝域 $R$ 的测试的测试函数定义为
$$ 
\ \Phi(\textbf{x}) = \begin{cases} 
1 &amp; \textbf{x}\in R \\
0 &amp; \textbf{x}\in R^C \\
\end{cases}
\
$$
当 $[L(\theta_1|\textbf{x})-kL(\theta_0|\textbf{x})] $ 为正时，$\implies \Phi(\textbf{x}) = 1 $；当 $[L(\theta_1|\textbf{x})-kL(\theta_0|\textbf{x})] $ 为负时，$\Phi(\textbf{x}) = 0 $
对于任何其他级别，$\implies$ $\alpha$ 检验与相应的检验函数 $\Phi&#39;$ 和幂函数 $\beta&#39;$ 检验，我们有
$$\int\Phi(\textbf{x})[L(\theta_1|\textbf{x})-kL(\theta_0|\textbf{x})]d\textbf{x} \ge \int\Phi&#39;(\textbf{x})[L(\theta_1|\textbf{x})-kL(\theta_0|\textbf{x})]d\textbf{x}$$
$$\int [\Phi(\textbf{x})-\Phi&#39;(\textbf{x})][L(\theta_1|\textbf{x})-kL(\theta_0|\textbf{x})]d\textbf{x}\ge 0$$
$\implies \beta(\theta_1)-\beta&#39;(\theta1) - k(\beta(\theta_0)-\beta&#39;(\theta_0)) \ge 0$
$\implies \beta(\theta_1) \ge \beta&#39;(\theta_1)$ 因为 $\beta&#39;(\theta_0)\le\alpha$
编辑
我认为这是错误的，因为这个事实没有在任何地方明确提及，尽管这个事实似乎在 Karlin-Rubin 定理的证明中发挥了重要作用。]]></description>
      <guid>https://stats.stackexchange.com/questions/660570/non-randomized-np-lemma-variant-that-includes-some-points-for-which-the-likeliho</guid>
      <pubDate>Sun, 26 Jan 2025 18:49:33 GMT</pubDate>
    </item>
    <item>
      <title>不存在对称性时的条件期望[关闭]</title>
      <link>https://stats.stackexchange.com/questions/660531/conditional-expectation-when-there-are-no-symmetries</link>
      <description><![CDATA[当没有对称性时，如何计算条件期望？例如：
如何证明$E[Y\mid S]=S/3$，其中$(X,Y,Z)$是一个三维变量，其密度函数为$f(x,y,z)=(x+2y+3z)/3$，位于$0&lt;x,y,z&lt;1$和$S=X+Y+Z$上？]]></description>
      <guid>https://stats.stackexchange.com/questions/660531/conditional-expectation-when-there-are-no-symmetries</guid>
      <pubDate>Sat, 25 Jan 2025 14:34:11 GMT</pubDate>
    </item>
    <item>
      <title>预先注册的假设是否需要进行多重比较校正？</title>
      <link>https://stats.stackexchange.com/questions/660522/do-pre-registered-hypotheses-need-a-correction-for-multiple-comparisons</link>
      <description><![CDATA[我最近偶然发现一个说法，研究人员只需预先注册他们将要执行的每项可能测试的假设，就可以避免使用校正进行多重比较。这是正确的吗？该声明没有引用任何参考文献，老实说，我以前没有在其他地方明确读到过这一点。如果能提供相关文献或任何形式的评论，我将不胜感激。谢谢！
编辑：错别字]]></description>
      <guid>https://stats.stackexchange.com/questions/660522/do-pre-registered-hypotheses-need-a-correction-for-multiple-comparisons</guid>
      <pubDate>Sat, 25 Jan 2025 12:14:46 GMT</pubDate>
    </item>
    <item>
      <title>修复 nlme/lme4 中的随机效应估计</title>
      <link>https://stats.stackexchange.com/questions/660422/fix-the-random-effects-estimates-in-nlme-lme4</link>
      <description><![CDATA[我想用 R 编写一个函数，将这篇论文的思想结合起来。它是关于计算混合模型的局部效应大小。更具体地说：计算模型每个预测变量的$f^2$。理论上，您可以使用 Cohen 方程（Cohen，1988，第 410 页，上述论文中的方程 (2)）来执行此操作：
$$f^2 = \frac{R^2_{AB} - R^2_A}{1 - R^2_{AB}}
$$
其中 B 是感兴趣的预测因子，A 是其他预测因子的集合。您可以想象，您可能希望对混合模型中的每个预测因子执行此操作。
因此，要计算预测因子 B 的 $f^2$，您需要两个模型：一个包含 A 和 B（完整模型），另一个仅包含 A（简化模型）。但是，正如论文作者所提到的：为了使这在混合模型中正常工作，您需要将简化模型的随机效应协方差估计值固定为从拟合完整模型中获得的估计值。
作者有一个 SAS 示例，在 PROC MIXED 中，您显然可以说 parms / parmsdata = VABex2ND hold=1,2,3;（第 5 页，右栏），其中 VABex2ND 是完整模型的随机效应协方差矩阵。现在，我不是 SAS 用户，也不打算将来成为用户，所以我希望在 R 中为此编写一些实现。但是，我找不到使用 nlme/lme4 预定义/修复混合模型中随机效应协方差估计值的方法。这有可能吗？
当然我可以使用贝叶斯方法，为随机效应协方差设置非常严格的先验。例如，使用 nlme 中的 Dialyzer 数据集来计算多元混合模型中变量 QB 的 $f^2$，如下所示：
library(nlme)
library(brms)

data(&quot;Dialyzer&quot;)

full_model &lt;- brm(rate ~ QB + index + pressure + (1 | Subject), 
data = Dialyzer)
ranef_variance &lt;- VarCorr(full_model)$Subject$sd[1]
fixed_prior &lt;- set_prior(paste0(&quot;normal(&quot;, ranef_variance, &quot;, 
0.001)&quot;), 
class = &quot;sd&quot;, 
group = &quot;Subject&quot;)
reduced_model &lt;- brm(rate ~ index + pressure + (1 | Subject),
data = Dialyzer,
Prior = fixed_prior)
VarCorr(full_model)
VarCorr(reduced_model) # 大约相同的随机效应方差，yaay
(bayes_R2(full_model)[1] - bayes_R2(reduced_model)[1]) / 
(1 - bayes_R2(full_model)[1])

但是，我现在想将事情保持在频率论框架内。此外，我不喜欢模型中每个潜在变量的漫长 Stan 编译时间。
tl;dr：有没有办法预定义/修复 nlme/lme4 中的随机效应协方差估计，而不是对它们进行估计？]]></description>
      <guid>https://stats.stackexchange.com/questions/660422/fix-the-random-effects-estimates-in-nlme-lme4</guid>
      <pubDate>Thu, 23 Jan 2025 13:21:39 GMT</pubDate>
    </item>
    <item>
      <title>选择统计方法来分析前后试验中具有多重共线性的计数资料</title>
      <link>https://stats.stackexchange.com/questions/660328/choosing-statistical-methods-for-analyzing-count-data-with-multicollinearity-in</link>
      <description><![CDATA[我正在对数据集进行统计分析，以确定药物的有效性。这是一项有两组的随机试验。我的目的是比较治疗后的发作次数，考虑基线频率。
这项研究的目的是确定该药物是否能有效降低发作频率。具体来说，目标是比较药物组和对照组之间的发作次数，同时考虑基线频率。
最初，我进行了双变量分析。我计算了发作前和发作后次数之间的相关性，并得出了差异。对于这些变量，我检查了它们的整体分布和治疗组分布。使用 Shapiro-Wilk 检验，我发现没有一个分布符合正态性假设，这导致我依靠非参数方法（Mann-Whitney U 检验、中位数无效性检验）进行组间比较。我还使用了 Wilcox 检验来检验中位数=0 的假设并得出置信区间。
由于我只有两组治疗，所以我没有使用 ANOVA 来比较两组的平均值。
对于建模，我首先使用了 ANCOVA 模型
$$
\text{post}_{ij} = \beta_0 + \beta_1 \text{pre}_i + \beta_2 \text{group}_i + \epsilon_{ij},
$$
然后我扩展了这个模型以包含“pre”之间的交互项和“group”：
$$
\text{post}_{ij} = \beta_0 + \beta_1 \text{pre}_i + \beta_2 \text{group}_i + \beta_3 (\text{pre}_i \cdot \text{group}_i) + \epsilon_{ij}。
$$
在两个模型中，残差均不呈正态分布（Shapiro p 值均小于 0.001）。
给定“post”是一个计数变量，我考虑了泊松回归：
$$
\log(\text{post}_{ij}) = \beta_0 + \beta_1 \text{pre}_i + \beta_2 \text{Age}_i + \beta_3 \text{group}_i。
$$
但是，强相关性，特别是“前”和“后”之间的相关性，引发了对多重共线性的担忧。
我的主要问题是：

我采取的步骤（双变量分析、ANCOVA 和 Poisson GLM）是否适合此数据集和研究问题？如果不适合，您会推荐哪些替代方法？
我应该如何处理 ANCOVA 模型中的非正态残差？转换或替代模型是否更合适？
考虑到多重共线性以及变量之间存在强相关性的事实，表明它们之间存在线性关系。应用泊松 GLM 有意义吗？
由于我只有两个测量值（前后），重复测量方差分析是否适用？

我很感激任何指导或建议。谢谢！]]></description>
      <guid>https://stats.stackexchange.com/questions/660328/choosing-statistical-methods-for-analyzing-count-data-with-multicollinearity-in</guid>
      <pubDate>Tue, 21 Jan 2025 16:51:01 GMT</pubDate>
    </item>
    <item>
      <title>参数化的多元条件密度</title>
      <link>https://stats.stackexchange.com/questions/659471/multivariate-conditional-density-when-parametrized</link>
      <description><![CDATA[在 Schervish (1995) 中，定义 1.22 指出

设 $(S, \mathcal{A}, \mu)$ 为概率空间，设
$(\mathcal{X}, \mathcal{B})$ 和 $(\Omega, \tau)$ 为 Borel 空间。设
$X: S \rightarrow \mathcal{X}$ 和 $\Theta: S \rightarrow \Omega$ 为可测的。然后 $\Theta$ 被称为 参数，而 $\Omega$ 被称为 参数空间。给定 $\Theta$ 的 $X$ 的条件分布被称为 $X$ 的参数分布族。 参数族表示为 $$\mathcal{P}_0 = \{P_{\theta} 
:\forall A \in \mathcal{B}, P_{\theta}(A) = \textrm{Pr}(X \in A \mid
\Theta = \theta), \textrm{ for } \theta \in \Omega \}.$$

然后，他写道

假设每个 $P_\theta,$ 在被视为 $(\mathcal{X}, \mathcal{B})$ 上的测度时，相对于 $\nu$ 上的测度是绝对连续的。令
$$f_{X \mid \Theta}(x \mid \theta) = \frac{\mathrm{d}P_\theta}{\mathrm{d} \nu}(x).$$ 在本文中，通常用 $X$ 给定另一个 $Y$ 的条件密度函数表示为 $f_{X \mid Y}.$ 我们可以假设 $f_{X \mid \Theta}$ 相对于乘积域 $\mathcal{B} \otimes \tau.$ 是可测的。这样，我们就可以对该函数进行积分，使其相对于$\mathcal{X}$ 和 $\Omega.$ 函数 $f_{X \mid \Theta}(x \mid \theta),$ 被视为 $\theta$ 的函数，在 $X = x$ 被观察到后，通常被称为 似然函数 $L(\theta).$ 对于每个 $\theta \in \Omega$，函数 $f_{X \mid \Theta}(\cdot \mid \theta)$ 是关于给定 $\Theta = \theta$，变为 $X$ 的 $\nu$。也就是说，对于每个 $A \in \mathcal{B},$
$$\textrm{Pr}(X \in A \mid \Theta = \theta) = \int_A f_{X \mid \Theta}(x \mid \theta) \, \mathrm{d}\nu (x).$$

根据这些定义，我想考虑一个 $X$ 的向量，以便 $\mathbf{X} = (X_1, X_2).$ 为了完全严格，我想我应该改变 $(\mathcal{X}, \mathcal{B})$ 到 $(\mathcal{X}_1 \times \mathcal{X}_2, \mathcal{B}_1 \times \mathcal{B}_2),$ 等。因此，和以前一样，Radon-Nikdoym 定理允许我考虑
$$f_{X_1, X_2 \mid \Theta}(x_1, x_2 \mid \theta) = \frac{\mathrm{d}P_\theta}{\mathrm{d} \nu}(x_1, x_2)。$$ 讨论由公式确定的 $X_2 \mid X_1, \Theta$ 的条件密度是否有意义
$$f_{X_2 \mid X_1, \Theta}(x_2 \mid x_1, \theta) =\frac{f_{X_1, X_2 \mid \Theta}(x_1, x_2 \mid \theta)}{f_{X_1 \mid \Theta}(x_1 \mid \theta)}?$$
我担心的是 $\Theta$ 的存在 — 这可能是我的理解失败的地方。函数 $\Theta$ 不是与 $(X_1, X_2)$ 相关联的吗？ $f_{X_1 \mid \Theta}(x_1 \mid \theta)$ 有意义吗？为什么？如果我考虑 $\mathbf{X} \sim \mathcal{N}(\mathbf{\mu} = (\mu_1, \mu_2), \mathbf{\Sigma})$ 并查看 $f_{X_1}(x_1),$，$\mu_2$ 不会出现，对吗？请尽可能技术化。:)]]></description>
      <guid>https://stats.stackexchange.com/questions/659471/multivariate-conditional-density-when-parametrized</guid>
      <pubDate>Thu, 02 Jan 2025 21:48:23 GMT</pubDate>
    </item>
    <item>
      <title>结合多个调查设计对象的年份，何时适当使用交互项</title>
      <link>https://stats.stackexchange.com/questions/659458/combining-years-for-multiple-survey-design-object-when-to-appropriately-use-inte</link>
      <description><![CDATA[我正在使用 KID（儿童住院数据库）并使用 R 中的调查包。我有两个问题

何时使用 Strata 和 PSU 的交互项：
KID 数据库包含每年重新采样的 PSU（医院），而 Strata 包括 10% 的健康新生儿出院和 80% 的其他出院。
我不确定何时在定义 svydesign() 的 id 和 strata 参数时使用交互项。

id 参数应该使用 ~ PSU 还是 ~ interaction(PSU, YEAR) 来解释医院的年度重新采样？
strata 参数应该使用 ~ strata 还是 ~ interaction(strata, YEAR)？
我想确保设计反映了调查结构。

子集化后是否可以合并 survey.design 对象？还是需要先合并原始数据框，创建一个调查设计对象，然后再子集化？

例如，如果我每年按人口统计组对 survey.design 对象进行子集化，是否可以合并生成的对象？]]></description>
      <guid>https://stats.stackexchange.com/questions/659458/combining-years-for-multiple-survey-design-object-when-to-appropriately-use-inte</guid>
      <pubDate>Thu, 02 Jan 2025 16:44:23 GMT</pubDate>
    </item>
    </channel>
</rss>