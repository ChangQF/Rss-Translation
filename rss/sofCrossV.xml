<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>最近的问题 - 交叉验证</title>
    <link>https://stats.stackexchange.com/questions</link>
    <description>来自 stats.stackexchange.com 的最新 30 条</description>
    <lastBuildDate>Sat, 13 Jul 2024 12:25:42 GMT</lastBuildDate>
    <item>
      <title>使用 NDVI 值分析火灾后植被恢复是否被视为中断时间序列分析？[关闭]</title>
      <link>https://stats.stackexchange.com/questions/650970/is-analyzing-post-fire-vegetation-recovery-with-ndvi-values-considered-an-interr</link>
      <description><![CDATA[我正在开展一个项目，该项目涉及使用 NDVI（归一化差异植被指数）值分析野火后植被的恢复情况。我的目标是评估植被在火灾后如何随时间再生。我在火灾前后定期收集了 NDVI 数据。
以下是我的数据和方法的一些细节：
数据描述：我从卫星图像中收集了受火灾影响的特定区域的 NDVI 值。数据跨越数年，对我主要区域的子区域在一年中的大多数日子进行了测量。
事件：火灾事件发生在我的数据集时间线的中间。
分析目标：我的目标是量化火灾对植被的影响并评估一段时间内的恢复过程。
考虑到这些要点，我想知道这种类型的分析是否可以被视为中断时间序列 (ITS) 分析。具体来说，我有以下问题：
定义和适用性：我的用例是否符合 ITS 的典型定义，即干预（在本例中为火灾）会破坏时间序列数据，目标是研究干预前后的影响？
建模方法：ITS 分析中常用哪些统计或建模方法可以适用于我的 NDVI 数据？是否有针对生态或环境数据推荐的特定模型或技术？
数据注意事项：将 ITS 方法应用于 NDVI 数据时，我应该注意哪些特殊注意事项或预处理步骤？例如，处理卫星图像中的季节性变化、缺失数据、附加数据或噪声。
任何与生态数据和 NDVI 背景下的 ITS 分析相关的指导、资源或示例都将不胜感激。谢谢！]]></description>
      <guid>https://stats.stackexchange.com/questions/650970/is-analyzing-post-fire-vegetation-recovery-with-ndvi-values-considered-an-interr</guid>
      <pubDate>Sat, 13 Jul 2024 11:54:04 GMT</pubDate>
    </item>
    <item>
      <title>箱线图：检测异常的最简单方法？[关闭]</title>
      <link>https://stats.stackexchange.com/questions/650969/box-plot-easiest-way-to-detect-anomalies</link>
      <description><![CDATA[箱线图是否是利用常用方法 Q1 - 1.5 x IQR 作为下限、Q3 + 1.5 x IQR 作为上限来检测异常的最简单方法？
统计学家多久会更改这个 1.5 倍数。我的意思是，是否存在使用其他乘数会给出更好的异常值检测结果的用例？
实际上，这种技术是否专门用于检测异常值？例如，审查年收入在 50000$ -75000 之间的个人的银行交易，这些交易在上限超过其他人，在 Q3 须线之外找到自己的位置。在下限（Q1 须线）作为异常值可能不是审查的理由，因为可以节省全部收入。]]></description>
      <guid>https://stats.stackexchange.com/questions/650969/box-plot-easiest-way-to-detect-anomalies</guid>
      <pubDate>Sat, 13 Jul 2024 10:17:52 GMT</pubDate>
    </item>
    <item>
      <title>函数 step.lmRob() 不起作用[关闭]</title>
      <link>https://stats.stackexchange.com/questions/650968/the-function-step-lmrob-is-not-working</link>
      <description><![CDATA[我有一个线性模型，我通过以下方式（在 R 中）对其进行了分析：lmrob_object&lt;-lmrob(diff_mg ~ age + bmi + energy + fiber + ca + phos + iron + potas + supp + uni, data = data)，其中：
diff_mg 是 DV（两个时间点之间 Mg 摄入量的变化），IV 是：年龄、BMI、能量摄入量、纤维摄入量、Ca 摄入量、磷酸盐摄入量、是否服用补充剂（虚拟变量）以及是否拥有大学学位。
该模型显然不是在常规 lm 函数中运行的，而是使用 lmrob 来获得稳健的结果（模型有几个违规行为：异常值、异方差和非正态性）。 lmrob 属于 robustbase 库。
然后我想通过函数 step.lmRob(lmrob_object) 基于 robsut 程序进行向后消除，该函数属于 complmrob 库。
不幸的是，最后一个命令由于此错误而无法运行：
if (object$est == &quot;initial&quot;) 中的错误警告（&quot;不建议基于初始估计进行推断。&quot;）：
参数长度为零
我该如何解决这个问题？
注意：我的样本 sie 是 30，step.lmRob() 属于 robust 库（其默认为 BE 选择方法）。
我]]></description>
      <guid>https://stats.stackexchange.com/questions/650968/the-function-step-lmrob-is-not-working</guid>
      <pubDate>Sat, 13 Jul 2024 08:08:59 GMT</pubDate>
    </item>
    <item>
      <title>如何估计 RERI 的 CI</title>
      <link>https://stats.stackexchange.com/questions/650966/how-to-estimate-the-ci-of-reri</link>
      <description><![CDATA[
是关于COX模型的。
我读的论文在理解临床试验中的相互作用（亚组）分析。这篇论文的主题是如何估计临床研究中的相互作用。我不知道如何估计相互作用导致的相对超额风险（RERI）的置信区间。本文给出的公式（表2）由几个部分组成，公式中有多个回归系数。
那么，如何用这种方式估计RERI的置信区间呢？非常感谢你的想法。]]></description>
      <guid>https://stats.stackexchange.com/questions/650966/how-to-estimate-the-ci-of-reri</guid>
      <pubDate>Sat, 13 Jul 2024 07:14:47 GMT</pubDate>
    </item>
    <item>
      <title>$A^{-1}$ 的奇异值，其中 $A$ 具有标准正态项</title>
      <link>https://stats.stackexchange.com/questions/650964/singular-values-of-a-1-where-a-has-standard-normal-entries</link>
      <description><![CDATA[关于 $A^{-1}$ 奇异值的行为，您是否有所了解，其中 $A$ 具有标准正态项？
从经验上看，$k$ 第 1 个奇异值似乎以 $1/k$ 的速度衰减，这是众所周知的吗？

colab]]></description>
      <guid>https://stats.stackexchange.com/questions/650964/singular-values-of-a-1-where-a-has-standard-normal-entries</guid>
      <pubDate>Sat, 13 Jul 2024 04:58:29 GMT</pubDate>
    </item>
    <item>
      <title>在 Python 中拟合具有可观察和不可观察因素的线性状态空间模型</title>
      <link>https://stats.stackexchange.com/questions/650963/fitting-a-linear-state-space-model-with-observable-and-unobservable-factors-in-p</link>
      <description><![CDATA[我想要拟合一个具有三个潜在/不可观察因素和一个可观察因素的线性高斯状态空间模型。如下所示：

未观测到的因素遵循自回归过程：

这里，G 是一些参数的转移矩阵，eta 假设具有零均值和常数协方差矩阵。 delta x_t 的维度为 n，b^o 是参数的 n-1 向量，f^o_t+1 是标量并且是可观测的，B^u 是已知且指定的 (n-1)x3 因子载荷矩阵，f^u_t+1 是 R^3 中三个不可观测因子的向量。
我尝试使用 https://www.statsmodels.org/stable/generated/statsmodels.tsa.statespace.dynamic_factor_mq.DynamicFactorMQ.html#statsmodels.tsa.statespace.dynamic_factor_mq.DynamicFactorMQ
但问题是可观察因子，这似乎只适用于所有 f 都未观察到的情况。我想使用 EM 算法来拟合它，但遇到了困难。这应该是标准的，并且能够使用现有的包来完成，也许我只是误解了。
到目前为止，我从头开始尝试了它，但它不起作用。
from numpy.linalg import inv

def em_algorithm_state_space(delta_I, z_test, B_u, max_iter=100, tol=1e-3):
&quot;&quot;&quot;
用于拟合线性高斯状态空间模型的 EM 算法。

参数：
delta_I：(n, k) 观测数据数组。
z_test：(n, 1) 观测因子数组。
B_u：(k, m) 未观测因子载荷矩阵。
max_iter：EM 迭代的最大次数。
tol：收敛容差。

返回：
G：估计的转换矩阵。
Sigma_eta：估计的状态创新协方差矩阵。
b：估计的截距向量。
Sigma_epsilon：估计的观测噪声协方差矩阵。
&quot;&quot;&quot;

n, k = delta_I.shape
m = B_u.shape[1] # 未观测因子的数量

# 初始化参数
G = np.zeros((m, m))
Sigma_eta = np.eye(m)
b = np.zeros((k, 1))
Sigma_epsilon = np.eye(k)
f_t = np.zeros((m, 1)) # 初始状态向量

for _ in range(max_iter):
# E-step：计算状态的条件期望
f_t_cond = np.zeros((m, n))
for t in range(1, n):
# 预测步骤（卡尔曼滤波器）
f_t_pred = G @ f_t
P_t_pred = G @ Sigma_eta @ G.T + Sigma_eta

# 更新步骤（卡尔曼滤波器）
y_t = delta_I[t, :].reshape(-1, 1) - b - B_u @ f_t_pred - z_test[t, :].reshape(-1, 1)
S_t = B_u @ P_t_pred @ B_u.T + Sigma_epsilon
K_t = P_t_pred @ B_u.T @ inv(S_t)
f_t = f_t_pred + K_t @ y_t
P_t = (np.eye(m) - K_t @ B_u) @ P_t_pred

f_t_cond[:, t] = f_t.reshape(-1)

# M-step：更新参数
G = np.dot(f_t_cond[:, 1:] @ f_t_cond[:, :-1].T, inv(np.dot(f_t_cond[:, :-1] @ f_t_cond[:, :-1].T, G) + Sigma_eta))
Sigma_eta = np.dot((f_t_cond[:, 1:] - G @ f_t_cond[:, :-1]) @ (f_t_cond[:, 1:] - G @ f_t_cond[:, :-1]).T, 1 / (n - 1))
b = (delta_I - (B_u @ f_t_cond).T - z_test).mean(axis=0).reshape(-1, 1)
residual = delta_I - b - B_u @ f_t_cond.T - np.tile(z_test.T, (1, k))
Sigma_epsilon = np.dot(residual, residual.T) / n

返回 G、Sigma_eta、b、Sigma_epsilon

# 示例用法（用您的实际数据替换）
# delta_I = ...
# z_test = ...
# B_u = ...

# 拟合模型
G_est、Sigma_eta_est、b_est、Sigma_epsilon_est = em_algorithm_state_space(delta_I_test、z_test、B_u)

print(&quot;Estimated G:&quot;, G_est)
print(&quot;Estimated Sigma_eta:&quot;, Sigma_eta_est)
print(&quot;Estimated b:&quot;, b_est)
print(&quot;Estimated Sigma_epsilon:&quot;, Sigma_epsilon_est)
]]></description>
      <guid>https://stats.stackexchange.com/questions/650963/fitting-a-linear-state-space-model-with-observable-and-unobservable-factors-in-p</guid>
      <pubDate>Sat, 13 Jul 2024 03:28:49 GMT</pubDate>
    </item>
    <item>
      <title>对数据进行多元 Ornstein-Uhlenbeck 过程拟合</title>
      <link>https://stats.stackexchange.com/questions/650962/fitting-a-multivariate-ornstein-uhlenbeck-process-to-data</link>
      <description><![CDATA[我拥有多变量时间序列数据（100 维或更多），并希望检验动态遵循朗之万方程的假设。一个简单的例子是 Ornstein-Uhlenbeck 过程，如何从给定的数据集估计这种多变量过程的参数并测试拟合优度？]]></description>
      <guid>https://stats.stackexchange.com/questions/650962/fitting-a-multivariate-ornstein-uhlenbeck-process-to-data</guid>
      <pubDate>Sat, 13 Jul 2024 02:16:27 GMT</pubDate>
    </item>
    <item>
      <title>Holder 空间中 Nadaraya–Watson 估计量的收敛速度</title>
      <link>https://stats.stackexchange.com/questions/650961/convergence-rate-of-nadaraya-watson-estimator-in-holder-space</link>
      <description><![CDATA[我目前正在使用一些在线公开资料学习非参数回归。
具体来说，考虑模型
$$
y_{i} = f_{0}(x_{i}) + \epsilon_{i}
$$
其中$x_{i}\in \mathcal{X} \subset \mathbb{R}^{d}$，$y_{i}\in \mathcal{Y}\subset\mathbb{R}$，并且$\epsilon_{i}$是独立于$x_{i}$的误差。
当真实均值函数$f_{0}$ 位于 $\beta$ 阶的 Hölder 空间中，我相信 Nadaraya–Watson 估计量的最佳速率是
$$
n^{-\frac{2\beta}{2\beta+d}},
$$
给定特定阶的核和最佳调整的带宽。
我想详细地介绍一下这个收敛速度的证明。但是，我在网上能找到的材料集中在$\beta\in(0,1]$和单变量情况。例如，

CMU 36-708 机器学习中的统计方法的讲义和其中的参考文献仅涵盖 1-Lipschitiz 连续函数的情况。
Larry Wasserman 的所有非参数统计学没有涵盖$\beta&gt;1$案例。

我的问题是，在哪里可以得到给定案例的 N-W 估计量的收敛速度的全面证明$\beta&gt;1$ 和 $d&gt;1$?]]></description>
      <guid>https://stats.stackexchange.com/questions/650961/convergence-rate-of-nadaraya-watson-estimator-in-holder-space</guid>
      <pubDate>Sat, 13 Jul 2024 02:12:02 GMT</pubDate>
    </item>
    <item>
      <title>使用 CPAT 检验检测 AR(1) 模型中的负向变化的问题</title>
      <link>https://stats.stackexchange.com/questions/650959/issues-with-detecting-negative-change-in-ar1-model-using-cpat-tests</link>
      <description><![CDATA[我目前正在评估 CUSUM、Rényi CUSUM 和 Erdős-Darling 检验在检测 AR(1) 模型中的变化点方面的经验功效，特别关注平均值的变化。下面是我用于此分析的代码片段：
library(CPAT)

Test=function(n, nb, beta, ro, alpha, g){
#### 初始化变量和向量
p = 20
X1 = numeric(n + 2 * p)
X2 = numeric(n + 2 * p)
D1 = numeric(n)

prob2 = logical(nb)
prob3 = logical(nb)
prob4 = logical(nb)

a = 1:p

# AR(1) 模型的模拟
for(k in 1:nb){
E = rnorm(n + 2 * p)

# 在变化点之前模拟 AR(1) 模型
X1[1] = rnorm(1)
for(i in 2:(g + p)){
X1[i] = ro * X1[i - 1] + E[i]
}

# 在变化点之后模拟 AR(1) 模型
X2[1] = rnorm(1)
for(i in 2:(n - g + p)){
X2[i] = (ro + beta / sqrt(n)) * X2[i - 1] + E[(g + p + i - 1)]
}

X = c(X1[-a], X2[-a])

# 计算模型残差
D1[1] = X[1] - ro * X1[p]
for(i in 2:n){
D1[i] = X[i] - ro * X[i - 1]
}

# 应用 CPAT 检验并评估功效
prob2[k] = (CUSUM.test(D1, use_kernel_var = FALSE, stat_plot = FALSE, kernel = &quot;ba&quot;, bandwidth = &quot;and&quot;)$p.value &lt; alpha)
prob3[k] = (HR.test(D1, kn = sqrt, use_kernel_var = FALSE, stat_plot = FALSE, kernel = &quot;ba&quot;, bandwidth = &quot;and&quot;)$p.value &lt; alpha)
prob4[k] = (CPAT::stat_de(X) &gt; CPAT::qdarling_erdos(1 - alpha))
}

# 计算模拟中的平均概率
Ls = list(mean(prob2), mean(prob3), mean(prob4))
return(Ls)
}

目前，我遇到一个问题，当 beta（平均值的变化）为负时，测试的功效明显低于指定的显着性水平 alpha。这似乎违反直觉。
我的问题：
我的代码中是否存在导致此问题的错误？
如何确保正确应用 CPAT 包中的函数，以准确确定这些测试在检测 AR(1) 模型中的负面变化方面的功效？]]></description>
      <guid>https://stats.stackexchange.com/questions/650959/issues-with-detecting-negative-change-in-ar1-model-using-cpat-tests</guid>
      <pubDate>Sat, 13 Jul 2024 01:56:27 GMT</pubDate>
    </item>
    <item>
      <title>关于多元正态分布或矩阵变量正态分布的区间删失模拟的参考请求</title>
      <link>https://stats.stackexchange.com/questions/650958/reference-request-about-interval-censored-simulation-for-multivariate-normal-dis</link>
      <description><![CDATA[正如标题所说，我对讨论从多元正态分布或矩阵变量正态分布生成区间删失（或缺失）数据的方法的参考文献感兴趣。据我所知，已经有此处等软件包提供了从矩阵变量分布进行模拟的函数。但是，我还没有找到在多元正态分布或矩阵变量分布的背景下模拟区间删失（或缺失）数据的软件包。
任何参考文献都值得赞赏。]]></description>
      <guid>https://stats.stackexchange.com/questions/650958/reference-request-about-interval-censored-simulation-for-multivariate-normal-dis</guid>
      <pubDate>Sat, 13 Jul 2024 01:16:01 GMT</pubDate>
    </item>
    <item>
      <title>多级模型残差散点图假设</title>
      <link>https://stats.stackexchange.com/questions/650954/multilevel-model-residuals-scatterplot-assumptions</link>
      <description><![CDATA[我正在 SPSS（混合建模）中进行多层次建模 (MLM)，以分析横断面重复测量数据。我的一个因变量是一个按 1 到 10 缩放的调查问题，它产生了附加的残差散点图，该散点图向下倾斜但仍在零线附近保持平衡。这种“倾斜”是否会引起对 MLM 假设得到满足的解释的担忧？
]]></description>
      <guid>https://stats.stackexchange.com/questions/650954/multilevel-model-residuals-scatterplot-assumptions</guid>
      <pubDate>Fri, 12 Jul 2024 23:02:43 GMT</pubDate>
    </item>
    <item>
      <title>FDR 在两种类似治疗的基因表达实验中</title>
      <link>https://stats.stackexchange.com/questions/650719/fdr-in-a-gene-expression-experiment-with-two-similar-treatments</link>
      <description><![CDATA[给出以下实验。在三种条件下获得数千个基因的基因表达谱：两种具有相似表型效应的药物（= 治疗）和一个对照组。对每个基因和两个治疗对照组中的每一个进行测试。目的是比较药物：获得对两种药物和每种药物均有反应的基因列表。
直观地说，在一种治疗中具有相同 p 值但在另一种治疗中具有不同 p 值的两个基因应该具有不同的权重。这个想法是利用许多基因会同时对两种药物产生反应的事实。将同一基因的 p 值组合起来、控制 FDR 并将基因分为对两种药物均有反应和仅对一种药物有反应的基因的正确方法是什么？]]></description>
      <guid>https://stats.stackexchange.com/questions/650719/fdr-in-a-gene-expression-experiment-with-two-similar-treatments</guid>
      <pubDate>Tue, 09 Jul 2024 08:27:24 GMT</pubDate>
    </item>
    <item>
      <title>关于测试可靠性对测试组合权重的影响的问题</title>
      <link>https://stats.stackexchange.com/questions/650558/question-on-the-effect-of-test-reliability-on-weighting-of-a-test-battery</link>
      <description><![CDATA[最初，测试组有 4 个部分：两个 100 项多项选择题测试、一个口语测试和一个论文测试。每个部分测量不同的主题。4 个部分中的每一个权重为 25%。
现在，每个多项选择题测试的测试长度已减少到 60 项（出于实际原因）。每个部分仍占 25%。
如果两个 MC 测试的可靠性降低到零，则两个 MC 测试测量的两个主题的权重将为零。（两个 MC 测试只会产生误差。）实际上，可靠性降低了，但并没有降低到零。
我的问题是，可靠性的变化对两个 MC 测试测量的两个主题的权重有何影响。我如何估计由于变化而导致的权重差异？
澄清：
原始权重是根据相关方的共识选择的。因此，我首先假设原始测试组的权重是理想的（只要各方同意这些权重）。项目数量的减少是出于权宜之计。项目越少，测试可靠性就越低。我试图确定新的测试组与原始测试组相比，在对测试组中每个测试所测量的主题赋予的权重方面，MC 测试时间越短。（直观上看，可靠性越低的测试对测试所测量的主题赋予的有效权重就越低。在极端情况下，如果测试的可靠性为零，它们只会给测试组的总分增加随机噪音，尽管名义权重为 25%，但 MC 测试所测试的主题根本没有任何权重。）
更新以解决评论：
似乎我的问题包含一些不成熟或非标准的词汇。因此，这里是使用其他词语来陈述我的问题的另一种尝试。
25% 的原始权重假设四个测试中的每一个都具有现有的有效性水平，并且一​​致认为这些测试理想情况下应该具有相等的权重。我认为这意味着每个测试最初对总分贡献了 25% 的非随机有效方差。
我推测，切换到较短的 MC 测试已经改变了两个 MC 测试的可靠性，因此也改变了它们的有效性。因此，较短的 MC 测试对总分的有效方差贡献较少。从这个意义上说，它们不再是 25% 的权重。我的问题是，它们的新权重是多少。
两种可能的方法：
这是我对如何处理我提出的问题的一种想法。有效性受可靠性平方根的限制。因此，如果可靠性从 0.8 降低到 0.7，则有效性上限从 0.89 降至 0.84。这似乎意味着新的、更短的 MC 测试的有效贡献比原始测试少 5%。就比例而言，即少 0.05/0.89，或新的较低权重比原始权重少约 6%。也就是说，更短的 MC 测试对总分的有效信息贡献减少了 6%。也许可以通过调整 25% 的权重来弥补这一点。对这种方法有什么看法？
或者，由于可靠性与效用呈线性关系，因此可靠性比率可能是 MC 测试影响减少的更好指标。这可能是 0.7/0.8=0.875，或权重减少 12.5%。对这种方法有什么看法？]]></description>
      <guid>https://stats.stackexchange.com/questions/650558/question-on-the-effect-of-test-reliability-on-weighting-of-a-test-battery</guid>
      <pubDate>Fri, 05 Jul 2024 22:15:38 GMT</pubDate>
    </item>
    <item>
      <title>如果分布中缺少数据，哪种统计数据可以最好地替代真实样本均值？</title>
      <link>https://stats.stackexchange.com/questions/648668/what-statistic-is-best-alternative-to-the-true-sample-mean-in-case-of-missing-da</link>
      <description><![CDATA[我有一组值，其中每个值代表基于一个样本的分布的统计数据。底层可观察值可以假设为粒子长度，因此该值是粒子长度分布的平均值或中位数或其他统计数据。问题是使用图像分析来评估分布。由于粒子重叠，分布不完整且有偏差，因此较长的长度相对于较短的长度被过度代表。一个样本分布中最长的粒子的长度是准确的。每个分布中的粒子数量实际上并不相同，可以假设在 10-50 之间，每个粒子通常与 1-5 个其他粒子重叠。
总而言之，每个样本都会生成一个不完整的离散分布，从中可以计算出一个代表性统计数据。统计数据“最大值”是准确的，其他数据（例如中位数或均值）可能不是，但没有办法通过实验来测试这一点。长度分布未知，但可能不是高斯分布，可能略微偏向大值，而短值很少。还请注意，不同样本的个体分布可能会有所不同，但您可以假设不同样本的分布的总体形状相似，并且真实统计量的分布是正态的。
我的问题是，基于此信息，是否有可能选择最能代表每个样本分布的真实平均值的统计量。特别是，如果离散采样分布中的最大值是准确的，但分布的其他区域由于重叠而被欠采样。直观地说，如果我有 N 个样本，“最佳”意味着这些分布的真实均值与我选择的统计量之间的平方偏差之和最小化，从而使 SSE 最小。
我的直觉是中位数是最好的统计数据。我正在考虑进行一些数值模拟，但为了节省时间，因为这可能是统计学家可以轻松诊断的问题，所以我先在这里询问。提前感谢任何帮助。]]></description>
      <guid>https://stats.stackexchange.com/questions/648668/what-statistic-is-best-alternative-to-the-true-sample-mean-in-case-of-missing-da</guid>
      <pubDate>Wed, 05 Jun 2024 10:06:22 GMT</pubDate>
    </item>
    <item>
      <title>如何对IPTW加权组正确执行对数秩检验？</title>
      <link>https://stats.stackexchange.com/questions/617420/how-to-perform-log-rank-test-correctly-on-iptw-weighted-groups</link>
      <description><![CDATA[非常感谢您的关注！
我正在研究一项关于事件发生时间数据的观察研究。数据有多个协变量，比如 V1-V5。我想评估治疗效果，所以我使用 IPTW（weightit 包）来平衡 V1-V5。IPTW 后，治疗组之间实现了平衡。然而，KM 曲线和对数秩 P 不太匹配，这让我很困惑。
以下是我进行分析的方式：

我首先评估治疗效果，没有进行平衡。我画了 KM 曲线并计算了对数秩 p 值，发现曲线相互重叠，P 值不显著

library(survival)
library(survminer)
fit_surv &lt;- survfit(Surv(time, event) ~ treat, data = data)
ggsurvplot(fit_surv, data = data, pval = T, pval.method = T)


2. 然后我使用 WeightIt 包执行 IPTW 加权，再次画出 KM 曲线并计算对数秩 p 值。但是，我发现曲线彼此分离，但 P 保持不变！
library(WeightIt)
W.out &lt;- weightit(treat ~ V1 + V2 + V3 + V4 + V5,
data = data, estimand = &quot;ATT&quot;, method = &quot;ebal&quot;)
data$weight &lt;- W.out$weights
fit_surv &lt;- survfit(Surv(time, event) ~ treat, data = data, weights = data$weight)
ggsurvplot(fit_surv, data = data, pval = T, pval.method = T)


为什么分开的 KM 曲线会产生完全相同的 P 值？我担心使用了错误的测试方法。
在分析时间事件数据中的加权样本时，测试生存差异的正确方法是什么？
我应该改用 survival::coxph(weight = ...) 吗？
非常欢迎任何建议和评论！]]></description>
      <guid>https://stats.stackexchange.com/questions/617420/how-to-perform-log-rank-test-correctly-on-iptw-weighted-groups</guid>
      <pubDate>Wed, 31 May 2023 11:04:45 GMT</pubDate>
    </item>
    </channel>
</rss>