<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>最近的问题 - 交叉验证</title>
    <link>https://stats.stackexchange.com/questions</link>
    <description>来自 stats.stackexchange.com 的最新 30 条</description>
    <lastBuildDate>Sun, 28 Jul 2024 12:26:26 GMT</lastBuildDate>
    <item>
      <title>如何获得优势比的 95% 置信区间？</title>
      <link>https://stats.stackexchange.com/questions/651891/how-can-i-get-95-confidence-intervals-for-odds-ratios</link>
      <description><![CDATA[我已经使用 R 中的 glmer 拟合了一个随机截距逻辑模型。
假设我得到了变量 x 的某个估计 beta。
然后我可以预测感兴趣事件的 *ODDS 对于几个 x 值，保持其他协变量不变。
这是通过“预测”命令完成的。
我想获得这些 *ODDS 与变量 x 平均值的几率之间的几率比。
这可以通过几个 x 值的预测 *ODDS 与 x 平均值的预测几率之间的比率简单地完成。
问题是，我如何获得这些几率比的置信区间？]]></description>
      <guid>https://stats.stackexchange.com/questions/651891/how-can-i-get-95-confidence-intervals-for-odds-ratios</guid>
      <pubDate>Sun, 28 Jul 2024 12:08:39 GMT</pubDate>
    </item>
    <item>
      <title>寻找潜变量模型的水平曲线</title>
      <link>https://stats.stackexchange.com/questions/651887/finding-level-curves-for-a-latent-variable-model</link>
      <description><![CDATA[我有一个潜在变量模型，它使用两个高斯分布 p(z) 和 p(x|z) 表示 p(x)。p(x|z) 的均值和协方差由使用神经网络的 z 的一些函数表示。
注意：x 和 z 都是二维的。因此函数 p(x) 定义在平面上，其水平曲线将是平面上的曲线。
问题：
我想找到对应于 p(x) = 1 的 p(x) 的水平曲线（轮廓）。
有哪些（有效的）方法可以做到这一点？
到目前为止，我的思考过程：

以某种方式使用 matlab 等内置包中的轮廓查找函数。
从 p(x) 进行某种形式的采样以获得水平曲线。可能的方向：从分布 1 / (1 - p(x)) 中抽样，这将生成接近所需轮廓的高概率样本，然后使用某种方法从采样点近似曲线本身。
]]></description>
      <guid>https://stats.stackexchange.com/questions/651887/finding-level-curves-for-a-latent-variable-model</guid>
      <pubDate>Sun, 28 Jul 2024 10:55:43 GMT</pubDate>
    </item>
    <item>
      <title>Beta分布损失函数</title>
      <link>https://stats.stackexchange.com/questions/651886/beta-distribution-loss-function</link>
      <description><![CDATA[我正在尝试建立一个模型来预测两个数字的比率。该比率的分布采用 beta 分布的形式，介于 0 和 1 之间。到目前为止，我一直在 XGBoost 中使用不同的现有损失函数，但没有成功。我解决这个问题的唯一想法是：

创建我自己的可以模拟 beta 分布的损失函数。但是我不知道如何实现这一点 - 我是否需要根据均值重新参数化 beta 分布的负对数似然？
我不一定非要使用 XGBoost。我愿意尝试其他可以更好地解决这个问题的软件包（GLM 等）。

有什么建议吗？提前谢谢]]></description>
      <guid>https://stats.stackexchange.com/questions/651886/beta-distribution-loss-function</guid>
      <pubDate>Sun, 28 Jul 2024 10:40:58 GMT</pubDate>
    </item>
    <item>
      <title>不使用 RMarkdown 从 {netmeta} 创建结果表摘要</title>
      <link>https://stats.stackexchange.com/questions/651884/creating-a-summary-of-results-table-from-netmeta-without-using-rmarkdown</link>
      <description><![CDATA[我花了几个小时尝试创建一个漂亮的汇总表，我可以将其复制并粘贴到 Word 文档中，但失败了。我正在使用 netmeta 包来建模网络元分析。我尝试使用 RMarkdown、stargazer、modelsummary、xtable、gt，但似乎无法做到，也不知道我哪里做错了。
当我尝试 RMarkdown 时，我在渲染窗口中收到以下错误：
C:\Users\estua\AppData\Roaming\TinyTeX\texmf-dist\scripts\texlive\tlmgr.pl：也许应该更改存储库设置。
C:\Users\estua\AppData\Roaming\TinyTeX\texmf-dist\scripts\texlive\tlmgr.pl：更多信息：https://tug.org/texlive/acquire.html
! LaTeX 错误：未找到文件“multirow.sty”。

! 紧急停止。
&lt;read *&gt; 

错误：LaTeX 无法编译 RMarkdown.tex。请参阅 https://yihui.org/tinytex/r/#debugging 了解调试提示。请参阅 RMarkdown.log 了解更多信息。
执行暂停

当我创建一个数据框来尝试使用上述包时，它只会在表格中输出原始数据，而不是下面这些我正在寻找的摘要结果：
成对比较的数量：m = 32
治疗数量：n = 7
设计数量：d = 10

随机效应模型

治疗估计（sm = &#39;MD&#39;，比较：其他治疗与&#39;无&#39;）：
MD 95%-CI z p 值 95%-PI
ALA 1.8033 [-0.6348; 4.2414] 1.45 0.1472 [-3.8517; 7.4583]
DHAEPA 1.8189 [-2.7954; 6.4332] 0.77 0.4398 [-5.2774; 8.9152] EA 1.3625 [-3.2319； 5.9569] 0.58 0.5611 [-5.7184; 8.4433] LA 0.8687 [-1.6083； 3.3457] 0.69 0.4919 [-4.8065; 6.5439] 单不饱和脂肪酸 0.4155 [-3.7984; 4.6293] 0.19 0.8468 [-6.3760; 7.2069]无。                 。    。       。                  。
SFA 1.4090 [-1.4802; 4.2982] 0.96 0.3392 [-4.4950; 7.3130]

量化异质性/不一致性：
tau^2 = 5.4044; tau = 2.3247; I^2 = 85.7% [78.2%; 90.6%]

异质性（设计内）和不一致性（设计间）检验：
Q d.f. p 值
总计 104.62 15 &lt; 0.0001
设计内 13.80 4 0.0080
设计间 90.82 11 &lt; 0.0001
]]></description>
      <guid>https://stats.stackexchange.com/questions/651884/creating-a-summary-of-results-table-from-netmeta-without-using-rmarkdown</guid>
      <pubDate>Sun, 28 Jul 2024 10:09:08 GMT</pubDate>
    </item>
    <item>
      <title>具有随机效应的 Firth 逻辑回归</title>
      <link>https://stats.stackexchange.com/questions/651882/firth-logistic-regression-with-random-effects</link>
      <description><![CDATA[有没有办法在引入随机效应的同时实现 Firth 的逻辑回归？]]></description>
      <guid>https://stats.stackexchange.com/questions/651882/firth-logistic-regression-with-random-effects</guid>
      <pubDate>Sun, 28 Jul 2024 08:00:20 GMT</pubDate>
    </item>
    <item>
      <title>特征的对数变换会影响随机森林的结果吗？[关闭]</title>
      <link>https://stats.stackexchange.com/questions/651877/does-log-transform-on-features-affect-random-forest-results</link>
      <description><![CDATA[这是常识，而且我到处都能看到这一点，即特征上的对数变换（我假设目标也是如此，而且我读到它是相同的）不会影响任何基于决策树的算法的结果。
这很有道理，但实际上我确实看到了变化的发生。 100%。
和我交谈过的每个人都告诉我他们看到了变化。
这怎么解释呢？
令人惊讶的是，在互联网上没有找到任何专门研究它的人。
但我确实找到了这个
为什么对决策树进行对数变换为正态分布？
答案似乎是矛盾的（好吧，他们谈论目标，但我认为没有任何区别），一方面他们说随机森林不应该改变，但另一方面他们确实解释说极端值应该有所改变。
我为什么要关心它是否极端？这仍然意味着在某些情况下对数转换应该会改变结果。
他们还谈到了最小化平方误差，但分类中的熵呢？这不应该受到使用对数压缩范围的影响。
或者说，对于回归类型，随机森林确实受对数影响，而对于分类问题则不受影响，这种说法正确吗？（虽然在我读过的互联网文章中，没有区分，并说随机森林不应该受到特征/目标对数的影响。）
也许有些情况下它会受到影响？例如，当看不见的数据非常不同且极端时？对数应该有影响吗？我仍然不明白分类模型是如何受到影响的。]]></description>
      <guid>https://stats.stackexchange.com/questions/651877/does-log-transform-on-features-affect-random-forest-results</guid>
      <pubDate>Sun, 28 Jul 2024 00:35:07 GMT</pubDate>
    </item>
    <item>
      <title>模拟中的偏差以更高的速率对低频事件进行采样</title>
      <link>https://stats.stackexchange.com/questions/651874/bias-in-simulation-samples-low-frequency-event-at-higher-rates</link>
      <description><![CDATA[我试图模拟一个包含 x 次试验和 y 个受试者的数据集，其中每次试验都可以是 3 个分类变量之一，与一个唯一概率相关联。对于每个受试者和试验，我还想在这些概率中添加噪声，因此每个受试者都有一个唯一的概率向量，并且每次试验都是有噪声的。
原始状态概率为 [.1,.4,.5]。为了添加受试者和试验噪声，我为每个受试者和每个试验生成随机噪声，然后将状态概率与受试者噪声和试验噪声相加。然后，我将这个新向量用作狄利克雷分布的 alpha 参数，以生成有噪声的受试者和试验状态概率。然后，我使用这些从多项分布中抽样。
但是，随着我增加试验和受试者的噪声，会出现偏差。如果我以低噪声采样，最终我将以原始概率对状态进行采样。如果我以更高的噪声采样，则会出现偏差，其中 .1 概率将以更高的速率采样（~.12）。我该如何解释这一点？
代码
library(tidyverse)
library(DirichletReg)

log_odds &lt;- function(probs) {
return(log(probs / (1 - probs)))
}

prob_from_log &lt;- function(logs){
return( exp(logs)/ (1+exp(logs)))
}

sample_from_dirichlet &lt;- function(alpha_params) {
return(rdirichlet(n = 1, alpha = alpha_params))
}

sample_from_multinomial &lt;- function(prob_vector) {
sample &lt;- rmultinom(n = 1, size = 1, prob = unlist(prob_vector))
return(which(sample==1))
}

initial_p &lt;- c(.1,.4,.5) # 初始状态概率

n_trials &lt;- 100 # 要考虑的试验次数

n_subjects &lt;- 100 # 要考虑的最大样本量

subj_int &lt;- .5 # 对数几率中受试者变化截距

error &lt;- .5 # 对数几率中每次试验的残差

# 使用试验创建一个数据框
items &lt;- data.frame(trial_id = rep(seq(n_trials),1), 
condition = rep(c(&quot;base&quot;), c(n_trials)) )

# 使用受试者噪声创建一个数据框
subjects &lt;- data.frame(subj_id = seq_len(n_subjects), 
subj_intercept = I(lapply(1:n_subjects, function(x) rnorm(n=length(initial_p),平均值=0，sd=subj_int))))

试验 &lt;- crossing(subjects, items) %&gt;% # 合并项目和受试者数据框
mutate(e_si =I(lapply(1:nrow(.), function(x) rnorm(n=length(initial_p), mean=0, sd=error))), # 创建试验特定噪声
initial_p_values= I(rep(list(initial_p), nrow(.))), # 添加概率向量
log_p= I(lapply(initial_p_values, log_odds)), # 将概率转换为对数几率
total_noise = map2(subj_intercept, e_si, ~ .x + .y), # 合并噪声源 (subject+trial)
final_log = map2(log_p, total_noise, ~ .x + .y), # 合并对数几率向量和噪声
final_p_non_sum = I(lapply(final_log, prob_from_log)), # 返回概率
alpha_params = I(lapply(final_p_non_sum, function(p) p * 1000)), # 缩放概率以用作 dirichlet 中的 alpha 参数
dirichlet_sample = I(lapply(alpha_params, sample_from_dirichlet)), # 总和为 1 的样本概率
sample_state = lapply(dirichlet_sample,sample_from_multinomial)) # 从多项分布中抽样

trials %&gt;% 
group_by(sample_state) %&gt;% 
count() %&gt;% 
mutate(perc=n/(n_trials*n_subjects)) -&gt; res

打印（res）
```
]]></description>
      <guid>https://stats.stackexchange.com/questions/651874/bias-in-simulation-samples-low-frequency-event-at-higher-rates</guid>
      <pubDate>Sat, 27 Jul 2024 22:25:27 GMT</pubDate>
    </item>
    <item>
      <title>多重 t 检验分析或个体 t 检验</title>
      <link>https://stats.stackexchange.com/questions/651872/multiple-t-test-analysis-or-indidivual-t-tests</link>
      <description><![CDATA[我必须使用 t 检验来分析样本。我不确定我是否应该将样本视为单个 t 检验或多个 t 检验。以下是详细信息：
我有一个实验，我分析了 30 种不同代谢物在 24 和 48 小时内的浓度。因此，我想知道每种代谢物在 24 小时和 48 小时之间是否存在显着差异。我对了解代谢物是否彼此不同并不感兴趣。我考虑运行 30 个单独的 t 检验（对每个代谢物进行一次 t 检验，评估 24 和 48 小时），但我不确定这是否可以，或者我是否应该考虑所有 30 种代谢物运行多个 t 检验。如果需要多个，有人可以告诉我原因吗？
谢谢]]></description>
      <guid>https://stats.stackexchange.com/questions/651872/multiple-t-test-analysis-or-indidivual-t-tests</guid>
      <pubDate>Sat, 27 Jul 2024 21:05:22 GMT</pubDate>
    </item>
    <item>
      <title>在 APA 格式的句子中，下列哪项是正确的：零还是 0？一还是 1？[关闭]</title>
      <link>https://stats.stackexchange.com/questions/651868/which-is-correct-for-writing-statstics-in-a-sentence-in-apa-style-zero-or-0-on</link>
      <description><![CDATA[示例：

如果两家公司位于同一国家，则指示变量等于一，否则等于零。

或者：

如果两家公司位于同一国家，则指示变量等于1，否则等于0。
]]></description>
      <guid>https://stats.stackexchange.com/questions/651868/which-is-correct-for-writing-statstics-in-a-sentence-in-apa-style-zero-or-0-on</guid>
      <pubDate>Sat, 27 Jul 2024 18:22:37 GMT</pubDate>
    </item>
    <item>
      <title>概率分布之间的距离</title>
      <link>https://stats.stackexchange.com/questions/651853/distance-between-probability-distributions</link>
      <description><![CDATA[我试图理解概率分布之间的三种距离之间的差异，例如它们的优点和缺点是什么，它们强调什么和不强调什么，本质上从实际的角度来看：何时使用这一个而不是另一个，它很容易用数字计算/估计，等等。在这里我只对绝对连续的一维概率分布感兴趣。给定两个这样的概率分布 $P$ 和 $Q$，我感兴趣的三个距离是：

总变异距离 (TVD)：
$$
\mathsf{TVD}(P,Q)=\int_\mathbb{R}\big|p(x)-q(x)\big|\,\mathrm{d}x,
$$
其中 $p$ 是与 $P$ 相关的概率密度函数 (PDF)，而 $q$ 是与 $Q$ 相关的概率密度函数。
 Wasserstein-1 距离：
$$
\mathsf{W}_1(P,Q)=\int_0^1\big|F^{-1}(q)-G^{-1}(q)\big|\,\mathrm{d}q=\int_\mathbb{R}\big|F(x)-G(x)\big|\,\mathrm{d}x,
$$
其中 $F$ 是与 $P$ 相关的累积概率函数 (CDF)，而 $G$ 是与 $Q$ 相关的累积概率函数。
最大均值差 (MMD) 距离，其函数类被视为希尔伯特空间$\mathcal{H}$的单位球:
$$
\textsf{MMD}_\varphi(P,Q)=\big\|\mathbb{E}_{X\sim P}[\varphi(X)]-\mathbb{E}_{Y\sim Q}[\varphi(Y)]\big\|_\mathcal{H},
$$
其中$\varphi:\mathbb{R}\to\mathcal{H}$。在这篇文章中，我主要感兴趣的是 $\varphi$ 与高斯核的关系：
$$
\big\langle\varphi(x),\varphi(y)\big\rangle_\mathcal{H}=k(x,y)=\exp\left(-\frac{1}{2\sigma^2}|x-y|^2\right).
$$

我感兴趣的是这些距离之间的差异。例如，在我看来：

$\mathsf{W}_1$ 比较了分布中分位数或质量分配的差异（注意：我知道 $\mathsf{W}_1$ 的最佳传输解释，而 $\mathsf{TVD}$ 比较了质量，但在“原子级”上，因为它涉及 PDF，所以它会“更紧密”，
上面的 $\textsf{MMD}_\varphi$ 的特定实例将比较两个分布之间的所有矩，如果我们从弥散、偏度和峰度的角度考虑，那么就会强调&quot; 分布的几何形状&quot;。
在数值方面，假设 $P$ 和 $Q$ 未知，如果我得到 $P$ 和 $Q$ 的样本，那么对于 $\mathsf{TVD}$，我必须估计 PDF 并近似积分。对于 $\mathsf{W}_1$ 也是如此：需要估计 CDF 并近似积分。但是，对于 $\textsf{MMD}_\varphi$，使用核技巧很容易获得 &quot; 插件&quot;距离的估计量。

在统计/数据科学/机器学习中，哪些用例会使用一种距离而不是其他距离，为什么？有人有简单的例子可以解释这三种距离之间的差异吗？谢谢帮助！]]></description>
      <guid>https://stats.stackexchange.com/questions/651853/distance-between-probability-distributions</guid>
      <pubDate>Sat, 27 Jul 2024 06:57:39 GMT</pubDate>
    </item>
    <item>
      <title>预期值是否相对于 CDF 单调递减？[关闭]</title>
      <link>https://stats.stackexchange.com/questions/651851/is-the-expected-value-monotonically-decreasing-with-respect-to-the-cdf</link>
      <description><![CDATA[当$P(X\ge0)=1$时，$E[X]=\int_0^1(1-F(x))dx\in[0,1]$。
那么，$E[X]$相对于$F(x)$单调递减，这一说法正确吗？
如果可能的话，我希望对此有一个简单的证明。
已添加：

$F(x)$ 是随机变量 $X$ 的累积分布函数，而不是 X 的 PDF。
“$E(X)$ 相对于 $F(x)$ 单调递减吗”意味着
$a\ge b\Rightarrow F(a)\ge F(b)\Rightarrow E(F(a)) \le E(F(b))$

已添加 2：

感谢所有评论和回答！正如 Sextus Empiricus 和 whuber 指出的那样，我的问题写得不太恰当，抱歉……
我的问题应该是这样的，是否存在满足以下条件的 $f(X)$？对于任何随机有价值的$X$，$E(X)&gt;E(f(X))\Rightarrow \forall x\in \mathbb{R};F_X(x)\le F_{f(x)}(x) $。
事实上，像 $f(X)=X-a \:(a\in\mathbb{R}^+)$ 这样的函数就是一个例子。
]]></description>
      <guid>https://stats.stackexchange.com/questions/651851/is-the-expected-value-monotonically-decreasing-with-respect-to-the-cdf</guid>
      <pubDate>Sat, 27 Jul 2024 05:06:34 GMT</pubDate>
    </item>
    <item>
      <title>重复嵌套交叉验证的标准误差</title>
      <link>https://stats.stackexchange.com/questions/651813/standard-error-of-repeated-nested-cross-validation</link>
      <description><![CDATA[是否有与模型无关的公式来计算 K 倍交叉验证、嵌套交叉验证或重复嵌套交叉验证预测结果的标准误差？
我刚刚偶然发现了这篇文章 ht tps://stackoverflow.com/questions/34914229/which-standard-deviation-of-the-cross-validation-score#:~:text=The%20standard%20deviation%20is%20a,the%20scores%20for%20k%20folds.&amp;text=(These%20ranges%20are%20called%20confidence%20intervals.)
上面写着“K folds 的标准差 / sqrt(K) 是分数的标准误差”，但我真的找不到关于此的其他参考资料。
如果有一个通用且有效的公式（或至少是近似值），那么知道这一点会很方便，因为这将允许例如从多个插补中获得不确定性估计。
问候
Ole]]></description>
      <guid>https://stats.stackexchange.com/questions/651813/standard-error-of-repeated-nested-cross-validation</guid>
      <pubDate>Fri, 26 Jul 2024 14:18:17 GMT</pubDate>
    </item>
    <item>
      <title>在对 betadisper 进行显著的方差分析后，使用 Permutest 或 TukeyHSD 进行分组比较？</title>
      <link>https://stats.stackexchange.com/questions/651794/permutest-or-tukeyhsd-for-group-wise-comparison-after-significant-anova-of-betad</link>
      <description><![CDATA[我想使用我的蜘蛛群落数据执行 PERMANOVA，这些数据是在不同的林分中采样的。在应用 PERMANOVA 之前，我想找出各组之间的分散度是否存在差异。
为此，我使用了 betadisper
dispersion_stands_trap &lt;- 
betadisper(all_dist_trap, 
meta_distance_trap$stand)

这将返回一个重要的输出
&gt; anova(dispersion_stands_trap)
方差分析表

响应：距离
Df 总和 平方均值 平方 F 值 Pr(&gt;F) 
组 4 0.2124 0.053107 2.4785 0.04653 *
残差 149 3.1927 0.021427 
---
显著性代码：0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

为了正确解释我的数据，我想知道哪些组在分散度上完全不同。
我读到我可以使用 TukeyHSD 或 permutest 进行成对比较。
permutest(dispersion_stands_trap, 
pairwise=TRUE)

返回以下内容：
成对比较：
（对角线下方观察到的 p 值，对角线上方置换的 p 值）
D DB B FB F
D 0.1450000 0.0980000 0.0030000 0.399
DB 0.1502930 0.8250000 0.1040000 0.558
B 0.0987879 0.8288240 0.1640000 0.425
FB 0.0035463 0.1172937 0.1621860 0.026
F 0.3962535 0.5326374 0.3977593 0.0291775

但是当我使用
TukeyHSD(dispersion_stands_trap)

显著性比较会发生变化（显著性效应丧失F-FB):
 Tukey 均值多重比较
95% 家族置信水平

拟合：aov（公式 = 距离 ~ 组，数据 = df）

$group
diff lwr upr p adj
DB-D 0.060699868 -0.042825680 0.16422542 0.4875989
B-D 0.068575786 -0.036690784 0.17384236 0.3780614
FB-D 0.112144505 0.009417572 0.21487144 0.0248321
F-D 0.036470261 -0.066256672 0.13919719 0.8637376
B-DB 0.007875918 -0.096552782 0.11230462 0.9995769
FB-DB 0.051444637 -0.050423540 0.15331281 0.6321060
F-DB -0.024229607 -0.126097784 0.07763857 0.9651200
FB-B 0.043568719 -0.060068327 0.14720576 0.7735077
F-B -0.032105525 -0.135742571 0.07153152 0.9124905
F-FB -0.075674244 -0.176730709 0.02538222 0.2395908


这让我想到我应该依赖这两个测试中的哪一个？
我的设计有点不平衡
D 30，
DB 31，
B 29，
FB 32，
F 32
这会有问题吗？]]></description>
      <guid>https://stats.stackexchange.com/questions/651794/permutest-or-tukeyhsd-for-group-wise-comparison-after-significant-anova-of-betad</guid>
      <pubDate>Fri, 26 Jul 2024 08:29:46 GMT</pubDate>
    </item>
    <item>
      <title>为什么不使用FFT和使用FFT的自相关计算会给出不同的结果？</title>
      <link>https://stats.stackexchange.com/questions/651749/why-are-the-autocorrelation-computations-without-fft-and-with-fft-giving-differe</link>
      <description><![CDATA[]]></description>
      <guid>https://stats.stackexchange.com/questions/651749/why-are-the-autocorrelation-computations-without-fft-and-with-fft-giving-differe</guid>
      <pubDate>Thu, 25 Jul 2024 14:36:20 GMT</pubDate>
    </item>
    <item>
      <title>lavaan 中使用 efa 模型进行 df（错误）计算</title>
      <link>https://stats.stackexchange.com/questions/651612/df-miscalculation-with-efa-models-in-lavaan</link>
      <description><![CDATA[我一直在研究一些将 EFA 脚本包装在 lavaan 中的功能，并注意到一些 df 似乎不对劲。我现在想知道我是否犯了错误/忽略了某些东西，或者更确切地说，使用 cfa() 来拟合这些模型是否发生了一些意外或错误的事情（就像在 EFA lavaan 教程/示例 中所做的那样）
要使用相同的示例（如果方便的话），请安装我开发的包（其中包含我使用的内置数据集）：
install.packages(&quot;dySEM&quot;)

library(dySEM)
library(lavaan)

dat &lt;- commitmentQ

fac1.script &lt;- &quot;
#测量模型

#载荷
efa(&#39;efa&#39;)*f1 =~ sat.g.1_1+sat.g.1_2+sat.g.1_3+sat.g.1_4+sat.g.1_5 + sat.g.2_1+sat.g.2_2+sat.g.2_3+sat.g.2_4+sat.g.2_5

#残差方差
sat.g.1_1 ~~ sat.g.1_1
sat.g.1_2 ~~ sat.g.1_2
sat.g.1_3 ~~ sat.g.1_3
sat.g.1_4 ~~ sat.g.1_4
sat.g.1_5 ~~ sat.g.1_5

sat.g.2_1 ~~ sat.g.2_1
sat.g.2_2 ~~ sat.g.2_2
sat.g.2_3 ~~ sat.g.2_3
sat.g.2_4 ~~ sat.g.2_4
sat.g.2_5 ~~ sat.g.2_5

#残差协方差
sat.g.1_1 ~~ sat.g.2_1
sat.g.1_2 ~~ sat.g.2_2
sat.g.1_3 ~~ sat.g.2_3
sat.g.1_4 ~~ sat.g.2_4
sat.g.1_5 ~~ sat.g.2_5 
&quot;

fac2.script &lt;- &quot;
#测量模型

#载荷
efa(&quot;efa&quot;)*f1 +
efa(&quot;efa&quot;)*f2 =~ sat.g.1_1 + sat.g.1_2 + sat.g.1_3 + sat.g.1_4 + sat.g.1_5 + sat.g.2_1 + sat.g.2_2 + sat.g.2_3 + sat.g.2_4 + sat.g.2_5

#残差方差
sat.g.1_1 ~~ sat.g.1_1
sat.g.1_2 ~~ sat.g.1_2
sat.g.1_3 ~~ sat.g.1_3
sat.g.1_4 ~~ sat.g.1_4
sat.g.1_5 ~~ sat.g.1_5

sat.g.2_1 ~~ sat.g.2_1
sat.g.2_2 ~~ sat.g.2_2
sat.g.2_3 ~~ sat.g.2_3
sat.g.2_4 ~~ sat.g.2_4
sat.g.2_5 ~~ sat.g.2_5

#残差协方差
sat.g.1_1 ~~ sat.g.2_1
sat.g.1_2 ~~ sat.g.2_2
sat.g.1_3 ~~ sat.g.2_3
sat.g.1_4 ~~ sat.g.2_4
sat.g.1_5 ~~ sat.g.2_5 
&quot;

fac3.script &lt;- &quot;
#测量模型

#载荷
efa(&quot;efa&quot;)*f1 +
efa(&quot;efa&quot;)*f2 +
efa(&quot;efa&quot;)*f3 =~ sat.g.1_1 + sat.g.1_2 + sat.g.1_3 + sat.g.1_4 + sat.g.1_5 + sat.g.2_1 + sat.g.2_2 + sat.g.2_3 + sat.g.2_4 + sat.g.2_5

#残差方差
sat.g.1_1 ~~ sat.g.1_1
sat.g.1_2 ~~ sat.g.1_2
sat.g.1_3 ~~ sat.g.1_3
sat.g.1_4 ~~ sat.g.1_4
sat.g.1_5 ~~ sat.g.1_5

sat.g.2_1 ~~ sat.g.2_1
sat.g.2_2 ~~ sat.g.2_2
sat.g.2_3 ~~ sat.g.2_3
sat.g.2_4 ~~ sat.g.2_4
sat.g.2_5 ~~ sat.g.2_5

#残差协方差
sat.g.1_1 ~~ sat.g.2_1
sat.g.1_2 ~~ sat.g.2_2
sat.g.1_3 ~~ sat.g.2_3
sat.g.1_4 ~~ sat.g.2_4
sat.g.1_5 ~~ sat.g.2_5 
&quot;

当我拟合这些时...（默认为 geomin 旋转，因此估计因子相关性）：
sat.defa1.fit &lt;- cfa(fac1.script , data = commitmentQ)
sat.defa2.fit &lt;- cfa(fac2.script , data = commitmentQ)
sat.defa3.fit &lt;- cfa(fac3.script , data = commitmentQ)

并比较它们...：
anova(sat.defa1.fit, sat.defa2.fit, sat.defa3.fit)

我得到：

1 个因子的 df 为 30，
2 个因子的 df 为 21，
13 df 3 因子

这适用于 1 因子模型。遵循 p(p+1)/2 公式：
已知：10(10+1)/2 = 55
1 因子模型估计 10 个因子载荷、10 个残差方差、5 个残差协方差 = 25 个估计值
1 因子的 df：55 - 25 = 30。
到目前为止一切顺利。
因此，要转向 2 因子，将涉及估计 10 个额外载荷（到第二个因子上）以及 F1 和 F2 之间的相关性。因此估计另外 11 个因素 (36)
2 因子的 df 应为 55 - 36 = 19
但对于此模型，anova() 显示 df 21（df diff 为 9，而不是 11）
对于 3 因子模型，问题似乎更加复杂：
应估计 48 个元素（添加 20 个新因子载荷与 1 因子模型 + 3 因子相关性），因此 df 应为 7，而 anova() 返回 13。
知道这里发生了什么吗？我查看了每个模型的parameterEstimates()的nrow()（减去用于识别/尺度设置的固定方差），它对应于我对每个模型的ests计数。
我还禁用了均值结构估计（无论如何它都没有估计）以防万一，但无济于事。]]></description>
      <guid>https://stats.stackexchange.com/questions/651612/df-miscalculation-with-efa-models-in-lavaan</guid>
      <pubDate>Tue, 23 Jul 2024 18:17:53 GMT</pubDate>
    </item>
    </channel>
</rss>