<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>最近的问题 - 交叉验证</title>
    <link>https://stats.stackexchange.com/questions</link>
    <description>来自 stats.stackexchange.com 的最新 30 条</description>
    <lastBuildDate>Mon, 24 Jun 2024 12:28:39 GMT</lastBuildDate>
    <item>
      <title>$f(a) = EX^{1+a}EX^{-(1+a)}$ 是非减的吗？</title>
      <link>https://stats.stackexchange.com/questions/649797/is-fa-ex1aex-1a-non-decreasing</link>
      <description><![CDATA[$X$ 是一个非负随机变量，$a$ 是一个非负实数。定义
$$f(a)= EX^{1+a}EX^{-(1+a)}.$$
$f(a)$ 是否非递减，且 $a$？
原始问题：当我阅读论文时，我遇到了一个未经证实的不等式
$$\frac{\sum_{m=0}^{T-1}E_m^{1+\delta/2}\sum_{m=0}^{T-1}1/E_m^{1+\delta/2}}{T^2}\leq \frac{\sum_{m=0}^{T-1}E_m^{1+\delta_3}\sum_{m=0}^{T-1}1/E_m^{1+\delta_3}}{T^2}
$$
由于$\delta &lt; \delta_3$。这里$E_m$是非减实数，T是某个正整数。我想证明这个结果的更强版本，但我失败了。我想知道我的猜想是否正确？或者有任何反例吗？
谢谢！]]></description>
      <guid>https://stats.stackexchange.com/questions/649797/is-fa-ex1aex-1a-non-decreasing</guid>
      <pubDate>Mon, 24 Jun 2024 12:18:03 GMT</pubDate>
    </item>
    <item>
      <title>通过网页抓取进行数据挖掘[关闭]</title>
      <link>https://stats.stackexchange.com/questions/649792/data-mining-by-web-page-scraping</link>
      <description><![CDATA[如何从网页中提取超链接和相关信息？使用 DataBricks、PySpark 和 Beautiful Soup]]></description>
      <guid>https://stats.stackexchange.com/questions/649792/data-mining-by-web-page-scraping</guid>
      <pubDate>Mon, 24 Jun 2024 11:22:55 GMT</pubDate>
    </item>
    <item>
      <title>是否有一个有意义的选项可以计算格兰杰因果关系的效应大小？</title>
      <link>https://stats.stackexchange.com/questions/649791/is-there-a-meaningful-option-to-compute-something-like-an-effect-size-for-grange</link>
      <description><![CDATA[我正在使用 statsmodels.tsa.stattools.grangercausalitytests 在多个时间序列对之间运行 Granger 因果关系 (GC) 分析。
用于 GC 分析的时间序列对都具有相同长度的 n = 720 个数据点，并且它们都使用相同类型的测量。
因此，我获得了时间序列 A) 与时间序列 B) 的 GC 统计数据，时间序列 B) 与时间序列 C) 的 GC 统计数据，依此类推。这些 GC 对产生不同的 p 值，例如在基于 SSR 的卡方检验中。
这是我的问题：我无法使用一对中比另一对中更低的 p 值来推断 GC 在第一对中的效应比在第二对中更高（或更强）。这是因为 p 值主要考虑估计精度，因此弱关系仍然可以产生较低的 p 值。
但是让我们假设一个 GC 对产生的 p 值为 0.005，而另一个 GC 对产生的 p 值为 0.1，在基于 SSR 的卡方检验中。有没有办法进一步证明第一种情况下的 GC 效应高于第二种情况？
在不深入讨论我的分析的所有理论细节的情况下，在我的案例中，“p 值的层次结构”跨 GC 对或比较反映了我理论上的预期。这意味着应该表现出高效应大小的 GC 对也会产生比我预期效应大小较小的 GC 对更低的 p 值。
但我无法使用 p 值来统计地支持我的理论推论，这是我的问题。因此，我正在寻找一种附加或额外的方法来以某种方式阐明我的观点。]]></description>
      <guid>https://stats.stackexchange.com/questions/649791/is-there-a-meaningful-option-to-compute-something-like-an-effect-size-for-grange</guid>
      <pubDate>Mon, 24 Jun 2024 11:10:13 GMT</pubDate>
    </item>
    <item>
      <title>基于多重样本回归的总体参数估计</title>
      <link>https://stats.stackexchange.com/questions/649790/estimation-of-population-parameters-on-the-basis-of-multiple-samples-regressions</link>
      <description><![CDATA[我正在研究大约 100 万个受试者的群体，我对他们的支出 (expend) 进行了重复测量。
我的目标是评估 2 个变量（假设 A 和 B）与支出金额之间的联系。鉴于数据的纵向性质和混杂因素的存在，我无法直接估计这些关联。因此，我承诺使用 R 和 lme4 库进行混合建模。这是我们感兴趣部分的代码。
 glmer(expend ~ A*B + (1|ID), family = Gamma(link = &quot;log&quot;), data = data)
考虑到人口规模，对所有数据进行这种回归显然是不可行的。因此，我承诺使用从总体中抽取的随机样本反复重复此回归模型。
最后，我得到了一个包含 5,000 个模型的样本，显然我有这些模型的参数及其方差的估计量。
我想，仅使用固定效应获得的估计量的分布可以让我估计与它们相关的标准误差，但我更感兴趣的是估计它们在初始总体中的分布，从而获得它们在这个总体中的标准差。
为此，我遵循了以下步骤并使用以下符号：
$ N $ 样本数/回归
$ n_{Ai} $ 样本 i 中具有特征 A 的观测值数量和 $ n_{\overline{A}i} $ 没有特征 A 的观测值数量
$ \beta_{Ai} $ 回归 i 的参数 A 的估计量
1 ：将获得的回归参数居中：$ \beta_{Ai}&#39; = \beta_{Ai} - \frac{\sum{\beta_{Ai}}}{n} $
2 ：乘以每个回归中隐含的观测值均方数：$ \beta_{Ai}&#39;&#39; = \beta_{Ai}&#39; \times \frac{\sum{(\sqrt{n_{Ai}}/2}+\sqrt{n_{\overline{A}i}}/2)}{n} $
3：重新定位参数：$ \beta_{Ai}&#39;&#39;&#39; = \beta_{Ai}&#39;&#39; + \frac{\sum{\beta_{Ai}}}{n} $
4：根据$\beta_{Ai}&#39;&#39;&#39;$的分布估计总体中参数的标准差
为了测试这种方法，我使用已知参数的分布进行了模拟。结果表明，通过我刚刚描述的程序获得的方差总是略微高估了源分布的方差。
如果您能帮助我更好地理解这个问题，我将不胜感激。]]></description>
      <guid>https://stats.stackexchange.com/questions/649790/estimation-of-population-parameters-on-the-basis-of-multiple-samples-regressions</guid>
      <pubDate>Mon, 24 Jun 2024 10:59:26 GMT</pubDate>
    </item>
    <item>
      <title>PP 图未出现在输出中</title>
      <link>https://stats.stackexchange.com/questions/649789/pp-plot-not-appearing-in-output</link>
      <description><![CDATA[我试图通过生成一些 PP 图来测试 ANOVA 的假设。这对我想要检查的大多数变量都有效，但出于某种未知原因，我没有看到某个变量的图表，而是看到一个空框，里面有红色文字：
无法调用“com.spss.vis.Visualization.getSpecification()”，因为“”为空。
有人知道这是什么意思吗？这个变量与我已成功生成图表的其他变量没有什么不同。]]></description>
      <guid>https://stats.stackexchange.com/questions/649789/pp-plot-not-appearing-in-output</guid>
      <pubDate>Mon, 24 Jun 2024 09:56:37 GMT</pubDate>
    </item>
    <item>
      <title>中心简单回归</title>
      <link>https://stats.stackexchange.com/questions/649787/central-simple-regression</link>
      <description><![CDATA[
我得出了 $$\sigma^2 + \sigma^2 \cdot \frac{\sum_{i=n_1}^{n} x_i^2}{\sum_{i=1}^{n_1} x_i^2} \cdot \frac{1}{n - n_1}$$
这个表达式正确吗？]]></description>
      <guid>https://stats.stackexchange.com/questions/649787/central-simple-regression</guid>
      <pubDate>Mon, 24 Jun 2024 09:26:50 GMT</pubDate>
    </item>
    <item>
      <title>最小二乘法中协方差矩阵贝叶斯推导的误差</title>
      <link>https://stats.stackexchange.com/questions/649786/error-in-bayesian-derivation-of-covariance-matrix-in-least-squares</link>
      <description><![CDATA[我知道这个问题的变体已经被问过一百万次了，但我不只是问“我如何推导协方差矩阵”，而是请你检查我计算中的错误，因为我被难住了……
我有最小二乘问题
$$\min_p \frac{1}{2}\lVert r(p)\rVert^2,$$
其中$r(p) = W(y-f(p))$是我的残差向量。这里 $y\in \mathbb{R}^{N_y}$ 是观测向量，$f(p)$ 是向量值模型函数，$p \in \mathbb{R}^{N_p}$ 是参数。权重矩阵为 $W=\text{diag}(1/\sigma_1,...,\sigma_{N_y})$，其中 $\sigma_j$ 为索引 $j$ 处数据的标准差。
我想做的是推导出 此表达式，用于最佳拟合参数 $p^\dagger$ 的协方差矩阵：
$$C_p = \sigma^2 (J^T J)^{-1}$$
其中 $J$ 是 $r$ 的雅可比矩阵，而 $\sigma^2$ 是
$$\sigma^2 = \frac{\lVert r(p^\dagger)\rVert^2}{N_y-N_p}$$
我尝试的方法
我尝试采用贝叶斯方法，其中最小二乘最小化是从均匀先验下给定观测值的参数的最大后验估计中得出的。我将略过这部分，因为这些都是众所周知的。我很乐意提供澄清。此外，如果我在这里掩盖了错误，我也很高兴。
假设所有$y_i$、$y_j$统计独立，我应该能够将后验写为：
$$P(p|y) = K \exp\left(-\frac{1}{2} \sum_j \frac{(y_j-f_j(p))^2}{\sigma_j^2} \right) = K \exp\left( -\frac{1}{2} \lVert r(p) \rVert^2 \right) = K \exp(-g(p)),$$
其中$K$是积分常数，对于简单来说，我这样写：
$$g(p) := \frac{1}{2} \lVert r(p) \rVert^2$$
然后，我使用 I 泰勒展开式对 $g(p)$ 进行最佳拟合参数 $p^\dagger$ 进行展开，即
$$g(p) \approx g(p^\dagger) + \nabla g(p^\dagger)(p-p^\dagger) + (p-p^\dagger)^T H(p^\dagger) (p-p^\dagger) = g(p^\dagger) + \frac{1}{2}(p-p^\dagger)^T H(p^\dagger) (p-p^\dagger),$$
其中 $H(p^\dagger)$ 是 $r(p)$ 的 Hessian 矩阵，在 $p^\dagger$ 处求值，我利用了梯度在 $p^\dagger$ 处消失的事实（有关公式，请参阅 此处第 3 页）。
现在我可以近似后验as
$$P(p|y) = K^\prime \exp\left( -\frac{1}{2}(p-p^\dagger)^T H(p^\dagger) (p-p^\dagger) \right),$$
其中我已将进一步的常数因子吸收到 $K^\prime$ 中。在我看来，这是一个 多元正态分布，其协方差矩阵为 $H(p^\dagger)^{-1}$。现在我知道我们经常用最小二乘近似法将 Hessian 近似为 $H=J^TJ$，这样我就可以得到协方差矩阵：
$$C_p = (J^T J)^{-1}$$
与我想要导出的表达式相比，这个表达式缺少 $\sigma^2$，我不知道我的逻辑哪里有缺陷。我感谢所有的帮助。]]></description>
      <guid>https://stats.stackexchange.com/questions/649786/error-in-bayesian-derivation-of-covariance-matrix-in-least-squares</guid>
      <pubDate>Mon, 24 Jun 2024 09:16:27 GMT</pubDate>
    </item>
    <item>
      <title>比较同一模型内的风险比</title>
      <link>https://stats.stackexchange.com/questions/649783/comparing-hazard-ratios-within-the-same-model</link>
      <description><![CDATA[我有一个包含两个预测因子的 Cox 回归模型：
预测因子 A：HR = 2.00，Z = 15.24，范围为 0-1（连续）
预测因子 B：HR = 0.97，Z = -6.68，范围为 1-17，
根据这些信息，我能说第一个变量对结果的影响更大吗？如果不是，我如何确定哪个预测因子的影响更大？
本质上，我正在寻找 OLS 中的 Beta 之类的东西。
谢谢！]]></description>
      <guid>https://stats.stackexchange.com/questions/649783/comparing-hazard-ratios-within-the-same-model</guid>
      <pubDate>Mon, 24 Jun 2024 07:26:53 GMT</pubDate>
    </item>
    <item>
      <title>具有多个独立变量的中介分析</title>
      <link>https://stats.stackexchange.com/questions/649782/mediation-analysis-with-multiple-independent-variables</link>
      <description><![CDATA[我想调查 M 是否在多个独立变量（X1、X2、X3）与 Y 的关系中起中介作用。我使用 R 中的中介包。这种使用 treat = &#39;X1&#39;、treat = &#39;X2&#39; 和 treat = &#39;X3&#39; 运行 3 个中介分析的方法是否正确？如果不是，正确的方法是什么？
fit.totaleffect &lt;- lmer(Y ~ TimePoint + X1 + X2 + X3 + covariate1 + covariate2 + (1 + TimePoint | ID), data = df)
fit.mediator &lt;- lmer(M ~ TimePoint + X1 + X2 + X3 + covariate1 + covariate2 + (1 + TimePoint | ID), data = df)
fit.dv &lt;- lmer(Y ~ M + TimePoint + X1 + X2 + X3 + covariate1 + covariate2 + (1 + TimePoint | ID), data = df)

# 中介分析
results_x1 &lt;- mediation::mediate(fit.mediator, fit.dv, treat=&#39;X1&#39;, mediator=&#39;M&#39;, sims = 500)
summary(results_x1)

results_x2 &lt;- mediation::mediate(fit.mediator, fit.dv, treat=&#39;X2&#39;, mediator=&#39;M&#39;, sims = 500)
summary(results_x2)

results_x3 &lt;- mediation::mediate(fit.mediator, fit.dv, treat=&#39;X3&#39;, mediator=&#39;M&#39;, sims = 500)
summary(results_x3)
]]></description>
      <guid>https://stats.stackexchange.com/questions/649782/mediation-analysis-with-multiple-independent-variables</guid>
      <pubDate>Mon, 24 Jun 2024 06:59:15 GMT</pubDate>
    </item>
    <item>
      <title>（如何）ROC/AUC 分析适应具有两个（或更多）阈值的问题？</title>
      <link>https://stats.stackexchange.com/questions/649780/how-can-roc-auc-analysis-be-adapted-to-problems-with-two-or-more-thresholds</link>
      <description><![CDATA[(如何) ROC/AUC 分析可以适应具有两个（或更多）阈值的问题？
示例 1：
我们测量变量 $x$，如果它落入区间 $[a, b]$，则分配标签 $1$，否则标记 $0$。然后我们有两个参数 $a,b$ 控制 TPR 和 FPR。
示例 2：
如果 $x&lt;a$，我们分配类 $0$，如果 $x&gt;b$ (b&gt;a)，我们分配类 $1$。如果 x 落入区间 $[a,b]$，则决策基于将第二个变量 $y$ 与阈值 $c$ 进行比较。]]></description>
      <guid>https://stats.stackexchange.com/questions/649780/how-can-roc-auc-analysis-be-adapted-to-problems-with-two-or-more-thresholds</guid>
      <pubDate>Mon, 24 Jun 2024 05:48:03 GMT</pubDate>
    </item>
    <item>
      <title>正确解读最终满足生存曲线</title>
      <link>https://stats.stackexchange.com/questions/649770/correct-interpretation-of-survival-curves-that-eventually-meet</link>
      <description><![CDATA[我有一些生存数据，我们正在尝试分析和理解这些数据。结果是疾病状态的进展。主要暴露在本质上是随时间变化的 - 最初未暴露，但一旦暴露，我们认为它们会一直保持这种状态，直到进展或审查。所以我们的数据是开始、停止格式 - 一切都很好。
我越来越被使用灵活的参数生存模型所吸引，因为它们使用简单，并且它们可以提供超出 Cox 模型的额外信息。我们最终用于此分析的灵活参数模型在对数累积基线风险的形状方面基本上简化为威布尔，但我们确实为主要暴露纳入了相互作用（时间变系数），因为它被证明具有非比例风险。
因此风险比随时间而变化。
附上随时间变化的 Kaplan Meier 和 HR 图。
生存曲线似乎在大约 17 年后汇合在一起，HR 表明暴露仅在前 5 年左右对结果有保护作用。
正确的解释方式是否类似于暴露在预防结果的短时间内有益处（相对于未暴露），但如果有足够的时间，每个人最终都会有相同程度的残疾？
如果是这样的话，我想你仍然可以合理地认为暴露在临时生活质量方面提供了好处，即使最终的净效应是中立？

]]></description>
      <guid>https://stats.stackexchange.com/questions/649770/correct-interpretation-of-survival-curves-that-eventually-meet</guid>
      <pubDate>Sun, 23 Jun 2024 22:56:43 GMT</pubDate>
    </item>
    <item>
      <title>卡尔曼滤波器最小化状态加权误差：我的推导有什么问题</title>
      <link>https://stats.stackexchange.com/questions/649748/kalman-filter-to-minimize-weighted-errors-on-the-states-whats-wrong-with-my-de</link>
      <description><![CDATA[我正在考虑如何实现“加权卡尔曼滤波器”。请注意，此处的权重取决于状态。基本上，经典的 KF 最小化 $\sum (x_i - \hat{x_i} )^2$，但我想最小化 $\sum w_i(x_i - \hat{x_i} )^2$，其中 $w_i$ 是外部提供的向量。
引用维基百科推导
更新函数是
\begin{aligned}
\mathbf {P} _{k\mid k-1}&amp;=\mathbf {F} _{k}\mathbf {P} _{k-1\mid k-1}\mathbf {F} _{k}^{\textsf {T}}+\mathbf {Q} _{k},\\
\mathbf {S} _{k}&amp;=\mathbf {H} _{k}\mathbf {P} _{k\mid k-1}\mathbf {H} _{k}^{\textsf {T}}+\mathbf {R} _{k},\\
\mathbf {K} _{k}&amp;=\mathbf {P} _{k\mid k-1}\mathbf {H} _{k}^{\textsf {T}}\mathbf {S} _{k}^{-1},\\
\mathbf {P} _{k|k}&amp;=\left(\mathbf {I} -\mathbf {K} _{k}\mathbf {H} _{k}\right)\mathbf {P} _{k|k-1}。
\end{aligned&gt;
我们如何找到最佳卡尔曼增益？我们对$P_{k|k}$求导，除以$K$
\begin{align}
\mathbf{P}_{k\mid k} &amp; = \mathbf{P}_{k\mid k-1} - \mathbf{K}_k \mathbf{H}_k \mathbf{P}_{k\mid k-1} - \mathbf{P}_{k\mid k-1} \mathbf{H}_k^\textsf{T} \mathbf{K}_k^\textsf{T} + \mathbf{K}_k \left(\mathbf{H}_k \mathbf{P}_{k\mid k-1} \mathbf{H}_k^\textsf{T} + \mathbf{R}_k\right) \mathbf{K}_k^\textsf{T} \\&amp;= \mathbf{P}_{k\mid k-1} - \mathbf{K}_k \mathbf{H}_k \mathbf{P}_{k\mid k-1} - \mathbf{P}_{k\mid k-1} \mathbf{H}_k^\textsf{T} \mathbf{K}_k^\textsf{T} + \mathbf{K}_k \mathbf{S}_k\mathbf{K}_k^\textsf{T}
\end{align&gt;
$$\frac{\partial \; \operatorname{tr}(\mathbf{P}_{k\mid k})}{\partial \;\mathbf{K}_k} = -2 \left(\mathbf{H}_k \mathbf{P}_{k\mid k-1}\right)^\textsf{T} + 2 \mathbf{K}_k \mathbf{S}_k = 0.$$
\begin{align}
\mathbf{K}_k \mathbf{S}_k &amp;= \left(\mathbf{H}_k \mathbf{P}_{k\mid k-1}\right)^\textsf{T} = \mathbf{P}_{k\mid k-1} \mathbf{H}_k^\textsf{T} \\
\Rightarrow \mathbf{K}_k &amp;= \mathbf{P}_{k\mid k-1} \mathbf{H}_k^\textsf{T} \mathbf{S}_k^{-1}
\end{align&gt;
然而，这是一个“未加权”的卡尔曼滤波器。我们最小化作为平方误差之和的迹。但是，如果我们想最小化平方误差的“加权”版本，该怎么办？ 我想确保估计某些状态的错误比其他状态具有更多的权重...我们可以假设我们知道权重是什么
我的尝试
由于矩阵 P 的迹是需要优化的目标函数，我们想以某种方式创建一个表达式 $P^{&#39;}_{k|k} = diag(w) \cdot P_{k|k} \cdot diag(w) $，其中 $w$ 是一个权重向量，其长度等于状态数。然后我们对 $P^{&#39;}_{k|k}$ 求导，得到 $K$。
给定 $\mathbf{P}_{k\mid k} = \mathbf{P}_{k\mid k-1} - \mathbf{K}_k \mathbf{H}_k \mathbf{P}_{k\mid k-1} - \mathbf{P}_{k\mid k-1} \mathbf{H}_k^\textsf{T} \mathbf{K}_k^\textsf{T} + \mathbf{K}_k \mathbf{S}_k\mathbf{K}_k^\textsf{T}$
我们可以在两端乘以 $W = diag(w)$：
$tr (WP_{k|k}W^T) = tr(P_{k|k} W W^T ) = tr(P_{k|k}\Omega )$（因为矩阵乘积的迹是可传递的。这里我们让 $W W^T = \Omega$ ）。
$$
\begin{align}
\frac{\partial tr(\mathbf {P} _{k\mid k}\Omega)}{\partial \mathbf{K}_k} &amp;= \frac{\partial tr(\mathbf{P}_{k\mid k-1}\Omega - \mathbf{K}_k \mathbf{H}_k \mathbf{P}_{k\mid k-1}\Omega - \mathbf{P}_{k\mid k-1} \mathbf{H}_k^\textsf{T} \mathbf{K}_k^\textsf{T}\Omega + \mathbf{K}_k \mathbf{S}_k\mathbf{K}_k^\textsf{T}\Omega )}{\partial \mathbf{K}_k} \\
&amp;= -2(\mathbf{H}_k \mathbf{P}_{k\mid k-1}\Omega)^T+2\Omega \mathbf{K}_k \mathbf{S}_k \\
&amp;= 0
\end{align}$$
因此
$$ \Omega \mathbf{K}_k \mathbf{S}_k = (\mathbf{H}_k \mathbf{P}_{k\mid k-1}\Omega)^T $$
由于 $\Omega$ 和 $P$ 是对称的
$$ \Omega \mathbf{K}_k \mathbf{S}_k = \Omega \mathbf{P}_{k\mid k-1} \mathbf{H}^T_k $$
并且 $\Omega$ 将被抵消...似乎卡尔曼增益在有或没有权重的情况下都相同？这似乎是错误的？]]></description>
      <guid>https://stats.stackexchange.com/questions/649748/kalman-filter-to-minimize-weighted-errors-on-the-states-whats-wrong-with-my-de</guid>
      <pubDate>Sun, 23 Jun 2024 14:07:46 GMT</pubDate>
    </item>
    <item>
      <title>GAM：平滑和因子交互作用</title>
      <link>https://stats.stackexchange.com/questions/649744/gam-smooth-and-factor-interaction</link>
      <description><![CDATA[我目前正在研究 GAM。它包括平滑因子交互。我正在尝试确定哪个函数是我需要的。
Model_gamlog2 &lt;- mgcv::gam(perpetration_all ~ dar_scale + s(dar_scale, by = age_binary) + age_binary, data = merged_all_complete, family=binomial, method = &quot;REML&quot;)

&gt; summary(Model_gamlog2)

系列：二项式 
链接函数：logit 

公式：
perpetration_all ~ dar_scale + s(dar_scale, by = age_binary) + 
age_binary

参数系数：
估计标准差。误差 z 值 Pr(&gt;|z|) 
(截距) 1.7862 0.3707 4.818 1.45e-06 ***
dar_scale -0.2610 7.0429 -0.037 0.970 
age_binary2 1.7874 1.2895 1.386 0.166 
---
显著性代码：0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

平滑项的近似显著性：
edf Ref.df Chi.sq p 值
s(dar_scale):age_binary1 1.000 1.000 0.010 0.920
s(dar_scale):age_binary2 1.474 2.122 2.038 0.421

排名：20/21
R-sq.(adj) = 0.0173 偏差解释 = 9.94%
-REML = 39.827 尺度估计 = 1 n = 134

这里我使用了 By= 参数。
我对此输出有一些疑问：

我是否需要 s() 作为平滑参数，或者 ti() 等是否也可以。我只希望每个 IV 级别的平滑参数在需要时有所不同。
如何查看是否存在交互？据我了解，平滑项仅告诉我每个 IV 级别的年龄与 DV 没有显着相关性，而不是它们是否不同。

或者我有以下代码：
Model_gamlog2 &lt;- mgcv::gam(perpetration_all ~ dar_scale + s(dar_scale, age_binary, bs = &quot;fs&quot;) + age_binary, data = merged_all_complete, family=binomial, method = &quot;REML&quot;)

&gt; summary(Model_gamlog2)

系列：二项式

链接函数：logit

公式：
perpetration_all ~ dar_scale + s(dar_scale, age_binary, bs = &quot;fs&quot;) + 
age_binary

参数系数：
估计标准误差 z 值 Pr(&gt;|z|) 
(截距) 1.8761 0.3907 4.802 1.57e-06 ***
dar_scale 0.5246 0.4452 1.178 0.2386 
age_binary2 1.2737 0.7561 1.685 0.0921 . 
---
Signif.代码：0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

平滑项的近似显著性：
edf Ref.df Chi.sq p 值
s(dar_scale,age_binary) 3.346 17 5.558 0.125

R-sq.(adj) = 0.0508 偏差解释 = 13.9%
-REML = 42.792 尺度估计 = 1 n = 134

s(dar_scale,age_binary) 是否显示交互作用？]]></description>
      <guid>https://stats.stackexchange.com/questions/649744/gam-smooth-and-factor-interaction</guid>
      <pubDate>Sun, 23 Jun 2024 11:33:25 GMT</pubDate>
    </item>
    <item>
      <title>广义可加模型的模型检验</title>
      <link>https://stats.stackexchange.com/questions/649509/model-checking-for-generalized-additive-models</link>
      <description><![CDATA[我目前正在构建一个 GAM 模型来描述房价。该数据集是特定地理区域内大约 20 万笔房屋销售的集合。
根据本论坛先前的建议，平均房价$p_{i}$的建模方式如下：
$$
\ln (p_{i}) = \sum_{j}s_{j}(x_{i,j}) \ \ , \ \ P_{i} \sim Tweedie(p_{i}) 
$$
，其中$s_{j}$表示我的一组协变量的第j个平滑值，这些协变量包括地理位置、房屋大小、地块大小等。由于价格的严格正性，我发现对数链接和Tweedie分布的组合提供了以样本外误差衡量的最佳结果（但是，带有对数链接的Gamma分布也表现得相当不错 -有关详细信息，请参阅我之前的帖子从拟合的 t 分布 mgcv 进行模拟）。
为了寻找最佳模型，我尝试了一系列不同的协变量，并得出了一个模型，我认为该模型在预测能力和简约性之间的平衡方面是最佳的。然而，我担心应用 mgcv（或 gratia 库中的 appraise()）提供的模型检查例程时得到的结果，如下所示：

显然，基于 QQ 图的结果表明，我的模型无法捕捉分布中的肥尾。此外，残差与线性预测器图并不像人们希望的那样是平坦的带状，而是在负残差的第一部分中有一些系统线性分量 - 我怀疑这与模型只能输出正值有关。
由于我对 GAM 模型检查的经验有限，因此我想向那些在该领域更有经验的人提出以下问题：
上述模型诊断是否表明我的模型存在严重问题，或者它们是否在人们通常可以接受的容差范围内？如果是这样，人们在基于 QQ 图等评估模型质量时使用的一般经验法则是什么。]]></description>
      <guid>https://stats.stackexchange.com/questions/649509/model-checking-for-generalized-additive-models</guid>
      <pubDate>Wed, 19 Jun 2024 11:36:50 GMT</pubDate>
    </item>
    <item>
      <title>加权线性回归的预测带</title>
      <link>https://stats.stackexchange.com/questions/649463/prediction-bands-for-weighted-linear-regression</link>
      <description><![CDATA[对于 $x_i, y_i,$ 的线性回归，我们知道置信区间为：
$$\hat{y} \pm t \cdot s \sqrt{ \frac{1}{n} + \frac{(x - \bar{x})^2}{\sum (x_i - \bar{x})^2} }$$
和预测带：
$$\hat{y} \pm t \cdot s \sqrt{ 1+ \frac{1}{n} + \frac{(x - \bar{x})^2}{\sum (x_i - \bar{x})^2} }$$
在加权线性回归情况下（权重$w_i$），我们有置信区间：
$$\hat{y} \pm t \cdot s \sqrt{ \frac{1}{\sum w_i} + \frac{(x - \bar{x}_w)^2}{\sum w_i (x_i - \bar{x}_w)^2} }$$
但预测带的公式是什么？ （与上一个公式的形式类似）
直观地讲，如果我们将权重 $1, 1, 1, 1, \ldots$ 替换为例如 $0.1, 0.1, 0.1, 0.1, \ldots$，那么波段应该保持不变，因此这表明它可能不是：
$$\hat{y} \pm t \cdot s \sqrt{ 1+ \frac{1}{\sum w_i} + \frac{(x - \bar{x}_w)^2}{\sum w_i (x_i - \bar{x}_w)^2}}$$
目标：假设我们想要在图表上绘制$(x_i, y_i)$散点、加权回归线、置信区间区域和预测带，如下所示：

那么，我们可以使用哪个公式来绘制预测带？]]></description>
      <guid>https://stats.stackexchange.com/questions/649463/prediction-bands-for-weighted-linear-regression</guid>
      <pubDate>Tue, 18 Jun 2024 14:33:31 GMT</pubDate>
    </item>
    </channel>
</rss>